var m8=Object.defineProperty;var Dg=Bt=>{throw TypeError(Bt)};var p8=(Bt,Rt,en)=>Rt in Bt?m8(Bt,Rt,{enumerable:!0,configurable:!0,writable:!0,value:en}):Bt[Rt]=en;var Kf=(Bt,Rt,en)=>p8(Bt,typeof Rt!="symbol"?Rt+"":Rt,en),Ng=(Bt,Rt,en)=>Rt.has(Bt)||Dg("Cannot "+en);var ur=(Bt,Rt,en)=>(Ng(Bt,Rt,"read from private field"),en?en.call(Bt):Rt.get(Bt)),ca=(Bt,Rt,en)=>Rt.has(Bt)?Dg("Cannot add the same private member more than once"):Rt instanceof WeakSet?Rt.add(Bt):Rt.set(Bt,en),Cr=(Bt,Rt,en,an)=>(Ng(Bt,Rt,"write to private field"),an?an.call(Bt,en):Rt.set(Bt,en),en);var $f=(Bt,Rt,en,an)=>({set _(Xi){Cr(Bt,Rt,Xi,en)},get _(){return ur(Bt,Rt,an)}});(function(){"use strict";var Gn,vi,xi;var Bt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Rt,en;function an(){return en||(en=1,Rt=function(e){try{return!!e()}catch{return!0}}),Rt}var Xi,Yf;function Ho(){if(Yf)return Xi;Yf=1;var e=an();return Xi=!e(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),Xi}var ua,Wf;function vn(){if(Wf)return ua;Wf=1;var e=Ho(),t=Function.prototype,n=t.call,r=e&&t.bind.bind(n,n);return ua=e?r:function(i){return function(){return n.apply(i,arguments)}},ua}var la,Zf;function jo(){if(Zf)return la;Zf=1;var e=vn(),t=e({}.toString),n=e("".slice);return la=function(r){return n(t(r),8,-1)},la}var fa,Xf;function Tg(){if(Xf)return fa;Xf=1;var e=vn(),t=an(),n=jo(),r=Object,i=e("".split);return fa=t(function(){return!r("z").propertyIsEnumerable(0)})?function(o){return n(o)==="String"?i(o,""):r(o)}:r,fa}var da,Qf;function zo(){return Qf||(Qf=1,da=function(e){return e==null}),da}var ha,Jf;function Vo(){if(Jf)return ha;Jf=1;var e=zo(),t=TypeError;return ha=function(n){if(e(n))throw new t("Can't call method on "+n);return n},ha}var ma,ed;function Qi(){if(ed)return ma;ed=1;var e=Tg(),t=Vo();return ma=function(n){return e(t(n))},ma}var Ji,td;function Ht(){if(td)return Ji;td=1;var e=function(t){return t&&t.Math===Math&&t};return Ji=e(typeof globalThis=="object"&&globalThis)||e(typeof window=="object"&&window)||e(typeof self=="object"&&self)||e(typeof Bt=="object"&&Bt)||e(typeof Ji=="object"&&Ji)||function(){return this}()||Function("return this")(),Ji}var pa={exports:{}},_a,nd;function un(){return nd||(nd=1,_a=!1),_a}var ya,rd;function ga(){if(rd)return ya;rd=1;var e=Ht(),t=Object.defineProperty;return ya=function(n,r){try{t(e,n,{value:r,configurable:!0,writable:!0})}catch{e[n]=r}return r},ya}var id;function Ko(){if(id)return pa.exports;id=1;var e=un(),t=Ht(),n=ga(),r="__core-js_shared__",i=pa.exports=t[r]||n(r,{});return(i.versions||(i.versions=[])).push({version:"3.41.0",mode:e?"pure":"global",copyright:"Â© 2014-2025 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.41.0/LICENSE",source:"https://github.com/zloirock/core-js"}),pa.exports}var ba,od;function sd(){if(od)return ba;od=1;var e=Ko();return ba=function(t,n){return e[t]||(e[t]=n||{})},ba}var va,ad;function xa(){if(ad)return va;ad=1;var e=Vo(),t=Object;return va=function(n){return t(e(n))},va}var Aa,cd;function Nn(){if(cd)return Aa;cd=1;var e=vn(),t=xa(),n=e({}.hasOwnProperty);return Aa=Object.hasOwn||function(i,o){return n(t(i),o)},Aa}var Sa,ud;function ld(){if(ud)return Sa;ud=1;var e=vn(),t=0,n=Math.random(),r=e(1 .toString);return Sa=function(i){return"Symbol("+(i===void 0?"":i)+")_"+r(++t+n,36)},Sa}var Ca,fd;function eo(){if(fd)return Ca;fd=1;var e=Ht(),t=e.navigator,n=t&&t.userAgent;return Ca=n?String(n):"",Ca}var Ia,dd;function hd(){if(dd)return Ia;dd=1;var e=Ht(),t=eo(),n=e.process,r=e.Deno,i=n&&n.versions||r&&r.version,o=i&&i.v8,s,a;return o&&(s=o.split("."),a=s[0]>0&&s[0]<4?1:+(s[0]+s[1])),!a&&t&&(s=t.match(/Edge\/(\d+)/),(!s||s[1]>=74)&&(s=t.match(/Chrome\/(\d+)/),s&&(a=+s[1]))),Ia=a,Ia}var wa,md;function pd(){if(md)return wa;md=1;var e=hd(),t=an(),n=Ht(),r=n.String;return wa=!!Object.getOwnPropertySymbols&&!t(function(){var i=Symbol("symbol detection");return!r(i)||!(Object(i)instanceof Symbol)||!Symbol.sham&&e&&e<41}),wa}var Pa,_d;function yd(){if(_d)return Pa;_d=1;var e=pd();return Pa=e&&!Symbol.sham&&typeof Symbol.iterator=="symbol",Pa}var Ea,gd;function on(){if(gd)return Ea;gd=1;var e=Ht(),t=sd(),n=Nn(),r=ld(),i=pd(),o=yd(),s=e.Symbol,a=t("wks"),c=o?s.for||s:s&&s.withoutSetter||r;return Ea=function(u){return n(a,u)||(a[u]=i&&n(s,u)?s[u]:c("Symbol."+u)),a[u]},Ea}var Ba,bd;function Yt(){if(bd)return Ba;bd=1;var e=typeof document=="object"&&document.all;return Ba=typeof e>"u"&&e!==void 0?function(t){return typeof t=="function"||t===e}:function(t){return typeof t=="function"},Ba}var Ra,vd;function Qn(){if(vd)return Ra;vd=1;var e=Yt();return Ra=function(t){return typeof t=="object"?t!==null:e(t)},Ra}var Da,xd;function Mt(){if(xd)return Da;xd=1;var e=Qn(),t=String,n=TypeError;return Da=function(r){if(e(r))return r;throw new n(t(r)+" is not an object")},Da}var Na={},Ma,Ad;function wn(){if(Ad)return Ma;Ad=1;var e=an();return Ma=!e(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),Ma}var Ta,Sd;function Cd(){if(Sd)return Ta;Sd=1;var e=wn(),t=an();return Ta=e&&t(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),Ta}var Oa={},ka,Id;function $o(){if(Id)return ka;Id=1;var e=Ht(),t=Qn(),n=e.document,r=t(n)&&t(n.createElement);return ka=function(i){return r?n.createElement(i):{}},ka}var qa,wd;function Pd(){if(wd)return qa;wd=1;var e=wn(),t=an(),n=$o();return qa=!e&&!t(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7}),qa}var Ua,Ed;function jt(){if(Ed)return Ua;Ed=1;var e=Ho(),t=Function.prototype.call;return Ua=e?t.bind(t):function(){return t.apply(t,arguments)},Ua}var Fa,Bd;function lr(){if(Bd)return Fa;Bd=1;var e=Ht(),t=Yt(),n=function(r){return t(r)?r:void 0};return Fa=function(r,i){return arguments.length<2?n(e[r]):e[r]&&e[r][i]},Fa}var La,Rd;function Yo(){if(Rd)return La;Rd=1;var e=vn();return La=e({}.isPrototypeOf),La}var Ga,Dd;function Nd(){if(Dd)return Ga;Dd=1;var e=lr(),t=Yt(),n=Yo(),r=yd(),i=Object;return Ga=r?function(o){return typeof o=="symbol"}:function(o){var s=e("Symbol");return t(s)&&n(s.prototype,i(o))},Ga}var Ha,Md;function Wo(){if(Md)return Ha;Md=1;var e=String;return Ha=function(t){try{return e(t)}catch{return"Object"}},Ha}var ja,Td;function fn(){if(Td)return ja;Td=1;var e=Yt(),t=Wo(),n=TypeError;return ja=function(r){if(e(r))return r;throw new n(t(r)+" is not a function")},ja}var za,Od;function Yr(){if(Od)return za;Od=1;var e=fn(),t=zo();return za=function(n,r){var i=n[r];return t(i)?void 0:e(i)},za}var Va,kd;function Og(){if(kd)return Va;kd=1;var e=jt(),t=Yt(),n=Qn(),r=TypeError;return Va=function(i,o){var s,a;if(o==="string"&&t(s=i.toString)&&!n(a=e(s,i))||t(s=i.valueOf)&&!n(a=e(s,i))||o!=="string"&&t(s=i.toString)&&!n(a=e(s,i)))return a;throw new r("Can't convert object to primitive value")},Va}var Ka,qd;function kg(){if(qd)return Ka;qd=1;var e=jt(),t=Qn(),n=Nd(),r=Yr(),i=Og(),o=on(),s=TypeError,a=o("toPrimitive");return Ka=function(c,u){if(!t(c)||n(c))return c;var l=r(c,a),d;if(l){if(u===void 0&&(u="default"),d=e(l,c,u),!t(d)||n(d))return d;throw new s("Can't convert object to primitive value")}return u===void 0&&(u="number"),i(c,u)},Ka}var $a,Ud;function Fd(){if(Ud)return $a;Ud=1;var e=kg(),t=Nd();return $a=function(n){var r=e(n,"string");return t(r)?r:r+""},$a}var Ld;function fr(){if(Ld)return Oa;Ld=1;var e=wn(),t=Pd(),n=Cd(),r=Mt(),i=Fd(),o=TypeError,s=Object.defineProperty,a=Object.getOwnPropertyDescriptor,c="enumerable",u="configurable",l="writable";return Oa.f=e?n?function(f,h,p){if(r(f),h=i(h),r(p),typeof f=="function"&&h==="prototype"&&"value"in p&&l in p&&!p[l]){var m=a(f,h);m&&m[l]&&(f[h]=p.value,p={configurable:u in p?p[u]:m[u],enumerable:c in p?p[c]:m[c],writable:!1})}return s(f,h,p)}:s:function(f,h,p){if(r(f),h=i(h),r(p),t)try{return s(f,h,p)}catch{}if("get"in p||"set"in p)throw new o("Accessors not supported");return"value"in p&&(f[h]=p.value),f},Oa}var Ya,Gd;function qg(){if(Gd)return Ya;Gd=1;var e=Math.ceil,t=Math.floor;return Ya=Math.trunc||function(r){var i=+r;return(i>0?t:e)(i)},Ya}var Wa,Hd;function Zo(){if(Hd)return Wa;Hd=1;var e=qg();return Wa=function(t){var n=+t;return n!==n||n===0?0:e(n)},Wa}var Za,jd;function Ug(){if(jd)return Za;jd=1;var e=Zo(),t=Math.max,n=Math.min;return Za=function(r,i){var o=e(r);return o<0?t(o+i,0):n(o,i)},Za}var Xa,zd;function Fg(){if(zd)return Xa;zd=1;var e=Zo(),t=Math.min;return Xa=function(n){var r=e(n);return r>0?t(r,9007199254740991):0},Xa}var Qa,Vd;function Kd(){if(Vd)return Qa;Vd=1;var e=Fg();return Qa=function(t){return e(t.length)},Qa}var Ja,$d;function Lg(){if($d)return Ja;$d=1;var e=Qi(),t=Ug(),n=Kd(),r=function(i){return function(o,s,a){var c=e(o),u=n(c);if(u===0)return!i&&-1;var l=t(a,u),d;if(i&&s!==s){for(;u>l;)if(d=c[l++],d!==d)return!0}else for(;u>l;l++)if((i||l in c)&&c[l]===s)return i||l||0;return!i&&-1}};return Ja={includes:r(!0),indexOf:r(!1)},Ja}var ec,Yd;function tc(){return Yd||(Yd=1,ec={}),ec}var nc,Wd;function Zd(){if(Wd)return nc;Wd=1;var e=vn(),t=Nn(),n=Qi(),r=Lg().indexOf,i=tc(),o=e([].push);return nc=function(s,a){var c=n(s),u=0,l=[],d;for(d in c)!t(i,d)&&t(c,d)&&o(l,d);for(;a.length>u;)t(c,d=a[u++])&&(~r(l,d)||o(l,d));return l},nc}var rc,Xd;function ic(){return Xd||(Xd=1,rc=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),rc}var oc,Qd;function Gg(){if(Qd)return oc;Qd=1;var e=Zd(),t=ic();return oc=Object.keys||function(r){return e(r,t)},oc}var Jd;function Hg(){if(Jd)return Na;Jd=1;var e=wn(),t=Cd(),n=fr(),r=Mt(),i=Qi(),o=Gg();return Na.f=e&&!t?Object.defineProperties:function(a,c){r(a);for(var u=i(c),l=o(c),d=l.length,f=0,h;d>f;)n.f(a,h=l[f++],u[h]);return a},Na}var sc,e1;function t1(){if(e1)return sc;e1=1;var e=lr();return sc=e("document","documentElement"),sc}var ac,n1;function cc(){if(n1)return ac;n1=1;var e=sd(),t=ld(),n=e("keys");return ac=function(r){return n[r]||(n[r]=t(r))},ac}var uc,r1;function Wr(){if(r1)return uc;r1=1;var e=Mt(),t=Hg(),n=ic(),r=tc(),i=t1(),o=$o(),s=cc(),a=">",c="<",u="prototype",l="script",d=s("IE_PROTO"),f=function(){},h=function(b){return c+l+a+b+c+"/"+l+a},p=function(b){b.write(h("")),b.close();var v=b.parentWindow.Object;return b=null,v},m=function(){var b=o("iframe"),v="java"+l+":",_;return b.style.display="none",i.appendChild(b),b.src=String(v),_=b.contentWindow.document,_.open(),_.write(h("document.F=Object")),_.close(),_.F},y,g=function(){try{y=new ActiveXObject("htmlfile")}catch{}g=typeof document<"u"?document.domain&&y?p(y):m():p(y);for(var b=n.length;b--;)delete g[u][n[b]];return g()};return r[d]=!0,uc=Object.create||function(v,_){var A;return v!==null?(f[u]=e(v),A=new f,f[u]=null,A[d]=v):A=g(),_===void 0?A:t.f(A,_)},uc}var lc,i1;function jg(){if(i1)return lc;i1=1;var e=on(),t=Wr(),n=fr().f,r=e("unscopables"),i=Array.prototype;return i[r]===void 0&&n(i,r,{configurable:!0,value:t(null)}),lc=function(o){i[r][o]=!0},lc}var fc,o1;function to(){return o1||(o1=1,fc={}),fc}var dc,s1;function zg(){if(s1)return dc;s1=1;var e=Ht(),t=Yt(),n=e.WeakMap;return dc=t(n)&&/native code/.test(String(n)),dc}var hc,a1;function Xo(){return a1||(a1=1,hc=function(e,t){return{enumerable:!(e&1),configurable:!(e&2),writable:!(e&4),value:t}}),hc}var mc,c1;function Ci(){if(c1)return mc;c1=1;var e=wn(),t=fr(),n=Xo();return mc=e?function(r,i,o){return t.f(r,i,n(1,o))}:function(r,i,o){return r[i]=o,r},mc}var pc,u1;function Zr(){if(u1)return pc;u1=1;var e=zg(),t=Ht(),n=Qn(),r=Ci(),i=Nn(),o=Ko(),s=cc(),a=tc(),c="Object already initialized",u=t.TypeError,l=t.WeakMap,d,f,h,p=function(b){return h(b)?f(b):d(b,{})},m=function(b){return function(v){var _;if(!n(v)||(_=f(v)).type!==b)throw new u("Incompatible receiver, "+b+" required");return _}};if(e||o.state){var y=o.state||(o.state=new l);y.get=y.get,y.has=y.has,y.set=y.set,d=function(b,v){if(y.has(b))throw new u(c);return v.facade=b,y.set(b,v),v},f=function(b){return y.get(b)||{}},h=function(b){return y.has(b)}}else{var g=s("state");a[g]=!0,d=function(b,v){if(i(b,g))throw new u(c);return v.facade=b,r(b,g,v),v},f=function(b){return i(b,g)?b[g]:{}},h=function(b){return i(b,g)}}return pc={set:d,get:f,has:h,enforce:p,getterFor:m},pc}var _c={},yc={},l1;function Vg(){if(l1)return yc;l1=1;var e={}.propertyIsEnumerable,t=Object.getOwnPropertyDescriptor,n=t&&!e.call({1:2},1);return yc.f=n?function(i){var o=t(this,i);return!!o&&o.enumerable}:e,yc}var f1;function d1(){if(f1)return _c;f1=1;var e=wn(),t=jt(),n=Vg(),r=Xo(),i=Qi(),o=Fd(),s=Nn(),a=Pd(),c=Object.getOwnPropertyDescriptor;return _c.f=e?c:function(l,d){if(l=i(l),d=o(d),a)try{return c(l,d)}catch{}if(s(l,d))return r(!t(n.f,l,d),l[d])},_c}var gc={exports:{}},bc,h1;function m1(){if(h1)return bc;h1=1;var e=wn(),t=Nn(),n=Function.prototype,r=e&&Object.getOwnPropertyDescriptor,i=t(n,"name"),o=i&&(function(){}).name==="something",s=i&&(!e||e&&r(n,"name").configurable);return bc={EXISTS:i,PROPER:o,CONFIGURABLE:s},bc}var vc,p1;function xc(){if(p1)return vc;p1=1;var e=vn(),t=Yt(),n=Ko(),r=e(Function.toString);return t(n.inspectSource)||(n.inspectSource=function(i){return r(i)}),vc=n.inspectSource,vc}var _1;function y1(){if(_1)return gc.exports;_1=1;var e=vn(),t=an(),n=Yt(),r=Nn(),i=wn(),o=m1().CONFIGURABLE,s=xc(),a=Zr(),c=a.enforce,u=a.get,l=String,d=Object.defineProperty,f=e("".slice),h=e("".replace),p=e([].join),m=i&&!t(function(){return d(function(){},"length",{value:8}).length!==8}),y=String(String).split("String"),g=gc.exports=function(b,v,_){f(l(v),0,7)==="Symbol("&&(v="["+h(l(v),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),_&&_.getter&&(v="get "+v),_&&_.setter&&(v="set "+v),(!r(b,"name")||o&&b.name!==v)&&(i?d(b,"name",{value:v,configurable:!0}):b.name=v),m&&_&&r(_,"arity")&&b.length!==_.arity&&d(b,"length",{value:_.arity});try{_&&r(_,"constructor")&&_.constructor?i&&d(b,"prototype",{writable:!1}):b.prototype&&(b.prototype=void 0)}catch{}var A=c(b);return r(A,"source")||(A.source=p(y,typeof v=="string"?v:"")),b};return Function.prototype.toString=g(function(){return n(this)&&u(this).source||s(this)},"toString"),gc.exports}var Ac,g1;function dr(){if(g1)return Ac;g1=1;var e=Yt(),t=fr(),n=y1(),r=ga();return Ac=function(i,o,s,a){a||(a={});var c=a.enumerable,u=a.name!==void 0?a.name:o;if(e(s)&&n(s,u,a),a.global)c?i[o]=s:r(o,s);else{try{a.unsafe?i[o]&&(c=!0):delete i[o]}catch{}c?i[o]=s:t.f(i,o,{value:s,enumerable:!1,configurable:!a.nonConfigurable,writable:!a.nonWritable})}return i},Ac}var Sc={},b1;function Kg(){if(b1)return Sc;b1=1;var e=Zd(),t=ic(),n=t.concat("length","prototype");return Sc.f=Object.getOwnPropertyNames||function(i){return e(i,n)},Sc}var Cc={},v1;function $g(){return v1||(v1=1,Cc.f=Object.getOwnPropertySymbols),Cc}var Ic,x1;function Yg(){if(x1)return Ic;x1=1;var e=lr(),t=vn(),n=Kg(),r=$g(),i=Mt(),o=t([].concat);return Ic=e("Reflect","ownKeys")||function(a){var c=n.f(i(a)),u=r.f;return u?o(c,u(a)):c},Ic}var wc,A1;function Wg(){if(A1)return wc;A1=1;var e=Nn(),t=Yg(),n=d1(),r=fr();return wc=function(i,o,s){for(var a=t(o),c=r.f,u=n.f,l=0;l<a.length;l++){var d=a[l];!e(i,d)&&!(s&&e(s,d))&&c(i,d,u(o,d))}},wc}var Pc,S1;function C1(){if(S1)return Pc;S1=1;var e=an(),t=Yt(),n=/#|\.prototype\./,r=function(c,u){var l=o[i(c)];return l===a?!0:l===s?!1:t(u)?e(u):!!u},i=r.normalize=function(c){return String(c).replace(n,".").toLowerCase()},o=r.data={},s=r.NATIVE="N",a=r.POLYFILL="P";return Pc=r,Pc}var Ec,I1;function Wt(){if(I1)return Ec;I1=1;var e=Ht(),t=d1().f,n=Ci(),r=dr(),i=ga(),o=Wg(),s=C1();return Ec=function(a,c){var u=a.target,l=a.global,d=a.stat,f,h,p,m,y,g;if(l?h=e:d?h=e[u]||i(u,{}):h=e[u]&&e[u].prototype,h)for(p in c){if(y=c[p],a.dontCallGetSet?(g=t(h,p),m=g&&g.value):m=h[p],f=s(l?p:u+(d?".":"#")+p,a.forced),!f&&m!==void 0){if(typeof y==typeof m)continue;o(y,m)}(a.sham||m&&m.sham)&&n(y,"sham",!0),r(h,p,y,a)}},Ec}var Bc,w1;function Zg(){if(w1)return Bc;w1=1;var e=an();return Bc=!e(function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}),Bc}var Rc,P1;function Qo(){if(P1)return Rc;P1=1;var e=Nn(),t=Yt(),n=xa(),r=cc(),i=Zg(),o=r("IE_PROTO"),s=Object,a=s.prototype;return Rc=i?s.getPrototypeOf:function(c){var u=n(c);if(e(u,o))return u[o];var l=u.constructor;return t(l)&&u instanceof l?l.prototype:u instanceof s?a:null},Rc}var Dc,E1;function Ii(){if(E1)return Dc;E1=1;var e=an(),t=Yt(),n=Qn(),r=Wr(),i=Qo(),o=dr(),s=on(),a=un(),c=s("iterator"),u=!1,l,d,f;[].keys&&(f=[].keys(),"next"in f?(d=i(i(f)),d!==Object.prototype&&(l=d)):u=!0);var h=!n(l)||e(function(){var p={};return l[c].call(p)!==p});return h?l={}:a&&(l=r(l)),t(l[c])||o(l,c,function(){return this}),Dc={IteratorPrototype:l,BUGGY_SAFARI_ITERATORS:u},Dc}var Nc,B1;function Jo(){if(B1)return Nc;B1=1;var e=fr().f,t=Nn(),n=on(),r=n("toStringTag");return Nc=function(i,o,s){i&&!s&&(i=i.prototype),i&&!t(i,r)&&e(i,r,{configurable:!0,value:o})},Nc}var Mc,R1;function Xg(){if(R1)return Mc;R1=1;var e=Ii().IteratorPrototype,t=Wr(),n=Xo(),r=Jo(),i=to(),o=function(){return this};return Mc=function(s,a,c,u){var l=a+" Iterator";return s.prototype=t(e,{next:n(+!u,c)}),r(s,l,!1,!0),i[l]=o,s},Mc}var Tc,D1;function Qg(){if(D1)return Tc;D1=1;var e=vn(),t=fn();return Tc=function(n,r,i){try{return e(t(Object.getOwnPropertyDescriptor(n,r)[i]))}catch{}},Tc}var Oc,N1;function Jg(){if(N1)return Oc;N1=1;var e=Qn();return Oc=function(t){return e(t)||t===null},Oc}var kc,M1;function eb(){if(M1)return kc;M1=1;var e=Jg(),t=String,n=TypeError;return kc=function(r){if(e(r))return r;throw new n("Can't set "+t(r)+" as a prototype")},kc}var qc,T1;function O1(){if(T1)return qc;T1=1;var e=Qg(),t=Qn(),n=Vo(),r=eb();return qc=Object.setPrototypeOf||("__proto__"in{}?function(){var i=!1,o={},s;try{s=e(Object.prototype,"__proto__","set"),s(o,[]),i=o instanceof Array}catch{}return function(c,u){return n(c),r(u),t(c)&&(i?s(c,u):c.__proto__=u),c}}():void 0),qc}var Uc,k1;function q1(){if(k1)return Uc;k1=1;var e=Wt(),t=jt(),n=un(),r=m1(),i=Yt(),o=Xg(),s=Qo(),a=O1(),c=Jo(),u=Ci(),l=dr(),d=on(),f=to(),h=Ii(),p=r.PROPER,m=r.CONFIGURABLE,y=h.IteratorPrototype,g=h.BUGGY_SAFARI_ITERATORS,b=d("iterator"),v="keys",_="values",A="entries",C=function(){return this};return Uc=function(I,S,w,R,M,P,E){o(w,S,R);var N=function(_e){if(_e===M&&se)return se;if(!g&&_e&&_e in z)return z[_e];switch(_e){case v:return function(){return new w(this,_e)};case _:return function(){return new w(this,_e)};case A:return function(){return new w(this,_e)}}return function(){return new w(this)}},q=S+" Iterator",j=!1,z=I.prototype,W=z[b]||z["@@iterator"]||M&&z[M],se=!g&&W||N(M),ue=S==="Array"&&z.entries||W,$,ne,de;if(ue&&($=s(ue.call(new I)),$!==Object.prototype&&$.next&&(!n&&s($)!==y&&(a?a($,y):i($[b])||l($,b,C)),c($,q,!0,!0),n&&(f[q]=C))),p&&M===_&&W&&W.name!==_&&(!n&&m?u(z,"name",_):(j=!0,se=function(){return t(W,this)})),M)if(ne={values:N(_),keys:P?se:N(v),entries:N(A)},E)for(de in ne)(g||j||!(de in z))&&l(z,de,ne[de]);else e({target:S,proto:!0,forced:g||j},ne);return(!n||E)&&z[b]!==se&&l(z,b,se,{name:M}),f[S]=se,ne},Uc}var Fc,U1;function no(){return U1||(U1=1,Fc=function(e,t){return{value:e,done:t}}),Fc}var Lc,F1;function L1(){if(F1)return Lc;F1=1;var e=Qi(),t=jg(),n=to(),r=Zr(),i=fr().f,o=q1(),s=no(),a=un(),c=wn(),u="Array Iterator",l=r.set,d=r.getterFor(u);Lc=o(Array,"Array",function(h,p){l(this,{type:u,target:e(h),index:0,kind:p})},function(){var h=d(this),p=h.target,m=h.index++;if(!p||m>=p.length)return h.target=null,s(void 0,!0);switch(h.kind){case"keys":return s(m,!1);case"values":return s(p[m],!1)}return s([m,p[m]],!1)},"values");var f=n.Arguments=n.Array;if(t("keys"),t("values"),t("entries"),!a&&c&&f.name!=="values")try{i(f,"name",{value:"values"})}catch{}return Lc}var G1={},Gc,H1;function Hc(){if(H1)return Gc;H1=1;var e=on(),t=e("toStringTag"),n={};return n[t]="z",Gc=String(n)==="[object z]",Gc}var jc,j1;function es(){if(j1)return jc;j1=1;var e=Hc(),t=Yt(),n=jo(),r=on(),i=r("toStringTag"),o=Object,s=n(function(){return arguments}())==="Arguments",a=function(c,u){try{return c[u]}catch{}};return jc=e?n:function(c){var u,l,d;return c===void 0?"Undefined":c===null?"Null":typeof(l=a(u=o(c),i))=="string"?l:s?n(u):(d=n(u))==="Object"&&t(u.callee)?"Arguments":d},jc}var zc,z1;function tb(){if(z1)return zc;z1=1;var e=Hc(),t=es();return zc=e?{}.toString:function(){return"[object "+t(this)+"]"},zc}var V1;function nb(){if(V1)return G1;V1=1;var e=Hc(),t=dr(),n=tb();return e||t(Object.prototype,"toString",n,{unsafe:!0}),G1}var K1={},Vc,$1;function Y1(){if($1)return Vc;$1=1;var e=es(),t=String;return Vc=function(n){if(e(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return t(n)},Vc}var Kc,W1;function rb(){if(W1)return Kc;W1=1;var e=vn(),t=Zo(),n=Y1(),r=Vo(),i=e("".charAt),o=e("".charCodeAt),s=e("".slice),a=function(c){return function(u,l){var d=n(r(u)),f=t(l),h=d.length,p,m;return f<0||f>=h?c?"":void 0:(p=o(d,f),p<55296||p>56319||f+1===h||(m=o(d,f+1))<56320||m>57343?c?i(d,f):p:c?s(d,f,f+2):(p-55296<<10)+(m-56320)+65536)}};return Kc={codeAt:a(!1),charAt:a(!0)},Kc}var Z1;function ib(){if(Z1)return K1;Z1=1;var e=rb().charAt,t=Y1(),n=Zr(),r=q1(),i=no(),o="String Iterator",s=n.set,a=n.getterFor(o);return r(String,"String",function(c){s(this,{type:o,string:t(c),index:0})},function(){var u=a(this),l=u.string,d=u.index,f;return d>=l.length?i(void 0,!0):(f=e(l,d),u.index+=f.length,i(f,!1))}),K1}var X1={},$c,Q1;function J1(){if(Q1)return $c;Q1=1;var e=Yo(),t=TypeError;return $c=function(n,r){if(e(r,n))return n;throw new t("Incorrect invocation")},$c}var Yc,e0;function t0(){if(e0)return Yc;e0=1;var e=y1(),t=fr();return Yc=function(n,r,i){return i.get&&e(i.get,r,{getter:!0}),i.set&&e(i.set,r,{setter:!0}),t.f(n,r,i)},Yc}var Wc,n0;function ob(){if(n0)return Wc;n0=1;var e=wn(),t=fr(),n=Xo();return Wc=function(r,i,o){e?t.f(r,i,n(0,o)):r[i]=o},Wc}var r0;function i0(){if(r0)return X1;r0=1;var e=Wt(),t=Ht(),n=J1(),r=Mt(),i=Yt(),o=Qo(),s=t0(),a=ob(),c=an(),u=Nn(),l=on(),d=Ii().IteratorPrototype,f=wn(),h=un(),p="constructor",m="Iterator",y=l("toStringTag"),g=TypeError,b=t[m],v=h||!i(b)||b.prototype!==d||!c(function(){b({})}),_=function(){if(n(this,d),o(this)===d)throw new g("Abstract class Iterator not directly constructable")},A=function(C,I){f?s(d,C,{configurable:!0,get:function(){return I},set:function(S){if(r(this),this===d)throw new g("You can't redefine this property");u(this,C)?this[C]=S:a(this,C,S)}}):d[C]=I};return u(d,y)||A(y,m),(v||!u(d,p)||d[p]===Object)&&A(p,_),_.prototype=d,e({global:!0,constructor:!0,forced:v},{Iterator:_}),X1}var o0={},Zc,s0;function Pn(){return s0||(s0=1,Zc=function(e){return{iterator:e,next:e.next,done:!1}}),Zc}var Xc,a0;function c0(){if(a0)return Xc;a0=1;var e=RangeError;return Xc=function(t){if(t===t)return t;throw new e("NaN is not allowed")},Xc}var Qc,u0;function l0(){if(u0)return Qc;u0=1;var e=Zo(),t=RangeError;return Qc=function(n){var r=e(n);if(r<0)throw new t("The argument can't be less than 0");return r},Qc}var Jc,f0;function eu(){if(f0)return Jc;f0=1;var e=dr();return Jc=function(t,n,r){for(var i in n)e(t,i,n[i],r);return t},Jc}var tu,d0;function wi(){if(d0)return tu;d0=1;var e=jt(),t=Mt(),n=Yr();return tu=function(r,i,o){var s,a;t(r);try{if(s=n(r,"return"),!s){if(i==="throw")throw o;return o}s=e(s,r)}catch(c){a=!0,s=c}if(i==="throw")throw o;if(a)throw s;return t(s),o},tu}var nu,h0;function Pi(){if(h0)return nu;h0=1;var e=jt(),t=Wr(),n=Ci(),r=eu(),i=on(),o=Zr(),s=Yr(),a=Ii().IteratorPrototype,c=no(),u=wi(),l=i("toStringTag"),d="IteratorHelper",f="WrapForValidIterator",h=o.set,p=function(g){var b=o.getterFor(g?f:d);return r(t(a),{next:function(){var _=b(this);if(g)return _.nextHandler();if(_.done)return c(void 0,!0);try{var A=_.nextHandler();return _.returnHandlerResult?A:c(A,_.done)}catch(C){throw _.done=!0,C}},return:function(){var v=b(this),_=v.iterator;if(v.done=!0,g){var A=s(_,"return");return A?e(A,_):c(void 0,!0)}if(v.inner)try{u(v.inner.iterator,"normal")}catch(C){return u(_,"throw",C)}return _&&u(_,"normal"),c(void 0,!0)}})},m=p(!0),y=p(!1);return n(y,l,"Iterator Helper"),nu=function(g,b,v){var _=function(C,I){I?(I.iterator=C.iterator,I.next=C.next):I=C,I.type=b?f:d,I.returnHandlerResult=!!v,I.nextHandler=g,I.counter=0,I.done=!1,h(this,I)};return _.prototype=b?m:y,_},nu}var m0;function p0(){if(m0)return o0;m0=1;var e=Wt(),t=jt(),n=Mt(),r=Pn(),i=c0(),o=l0(),s=Pi(),a=un(),c=s(function(){for(var u=this.iterator,l=this.next,d,f;this.remaining;)if(this.remaining--,d=n(t(l,u)),f=this.done=!!d.done,f)return;if(d=n(t(l,u)),f=this.done=!!d.done,!f)return d.value});return e({target:"Iterator",proto:!0,real:!0,forced:a},{drop:function(l){n(this);var d=o(i(+l));return new c(r(this),{remaining:d})}}),o0}var _0={},ru,y0;function sb(){if(y0)return ru;y0=1;var e=jo(),t=vn();return ru=function(n){if(e(n)==="Function")return t(n)},ru}var iu,g0;function ou(){if(g0)return iu;g0=1;var e=sb(),t=fn(),n=Ho(),r=e(e.bind);return iu=function(i,o){return t(i),o===void 0?i:n?r(i,o):function(){return i.apply(o,arguments)}},iu}var su,b0;function ab(){if(b0)return su;b0=1;var e=on(),t=to(),n=e("iterator"),r=Array.prototype;return su=function(i){return i!==void 0&&(t.Array===i||r[n]===i)},su}var au,v0;function cu(){if(v0)return au;v0=1;var e=es(),t=Yr(),n=zo(),r=to(),i=on(),o=i("iterator");return au=function(s){if(!n(s))return t(s,o)||t(s,"@@iterator")||r[e(s)]},au}var uu,x0;function cb(){if(x0)return uu;x0=1;var e=jt(),t=fn(),n=Mt(),r=Wo(),i=cu(),o=TypeError;return uu=function(s,a){var c=arguments.length<2?i(s):a;if(t(c))return n(e(c,s));throw new o(r(s)+" is not iterable")},uu}var lu,A0;function Ir(){if(A0)return lu;A0=1;var e=ou(),t=jt(),n=Mt(),r=Wo(),i=ab(),o=Kd(),s=Yo(),a=cb(),c=cu(),u=wi(),l=TypeError,d=function(h,p){this.stopped=h,this.result=p},f=d.prototype;return lu=function(h,p,m){var y=m&&m.that,g=!!(m&&m.AS_ENTRIES),b=!!(m&&m.IS_RECORD),v=!!(m&&m.IS_ITERATOR),_=!!(m&&m.INTERRUPTED),A=e(p,y),C,I,S,w,R,M,P,E=function(q){return C&&u(C,"normal",q),new d(!0,q)},N=function(q){return g?(n(q),_?A(q[0],q[1],E):A(q[0],q[1])):_?A(q,E):A(q)};if(b)C=h.iterator;else if(v)C=h;else{if(I=c(h),!I)throw new l(r(h)+" is not iterable");if(i(I)){for(S=0,w=o(h);w>S;S++)if(R=N(h[S]),R&&s(f,R))return R;return new d(!1)}C=a(h,I)}for(M=b?h.next:C.next;!(P=t(M,C)).done;){try{R=N(P.value)}catch(q){u(C,"throw",q)}if(typeof R=="object"&&R&&s(f,R))return R}return new d(!1)},lu}var S0;function C0(){if(S0)return _0;S0=1;var e=Wt(),t=Ir(),n=fn(),r=Mt(),i=Pn();return e({target:"Iterator",proto:!0,real:!0},{every:function(s){r(this),n(s);var a=i(this),c=0;return!t(a,function(u,l){if(!s(u,c++))return l()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),_0}var I0={},fu,w0;function P0(){if(w0)return fu;w0=1;var e=Mt(),t=wi();return fu=function(n,r,i,o){try{return o?r(e(i)[0],i[1]):r(i)}catch(s){t(n,"throw",s)}},fu}var E0;function B0(){if(E0)return I0;E0=1;var e=Wt(),t=jt(),n=fn(),r=Mt(),i=Pn(),o=Pi(),s=P0(),a=un(),c=o(function(){for(var u=this.iterator,l=this.predicate,d=this.next,f,h,p;;){if(f=r(t(d,u)),h=this.done=!!f.done,h)return;if(p=f.value,s(u,l,[p,this.counter++],!0))return p}});return e({target:"Iterator",proto:!0,real:!0,forced:a},{filter:function(l){return r(this),n(l),new c(i(this),{predicate:l})}}),I0}var R0={},D0;function N0(){if(D0)return R0;D0=1;var e=Wt(),t=Ir(),n=fn(),r=Mt(),i=Pn();return e({target:"Iterator",proto:!0,real:!0},{find:function(s){r(this),n(s);var a=i(this),c=0;return t(a,function(u,l){if(s(u,c++))return l(u)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),R0}var M0={},du,T0;function O0(){if(T0)return du;T0=1;var e=jt(),t=Mt(),n=Pn(),r=cu();return du=function(i,o){(!o||typeof i!="string")&&t(i);var s=r(i);return n(t(s!==void 0?e(s,i):i))},du}var k0;function q0(){if(k0)return M0;k0=1;var e=Wt(),t=jt(),n=fn(),r=Mt(),i=Pn(),o=O0(),s=Pi(),a=wi(),c=un(),u=s(function(){for(var l=this.iterator,d=this.mapper,f,h;;){if(h=this.inner)try{if(f=r(t(h.next,h.iterator)),!f.done)return f.value;this.inner=null}catch(p){a(l,"throw",p)}if(f=r(t(this.next,l)),this.done=!!f.done)return;try{this.inner=o(d(f.value,this.counter++),!1)}catch(p){a(l,"throw",p)}}});return e({target:"Iterator",proto:!0,real:!0,forced:c},{flatMap:function(d){return r(this),n(d),new u(i(this),{mapper:d,inner:null})}}),M0}var U0={},F0;function L0(){if(F0)return U0;F0=1;var e=Wt(),t=Ir(),n=fn(),r=Mt(),i=Pn();return e({target:"Iterator",proto:!0,real:!0},{forEach:function(s){r(this),n(s);var a=i(this),c=0;t(a,function(u){s(u,c++)},{IS_RECORD:!0})}}),U0}var G0={},H0;function j0(){if(H0)return G0;H0=1;var e=Wt(),t=jt(),n=xa(),r=Yo(),i=Ii().IteratorPrototype,o=Pi(),s=O0(),a=un(),c=o(function(){return t(this.next,this.iterator)},!0);return e({target:"Iterator",stat:!0,forced:a},{from:function(l){var d=s(typeof l=="string"?n(l):l,!0);return r(i,d.iterator)?d.iterator:new c(d)}}),G0}var z0={},hu,V0;function ub(){if(V0)return hu;V0=1;var e=jt(),t=fn(),n=Mt(),r=Pn(),i=Pi(),o=P0(),s=i(function(){var a=this.iterator,c=n(e(this.next,a)),u=this.done=!!c.done;if(!u)return o(a,this.mapper,[c.value,this.counter++],!0)});return hu=function(c){return n(this),t(c),new s(r(this),{mapper:c})},hu}var K0;function $0(){if(K0)return z0;K0=1;var e=Wt(),t=ub(),n=un();return e({target:"Iterator",proto:!0,real:!0,forced:n},{map:t}),z0}var Y0={},W0;function Z0(){if(W0)return Y0;W0=1;var e=Wt(),t=Ir(),n=fn(),r=Mt(),i=Pn(),o=TypeError;return e({target:"Iterator",proto:!0,real:!0},{reduce:function(a){r(this),n(a);var c=i(this),u=arguments.length<2,l=u?void 0:arguments[1],d=0;if(t(c,function(f){u?(u=!1,l=f):l=a(l,f,d),d++},{IS_RECORD:!0}),u)throw new o("Reduce of empty iterator with no initial value");return l}}),Y0}var X0={},Q0;function J0(){if(Q0)return X0;Q0=1;var e=Wt(),t=Ir(),n=fn(),r=Mt(),i=Pn();return e({target:"Iterator",proto:!0,real:!0},{some:function(s){r(this),n(s);var a=i(this),c=0;return t(a,function(u,l){if(s(u,c++))return l()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),X0}var eh={},th;function nh(){if(th)return eh;th=1;var e=Wt(),t=jt(),n=Mt(),r=Pn(),i=c0(),o=l0(),s=Pi(),a=wi(),c=un(),u=s(function(){var l=this.iterator;if(!this.remaining--)return this.done=!0,a(l,"normal",void 0);var d=n(t(this.next,l)),f=this.done=!!d.done;if(!f)return d.value});return e({target:"Iterator",proto:!0,real:!0,forced:c},{take:function(d){n(this);var f=o(i(+d));return new u(r(this),{remaining:f})}}),eh}var rh={},ih;function oh(){if(ih)return rh;ih=1;var e=Wt(),t=Mt(),n=Ir(),r=Pn(),i=[].push;return e({target:"Iterator",proto:!0,real:!0},{toArray:function(){var s=[];return n(r(t(this)),i,{that:s,IS_RECORD:!0}),s}}),rh}var mu,sh;function lb(){if(sh)return mu;sh=1;var e=Ht();return mu=e,mu}var pu,ah;function fb(){if(ah)return pu;ah=1,L1(),nb(),ib(),i0(),p0(),C0(),B0(),N0(),q0(),L0(),j0(),$0(),Z0(),J0(),nh(),oh();var e=lb();return pu=e.Iterator,pu}var ch={},_u,uh;function db(){return uh||(uh=1,_u={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}),_u}var yu,lh;function hb(){if(lh)return yu;lh=1;var e=$o(),t=e("span").classList,n=t&&t.constructor&&t.constructor.prototype;return yu=n===Object.prototype?void 0:n,yu}var fh;function mb(){if(fh)return ch;fh=1;var e=Ht(),t=db(),n=hb(),r=L1(),i=Ci(),o=Jo(),s=on(),a=s("iterator"),c=r.values,u=function(d,f){if(d){if(d[a]!==c)try{i(d,a,c)}catch{d[a]=c}if(o(d,f,!0),t[f]){for(var h in r)if(d[h]!==r[h])try{i(d,h,r[h])}catch{d[h]=r[h]}}}};for(var l in t)u(e[l]&&e[l].prototype,l);return u(n,"DOMTokenList"),ch}var gu,dh;function pb(){if(dh)return gu;dh=1;var e=fb();return mb(),gu=e,gu}var hh={},mh={},bu,ph;function _h(){if(ph)return bu;ph=1;var e=Ht(),t=eo(),n=jo(),r=function(i){return t.slice(0,i.length)===i};return bu=function(){return r("Bun/")?"BUN":r("Cloudflare-Workers")?"CLOUDFLARE":r("Deno/")?"DENO":r("Node.js/")?"NODE":e.Bun&&typeof Bun.version=="string"?"BUN":e.Deno&&typeof Deno.version=="object"?"DENO":n(e.process)==="process"?"NODE":e.window&&e.document?"BROWSER":"REST"}(),bu}var vu,yh;function xu(){if(yh)return vu;yh=1;var e=_h();return vu=e==="NODE",vu}var Au,gh;function _b(){if(gh)return Au;gh=1;var e=lr(),t=t0(),n=on(),r=wn(),i=n("species");return Au=function(o){var s=e(o);r&&s&&!s[i]&&t(s,i,{configurable:!0,get:function(){return this}})},Au}var Su,bh;function yb(){if(bh)return Su;bh=1;var e=vn(),t=an(),n=Yt(),r=es(),i=lr(),o=xc(),s=function(){},a=i("Reflect","construct"),c=/^\s*(?:class|function)\b/,u=e(c.exec),l=!c.test(s),d=function(p){if(!n(p))return!1;try{return a(s,[],p),!0}catch{return!1}},f=function(p){if(!n(p))return!1;switch(r(p)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return l||!!u(c,o(p))}catch{return!0}};return f.sham=!0,Su=!a||t(function(){var h;return d(d.call)||!d(Object)||!d(function(){h=!0})||h})?f:d,Su}var Cu,vh;function gb(){if(vh)return Cu;vh=1;var e=yb(),t=Wo(),n=TypeError;return Cu=function(r){if(e(r))return r;throw new n(t(r)+" is not a constructor")},Cu}var Iu,xh;function bb(){if(xh)return Iu;xh=1;var e=Mt(),t=gb(),n=zo(),r=on(),i=r("species");return Iu=function(o,s){var a=e(o).constructor,c;return a===void 0||n(c=e(a)[i])?s:t(c)},Iu}var wu,Ah;function vb(){if(Ah)return wu;Ah=1;var e=Ho(),t=Function.prototype,n=t.apply,r=t.call;return wu=typeof Reflect=="object"&&Reflect.apply||(e?r.bind(n):function(){return r.apply(n,arguments)}),wu}var Pu,Sh;function xb(){if(Sh)return Pu;Sh=1;var e=vn();return Pu=e([].slice),Pu}var Eu,Ch;function Ab(){if(Ch)return Eu;Ch=1;var e=TypeError;return Eu=function(t,n){if(t<n)throw new e("Not enough arguments");return t},Eu}var Bu,Ih;function wh(){if(Ih)return Bu;Ih=1;var e=eo();return Bu=/(?:ipad|iphone|ipod).*applewebkit/i.test(e),Bu}var Ru,Ph;function Eh(){if(Ph)return Ru;Ph=1;var e=Ht(),t=vb(),n=ou(),r=Yt(),i=Nn(),o=an(),s=t1(),a=xb(),c=$o(),u=Ab(),l=wh(),d=xu(),f=e.setImmediate,h=e.clearImmediate,p=e.process,m=e.Dispatch,y=e.Function,g=e.MessageChannel,b=e.String,v=0,_={},A="onreadystatechange",C,I,S,w;o(function(){C=e.location});var R=function(N){if(i(_,N)){var q=_[N];delete _[N],q()}},M=function(N){return function(){R(N)}},P=function(N){R(N.data)},E=function(N){e.postMessage(b(N),C.protocol+"//"+C.host)};return(!f||!h)&&(f=function(q){u(arguments.length,1);var j=r(q)?q:y(q),z=a(arguments,1);return _[++v]=function(){t(j,void 0,z)},I(v),v},h=function(q){delete _[q]},d?I=function(N){p.nextTick(M(N))}:m&&m.now?I=function(N){m.now(M(N))}:g&&!l?(S=new g,w=S.port2,S.port1.onmessage=P,I=n(w.postMessage,w)):e.addEventListener&&r(e.postMessage)&&!e.importScripts&&C&&C.protocol!=="file:"&&!o(E)?(I=E,e.addEventListener("message",P,!1)):A in c("script")?I=function(N){s.appendChild(c("script"))[A]=function(){s.removeChild(this),R(N)}}:I=function(N){setTimeout(M(N),0)}),Ru={set:f,clear:h},Ru}var Du,Bh;function Sb(){if(Bh)return Du;Bh=1;var e=Ht(),t=wn(),n=Object.getOwnPropertyDescriptor;return Du=function(r){if(!t)return e[r];var i=n(e,r);return i&&i.value},Du}var Nu,Rh;function Dh(){if(Rh)return Nu;Rh=1;var e=function(){this.head=null,this.tail=null};return e.prototype={add:function(t){var n={item:t,next:null},r=this.tail;r?r.next=n:this.head=n,this.tail=n},get:function(){var t=this.head;if(t){var n=this.head=t.next;return n===null&&(this.tail=null),t.item}}},Nu=e,Nu}var Mu,Nh;function Cb(){if(Nh)return Mu;Nh=1;var e=eo();return Mu=/ipad|iphone|ipod/i.test(e)&&typeof Pebble<"u",Mu}var Tu,Mh;function Ib(){if(Mh)return Tu;Mh=1;var e=eo();return Tu=/web0s(?!.*chrome)/i.test(e),Tu}var Ou,Th;function wb(){if(Th)return Ou;Th=1;var e=Ht(),t=Sb(),n=ou(),r=Eh().set,i=Dh(),o=wh(),s=Cb(),a=Ib(),c=xu(),u=e.MutationObserver||e.WebKitMutationObserver,l=e.document,d=e.process,f=e.Promise,h=t("queueMicrotask"),p,m,y,g,b;if(!h){var v=new i,_=function(){var A,C;for(c&&(A=d.domain)&&A.exit();C=v.get();)try{C()}catch(I){throw v.head&&p(),I}A&&A.enter()};!o&&!c&&!a&&u&&l?(m=!0,y=l.createTextNode(""),new u(_).observe(y,{characterData:!0}),p=function(){y.data=m=!m}):!s&&f&&f.resolve?(g=f.resolve(void 0),g.constructor=f,b=n(g.then,g),p=function(){b(_)}):c?p=function(){d.nextTick(_)}:(r=n(r,e),p=function(){r(_)}),h=function(A){v.head||p(),v.add(A)}}return Ou=h,Ou}var ku,Oh;function Pb(){return Oh||(Oh=1,ku=function(e,t){try{arguments.length===1?console.error(e):console.error(e,t)}catch{}}),ku}var qu,kh;function ts(){return kh||(kh=1,qu=function(e){try{return{error:!1,value:e()}}catch(t){return{error:!0,value:t}}}),qu}var Uu,qh;function ro(){if(qh)return Uu;qh=1;var e=Ht();return Uu=e.Promise,Uu}var Fu,Uh;function io(){if(Uh)return Fu;Uh=1;var e=Ht(),t=ro(),n=Yt(),r=C1(),i=xc(),o=on(),s=_h(),a=un(),c=hd(),u=t&&t.prototype,l=o("species"),d=!1,f=n(e.PromiseRejectionEvent),h=r("Promise",function(){var p=i(t),m=p!==String(t);if(!m&&c===66||a&&!(u.catch&&u.finally))return!0;if(!c||c<51||!/native code/.test(p)){var y=new t(function(v){v(1)}),g=function(v){v(function(){},function(){})},b=y.constructor={};if(b[l]=g,d=y.then(function(){})instanceof g,!d)return!0}return!m&&(s==="BROWSER"||s==="DENO")&&!f});return Fu={CONSTRUCTOR:h,REJECTION_EVENT:f,SUBCLASSING:d},Fu}var Lu={},Fh;function oo(){if(Fh)return Lu;Fh=1;var e=fn(),t=TypeError,n=function(r){var i,o;this.promise=new r(function(s,a){if(i!==void 0||o!==void 0)throw new t("Bad Promise constructor");i=s,o=a}),this.resolve=e(i),this.reject=e(o)};return Lu.f=function(r){return new n(r)},Lu}var Lh;function Eb(){if(Lh)return mh;Lh=1;var e=Wt(),t=un(),n=xu(),r=Ht(),i=jt(),o=dr(),s=O1(),a=Jo(),c=_b(),u=fn(),l=Yt(),d=Qn(),f=J1(),h=bb(),p=Eh().set,m=wb(),y=Pb(),g=ts(),b=Dh(),v=Zr(),_=ro(),A=io(),C=oo(),I="Promise",S=A.CONSTRUCTOR,w=A.REJECTION_EVENT,R=A.SUBCLASSING,M=v.getterFor(I),P=v.set,E=_&&_.prototype,N=_,q=E,j=r.TypeError,z=r.document,W=r.process,se=C.f,ue=se,$=!!(z&&z.createEvent&&r.dispatchEvent),ne="unhandledrejection",de="rejectionhandled",_e=0,X=1,ce=2,k=1,B=2,F,re,G,V,K=function(x){var D;return d(x)&&l(D=x.then)?D:!1},Q=function(x,D){var J=D.value,le=D.state===X,he=le?x.ok:x.fail,ye=x.resolve,Se=x.reject,Ie=x.domain,Ee,Be,we;try{he?(le||(D.rejection===B&&Y(D),D.rejection=k),he===!0?Ee=J:(Ie&&Ie.enter(),Ee=he(J),Ie&&(Ie.exit(),we=!0)),Ee===x.promise?Se(new j("Promise-chain cycle")):(Be=K(Ee))?i(Be,Ee,ye,Se):ye(Ee)):Se(J)}catch(Ue){Ie&&!we&&Ie.exit(),Se(Ue)}},Z=function(x,D){x.notified||(x.notified=!0,m(function(){for(var J=x.reactions,le;le=J.get();)Q(le,x);x.notified=!1,D&&!x.rejection&&L(x)}))},ie=function(x,D,J){var le,he;$?(le=z.createEvent("Event"),le.promise=D,le.reason=J,le.initEvent(x,!1,!0),r.dispatchEvent(le)):le={promise:D,reason:J},!w&&(he=r["on"+x])?he(le):x===ne&&y("Unhandled promise rejection",J)},L=function(x){i(p,r,function(){var D=x.facade,J=x.value,le=U(x),he;if(le&&(he=g(function(){n?W.emit("unhandledRejection",J,D):ie(ne,D,J)}),x.rejection=n||U(x)?B:k,he.error))throw he.value})},U=function(x){return x.rejection!==k&&!x.parent},Y=function(x){i(p,r,function(){var D=x.facade;n?W.emit("rejectionHandled",D):ie(de,D,x.value)})},fe=function(x,D,J){return function(le){x(D,le,J)}},me=function(x,D,J){x.done||(x.done=!0,J&&(x=J),x.value=D,x.state=ce,Z(x,!0))},Te=function(x,D,J){if(!x.done){x.done=!0,J&&(x=J);try{if(x.facade===D)throw new j("Promise can't be resolved itself");var le=K(D);le?m(function(){var he={done:!1};try{i(le,D,fe(Te,he,x),fe(me,he,x))}catch(ye){me(he,ye,x)}}):(x.value=D,x.state=X,Z(x,!1))}catch(he){me({done:!1},he,x)}}};if(S&&(N=function(D){f(this,q),u(D),i(F,this);var J=M(this);try{D(fe(Te,J),fe(me,J))}catch(le){me(J,le)}},q=N.prototype,F=function(D){P(this,{type:I,done:!1,notified:!1,parent:!1,reactions:new b,rejection:!1,state:_e,value:null})},F.prototype=o(q,"then",function(D,J){var le=M(this),he=se(h(this,N));return le.parent=!0,he.ok=l(D)?D:!0,he.fail=l(J)&&J,he.domain=n?W.domain:void 0,le.state===_e?le.reactions.add(he):m(function(){Q(he,le)}),he.promise}),re=function(){var x=new F,D=M(x);this.promise=x,this.resolve=fe(Te,D),this.reject=fe(me,D)},C.f=se=function(x){return x===N||x===G?new re(x):ue(x)},!t&&l(_)&&E!==Object.prototype)){V=E.then,R||o(E,"then",function(D,J){var le=this;return new N(function(he,ye){i(V,le,he,ye)}).then(D,J)},{unsafe:!0});try{delete E.constructor}catch{}s&&s(E,q)}return e({global:!0,constructor:!0,wrap:!0,forced:S},{Promise:N}),a(N,I,!1,!0),c(I),mh}var Gh={},Gu,Hh;function Bb(){if(Hh)return Gu;Hh=1;var e=on(),t=e("iterator"),n=!1;try{var r=0,i={next:function(){return{done:!!r++}},return:function(){n=!0}};i[t]=function(){return this},Array.from(i,function(){throw 2})}catch{}return Gu=function(o,s){try{if(!s&&!n)return!1}catch{return!1}var a=!1;try{var c={};c[t]=function(){return{next:function(){return{done:a=!0}}}},o(c)}catch{}return a},Gu}var Hu,jh;function zh(){if(jh)return Hu;jh=1;var e=ro(),t=Bb(),n=io().CONSTRUCTOR;return Hu=n||!t(function(r){e.all(r).then(void 0,function(){})}),Hu}var Vh;function Rb(){if(Vh)return Gh;Vh=1;var e=Wt(),t=jt(),n=fn(),r=oo(),i=ts(),o=Ir(),s=zh();return e({target:"Promise",stat:!0,forced:s},{all:function(c){var u=this,l=r.f(u),d=l.resolve,f=l.reject,h=i(function(){var p=n(u.resolve),m=[],y=0,g=1;o(c,function(b){var v=y++,_=!1;g++,t(p,u,b).then(function(A){_||(_=!0,m[v]=A,--g||d(m))},f)}),--g||d(m)});return h.error&&f(h.value),l.promise}}),Gh}var Kh={},$h;function Db(){if($h)return Kh;$h=1;var e=Wt(),t=un(),n=io().CONSTRUCTOR,r=ro(),i=lr(),o=Yt(),s=dr(),a=r&&r.prototype;if(e({target:"Promise",proto:!0,forced:n,real:!0},{catch:function(u){return this.then(void 0,u)}}),!t&&o(r)){var c=i("Promise").prototype.catch;a.catch!==c&&s(a,"catch",c,{unsafe:!0})}return Kh}var Yh={},Wh;function Nb(){if(Wh)return Yh;Wh=1;var e=Wt(),t=jt(),n=fn(),r=oo(),i=ts(),o=Ir(),s=zh();return e({target:"Promise",stat:!0,forced:s},{race:function(c){var u=this,l=r.f(u),d=l.reject,f=i(function(){var h=n(u.resolve);o(c,function(p){t(h,u,p).then(l.resolve,d)})});return f.error&&d(f.value),l.promise}}),Yh}var Zh={},Xh;function Mb(){if(Xh)return Zh;Xh=1;var e=Wt(),t=oo(),n=io().CONSTRUCTOR;return e({target:"Promise",stat:!0,forced:n},{reject:function(i){var o=t.f(this),s=o.reject;return s(i),o.promise}}),Zh}var Qh={},ju,Jh;function Tb(){if(Jh)return ju;Jh=1;var e=Mt(),t=Qn(),n=oo();return ju=function(r,i){if(e(r),t(i)&&i.constructor===r)return i;var o=n.f(r),s=o.resolve;return s(i),o.promise},ju}var em;function Ob(){if(em)return Qh;em=1;var e=Wt(),t=lr(),n=un(),r=ro(),i=io().CONSTRUCTOR,o=Tb(),s=t("Promise"),a=n&&!i;return e({target:"Promise",stat:!0,forced:n||i},{resolve:function(u){return o(a&&this===s?r:this,u)}}),Qh}var tm;function kb(){return tm||(tm=1,Eb(),Rb(),Db(),Nb(),Mb(),Ob()),hh}var nm={},rm;function qb(){return rm||(rm=1,i0()),nm}var im={},om;function Ub(){if(om)return im;om=1;var e=jt(),t=dr(),n=Yr(),r=Nn(),i=on(),o=Ii().IteratorPrototype,s=i("dispose");return r(o,s)||t(o,s,function(){var a=n(this,"return");a&&e(a,this)}),im}var sm={},am;function Fb(){return am||(am=1,p0()),sm}var cm={},um;function Lb(){return um||(um=1,C0()),cm}var lm={},fm;function Gb(){return fm||(fm=1,B0()),lm}var dm={},hm;function Hb(){return hm||(hm=1,N0()),dm}var mm={},pm;function jb(){return pm||(pm=1,q0()),mm}var _m={},ym;function zb(){return ym||(ym=1,L0()),_m}var gm={},bm;function Vb(){return bm||(bm=1,j0()),gm}var vm={},xm;function Kb(){return xm||(xm=1,$0()),vm}var Am={},Sm;function $b(){return Sm||(Sm=1,Z0()),Am}var Cm={},Im;function Yb(){return Im||(Im=1,J0()),Cm}var wm={},Pm;function Wb(){return Pm||(Pm=1,nh()),wm}var Em={},Bm;function Zb(){return Bm||(Bm=1,oh()),Em}var Rm={},zu,Dm;function Nm(){if(Dm)return zu;Dm=1;var e=Ht(),t=Ko(),n=Yt(),r=Wr(),i=Qo(),o=dr(),s=on(),a=un(),c="USE_FUNCTION_CONSTRUCTOR",u=s("asyncIterator"),l=e.AsyncIterator,d=t.AsyncIteratorPrototype,f,h;if(d)f=d;else if(n(l))f=l.prototype;else if(t[c]||e[c])try{h=i(i(i(Function("return async function*(){}()")()))),i(h)===Object.prototype&&(f=h)}catch{}return f?a&&(f=r(f)):f={},n(f[u])||o(f,u,function(){return this}),zu=f,zu}var Vu,Mm;function Xb(){if(Mm)return Vu;Mm=1;var e=jt(),t=Mt(),n=Wr(),r=Yr(),i=eu(),o=Zr(),s=lr(),a=Nm(),c=no(),u=s("Promise"),l="AsyncFromSyncIterator",d=o.set,f=o.getterFor(l),h=function(m,y,g){var b=m.done;u.resolve(m.value).then(function(v){y(c(v,b))},g)},p=function(y){y.type=l,d(this,y)};return p.prototype=i(n(a),{next:function(){var y=f(this);return new u(function(g,b){var v=t(e(y.next,y.iterator));h(v,g,b)})},return:function(){var m=f(this).iterator;return new u(function(y,g){var b=r(m,"return");if(b===void 0)return y(c(void 0,!0));var v=t(e(b,m));h(v,y,g)})}}),Vu=p,Vu}var Ku,Tm;function Qb(){if(Tm)return Ku;Tm=1;var e=jt(),t=ts(),n=Mt(),r=Wr(),i=Ci(),o=eu(),s=on(),a=Zr(),c=lr(),u=Yr(),l=Nm(),d=no(),f=wi(),h=c("Promise"),p=s("toStringTag"),m="AsyncIteratorHelper",y="WrapForValidAsyncIterator",g=a.set,b=function(A){var C=!A,I=a.getterFor(A?y:m),S=function(w){var R=t(function(){return I(w)}),M=R.error,P=R.value;return M||C&&P.done?{exit:!0,value:M?h.reject(P):h.resolve(d(void 0,!0))}:{exit:!1,value:P}};return o(r(l),{next:function(){var R=S(this),M=R.value;if(R.exit)return M;var P=t(function(){return n(M.nextHandler(h))}),E=P.error,N=P.value;return E&&(M.done=!0),E?h.reject(N):h.resolve(N)},return:function(){var w=S(this),R=w.value;if(w.exit)return R;R.done=!0;var M=R.iterator,P,E,N=t(function(){if(R.inner)try{f(R.inner.iterator,"normal")}catch(q){return f(M,"throw",q)}return u(M,"return")});return P=E=N.value,N.error?h.reject(E):P===void 0?h.resolve(d(void 0,!0)):(N=t(function(){return e(P,M)}),E=N.value,N.error?h.reject(E):A?h.resolve(E):h.resolve(E).then(function(q){return n(q),d(void 0,!0)}))}})},v=b(!0),_=b(!1);return i(_,p,"Async Iterator Helper"),Ku=function(A,C){var I=function(w,R){R?(R.iterator=w.iterator,R.next=w.next):R=w,R.type=C?y:m,R.nextHandler=A,R.counter=0,R.done=!1,g(this,R)};return I.prototype=C?v:_,I},Ku}var $u,Om;function Jb(){if(Om)return $u;Om=1;var e=jt(),t=Qb();return $u=t(function(){return e(this.next,this.iterator)},!0),$u}var km;function e3(){if(km)return Rm;km=1;var e=Wt(),t=Mt(),n=Xb(),r=Jb(),i=Pn(),o=un();return e({target:"Iterator",proto:!0,real:!0,forced:o},{toAsync:function(){return new r(i(new n(i(t(this)))))}}),Rm}var Yu,qm;function t3(){if(qm)return Yu;qm=1;var e=pb();return kb(),qb(),Ub(),Fb(),Lb(),Gb(),Hb(),jb(),zb(),Vb(),Kb(),$b(),Yb(),Wb(),Zb(),e3(),Yu=e,Yu}t3();function so(e){return 16843009*((e=(858993459&(e-=e>>>1&1431655765))+(e>>>2&858993459))+(e>>>4)&252645135)>>>24}class ao{constructor(t,n){this.length=t,this.t=new Uint32Array(t+32>>>5),n===!0&&this.i()}get(t){return(this.t[t>>>5]&1<<t)!=0}set(t){this.t[t>>>5]|=1<<t}clear(t){this.t[t>>>5]&=~(1<<t)}o(t){this.t[t>>>5]^=1<<t}h(t,n,r){if(n<t)return;const i=this.t,o=r===!0?4294967295:0,s=t>>>5,a=n>>>5;for(let l=s;l<a;++l)i[l]=o;const c=s<<5,u=a<<5;if(r===!0)if(n-t<32)for(let l=t,d=n+1;l<d;++l)i[l>>>5]|=1<<l;else{for(let l=t,d=c;l<d;++l)i[l>>>5]|=1<<l;for(let l=u,d=n+1;l<d;++l)i[l>>>5]|=1<<l}else if(n-t<32)for(let l=t,d=n+1;l<d;++l)i[l>>>5]&=~(1<<l);else{for(let l=t,d=c;l<d;++l)i[l>>>5]&=~(1<<l);for(let l=u,d=n+1;l<d;++l)i[l>>>5]&=~(1<<l)}return this}l(t,n){return this.h(t,n,!0)}u(t,n){return this.h(t,n,!1)}A(...t){const n=this.t,r=t.length;for(let i=0;i<r;++i){const o=t[i];n[o>>>5]|=1<<o}return this}p(...t){const n=this.t,r=t.length;for(let i=0;i<r;++i){const o=t[i];n[o>>>5]&=~(1<<o)}return this}i(){return this.h(0,this.length-1,!0)}M(){return this.h(0,this.length-1,!1)}m(){const t=this.t.length,n=this.t,r=32-this.length%32;for(let i=0;i<t-1;++i)n[i]=~n[i];return n[t-1]=~(n[t-1]<<r)>>>r,this}S(t,n,r){if(n<t)return;const i=this.t,o=r===!0?4294967295:0,s=t>>>5,a=n>>>5;for(let c=s;c<a;++c)if(i[c]!==o)return!1;if(n-t<32){for(let c=t,u=n+1;c<u;++c)if(!!(i[c>>>5]&1<<c)!==r)return!1}else{const c=a<<5;for(let u=t,l=s<<5<<5;u<l;++u)if(!!(i[u>>>5]&1<<u)!==r)return!1;for(let u=c,l=n+1;u<l;++u)if(!!(i[u>>>5]&1<<u)!==r)return!1}return!0}U(t,n){return this.S(t,n,!0)}_(t,n){return this.S(t,n,!1)}q(){return this.S(0,this.length-1,!0)}v(){return this.S(0,this.length-1,!1)}O(...t){const n=this.t,r=t.length;for(let i=0;i<r;++i){const o=t[i];if((n[o>>>5]&1<<o)==0)return!1}return!0}C(...t){const n=this.t,r=t.length;for(let i=0;i<r;++i){const o=t[i];if((n[o>>>5]&1<<o)!=0)return!1}return!0}G(t){const n=this.t,r=t.t,i=Math.min(n.length,r.length);for(let o=0;o<i;++o)if(n[o]!==r[o])return!1;return!0}P(){const t=this.t.length,n=this.t;let r=0;for(let i=0;i<t;++i)r+=so(n[i]);return r}R(t){const n=this.t,r=t.t,i=Math.min(n.length,r.length);for(let o=0;o<i;++o)n[o]=n[o]&~r[o];for(let o=n.length;o<i;++o)n[o]=0;return this}I(t){const n=this.t,r=t.t,i=Math.min(n.length,r.length);for(let o=0;o<i;++o)n[o]|=r[o];for(let o=n.length;o<i;++o)n[o]=0;return this}T(t){const n=this.t,r=t.t,i=Math.min(n.length,r.length);for(let o=0;o<i;++o)n[o]&=r[o];for(let o=n.length;o<i;++o)n[o]=0;return this}F(t){const n=this.t,r=t.t,i=Math.min(n.length,r.length);for(let o=0;o<i;++o)if((n[o]&r[o])!=0)return!0;return!1}D(t){const n=this.t,r=t.t,i=Math.min(n.length,r.length);let o=0;for(let s=0;s<i;++s)o+=so(n[s]&r[s]);return o}B(t){const n=this.t,r=t.t,i=Math.min(n.length,r.length),o=new Uint32Array(i),s=Object.create(ao.prototype);s.t=o,s.length=Math.min(this.length,t.length);for(let a=0;a<i;++a)o[a]=n[a]&r[a];return s}forEach(t){const n=this.t.length,r=this.t;let i=0;for(let o=0;o<n;++o){let s=r[o];for(;s!==0;){const a=s&-s;t((o<<5)+so(a-1),i),s^=a,++i}}}toArray(){const t=this.t,n=Array(this.P()),r=this.t.length;let i=0;for(let o=0;o<r;++o){let s=t[o];for(;s!==0;){const a=s&-s;n[i++]=(o<<5)+so(a-1),s^=a}}return n}toString(){return"{"+this.toArray().join(",")+"}"}N(){const t=this.toArray().join(",");return t?"@"+t:"NONE"}clone(){const t=Object.create(ao.prototype);return t.length=this.length,t.t=new Uint32Array(this.t),t}}const n3={matrix:[[58,23,-12,-7,-44,10,-23,-14,-14,-27,-17,-8,1,-9,-22,23,15,5,-74,-45,0],[23,224,-67,-63,-50,-30,-29,1,-56,-41,-6,-33,-44,-53,-43,15,2,18,-93,-6,0],[-12,-67,111,59,-104,-4,4,-84,6,-88,-65,48,-13,18,-29,5,-7,-63,-105,-73,0],[-7,-63,59,85,-83,-17,-1,-63,25,-60,-47,15,-12,40,-8,1,-7,-47,-108,-51,0],[-44,-50,-104,-83,144,-93,4,12,-74,36,30,-64,-67,-56,-65,-43,-41,-3,63,104,0],[10,-30,-4,-17,-93,140,-32,-95,-27,-91,-75,4,-36,-29,-32,5,-26,-68,-80,-79,0],[-23,-29,4,-1,4,-32,137,-50,6,-37,-42,21,-23,27,19,-4,-12,-44,-13,48,0],[-14,1,-84,-63,12,-95,-50,86,-53,53,47,-62,-60,-47,-55,-43,-8,69,-27,-24,0],[-14,-56,6,25,-74,-27,6,-53,75,-48,-30,13,-12,34,68,-3,-4,-44,-71,-49,0],[-27,-41,-88,-60,36,-91,-37,53,-48,88,62,-63,-48,-36,-48,-47,-25,36,-11,-4,0],[-17,-6,-65,-47,30,-75,-42,47,-30,62,103,-45,-54,-21,-31,-35,-9,31,-46,-20,0],[-8,-33,48,15,-64,4,21,-62,13,-63,-45,89,-25,12,2,22,10,-51,-79,-29,0],[1,-44,-13,-12,-67,-36,-23,-60,-12,-48,-54,-25,160,-6,-20,5,-12,-42,-76,-83,0],[-9,-53,18,40,-56,-29,27,-47,34,-36,-21,12,-6,75,34,1,-4,-37,-92,-48,0],[-22,-43,-29,-8,-65,-32,19,-55,68,-48,-31,2,-20,34,113,-10,-14,-49,-58,-39,0],[23,15,5,1,-43,5,-4,-43,-3,-47,-35,22,5,1,-10,53,32,-28,-62,-31,0],[15,2,-7,-7,-41,-26,-12,-8,-4,-25,-9,10,-12,-4,-14,32,68,0,-87,-40,0],[5,18,-63,-47,-3,-68,-44,69,-44,36,31,-51,-42,-37,-49,-28,0,74,-61,-32,0],[-74,-93,-105,-108,63,-80,-13,-27,-71,-11,-46,-79,-76,-92,-58,-62,-87,-61,289,81,0],[-45,-6,-73,-51,104,-79,48,-24,-49,-4,-20,-29,-83,-48,-39,-31,-40,-32,81,162,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],H:22,$:-300},r3={matrix:[[91,-114,-31,-123],[-114,100,-125,-31],[-31,-125,100,-114],[-123,-31,-114,91]],$:-400,H:120},i3=/^[ACGTRNDEQHILKMFPSWYV]+$/,o3=/^[ABCDGHKMNRSTUVWY]+$/i,s3=/^[ABCGTRNDEQHIJLKMFPSWYUVXZ]+$/i,a3=/[^ACGU]/i,c3=/[^ACGT]/i;function Um(e){if(!a3.test(e)||!c3.test(e))return 1;const t=o3.test(e),n=i3.test(e);if(n&&!t)return 0;if(n&&t||s3.test(e))return Fm(e);throw Error("Unrecognized sequence type: "+e)}function Fm(e){let t=0;const n=Math.min(e.length,100);for(let r=0;r<n;r++)switch(e[r]){case"A":case"T":case"U":case"G":case"C":case"N":t++}return t/n>Math.SQRT1_2?1:0}const Lt=new Uint8Array(96);Lt.fill(255),Lt[65]=0,Lt[67]=1,Lt[68]=2,Lt[69]=3,Lt[70]=4,Lt[71]=5,Lt[72]=6,Lt[73]=7,Lt[75]=8,Lt[76]=9,Lt[77]=10,Lt[78]=11,Lt[80]=12,Lt[81]=13,Lt[82]=14,Lt[83]=15,Lt[84]=16,Lt[86]=17,Lt[87]=18,Lt[89]=19,Lt[95]=20;const Xr=new Uint8Array(96);function u3(e,t){const n=Math.floor(100*Math.random());if(t===1)switch(e){case"M":return[0,1][n%2];case"R":return[0,2][n%2];case"W":return[0,3][n%2];case"S":return[1,2][n%2];case"Y":return[1,3][n%2];case"K":return[2,3][n%2];case"V":return[0,1,2][n%3];case"H":return[0,1,3][n%3];case"D":return[0,2,3][n%3];case"B":return[1,2,3][n%3];default:return n%4}switch(e){case"B":return[2,11][n%2];case"Z":return[3,13][n%2];case"J":return[7,9][n%2];default:return n%20}}function l3(e){return e.map(t=>f3[t])}Xr.fill(255),Xr[65]=0,Xr[67]=1,Xr[71]=2,Xr[84]=3,Xr[85]=3;const f3=[0,1,2,2,3,0,4,5,4,5,5,2,0,2,4,0,0,5,3,3];function d3(e,t,n){const r=[],i=n.gapchar;let o=0;for(let s=0;s<t.length;s++){let a=t[s];a<0?r.push(i.repeat(-a)):(r.push(e.substr(o,a)),o+=a)}return r.join("")}function ns(e,t){const n=[0];let r=0;const i=t.slice();function o(s){(s^n[n.length-1])>=0?n[n.length-1]+=s:n.push(s)}for(let s=0;s<e.length;s++){let a=e[s];if(a<0)o(a);else for(;a>0&&r<i.length;){let c=i[r];c<0?a<-c?(i[r]+=a,o(-a),a=0):(o(c),a+=c,r++):a<c?(i[r]-=a,o(a),a=0):(o(c),a-=c,r++)}}return n}function h3(e,t){const n=[];let r=0,i=0,o=e[0],s=t[0];for(;r<e.length||i<t.length;)o!==s?Math.sign(o)!==Math.sign(s)?o<0||s===void 0?(n.push(o),o=e[++r]):(n.push(s),s=t[++i]):o>0?o>s?(n.push(s),o-=s,s=t[++i]):(n.push(o),s-=o,o=e[++r]):(n.push(Math.min(o,s)),o=e[++r],s=t[++i]):(n.push(s),o=e[++r],s=t[++i]);return n}function m3(e,t){const n=[];let r=0,i=0,o=t[0],s=e[0],a=0;for(;r<t.length||i<e.length;)if(a=n[n.length-1],o!==s){if(Math.sign(o)===Math.sign(s)){if(o>0){if(s>o)return;a>0?n[n.length-1]=a+s:n.push(s),o-=s,s=e[++i];continue}if(o>s){a>0?n[n.length-1]=a-o:n.push(Math.abs(o)),s-=o,o=t[++r];continue}return}if(!(s<0))return;a<0?n[n.length-1]=a+s:n.push(s),s=e[++i]}else a>0?n[n.length-1]=a+Math.abs(o):n.push(Math.abs(o)),o=t[++r],s=e[++i];return n}function Lm(e,t){if(Math.sign(e[e.length-1])===Math.sign(t[0])){let n=[...e];return n[n.length-1]+=t[0],n.push(...t.slice(1)),n}return[...e,...t]}function wr(e,t=0){const n=[];let r=0,i=0;for(let o=0;o<e.length;o++)i=e[o],(i^r)>=0?r+=i:(n.push(r),r=i);return n.push(r),n[0]===0&&n.shift(),1&t||n.reverse(),n}function Wu(e){let t=0,n=0;for(let r=0;r<e.length;r++)n=e[r],t+=n<0?-n:n;return t}function Gm(e){const t=[];let n=0,r=0;for(let i=0;i<e.length;i++)if(r=e[i],r<0)for(let o=0;o<-r;o++)t.push(-1);else for(let o=0;o<r;o++)t.push(n),n++;return t}function rs(e,t,n,r=0){const i=e.V,o=t.V,s=i.length,a=o.length;let c=0,u=[],l=[],d=0,f=0,h=0,p=0;const m=new Uint8Array(Math.ceil((s+1)*a/2)+1);let y=0,g=0,b=0,v=0,_=0,A=n.W[0];const C=n.$,I=1&r?0:-C/2,S=2&r?0:-C/2;u[0]=0,l[0]=-1/0;for(let P=1;P<=a;P++)u[P]=C+I,l[P]=-1/0;for(let P=1;P<=s;P++){d=I,f=-1/0,A=n.W[i[P-1]];for(let E=1;E<=a;E++)_=0,y=u[E]+C,b=l[E],E===a&&(y+=S),y>=b?l[E]=y:_+=1,g=d+C,v=f,P===s&&(g+=S),g>=v?f=g:_+=2,c=u[E-1]+A[o[E-1]],u[E-1]=d,c>=f?c>=l[E]?d=c:(d=l[E],_+=4):f>=l[E]?(d=f,_+=8):(d=l[E],_+=4),h=P*a+E,p=h%2,h>>>=1,m[h]+=p?_:_<<4;u[a]=d}const w=Math.max(c,f,l[l.length-1]),[R,M]=Zu(m,s,a,_);return{j:[wr(R),wr(M)],K:w}}function Zu(e,t,n,r){let i=t,o=n,s=t*n+n,a=s,c=1;const u=[],l=[];let d=(12&r)>>2,f=0;for(;i>0&&o>0;)s=i*n+o,a=s>>>1,c=s%2,f=e[a],f=c?15&f:f>>>4,d===0?(f>>=2,f===0&&(i--,o--,u.push(1),l.push(1))):d===2?(u.push(-1),l.push(1),f&=2,o--):(u.push(1),l.push(-1),f&=1,i--),d=f;return i>0?(u.push(i),l.push(-i)):o>0&&(u.push(-o),l.push(o)),[u,l]}class Hm{constructor(t,n,r,i=0){this.Y=0,this.length=0,this.weight=0,this.length=t,this.J=new ao(t),this.L=new Uint8Array(n*t),this.Z=new Uint8Array(n*t),this.X=new Float32Array(n*t),this.tt=new Float32Array(n*t),this.et=new Uint8Array(t),this.rt=new Float32Array(t),this.nt=new Float32Array(t),this.it=new Float32Array(t),this.st=new Float32Array(t),this.ot=new Float32Array(t),this.Y=r,this.ht=n,this.weight=i}ct(t=0){return new p3(this,t)}}let p3=class{constructor(t,n=0){this.lt=0,this.ht=4,this.offset=0,this.ut=t,this.lt=n,this.ht=t.ht,this.offset=this.lt*this.ht}ft(t){this.lt=t,this.offset=t*this.ht}get J(){return this.ut.J.get(this.lt)}set J(t){t?this.ut.J.set(this.lt):this.ut.J.clear(this.lt)}get L(){return this.ut.L.subarray(this.offset,this.offset+this.ht)}set L(t){this.ut.L.set(t,this.offset)}get et(){return this.ut.et[this.lt]}set et(t){this.ut.et[this.lt]=t}get Z(){return this.ut.Z.subarray(this.offset,this.offset+this.ht)}set Z(t){this.ut.Z.set(t,this.offset)}get X(){return this.ut.X.subarray(this.offset,this.offset+this.ht)}set X(t){this.ut.X.set(t,this.offset)}get tt(){return this.ut.tt.subarray(this.offset,this.offset+this.ht)}set tt(t){this.ut.tt.set(t,this.offset)}get rt(){return this.ut.rt[this.lt]}set rt(t){this.ut.rt[this.lt]=t}get nt(){return this.ut.nt[this.lt]}set nt(t){this.ut.nt[this.lt]=t}get it(){return this.ut.it[this.lt]}set it(t){this.ut.it[this.lt]=t}get st(){return this.ut.st[this.lt]}set st(t){this.ut.st[this.lt]=t}get ot(){return this.ut.ot[this.lt]}set ot(t){this.ut.ot[this.lt]=t}};function _3(e,t,n,r=0){const i=e.V,o=i.length,s=new Hm(o,n.dt,1,t);let a=t;const c=n.$;let u=s.ct(),l=0;for(let d=0;d<o;d++){u.ft(d),l=i[d],u.Z[l]=1,u.X[l]=a,u.L[u.et]=l,u.et=1,u.rt=a,u.st=c/2*a,u.ot=c/2*a;for(let f=0;f<n.dt;f++)u.tt[f]=a*n.W[f][l]}return 1&r||(s.st[0]/=2),2&r||(s.st[o-1]/=2),s}function Xu(e,t,n,r,i,o=0){const s=Wu(n),a=e.Y+t.Y,c=e.weight+t.weight,u=new Hm(s,i.dt,a,c),l=i.$;let d=u.ct(),f=e.ct(),h=t.ct(),p=Gm(n),m=Gm(r),y=0,g=0,b=1,v=1,_=!1,A=!1,C=!1,I=!1,S=0;for(let w=0;w<s;w++){if(d.ft(w),y=p[w],f.ft(y),y===-1?(_=b>=0,A=w===s-1||p[w+1]>0):(_=!1,A=!1),b=y,g=m[w],h.ft(g),g===-1?(C=v>=0,I=w==s-1||m[w+1]>0):(C=!1,I=!1),v=g,S=0,y!==-1&&g!==-1){d.nt=f.nt+h.nt,d.it=f.it+h.it,d.rt=f.rt+h.rt,d.Z.set(f.Z),d.X.set(f.X);for(let R=0;R<t.ht;R++){let M=h.Z[R];M&&(d.Z[R]+=M,d.X[R]+=h.X[R]),d.Z[R]&&(d.L[S]=R,S++),d.tt[R]=f.tt[R]+h.tt[R]}d.et=S}else y==-1?(d.nt=h.nt+(_?e.weight:0),d.it=h.it+(A?e.weight:0),d.rt=h.rt,d.Z.set(h.Z),d.X.set(h.X),d.L.set(h.L),d.tt.set(h.tt),d.et=h.et):g==-1&&(d.nt=f.nt+(C?t.weight:0),d.it=f.it+(I?t.weight:0),d.rt=f.rt,d.Z.set(f.Z),d.X.set(f.X),d.L.set(f.L),d.tt.set(f.tt),d.et=f.et);d.st=l/2*(1-d.nt)*d.rt,d.ot=l/2*(1-d.it)*d.rt}return 1&o||(u.st[0]/=2),2&o||(u.st[s-1]/=2),u}function Ei(e){return"gt"in e}function y3(e,t){let n=1/0,r=0,i=0,o=e.length;for(let s=0;s<o;s++)for(let a=s+1;a<o;a++)e[s][a]<n&&(n=e[s][a],r=s,i=a);return[{profile:null,wt:t[r],At:t[i],Mt:n,yt:[],St:[],Ut:[],type:1,_t:0,id:"",qt:[],parent:-1,weight:0},r,i]}function g3(e,t,n,r){const[i,o]=t>n?[t,n]:[n,t],s=[],a=e.length;for(let c=0;c<a;c++){if(c==t||c==n)continue;const u=.1*(e[c][t]+e[c][n])/2+.9*Math.min(e[c][t],e[c][n]);e[c].push(u),s.push(u),e[c].splice(i,1),e[c].splice(o,1)}return s.push(0),e.push(s),e.splice(i,1),e.splice(o,1),r.splice(i,1),r.splice(o,1),e}class b3{constructor(t){this.bt=t,this.store=Array(t),this.head=0,this.vt=0}get size(){return(this.vt-this.head+this.bt)%this.bt}get Ot(){return this.head===this.vt}Ct(){if(this.Ot)return null;const t=this.store[this.head];return this.head++,this.head>=this.bt&&(this.head=0),t}Et(){return this.Ot?null:(this.vt--,this.vt<0&&(this.vt=this.bt-1),this.store[this.vt])}Gt(t){this.head--,this.head<0&&(this.head=this.bt-1),this.store[this.head]=t,this.head===this.vt&&(this.vt=(this.vt-1+this.bt)%this.bt)}Pt(t){this.store[this.vt]=t,this.vt++,this.vt>=this.bt&&(this.vt=0),this.head===this.vt&&(this.head=(this.head-1+this.bt)%this.bt)}Rt(t=0){const n=t===0?this.head:(this.head+t+this.bt)%this.bt;return this.store[n]}It(t=0){const n=(this.vt-1-t+this.bt)%this.bt;return this.store[n]}}function Qu(e,t,n){const r=new Map,i=new b3(n),o=0|t,s=new Uint16Array(e.V.length-o+1);let a=0,c=0;for(let p=0;p<o;p++)a|=e.V[o-p-1]<<2*p;s[c++]=a;for(let p=o,m=e.V.length;p<m;p++)a=(a<<2)+e.V[p],s[c++]=a;const u=e.Tt.length*(2/(n+1))*2|0,l={Ft:new Uint16Array(u),Dt:new Uint16Array(u),xt:new Uint16Array(u),Bt:new Uint16Array(u),count:0};let d=NaN,f=0,h=-17;for(let p=0;p<s.length;p++){const m=s[p];for(h++;!i.Ot&&((f=i.It())<h||s[f]>=m);)i.Et();if(i.Pt(p),h<0)continue;for(;i.Rt()<h;)i.Ct();let y=i.Rt();if(y===d)l.Bt[l.count-1]=p+o;else{const g=s[y],b=l.count;l.count++,l.Ft[b]=g,l.Dt[b]=y,l.xt[b]=h,l.Bt[b]=p+o,d=y,r.has(g)?r.get(g).push(b):r.set(g,[b])}}return[r,l,s]}function jm(e,t,n,r,i){const[o,s,a]=r??Qu(e,8,24),[c,u,l]=i??Qu(t,8,24);e.Tt.length,t.Tt.length;const d=new Map;for(let I=0;I<s.count;I++){let S=s.Ft[I];if(!c.has(S))continue;let w=c.get(S);if(w.length>4)continue;let R=e.Tt.substring(s.xt[I],s.Bt[I]);for(let M=0;M<w.length;M++){let P=w[M],E=t.Tt.substring(u.xt[P],u.Bt[P]),N=Math.min(R.length,E.length),q=!1;q=N==R.length?E.indexOf(R)===0:R.indexOf(E)===0;let j,z=0;q?(z=s.xt[I]-u.xt[P],j={Nt:z,Ht:s.xt[I],end:s.xt[I]+N}):(z=s.Dt[I]-u.Dt[P],j={Nt:z,Ht:s.Dt[I],end:s.Dt[I]+8-1}),d.has(z)?d.get(z).push(j):d.set(z,[j])}}let f=[];if(d.forEach(I=>{if(!I.length)return;let S=I[0];f.push(S),I.forEach(w=>{w.Ht<=S.end?S.end=w.end:(S=w,f.push(S))})}),f.length===0)return rs(e,t,n).j;f.sort((I,S)=>{let w=I.Ht+I.Nt-S.Ht-S.Nt;return w===0?I.Nt-S.Nt:w}),f=function(I,S,w){var R;const M=1/Math.max(S,w),P=S-w;let E=[0],N=new Int16Array(I.length);N[0]=-1;let q=I[0],j=q.end-q.Ht,z=q.end-q.Nt,W=q.Ht-q.Nt,se=Math.min(w-z,S-q.end),ue=[j],$=[z],ne=[se],de=I[0],_e=0,X=I[_e],ce=j,k=0;for(let V=1;V<I.length;V++){if(q=I[V],j=q.end-q.Ht,z=q.end-q.Nt,W=q.Ht-q.Nt,se=q.Nt<P?w-z:S-q.end,k===20){k=0;let K=[],Q=E.length-1,Z=$[Q],ie=S-q.Ht;for(;Q--;)$[Q]>Z?K.push(Q):(Z=$[Q],ue[Q]+Math.min(ne[Q],ie)<ce&&K.push(Q));K.forEach(L=>{E.splice(L,1),ue.splice(L,1),$.splice(L,1),ne.splice(L,1)})}if(q.Nt>=de.Nt&&z<$[0]){if(j+se<ce)continue;if(N[V]=-1,de=I[V],k++,j<ue[0]){E.unshift(V),ue.unshift(j),$.unshift(z),ne.unshift(se);continue}j>ce&&(ce=j),E[0]=V,ue[0]=j,$[0]=z,ne[0]=se}else{for(let K=E.length-1;K>=0;K--)if(_e=E[K],X=I[_e],q.Ht>=X.end&&$[K]<W){const Q=Math.abs(q.Nt-_e)*M,Z=ue[K]+j-Q;if(Z+se<ce)continue;let ie=K;for(;ie<E.length&&ue[ie]<Z;)ie++;if(ie===E.length)ce=Z,ne.push(se),ue.push(Z),$.push(z),E.push(V);else{if(z>=$[$.length-1])continue;ne.splice(ie,0,se),ue.splice(ie,0,Z),$.splice(ie,0,z),E.splice(ie,0,V)}N[V]=_e,k++;break}j>ce&&(N[V]=-1,ce=j,ne.push(se),ue.push(j),$.push(z),E.push(V),k++)}}let B=[],F=(R=E.pop())!==null&&R!==void 0?R:0,re=F;for(;F>-1&&re>-1;)B.push(F),F=N[F],re--;let G=[];for(let V=B.length-1;V>=0;V--)G.push(I[B[V]]);return G}(f,e.V.length,t.V.length);let h={Nt:0,Ht:0,end:0},p=[h],m=[];for(let I=0;I<f.length;I++){let S=f[I];if(S.Nt!==h.Nt){let w=h.end,R=w-h.Nt;for(;e.V[w]===t.V[R]&&w<S.Ht&&R<S.Ht-S.Nt;)w++,R++;for(h.end=w,w=S.Ht,R=w-S.Nt;e.V[w]===t.V[R]&&w>h.end&&R>h.end-h.Nt;)w--,R--;S.Ht=w+1,m.push({$t:S.Nt,kt:h.Nt,Ht:h.end,end:S.Ht}),p.push(S),h=S}else{let w=h.end,R=w-S.Nt,M=0;for(;w<S.Ht&&R<S.Ht-S.Nt&&M<2;)w+=8,R+=8,M=Vm(a[w],l[R])<=2?0:M+1;for(w>h.end&&(h.end=Math.max(w-2-8,h.end)),w=S.Ht-8,R=w-S.Nt,M=0;w>h.end&&R>h.end-h.Nt&&M<2;)w-=8,R-=8,M=Vm(a[w],l[R])<=2?0:M+1;if(w<S.Ht-16&&(S.Ht=w+24+2),S.Ht-h.end<=24){h.end=S.end;continue}m.push({kt:h.Nt,$t:S.Nt,Ht:h.end,end:S.Ht}),p.push(S),h=S}}let y=p[0];const g=[],b=[];for(let I=0;I<p.length;I++){y=p[I],g.push(y.end-y.Ht),b.push(y.end-y.Ht);let S=m[I];if(S){if(S.Ht===S.end){const R=Math.abs(S.$t-S.kt);g.push(-R),b.push(R);continue}if(S.Ht-S.kt==S.end-S.$t){const R=S.end-S.Ht;b.push(-R),g.push(R);continue}let w=rs({Tt:e.Tt.substring(S.Ht,S.end),type:e.type,V:e.V.subarray(S.Ht,S.end)},{Tt:t.Tt.substring(S.Ht-S.kt,S.end-S.$t),type:t.type,V:t.V.subarray(S.Ht-S.kt,S.end-S.$t)},n,3);g.push(...w.j[0]),b.push(...w.j[1])}}zm(g,e.V.length),zm(b,t.V.length);let v=wr(g,1),_=wr(b,1);const A=Wu(v),C=Wu(_);return A>C?_=Lm(_,[C-A]):A<C&&(v=Lm(v,[A-C])),[v,_]}function zm(e,t){let n=t-function(r){let i=0,o=0;for(let s=0;s<r.length;s++)o=r[s],o<0||(i+=o);return i}(e);n>0?e.push(n):n<0&&(e[e.length-1]+=n)}function Vm(e,t){let n=e^t;return n=1431655765&n|n>>1&1431655765,so(n)}const Km={Vt:"auto",gapchar:"-",Wt:"auto",debug:!1},v3=new class{constructor(){this.jt=[],this.Kt=2,this.Yt=Object.assign({},Km)}Jt(e){if(Array.isArray(e))e.forEach(t=>{this.Jt(t)});else{if(typeof e!="string")throw new TypeError("String type expected for sequences to add.");if(e=e.toUpperCase(),this.Yt.Vt==="auto"){const t=Um(e);if(this.Kt===2)this.Kt=t;else if(this.Kt!==t)throw Error("All sequences must be of same type.")}this.jt.push(function(t,n){const r=n??Um(t),i=function(o,s){const a=new Uint8Array(o.length),c=s===0?Lt:Xr;let u=0;for(let l=0,d=o.length;l<d;l++)u=c[o.charCodeAt(l)],u===255&&(u=u3(o[l],s)),a[l]=u;return a}(t,r);return{Tt:t,V:i,zt:r===0?l3(i):i,type:r}}(e,this.Kt))}}reset(){this.jt=[],this.Kt=2,this.Lt()}Lt(){this.Yt=Object.assign({},Km)}Qt(e){var t;function n(r,i){return i.some(o=>o==r)}e.method&&n(e.method,["complete","diag"])&&(this.Yt.Wt=e.method),e.type&&n(e.type,["amino","nucleic"])&&(this.Yt.Vt=e.type,this.Kt=e.type==="amino"?0:1),((t=e.gapchar)===null||t===void 0?void 0:t.length)===1&&(this.Yt.gapchar=e.gapchar),e.debug!==void 0&&(this.Yt.debug=!!e.debug)}align(e,t){return new Promise((r,i)=>{if(!Array.isArray(e)||e.some(u=>typeof u!="string"))return i("Array of sequences expected");if(e.length<2)return i("At least 2 sequences are required.");this.reset(),t&&this.Qt(t),this.Jt(e);const o=function(u,l){var d,f;const h=u===0?n3:r3;let p=(d=l==null?void 0:l.matrix)!==null&&d!==void 0?d:h.matrix,m=l!=null&&l.gapextend?2*-l.gapextend:h.H;var y;return{type:u,W:(y=m,p.map(g=>g.map(b=>b+y))),$:(f=l==null?void 0:l.gapopen)!==null&&f!==void 0?f:h.$,dt:u===0?20:4}}(this.Kt,t);let s,a=!1;a=this.Yt.Wt==="auto"?this.jt.some(u=>u.Tt.length>1600):this.Yt.Wt==="diag",s=this.jt.length==2?a?jm(this.jt[0],this.jt[1],o):rs(this.jt[0],this.jt[1],o).j:a?function(u,l){let d=u.map(m=>Qu(m,8,24)),f=[],h=[],p=[];for(let m=0;m<d.length;m++){if(m===0)continue;let y=jm(u[0],u[m],l,d[0],d[m]);h=h.length===0?y[0]:h3(h,y[0]),p[m]=y[0],f[m]=y[1]}for(let m=0;m<d.length;m++){if(m===0){f[m]=h;continue}let y=m3(h,p[m]);if(!y)throw console.error("An error occured while computing the center diff. for sequence #"+m,h,p[m]),console.dir(f),console.dir(p),new RangeError;f[m]=ns(y,f[m])}return f}(this.jt,o):function(u,l){const d=(m,y)=>{const g=f[m.wt],b=f[m.At];let v={};if(Ei(g)||g.St.length!==0||d(g,y),Ei(b)||b.St.length!==0||d(b,y),Ei(g))if(Ei(b)){const _=rs(g.gt,b.gt,l);v.K=_.K,m.Ut=[g.Ut[0],b.Ut[0]],m.yt=_.j,m.profile=Xu(g.profile,b.profile,_.j[0],_.j[1],l)}else{b.qt=b.Ut.map(A=>y[A]);const _=function(A,C,I,S=0){const w=C.gt,R=C.weight,M=w.Tt.length,P=A.profile.length;let E=0,N=[],q=[];const j=new Uint8Array(Math.ceil((P+1)*(M+1)/2)+1);let z,W,se,ue=0,$=0,ne=0,de=0,_e=0,X=0,ce=0,k=0,B=0,F=0,re=0,G=0,V=0;const K=I.$*R,Q=K/2,Z=K/2,ie=1&S?0:-K/4,L=2&S?0:-K/4,U=w.V,Y=A.profile;N[0]=0,q[0]=-1/0;for(let x=1;x<=M;x++)N[x]=Q+Z+ie,q[x]=-1/0;for(let x=1;x<=P;x++){G=Y.st[x-1],V=Y.ot[x-1],se=Y.tt.subarray((x-1)*I.dt,x*I.dt),B=ie,X=-1/0,q[0]=Y.st[0];for(let D=1;D<=M;D++)_e=0,ue=N[D]+G,ne=k=q[D],D===M&&(ue-=G/2),ue>=ne?q[D]=ue:_e+=1,$=B+Q,de=ce=X,x===P&&($+=L),$>=de?X=$:_e+=2,F=k+V,re=ce+Z,E=N[D-1]+se[U[D-1]],D===M&&(re+=L),N[D-1]=B,E>=re?E>=F?B=E:(B=F,_e+=4):re>=F?(B=re,_e+=8):(B=F,_e+=4),z=x*M+D,W=z%2,z>>>=1,j[z]+=W?_e:_e<<4;N[M]=B}const fe=Math.max(E,X,q[q.length-2]),[me,Te]=Zu(j,P,M,_e);return{j:[wr(me),wr(Te)],K:fe}}(b,g,l);v.K=_.K,m.Ut=[g.Ut[0],...b.Ut],m.yt=[_.j[1],...b.yt.map(A=>ns(_.j[0],A))],m.profile=Xu(g.profile,b.profile,_.j[1],_.j[0],l)}else if(!Ei(b)){b.qt=b.Ut.map(A=>y[A]),g.qt=g.Ut.map(A=>y[A]);const _=function(A,C,I,S=0){const w=A.profile.length,R=C.profile.length,M=new Uint8Array(Math.ceil((w+1)*(R+1)/2)+1);let P,E,N=[],q=[],j=0,z=0,W=0,se=0,ue=0,$=0,ne=0,de=0,_e=0,X=0,ce=0,k=0,B=0,F=0,re=new Float32Array(I.dt),G=new Uint8Array(I.dt),V=0,K=0,Q=0,Z=0,ie=0,L=0;const U=1&S?1:2,Y=C.profile,fe=A.profile;for(N[0]=0,q[0]=-1/0,ie=1;ie<=R;ie++)N[ie]=Y.st[0]+Y.ot[ie-1]/U,q[ie]=-1/0;const me=fe.st[0];for(Z=1;Z<=w;Z++){for(re=fe.tt.subarray(I.dt*(Z-1),I.dt*Z),B=fe.st[Z-1],F=fe.ot[Z-1],_e=me+F/U,ne=-1/0,q[0]=fe.st[0],ie=1;ie<=R;ie++){for($=0,z=N[ie]+B,se=X=q[ie],ie!==R||2&S||(z-=B/2),z>=se?q[ie]=z:$+=1,W=_e+Y.st[ie-1],ue=de=ne,Z!==w||2&S||(W-=Y.st[ie-1]/2),W>=ue?ne=W:$+=2,j=N[ie-1],Q=Y.et[ie-1],L=0,K=(ie-1)*I.dt,G=Y.L.subarray(K,K+Q);L<Q;)V=G[L],j+=re[V],L++;ce=X+F,k=de+Y.ot[ie-1],ie!==1||2&S||(ce-=F/2),ie!==R||2&S||(ce-=F/2,k-=Y.ot[R-1]/2),N[ie-1]=_e,j>=k?j>=ce?_e=j:(_e=ce,$+=4):k>=ce?(_e=k,$+=8):(_e=ce,$+=4),P=Z*R+ie,E=P%2,P>>>=1,M[P]+=E?$:$<<4}N[R]=_e}const Te=Math.max(j,ne,q[ie-1]),[x,D]=Zu(M,w,R,$);return{j:[wr(x),wr(D)],K:Te}}(g,b,l);v.K=_.K,m.yt=[...g.yt.map(A=>ns(_.j[0],A)),...b.yt.map(A=>ns(_.j[1],A))],m.profile=Xu(g.profile,b.profile,_.j[0],_.j[1],l)}return m.Ut=[...g.Ut,...b.Ut],v.K},f=function(m,y){let g,b,v,_=[],A=m.length,C=[];for(let I=0;I<A;I++)_[I]={type:0,gt:y[I],profile:null,wt:I,At:I,Mt:0,Ut:[I],St:[],id:I.toString(),weight:0,parent:-1,_t:0},C[I]=I;for(let I=0,S=A-1;I<S;I++){[g,b,v]=y3(m,C);const w=_[g.wt],R=_[g.At];g.id=w.id<R.id?`|${w.id},${R.id}|`:`|${R.id},${w.id}|`,g._t=Math.max(w._t,R._t)+1,R.parent=w.parent=_.length,C.push(A+I),_.push(g),m=g3(m,b,v,C)}return _[_.length-1].type=2,_}(function(m){const y=m[0].type===0,g=y?6:4,b=Math.pow(g,6),v=m.map(E=>{const N=new ao(b),q=y?E.zt:E.V;let j=0;for(let W=0;W<6;W++)j+=q[W]*Math.pow(g,W);N.set(j);const z=Math.pow(g,5);for(let W=6,se=q.length;W<se;W++)j-=q[W-6],j/=g,j+=q[W]*z,N.set(j);return N}),_=m.length,A=m.map(()=>[]);let C,I,S,w,R,M,P;for(let E=0;E<_;E++){A[E][E]=0,C=v[E],S=C.P(),M=1/(-Math.LN2/Math.log(1-S/b)*2);for(let N=E+1;N<_;N++)w=v[N].P(),R=C.D(v[N]),R+=b-(S+w-R),P=Math.ceil(M*w),R-=P,R=Math.max(R,0),I=1-R/(b-P),A[N][E]=A[E][N]=I}return A}(u),u),h=f[f.length-1],p=function(m){let y=0;return function g(b){let v=0,_=0;switch(b.type){case 2:b.weight=0,g(m[b.wt]),g(m[b.At]);break;case 1:v=m[b.parent].Mt-b.Mt,_=b.id.split(",").length,b.weight=m[b.parent].weight+v/_,g(m[b.wt]),g(m[b.At]);break;case 0:v=m[b.parent].Mt,b.weight=m[b.parent].weight+v,y+=b.weight}}(m[m.length-1]),m.map(g=>g.weight)}(f);return function(m,y,g){let b=0,v=m[b];for(;Ei(v)&&b<m.length;)v.profile=_3(v.gt,v.weight,y,void 0),b++,v=m[b]}(f,l),d(h,p),function(m,y){let g=y.slice();return y.forEach((b,v)=>g[b]=v),g.map(b=>m[b])}(h.yt.slice(),h.Ut)}(this.jt,o);const c=function(u,l,d){var f;let h=(f=d==null?void 0:d.gapchar)!==null&&f!==void 0?f:"-",p=[];for(let m=0;m<u.length;m++)p.push(d3(u[m].Tt,l[m],{gapchar:h}));return p}(this.jt,s,{gapchar:this.Yt.gapchar});return r(c)}).catch(r=>Promise.reject(r))}},$m={A:{A:10,R:-1,N:0,D:-1,C:-1,Q:-1,E:-1,G:1,H:-2,I:0,L:-1,K:-1,M:-1,F:-3,P:1,S:1,T:2,W:-4,Y:-3,V:1,B:0,Z:-1,X:0,"-":0},R:{A:-1,R:10,N:0,D:-1,C:-1,Q:2,E:0,G:0,H:2,I:-3,L:-3,K:4,M:-2,F:-4,P:-1,S:-1,T:-1,W:0,Y:-2,V:-3,B:0,Z:1,X:0,"-":0},N:{A:0,R:0,N:10,D:2,C:-1,Q:0,E:1,G:0,H:1,I:-2,L:-3,K:1,M:-2,F:-3,P:-1,S:1,T:1,W:-4,Y:-1,V:-2,B:2,Z:0,X:0,"-":0},D:{A:-1,R:-1,N:2,D:10,C:-3,Q:0,E:4,G:1,H:0,I:-3,L:-4,K:0,M:-3,F:-5,P:-2,S:0,T:-1,W:-5,Y:-2,V:-3,B:3,Z:2,X:0,"-":0},C:{A:-1,R:-1,N:-1,D:-3,C:10,Q:-3,E:-4,G:-1,H:0,I:-2,L:-3,K:-3,M:-2,F:0,P:-2,S:1,T:-1,W:1,Y:2,V:-2,B:-2,Z:-3,X:0,"-":0},Q:{A:-1,R:2,N:0,D:0,C:-3,Q:10,E:2,G:-1,H:3,I:-3,L:-2,K:2,M:-2,F:-4,P:0,S:-1,T:-1,W:-3,Y:-1,V:-3,B:0,Z:3,X:0,"-":0},E:{A:-1,R:0,N:1,D:4,C:-4,Q:2,E:10,G:1,H:0,I:-3,L:-4,K:1,M:-3,F:-5,P:-2,S:-1,T:-1,W:-5,Y:-4,V:-2,B:2,Z:3,X:0,"-":0},G:{A:1,R:0,N:0,D:1,C:-1,Q:-1,E:1,G:10,H:-2,I:-3,L:-4,K:-1,M:-3,F:-5,P:-1,S:1,T:0,W:-2,Y:-4,V:-2,B:0,Z:0,X:0,"-":0},H:{A:-2,R:2,N:1,D:0,C:0,Q:3,E:0,G:-2,H:10,I:-3,L:-2,K:1,M:-2,F:0,P:0,S:-1,T:-1,W:-3,Y:4,V:-3,B:0,Z:1,X:0,"-":0},I:{A:0,R:-3,N:-2,D:-3,C:-2,Q:-3,E:-3,G:-3,H:-3,I:10,L:2,K:-3,M:3,F:0,P:-2,S:-1,T:1,W:-4,Y:-2,V:4,B:-2,Z:-3,X:0,"-":0},L:{A:-1,R:-3,N:-3,D:-4,C:-3,Q:-2,E:-4,G:-4,H:-2,I:2,L:10,K:-3,M:3,F:2,P:0,S:-2,T:-1,W:-2,Y:-1,V:2,B:-3,Z:-3,X:0,"-":0},K:{A:-1,R:4,N:1,D:0,C:-3,Q:2,E:1,G:-1,H:1,I:-3,L:-3,K:10,M:-2,F:-5,P:-2,S:-1,T:-1,W:-3,Y:-3,V:-3,B:0,Z:1,X:0,"-":0},M:{A:-1,R:-2,N:-2,D:-3,C:-2,Q:-2,E:-3,G:-3,H:-2,I:3,L:3,K:-2,M:10,F:0,P:-2,S:-1,T:0,W:-3,Y:-3,V:2,B:-2,Z:-2,X:0,"-":0},F:{A:-3,R:-4,N:-3,D:-5,C:0,Q:-4,E:-5,G:-5,H:0,I:0,L:2,K:-5,M:0,F:10,P:-2,S:-2,T:-2,W:-1,Y:5,V:0,B:-4,Z:-4,X:0,"-":0},P:{A:1,R:-1,N:-1,D:-2,C:-2,Q:0,E:-2,G:-1,H:0,I:-2,L:0,K:-2,M:-2,F:-2,P:10,S:1,T:1,W:-5,Y:-3,V:-1,B:-1,Z:-1,X:0,"-":0},S:{A:1,R:-1,N:1,D:0,C:1,Q:-1,E:-1,G:1,H:-1,I:-1,L:-2,K:-1,M:-1,F:-2,P:1,S:10,T:1,W:-3,Y:-1,V:-1,B:0,Z:-1,X:0,"-":0},T:{A:2,R:-1,N:1,D:-1,C:-1,Q:-1,E:-1,G:0,H:-1,I:1,L:-1,K:-1,M:0,F:-2,P:1,S:1,T:10,W:-4,Y:-3,V:0,B:0,Z:-1,X:0,"-":0},W:{A:-4,R:0,N:-4,D:-5,C:1,Q:-3,E:-5,G:-2,H:-3,I:-4,L:-2,K:-3,M:-3,F:-1,P:-5,S:-3,T:-4,W:10,Y:0,V:-4,B:-4,Z:-4,X:0,"-":0},Y:{A:-3,R:-2,N:-1,D:-2,C:2,Q:-1,E:-4,G:-4,H:4,I:-2,L:-1,K:-3,M:-3,F:5,P:-3,S:-1,T:-3,W:0,Y:10,V:-3,B:-1,Z:-2,X:0,"-":0},V:{A:1,R:-3,N:-2,D:-3,C:-2,Q:-3,E:-2,G:-2,H:-3,I:4,L:2,K:-3,M:2,F:0,P:-1,S:-1,T:0,W:-4,Y:-3,V:10,B:-2,Z:-2,X:0,"-":0},B:{A:0,R:0,N:2,D:3,C:-2,Q:0,E:2,G:0,H:0,I:-2,L:-3,K:0,M:-2,F:-4,P:-1,S:0,T:0,W:-4,Y:-1,V:-2,B:10,Z:1,X:0,"-":0},Z:{A:-1,R:1,N:0,D:2,C:-3,Q:3,E:3,G:0,H:1,I:-3,L:-3,K:1,M:-2,F:-4,P:-1,S:-1,T:-1,W:-4,Y:-2,V:-2,B:1,Z:10,X:0,"-":0},X:{A:0,R:0,N:0,D:0,C:0,Q:0,E:0,G:0,H:0,I:0,L:0,K:0,M:0,F:0,P:0,S:0,T:0,W:0,Y:0,V:0,B:0,Z:0,X:1,"-":0},"-":{A:0,R:0,N:0,D:0,C:0,Q:0,E:0,G:0,H:0,I:0,L:0,K:0,M:0,F:0,P:0,S:0,T:0,W:0,Y:0,V:0,B:0,Z:0,X:0,"-":1}},Ym=Object.values($m).map(e=>Object.values(e)),Wm=Math.min(...Ym.flat()),x3=Math.max(...Ym.flat());function Zm(e,t){return e==="-"||t==="-"?0:($m[e][t]-Wm)/(x3-Wm)}function A3(e,t){const n=Array.from(e),r=Array.from(t),i=[];for(let a=0;a<n.length;a++)n[a]==="-"||r[a]==="-"||i.push(a);const o=i.length;let s=0;for(const a of i)s+=Zm(n[a],r[a]);return 1-s/o}function Xm(e,t){let n=0;for(const r of t)n+=A3(e,r);return n/(t.length-1)}function S3(e){const t=e[0].length,n=Array.from({length:t},()=>0);let r=0;for(let o=0;o<e.length;o++){const s=Xm(e[o],e);for(let a=o+1;a<e.length;a++){const c=Xm(e[a],e);for(let u=0;u<t;u++)n[u]+=s*c*Zm(e[o][u],e[a][u]);r+=s*c}}return n.map(o=>o/r)}const C3=e=>e.reduce((t,n)=>t+n,0)/e.length,I3=(...e)=>{const t=Math.max(...e.map(n=>n.length));return Array.from(Array(t)).map((n,r)=>e.map(i=>i[r]))};function w3(e){const t=[],n=[];let r=0;return Array.from(e).forEach((i,o)=>{i==="-"?n.push(-1):(t.push(o),n.push(r),++r)}),{alignedSequence:e,toReference:t,fromReference:n}}function Qm(e,t){let r=S3(e);return r.every(i=>Number.isNaN(i))&&(r=I3(...e.map(i=>Array.from(i))).map(i=>new Set(i).values().map(o=>i.filter(s=>s===o).length).toArray().toSorted((o,s)=>s-o)[0]/i.length)),{consensus:void 0,conservationScores:r,alignments:e.map(i=>w3(i))}}async function P3(e,t){const n=await v3.align(e,{type:"amino"});return Qm(n)}const E3=(e,t,n=0,r=!1)=>{const i=new Set,o=new Set,s=new Set;for(const[a,c]of e){if(r&&o.size>0)break;const u=(a==="ntd"?1:a)+n-1;if(u<0||u>=t.length){s.add(a);continue}if(t[u]==="-"){s.add(a);continue}a==="ntd"&&n===0||a!=="ntd"&&(c===void 0||t[u]===c)?i.add(a):o.add(a)}return{success:i.size>0&&o.size===0,mappedPositions:i,mismatchedPositions:o,unmappedPositions:s}},B3=e=>{const t=e.keys().map(n=>n==="ntd"?1:n).toArray();return[Math.min(...t),Math.max(...t)]},R3=(e,t)=>{const n=[],[r,i]=B3(e);for(let o=(i-1)*-1;o<=t-r;o+=1)n.push(o);return n},D3=(e,t)=>{let n=new Map;for(const r of R3(t,e.length)){const{success:i,mappedPositions:o}=E3(t,e,r,!0);i&&n.set(r,o)}return n.entries().map(([r,i])=>({offset:r,mappedPositions:i})).toArray().toSorted((r,i)=>i.mappedPositions.size-r.mappedPositions.size)};async function N3(e,t,n){const{alignments:r,conservationScores:i}=n?Qm(n):await P3([e,t.replaceAll("-","X")]),o=r[0].toReference,s=r[1].fromReference;return{alignedSequences:r.map(({alignedSequence:a})=>a),alignmentOffsets:o.map(a=>s[a]),scores:i}}const M3=({linkPositionToAminoAcid:e,peptides:t})=>new Map([...Object.entries(e??{}).map(([n,r])=>[n==="ntd"?"ntd":Number.parseInt(n),r]),...(t??[]).flatMap(({position:n,sequence:r})=>Array.from(r).map((i,o)=>[n+o,i]))]);async function T3(e,{sequence:t,...n},r){if(t){const{alignmentOffsets:i,scores:o,alignedSequences:s}=await N3(t,e.sequence,void 0),a=new Map(Array.from(Array(t.length)).map((u,l)=>[l+1,i[l]!==-1?e.startPosition+i[l]:void 0]));a.set("ntd",i[0]===0?e.startPosition:void 0);const c=a.entries().filter(([u,l])=>l!==void 0&&(u==="ntd"?a.get("ntd")!==void 0:t[u]===e.sequence[l-e.startPosition+1])).toArray().length;return{proteinPosToChainPos:a,alignedSequences:{chain:s[1],protein:s[0]},alignmentScore:C3(o),hits:c,relativeHits:c/t.length}}else{const i=M3(n),o=D3(e.sequence,i);if(o.length===0)return;const{mappedPositions:s,offset:a}=o[0],c=new Map(i.keys().map(l=>[l,s.has(l)?l==="ntd"?e.startPosition:e.startPosition+a+l-1:void 0])),u=s.size;return{proteinPosToChainPos:c,hits:u,relativeHits:u/i.size}}}async function O3(e,t){const n=[];for(const r of t){const i=await T3(e,r);i&&n.push({...i,proteinId:r.id})}return n.toSorted((r,i)=>i.relativeHits!==r.relativeHits?i.relativeHits-r.relativeHits:(i.alignmentScore??0)-(r.alignmentScore??0))}function k3(e){const t=e.filter(({alignmentScore:n,hits:r,relativeHits:i})=>{if(n&&n<.2||i<.2)return!1;const o=r/i;return!(r<Math.min(o/10,5))}).toSorted((n,r)=>r.relativeHits!==n.relativeHits?r.relativeHits-n.relativeHits:(r.alignmentScore??0)-(n.alignmentScore??0));return t.length>0?t[0]:void 0}const q3={HIS:"H",ARG:"R",LYS:"K",ILE:"I",PHE:"F",LEU:"L",TRP:"W",ALA:"A",MET:"M",PRO:"P",CYS:"C",ASN:"N",VAL:"V",GLY:"G",SER:"S",GLN:"Q",TYR:"Y",ASP:"D",GLU:"E",THR:"T",SEC:"U",PYL:"O",HSD:"H",HSE:"H",HSP:"H",LSN:"K",ASPP:"D",GLUP:"E",HID:"H",HIE:"H",HIP:"H",LYN:"K",ASH:"D",GLH:"E"},U3={DA:"A",DC:"C",DG:"G",DT:"T",DU:"U"},F3={A:"A",C:"C",G:"G",T:"T",U:"U"};function Ju(e){return q3[e]||"X"}function Jm(e){return F3[e]||"X"}function ep(e){return U3[e]||"X"}function Bi(e,t){const n=t&&typeof t.start<"u"?Math.max(Math.min(t.start,e-1),0):0,r=t&&typeof t.end<"u"?Math.min(t.end,e):e;return{start:n,end:r}}function co(e,t){const n=t&&typeof t.array<"u"?t.array:Array,{start:r,end:i}=Bi(e,t);return{array:new n(i-r),start:r,end:i}}function L3(e,t,n){for(let r=0,i=t.length;r<i;r++)t[r]=e(n+r);return t}function dn(e,t,n){const{array:r,start:i}=co(e,n);return L3(t,r,i)}function el(e){return!!e.buffer&&typeof e.byteLength=="number"&&typeof e.BYTES_PER_ELEMENT=="number"}function is(e,t){const{constructor:n,buffer:r,length:i,byteOffset:o,BYTES_PER_ELEMENT:s}=e,{start:a,end:c}=Bi(i,t);return a===0&&c===i?e:new n(r,o+s*a,Math.min(i,c-a))}const Tt=1e-6;function sn(e,t,n){return Math.abs(e-t)<=n}function Pr(e,t,n){return Math.max(t,Math.min(n,e))}function tl(e,t,n){return e+(t-e)*n}function nl(e,t,n,r,i,o){const s=(n-e)*o,a=(r-t)*o,c=i*i,u=i*c;return(2*t-2*n+s+a)*u+(-3*t+3*n-2*s-a)*c+s*i+t}function rl(e,t,n,r){const i=1-r;return i*i*e+2*i*r*t+r*r*n}const il=isFinite;function O(){return O.zero()}(function(e){function t(){const H=[.1,0,0];return H[0]=0,H}e.zero=t;function n(H){const ee=t();return ee[0]=H[0],ee[1]=H[1],ee[2]=H[2],ee}e.clone=n;function r(H){return il(H[0])&&il(H[1])&&il(H[2])}e.isFinite=r;function i(H){return isNaN(H[0])||isNaN(H[1])||isNaN(H[2])}e.hasNaN=i;function o(H){return H[0]=NaN,H[1]=NaN,H[2]=NaN,H}e.setNaN=o;function s(H){return l(H.x,H.y,H.z)}e.fromObj=s;function a(H){return{x:H[0],y:H[1],z:H[2]}}e.toObj=a;function c(H,ee,ae){return H[0]=ee[ae+0],H[1]=ee[ae+1],H[2]=ee[ae+2],H}e.fromArray=c;function u(H,ee,ae){return ee[ae+0]=H[0],ee[ae+1]=H[1],ee[ae+2]=H[2],ee}e.toArray=u;function l(H,ee,ae){const be=t();return be[0]=H,be[1]=ee,be[2]=ae,be}e.create=l;function d(H){const ee=t();return ee[0]=H[0],ee[1]=H[1],ee[2]=H[2],ee}e.ofArray=d;function f(H,ee,ae,be){return H[0]=ee,H[1]=ae,H[2]=be,H}e.set=f;function h(H,ee){return H[0]=ee[0],H[1]=ee[1],H[2]=ee[2],H}e.copy=h;function p(H,ee,ae){return H[0]=ee[0]+ae[0],H[1]=ee[1]+ae[1],H[2]=ee[2]+ae[2],H}e.add=p;function m(H,ee,ae){return H[0]=ee[0]-ae[0],H[1]=ee[1]-ae[1],H[2]=ee[2]-ae[2],H}e.sub=m;function y(H,ee,ae){return H[0]=ee[0]*ae[0],H[1]=ee[1]*ae[1],H[2]=ee[2]*ae[2],H}e.mul=y;function g(H,ee,ae){return H[0]=ee[0]/ae[0],H[1]=ee[1]/ae[1],H[2]=ee[2]/ae[2],H}e.div=g;function b(H,ee,ae){return H[0]=ee[0]*ae,H[1]=ee[1]*ae,H[2]=ee[2]*ae,H}e.scale=b;function v(H,ee,ae,be){return H[0]=ee[0]+ae[0]*be,H[1]=ee[1]+ae[1]*be,H[2]=ee[2]+ae[2]*be,H}e.scaleAndAdd=v;function _(H,ee,ae,be){return H[0]=ee[0]-ae[0]*be,H[1]=ee[1]-ae[1]*be,H[2]=ee[2]-ae[2]*be,H}e.scaleAndSub=_;function A(H,ee,ae){return H[0]=ee[0]+ae,H[1]=ee[1]+ae,H[2]=ee[2]+ae,H}e.addScalar=A;function C(H,ee,ae){return H[0]=ee[0]-ae,H[1]=ee[1]-ae,H[2]=ee[2]-ae,H}e.subScalar=C;function I(H,ee){return H[0]=Math.round(ee[0]),H[1]=Math.round(ee[1]),H[2]=Math.round(ee[2]),H}e.round=I;function S(H,ee){return H[0]=Math.ceil(ee[0]),H[1]=Math.ceil(ee[1]),H[2]=Math.ceil(ee[2]),H}e.ceil=S;function w(H,ee){return H[0]=Math.floor(ee[0]),H[1]=Math.floor(ee[1]),H[2]=Math.floor(ee[2]),H}e.floor=w;function R(H,ee){return H[0]=Math.trunc(ee[0]),H[1]=Math.trunc(ee[1]),H[2]=Math.trunc(ee[2]),H}e.trunc=R;function M(H,ee){return H[0]=Math.abs(ee[0]),H[1]=Math.abs(ee[1]),H[2]=Math.abs(ee[2]),H}e.abs=M;function P(H,ee,ae){return H[0]=Math.min(ee[0],ae[0]),H[1]=Math.min(ee[1],ae[1]),H[2]=Math.min(ee[2],ae[2]),H}e.min=P;function E(H,ee,ae){return H[0]=Math.max(ee[0],ae[0]),H[1]=Math.max(ee[1],ae[1]),H[2]=Math.max(ee[2],ae[2]),H}e.max=E;function N(H,ee,ae,be){return H[0]=Math.max(ae[0],Math.min(be[0],ee[0])),H[1]=Math.max(ae[1],Math.min(be[1],ee[1])),H[2]=Math.max(ae[2],Math.min(be[2],ee[2])),H}e.clamp=N;function q(H,ee){const ae=ee[0]-H[0],be=ee[1]-H[1],Ge=ee[2]-H[2];return Math.sqrt(ae*ae+be*be+Ge*Ge)}e.distance=q;function j(H,ee){const ae=ee[0]-H[0],be=ee[1]-H[1],Ge=ee[2]-H[2];return ae*ae+be*be+Ge*Ge}e.squaredDistance=j;function z(H){const ee=H[0],ae=H[1],be=H[2];return Math.sqrt(ee*ee+ae*ae+be*be)}e.magnitude=z;function W(H){const ee=H[0],ae=H[1],be=H[2];return ee*ee+ae*ae+be*be}e.squaredMagnitude=W;function se(H,ee,ae){return b(H,ne(H,ee),ae)}e.setMagnitude=se;function ue(H,ee){return H[0]=-ee[0],H[1]=-ee[1],H[2]=-ee[2],H}e.negate=ue;function $(H,ee){return H[0]=1/ee[0],H[1]=1/ee[1],H[2]=1/ee[2],H}e.inverse=$;function ne(H,ee){const ae=ee[0],be=ee[1],Ge=ee[2];let Pe=ae*ae+be*be+Ge*Ge;return Pe>0&&(Pe=1/Math.sqrt(Pe),H[0]=ee[0]*Pe,H[1]=ee[1]*Pe,H[2]=ee[2]*Pe),H}e.normalize=ne;function de(H,ee){return H[0]*ee[0]+H[1]*ee[1]+H[2]*ee[2]}e.dot=de;function _e(H,ee,ae){const be=ee[0],Ge=ee[1],Pe=ee[2],Je=ae[0],Et=ae[1],kt=ae[2];return H[0]=Ge*kt-Pe*Et,H[1]=Pe*Je-be*kt,H[2]=be*Et-Ge*Je,H}e.cross=_e;function X(H,ee,ae,be){const Ge=ee[0],Pe=ee[1],Je=ee[2];return H[0]=Ge+be*(ae[0]-Ge),H[1]=Pe+be*(ae[1]-Pe),H[2]=Je+be*(ae[2]-Je),H}e.lerp=X;const ce=t();function k(H,ee,ae,be){const Ge=Pr(de(ee,ae),-1,1),Pe=Math.acos(Ge)*be;return v(ce,ae,ee,-Ge),ne(ce,ce),p(H,b(H,ee,Math.cos(Pe)),b(ce,ce,Math.sin(Pe)))}e.slerp=k;function B(H,ee,ae,be,Ge,Pe){const Je=Pe*Pe,Et=Je*(2*Pe-3)+1,kt=Je*(Pe-2)+Pe,Gt=Je*(Pe-1),Xn=Je*(3-2*Pe);return H[0]=ee[0]*Et+ae[0]*kt+be[0]*Gt+Ge[0]*Xn,H[1]=ee[1]*Et+ae[1]*kt+be[1]*Gt+Ge[1]*Xn,H[2]=ee[2]*Et+ae[2]*kt+be[2]*Gt+Ge[2]*Xn,H}e.hermite=B;function F(H,ee,ae,be,Ge,Pe){const Je=1-Pe,Et=Je*Je,kt=Pe*Pe,Gt=Et*Je,Xn=3*Pe*Et,Ai=3*kt*Je,Si=kt*Pe;return H[0]=ee[0]*Gt+ae[0]*Xn+be[0]*Ai+Ge[0]*Si,H[1]=ee[1]*Gt+ae[1]*Xn+be[1]*Ai+Ge[1]*Si,H[2]=ee[2]*Gt+ae[2]*Xn+be[2]*Ai+Ge[2]*Si,H}e.bezier=F;function re(H,ee,ae,be,Ge){return H[0]=rl(ee[0],ae[0],be[0],Ge),H[1]=rl(ee[1],ae[1],be[1],Ge),H[2]=rl(ee[2],ae[2],be[2],Ge),H}e.quadraticBezier=re;function G(H,ee,ae,be,Ge,Pe,Je){return H[0]=nl(ee[0],ae[0],be[0],Ge[0],Pe,Je),H[1]=nl(ee[1],ae[1],be[1],Ge[1],Pe,Je),H[2]=nl(ee[2],ae[2],be[2],Ge[2],Pe,Je),H}e.spline=G;function V(H,ee){const ae=Math.random()*2*Math.PI,be=Math.random()*2-1,Ge=Math.sqrt(1-be*be)*ee;return H[0]=Math.cos(ae)*Ge,H[1]=Math.sin(ae)*Ge,H[2]=be*ee,H}e.random=V;function K(H,ee,ae){const be=ee[0],Ge=ee[1],Pe=ee[2],Je=1/(ae[3]*be+ae[7]*Ge+ae[11]*Pe+ae[15]||1);return H[0]=(ae[0]*be+ae[4]*Ge+ae[8]*Pe+ae[12])*Je,H[1]=(ae[1]*be+ae[5]*Ge+ae[9]*Pe+ae[13])*Je,H[2]=(ae[2]*be+ae[6]*Ge+ae[10]*Pe+ae[14])*Je,H}e.transformMat4=K;function Q(H,ee,ae){const be=ee[0],Ge=ee[1],Pe=ee[2];return H[0]=ae[0]*be+ae[4]*Ge+ae[8]*Pe,H[1]=ae[1]*be+ae[5]*Ge+ae[9]*Pe,H[2]=ae[2]*be+ae[6]*Ge+ae[10]*Pe,ne(H,H)}e.transformDirection=Q;function Z(H,ee,ae,be,Ge,Pe){const Je=ee[0+Ge],Et=ee[1+Ge],kt=ee[2+Ge],Gt=1/(ae[3+Pe]*Je+ae[7+Pe]*Et+ae[11+Pe]*kt+ae[15+Pe]||1);return H[0+be]=(ae[0+Pe]*Je+ae[4+Pe]*Et+ae[8+Pe]*kt+ae[12+Pe])*Gt,H[1+be]=(ae[1+Pe]*Je+ae[5+Pe]*Et+ae[9+Pe]*kt+ae[13+Pe])*Gt,H[2+be]=(ae[2+Pe]*Je+ae[6+Pe]*Et+ae[10+Pe]*kt+ae[14+Pe])*Gt,H}e.transformMat4Offset=Z;function ie(H,ee,ae,be,Ge,Pe){const Je=ee[0+Ge],Et=ee[1+Ge],kt=ee[2+Ge];H[0+be]=ae[0+Pe]*Je+ae[4+Pe]*Et+ae[8+Pe]*kt,H[1+be]=ae[1+Pe]*Je+ae[5+Pe]*Et+ae[9+Pe]*kt,H[2+be]=ae[2+Pe]*Je+ae[6+Pe]*Et+ae[10+Pe]*kt;const Gt=Math.hypot(H[0+be],H[1+be],H[2+be]);return Gt>0&&(H[0+be]/=Gt,H[1+be]/=Gt,H[2+be]/=Gt),H}e.transformDirectionOffset=ie;function L(H,ee,ae){const be=ee[0],Ge=ee[1],Pe=ee[2];return H[0]=be*ae[0]+Ge*ae[3]+Pe*ae[6],H[1]=be*ae[1]+Ge*ae[4]+Pe*ae[7],H[2]=be*ae[2]+Ge*ae[5]+Pe*ae[8],H}e.transformMat3=L;function U(H,ee,ae){const be=ee[0],Ge=ee[1],Pe=ee[2],Je=ae[0],Et=ae[1],kt=ae[2],Gt=ae[3],Xn=Gt*be+Et*Pe-kt*Ge,Ai=Gt*Ge+kt*be-Je*Pe,Si=Gt*Pe+Je*Ge-Et*be,Vf=-Je*be-Et*Ge-kt*Pe;return H[0]=Xn*Gt+Vf*-Je+Ai*-kt-Si*-Et,H[1]=Ai*Gt+Vf*-Et+Si*-Je-Xn*-kt,H[2]=Si*Gt+Vf*-kt+Xn*-Et-Ai*-Je,H}e.transformQuat=U;function Y(H,ee){const ae=Math.sqrt(W(H)*W(ee));if(ae===0)return Math.PI/2;const be=de(H,ee)/ae;return Math.acos(Pr(be,-1,1))}e.angle=Y;const fe=t(),me=t(),Te=t(),x=t(),D=t(),J=t(),le=t();function he(H,ee,ae,be){m(fe,H,ee),m(me,ae,ee),m(Te,ee,ae),m(x,be,ae),_e(D,fe,me),_e(J,Te,x);const Ge=Y(D,J);return _e(le,D,J),de(me,le)>0?Ge:-Ge}e.dihedralAngle=he;function ye(H,ee,ae,be){return e.set(H,be*Math.cos(ae)*Math.sin(ee),be*Math.sin(ae)*Math.sin(ee),be*Math.cos(ee))}e.directionFromSpherical=ye;function Se(H,ee){return H[0]===ee[0]&&H[1]===ee[1]&&H[2]===ee[2]}e.exactEquals=Se;function Ie(H,ee){const ae=H[0],be=H[1],Ge=H[2],Pe=ee[0],Je=ee[1],Et=ee[2];return Math.abs(ae-Pe)<=Tt*Math.max(1,Math.abs(ae),Math.abs(Pe))&&Math.abs(be-Je)<=Tt*Math.max(1,Math.abs(be),Math.abs(Je))&&Math.abs(Ge-Et)<=Tt*Math.max(1,Math.abs(Ge),Math.abs(Et))}e.equals=Ie;const Ee=t();function Be(H,ee,ae){const be=Y(ee,ae);if(Math.abs(be)<1e-4)return Oe.setIdentity(H);if(Math.abs(be-Math.PI)<Tt)return Oe.fromRotation(H,Math.PI,Math.abs(ee[0])<.9?e.unitX:e.unitZ);const Ge=_e(Ee,ee,ae);return Oe.fromRotation(H,be,Ge)}e.makeRotation=Be;function we(H){return H[0]===0&&H[1]===0&&H[2]===0}e.isZero=we;function Ue(H,ee,ae,be){m(H,ee,be);const Ge=de(ae,H)/W(ae);return p(H,b(H,ae,Ge),be)}e.projectPointOnVector=Ue;const Fe=t();function qe(H,ee,ae,be){return ne(Fe,ae),m(H,ee,be),m(H,ee,b(Fe,Fe,de(H,Fe)))}e.projectPointOnPlane=qe;function He(H,ee,ae){const be=de(ae,ee)/W(ae);return b(H,ae,be)}e.projectOnVector=He;const Ve=t();function Xe(H,ee,ae){return He(Ve,ee,ae),m(H,ee,Ve)}e.projectOnPlane=Xe;function ht(H,ee,ae){return ne(H,_e(H,_e(H,ee,ae),ee))}e.orthogonalize=ht;function It(H,ee,ae){return de(ee,ae)>0?h(H,ee):ue(H,h(H,ee)),H}e.matchDirection=It;const ot=t(),nt=t();function st(H,ee,ae,be){return m(ot,ae,ee),m(nt,be,ee),ne(H,_e(H,ot,nt))}e.triangleNormal=st;const Ke=t();function pt(H,ee,ae){return e.scaleAndAdd(H,ee,e.sub(Ke,ae,ee),.5)}e.center=pt;function _t(H,ee){return`[${H[0].toPrecision(ee)} ${H[1].toPrecision(ee)} ${H[2].toPrecision(ee)}]`}e.toString=_t,e.origin=l(0,0,0),e.unit=l(1,1,1),e.negUnit=l(-1,-1,-1),e.unitX=l(1,0,0),e.unitY=l(0,1,0),e.unitZ=l(0,0,1),e.negUnitX=l(-1,0,0),e.negUnitY=l(0,-1,0),e.negUnitZ=l(0,0,-1)})(O||(O={}));const tp=Math.PI/180;function Er(e){return e*tp}function Qr(e){return e/tp}function Oe(){return Oe.zero()}(function(e){function t(){const x=[.1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];return x[0]=0,x}e.zero=t;function n(){const x=t();return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x}e.identity=n;function r(x){return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x}e.setIdentity=r;function i(x){for(let D=0;D<16;D++)x[D]=0;return x}e.setZero=i;function o(x){const D=t();for(let J=0;J<4;J++){const le=x[J];for(let he=0;he<4;he++)D[4*he+J]=le[he]}return D}e.ofRows=o;const s=n();function a(x,D){return u(x,s,typeof D>"u"?Tt:D)}e.isIdentity=a;function c(x){for(let D=0;D<16;D++)if(isNaN(x[D]))return!0;return!1}e.hasNaN=c;function u(x,D,J){for(let le=0;le<16;le++)if(Math.abs(x[le]-D[le])>J)return!1;return!0}e.areEqual=u;function l(x,D,J,le){x[4*J+D]=le}e.setValue=l;function d(x,D,J){return x[4*J+D]}e.getValue=d;function f(x,D,J){return D[J+0]=x[0],D[J+1]=x[1],D[J+2]=x[2],D[J+3]=x[3],D[J+4]=x[4],D[J+5]=x[5],D[J+6]=x[6],D[J+7]=x[7],D[J+8]=x[8],D[J+9]=x[9],D[J+10]=x[10],D[J+11]=x[11],D[J+12]=x[12],D[J+13]=x[13],D[J+14]=x[14],D[J+15]=x[15],D}e.toArray=f;function h(x,D,J){return x[0]=D[J+0],x[1]=D[J+1],x[2]=D[J+2],x[3]=D[J+3],x[4]=D[J+4],x[5]=D[J+5],x[6]=D[J+6],x[7]=D[J+7],x[8]=D[J+8],x[9]=D[J+9],x[10]=D[J+10],x[11]=D[J+11],x[12]=D[J+12],x[13]=D[J+13],x[14]=D[J+14],x[15]=D[J+15],x}e.fromArray=h;function p(x,D,J,le){return i(x),l(x,0,0,D[0]),l(x,1,0,D[1]),l(x,2,0,D[2]),l(x,0,1,J[0]),l(x,1,1,J[1]),l(x,2,1,J[2]),l(x,0,2,le[0]),l(x,1,2,le[1]),l(x,2,2,le[2]),l(x,3,3,1),x}e.fromBasis=p;function m(x,D){return x[0]=D[0],x[1]=D[1],x[2]=D[2],x[3]=D[3],x[4]=D[4],x[5]=D[5],x[6]=D[6],x[7]=D[7],x[8]=D[8],x[9]=D[9],x[10]=D[10],x[11]=D[11],x[12]=D[12],x[13]=D[13],x[14]=D[14],x[15]=D[15],x}e.copy=m;function y(x){return m(t(),x)}e.clone=y;function g(x,D){return x[0]=D[12],x[1]=D[13],x[2]=D[14],x}e.getTranslation=g;function b(x,D){const J=D[0],le=D[1],he=D[2],ye=D[4],Se=D[5],Ie=D[6],Ee=D[8],Be=D[9],we=D[10];return x[0]=Math.sqrt(J*J+le*le+he*he),x[1]=Math.sqrt(ye*ye+Se*Se+Ie*Ie),x[2]=Math.sqrt(Ee*Ee+Be*Be+we*we),x}e.getScaling=b;function v(x,D){const J=D[0]+D[5]+D[10];let le=0;return J>0?(le=Math.sqrt(J+1)*2,x[3]=.25*le,x[0]=(D[6]-D[9])/le,x[1]=(D[8]-D[2])/le,x[2]=(D[1]-D[4])/le):D[0]>D[5]&&D[0]>D[10]?(le=Math.sqrt(1+D[0]-D[5]-D[10])*2,x[3]=(D[6]-D[9])/le,x[0]=.25*le,x[1]=(D[1]+D[4])/le,x[2]=(D[8]+D[2])/le):D[5]>D[10]?(le=Math.sqrt(1+D[5]-D[0]-D[10])*2,x[3]=(D[8]-D[2])/le,x[0]=(D[1]+D[4])/le,x[1]=.25*le,x[2]=(D[6]+D[9])/le):(le=Math.sqrt(1+D[10]-D[0]-D[5])*2,x[3]=(D[1]-D[4])/le,x[0]=(D[8]+D[2])/le,x[1]=(D[6]+D[9])/le,x[2]=.25*le),x}e.getRotation=v;function _(x,D){const J=1/Math.sqrt(D[0]*D[0]+D[1]*D[1]+D[2]*D[2]),le=1/Math.sqrt(D[4]*D[4]+D[5]*D[5]+D[6]*D[6]),he=1/Math.sqrt(D[8]*D[8]+D[9]*D[9]+D[10]*D[10]);return x[0]=D[0]*J,x[1]=D[1]*J,x[2]=D[2]*J,x[3]=0,x[4]=D[4]*le,x[5]=D[5]*le,x[6]=D[6]*le,x[7]=0,x[8]=D[8]*he,x[9]=D[9]*he,x[10]=D[10]*he,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x}e.extractRotation=_;function A(x,D){if(x===D){const J=D[1],le=D[2],he=D[3],ye=D[6],Se=D[7],Ie=D[11];x[1]=D[4],x[2]=D[8],x[3]=D[12],x[4]=J,x[6]=D[9],x[7]=D[13],x[8]=le,x[9]=ye,x[11]=D[14],x[12]=he,x[13]=Se,x[14]=Ie}else x[0]=D[0],x[1]=D[4],x[2]=D[8],x[3]=D[12],x[4]=D[1],x[5]=D[5],x[6]=D[9],x[7]=D[13],x[8]=D[2],x[9]=D[6],x[10]=D[10],x[11]=D[14],x[12]=D[3],x[13]=D[7],x[14]=D[11],x[15]=D[15];return x}e.transpose=A;function C(x,D){const J=D[0],le=D[1],he=D[2],ye=D[3],Se=D[4],Ie=D[5],Ee=D[6],Be=D[7],we=D[8],Ue=D[9],Fe=D[10],qe=D[11],He=D[12],Ve=D[13],Xe=D[14],ht=D[15],It=J*Ie-le*Se,ot=J*Ee-he*Se,nt=J*Be-ye*Se,st=le*Ee-he*Ie,Ke=le*Be-ye*Ie,pt=he*Be-ye*Ee,_t=we*Ve-Ue*He,H=we*Xe-Fe*He,ee=we*ht-qe*He,ae=Ue*Xe-Fe*Ve,be=Ue*ht-qe*Ve,Ge=Fe*ht-qe*Xe;let Pe=It*Ge-ot*be+nt*ae+st*ee-Ke*H+pt*_t;return Pe?(Pe=1/Pe,x[0]=(Ie*Ge-Ee*be+Be*ae)*Pe,x[1]=(he*be-le*Ge-ye*ae)*Pe,x[2]=(Ve*pt-Xe*Ke+ht*st)*Pe,x[3]=(Fe*Ke-Ue*pt-qe*st)*Pe,x[4]=(Ee*ee-Se*Ge-Be*H)*Pe,x[5]=(J*Ge-he*ee+ye*H)*Pe,x[6]=(Xe*nt-He*pt-ht*ot)*Pe,x[7]=(we*pt-Fe*nt+qe*ot)*Pe,x[8]=(Se*be-Ie*ee+Be*_t)*Pe,x[9]=(le*ee-J*be-ye*_t)*Pe,x[10]=(He*Ke-Ve*nt+ht*It)*Pe,x[11]=(Ue*nt-we*Ke-qe*It)*Pe,x[12]=(Ie*H-Se*ae-Ee*_t)*Pe,x[13]=(J*ae-le*H+he*_t)*Pe,x[14]=(Ve*ot-He*st-Xe*It)*Pe,x[15]=(we*st-Ue*ot+Fe*It)*Pe,!0):!1}e.tryInvert=C;function I(x,D){return C(x,D)||console.warn("non-invertible matrix.",D),x}e.invert=I;function S(x,D,J){const le=D[0],he=D[1],ye=D[2],Se=D[3],Ie=D[4],Ee=D[5],Be=D[6],we=D[7],Ue=D[8],Fe=D[9],qe=D[10],He=D[11],Ve=D[12],Xe=D[13],ht=D[14],It=D[15];let ot=J[0],nt=J[1],st=J[2],Ke=J[3];return x[0]=ot*le+nt*Ie+st*Ue+Ke*Ve,x[1]=ot*he+nt*Ee+st*Fe+Ke*Xe,x[2]=ot*ye+nt*Be+st*qe+Ke*ht,x[3]=ot*Se+nt*we+st*He+Ke*It,ot=J[4],nt=J[5],st=J[6],Ke=J[7],x[4]=ot*le+nt*Ie+st*Ue+Ke*Ve,x[5]=ot*he+nt*Ee+st*Fe+Ke*Xe,x[6]=ot*ye+nt*Be+st*qe+Ke*ht,x[7]=ot*Se+nt*we+st*He+Ke*It,ot=J[8],nt=J[9],st=J[10],Ke=J[11],x[8]=ot*le+nt*Ie+st*Ue+Ke*Ve,x[9]=ot*he+nt*Ee+st*Fe+Ke*Xe,x[10]=ot*ye+nt*Be+st*qe+Ke*ht,x[11]=ot*Se+nt*we+st*He+Ke*It,ot=J[12],nt=J[13],st=J[14],Ke=J[15],x[12]=ot*le+nt*Ie+st*Ue+Ke*Ve,x[13]=ot*he+nt*Ee+st*Fe+Ke*Xe,x[14]=ot*ye+nt*Be+st*qe+Ke*ht,x[15]=ot*Se+nt*we+st*He+Ke*It,x}e.mul=S;function w(x,D,J,le,he,ye){const Se=D[0+he],Ie=D[1+he],Ee=D[2+he],Be=D[3+he],we=D[4+he],Ue=D[5+he],Fe=D[6+he],qe=D[7+he],He=D[8+he],Ve=D[9+he],Xe=D[10+he],ht=D[11+he],It=D[12+he],ot=D[13+he],nt=D[14+he],st=D[15+he];let Ke=J[0+ye],pt=J[1+ye],_t=J[2+ye],H=J[3+ye];return x[0+le]=Ke*Se+pt*we+_t*He+H*It,x[1+le]=Ke*Ie+pt*Ue+_t*Ve+H*ot,x[2+le]=Ke*Ee+pt*Fe+_t*Xe+H*nt,x[3+le]=Ke*Be+pt*qe+_t*ht+H*st,Ke=J[4+ye],pt=J[5+ye],_t=J[6+ye],H=J[7+ye],x[4+le]=Ke*Se+pt*we+_t*He+H*It,x[5+le]=Ke*Ie+pt*Ue+_t*Ve+H*ot,x[6+le]=Ke*Ee+pt*Fe+_t*Xe+H*nt,x[7+le]=Ke*Be+pt*qe+_t*ht+H*st,Ke=J[8+ye],pt=J[9+ye],_t=J[10+ye],H=J[11+ye],x[8+le]=Ke*Se+pt*we+_t*He+H*It,x[9+le]=Ke*Ie+pt*Ue+_t*Ve+H*ot,x[10+le]=Ke*Ee+pt*Fe+_t*Xe+H*nt,x[11+le]=Ke*Be+pt*qe+_t*ht+H*st,Ke=J[12+ye],pt=J[13+ye],_t=J[14+ye],H=J[15+ye],x[12+le]=Ke*Se+pt*we+_t*He+H*It,x[13+le]=Ke*Ie+pt*Ue+_t*Ve+H*ot,x[14+le]=Ke*Ee+pt*Fe+_t*Xe+H*nt,x[15+le]=Ke*Be+pt*qe+_t*ht+H*st,x}e.mulOffset=w;function R(x,D,J,le){return S(x,S(x,D,J),le)}e.mul3=R;function M(x,D,J){const le=J[0],he=J[1],ye=J[2];let Se,Ie,Ee,Be,we,Ue,Fe,qe,He,Ve,Xe,ht;return D===x?(x[12]=D[0]*le+D[4]*he+D[8]*ye+D[12],x[13]=D[1]*le+D[5]*he+D[9]*ye+D[13],x[14]=D[2]*le+D[6]*he+D[10]*ye+D[14],x[15]=D[3]*le+D[7]*he+D[11]*ye+D[15]):(Se=D[0],Ie=D[1],Ee=D[2],Be=D[3],we=D[4],Ue=D[5],Fe=D[6],qe=D[7],He=D[8],Ve=D[9],Xe=D[10],ht=D[11],x[0]=Se,x[1]=Ie,x[2]=Ee,x[3]=Be,x[4]=we,x[5]=Ue,x[6]=Fe,x[7]=qe,x[8]=He,x[9]=Ve,x[10]=Xe,x[11]=ht,x[12]=Se*le+we*he+He*ye+D[12],x[13]=Ie*le+Ue*he+Ve*ye+D[13],x[14]=Ee*le+Fe*he+Xe*ye+D[14],x[15]=Be*le+qe*he+ht*ye+D[15]),x}e.translate=M;function P(x,D){return x[0]=1,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=1,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=1,x[11]=0,x[12]=D[0],x[13]=D[1],x[14]=D[2],x[15]=1,x}e.fromTranslation=P;function E(x,D){return x[12]=D[0],x[13]=D[1],x[14]=D[2],x}e.setTranslation=E;function N(x,D,J,le){return x[0]=J[0],x[4]=J[1],x[8]=J[2],x[1]=le[0],x[5]=le[1],x[9]=le[2],x[2]=D[0],x[6]=D[1],x[10]=D[2],x}e.setAxes=N;function q(x,D,J,le){let he=le[0],ye=le[1],Se=le[2],Ie=Math.sqrt(he*he+ye*ye+Se*Se);if(Math.abs(Ie)<Tt)return n();Ie=1/Ie,he*=Ie,ye*=Ie,Se*=Ie;const Ee=Math.sin(J),Be=Math.cos(J),we=1-Be,Ue=D[0],Fe=D[1],qe=D[2],He=D[3],Ve=D[4],Xe=D[5],ht=D[6],It=D[7],ot=D[8],nt=D[9],st=D[10],Ke=D[11],pt=he*he*we+Be,_t=ye*he*we+Se*Ee,H=Se*he*we-ye*Ee,ee=he*ye*we-Se*Ee,ae=ye*ye*we+Be,be=Se*ye*we+he*Ee,Ge=he*Se*we+ye*Ee,Pe=ye*Se*we-he*Ee,Je=Se*Se*we+Be;return x[0]=Ue*pt+Ve*_t+ot*H,x[1]=Fe*pt+Xe*_t+nt*H,x[2]=qe*pt+ht*_t+st*H,x[3]=He*pt+It*_t+Ke*H,x[4]=Ue*ee+Ve*ae+ot*be,x[5]=Fe*ee+Xe*ae+nt*be,x[6]=qe*ee+ht*ae+st*be,x[7]=He*ee+It*ae+Ke*be,x[8]=Ue*Ge+Ve*Pe+ot*Je,x[9]=Fe*Ge+Xe*Pe+nt*Je,x[10]=qe*Ge+ht*Pe+st*Je,x[11]=He*Ge+It*Pe+Ke*Je,D!==x&&(x[12]=D[12],x[13]=D[13],x[14]=D[14],x[15]=D[15]),x}e.rotate=q;function j(x,D,J){let le=J[0],he=J[1],ye=J[2],Se=Math.sqrt(le*le+he*he+ye*ye);if(Math.abs(Se)<Tt)return r(x);Se=1/Se,le*=Se,he*=Se,ye*=Se;const Ie=Math.sin(D),Ee=Math.cos(D),Be=1-Ee;return x[0]=le*le*Be+Ee,x[1]=he*le*Be+ye*Ie,x[2]=ye*le*Be-he*Ie,x[3]=0,x[4]=le*he*Be-ye*Ie,x[5]=he*he*Be+Ee,x[6]=ye*he*Be+le*Ie,x[7]=0,x[8]=le*ye*Be+he*Ie,x[9]=he*ye*Be-le*Ie,x[10]=ye*ye*Be+Ee,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x}e.fromRotation=j;function z(x,D,J){const le=J[0],he=J[1],ye=J[2];return x[0]=D[0]*le,x[1]=D[1]*le,x[2]=D[2]*le,x[3]=D[3]*le,x[4]=D[4]*he,x[5]=D[5]*he,x[6]=D[6]*he,x[7]=D[7]*he,x[8]=D[8]*ye,x[9]=D[9]*ye,x[10]=D[10]*ye,x[11]=D[11]*ye,x[12]=D[12],x[13]=D[13],x[14]=D[14],x[15]=D[15],x}e.scale=z;function W(x,D,J){return x[0]=D[0]*J,x[1]=D[1]*J,x[2]=D[2]*J,x[3]=D[3]*J,x[4]=D[4]*J,x[5]=D[5]*J,x[6]=D[6]*J,x[7]=D[7]*J,x[8]=D[8]*J,x[9]=D[9]*J,x[10]=D[10]*J,x[11]=D[11]*J,x[12]=D[12],x[13]=D[13],x[14]=D[14],x[15]=D[15],x}e.scaleUniformly=W;function se(x,D){return x[0]=D[0],x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=D[1],x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=D[2],x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x}e.fromScaling=se;function ue(x,D){return x[0]=D,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=D,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=D,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x}e.fromUniformScaling=ue;function $(x,D){return x[0]=D[0],x[1]=D[1],x[2]=D[2],x[4]=D[3],x[5]=D[4],x[6]=D[5],x[8]=D[6],x[9]=D[7],x[10]=D[8],x}e.fromMat3=$;function ne(x,D,J,le){const[he,ye,Se,Ie]=J,Ee=he+he,Be=ye+ye,we=Se+Se,Ue=he*Ee,Fe=he*Be,qe=he*we,He=ye*Be,Ve=ye*we,Xe=Se*we,ht=Ie*Ee,It=Ie*Be,ot=Ie*we,[nt,st,Ke]=le;return x[0]=(1-(He+Xe))*nt,x[1]=(Fe+ot)*nt,x[2]=(qe-It)*nt,x[3]=0,x[4]=(Fe-ot)*st,x[5]=(1-(Ue+Xe))*st,x[6]=(Ve+ht)*st,x[7]=0,x[8]=(qe+It)*Ke,x[9]=(Ve-ht)*Ke,x[10]=(1-(Ue+He))*Ke,x[11]=0,x[12]=D[0],x[13]=D[1],x[14]=D[2],x[15]=1,x}e.compose=ne;const de=[0,0,0],_e=t();function X(x,D,J,le){let he=O.magnitude(O.set(de,x[0],x[1],x[2]));const ye=O.magnitude(O.set(de,x[4],x[5],x[6])),Se=O.magnitude(O.set(de,x[8],x[9],x[10]));k(x)<0&&(he=-he),D[0]=x[12],D[1]=x[13],D[2]=x[14],m(_e,x);const Ee=1/he,Be=1/ye,we=1/Se;return _e[0]*=Ee,_e[1]*=Ee,_e[2]*=Ee,_e[4]*=Be,_e[5]*=Be,_e[6]*=Be,_e[8]*=we,_e[9]*=we,_e[10]*=we,v(J,_e),le[0]=he,le[1]=ye,le[2]=Se,x}e.decompose=X;function ce(x){let D="";for(let J=0;J<4;J++){for(let le=0;le<4;le++)D+=x[4*le+J].toString(),le<3&&(D+=" ");J<3&&(D+=`
`)}return D}e.makeTable=ce;function k(x){const D=x[0],J=x[1],le=x[2],he=x[3],ye=x[4],Se=x[5],Ie=x[6],Ee=x[7],Be=x[8],we=x[9],Ue=x[10],Fe=x[11],qe=x[12],He=x[13],Ve=x[14],Xe=x[15],ht=D*Se-J*ye,It=D*Ie-le*ye,ot=D*Ee-he*ye,nt=J*Ie-le*Se,st=J*Ee-he*Se,Ke=le*Ee-he*Ie,pt=Be*He-we*qe,_t=Be*Ve-Ue*qe,H=Be*Xe-Fe*qe,ee=we*Ve-Ue*He,ae=we*Xe-Fe*He,be=Ue*Xe-Fe*Ve;return ht*be-It*ae+ot*ee+nt*H-st*_t+Ke*pt}e.determinant=k;function B(x,D){return F(x,typeof D<"u"?D:Tt)}e.isRotationAndTranslation=B;function F(x,D){const J=x[0],le=x[1],he=x[2],ye=x[3],Se=x[4],Ie=x[5],Ee=x[6],Be=x[7],we=x[8],Ue=x[9],Fe=x[10],qe=x[11],He=x[15];if(!sn(He,1,D)||!sn(ye,0,D)||!sn(Be,0,D)||!sn(qe,0,D))return!1;const Ve=Math.abs(J*(Ie*Fe-Ee*Ue)-le*(Se*Fe-Ee*we)+he*(Se*Ue-Ie*we));return!!sn(Ve,1,D)}function re(x,D){return G(x,typeof D<"u"?D:Tt)}e.isTranslationAndUniformScaling=re;function G(x,D){const J=x[0];return sn(x[1],0,D)&&sn(x[2],0,D)&&sn(x[3],0,D)&&sn(x[4],0,D)&&sn(x[5],J,D)&&sn(x[6],0,D)&&sn(x[7],0,D)&&sn(x[8],0,D)&&sn(x[9],0,D)&&sn(x[10],J,D)&&sn(x[11],0,D)&&sn(x[15],1,D)}function V(x,D){const J=D[0],le=D[1],he=D[2],ye=D[3],Se=J+J,Ie=le+le,Ee=he+he,Be=J*Se,we=le*Se,Ue=le*Ie,Fe=he*Se,qe=he*Ie,He=he*Ee,Ve=ye*Se,Xe=ye*Ie,ht=ye*Ee;return x[0]=1-Ue-He,x[1]=we+ht,x[2]=Fe-Xe,x[3]=0,x[4]=we-ht,x[5]=1-Be-He,x[6]=qe+Ve,x[7]=0,x[8]=Fe+Xe,x[9]=qe-Ve,x[10]=1-Be-Ue,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x}e.fromQuat=V;function K(x,D,J){const le=D[0],he=D[1],ye=D[2],Se=Math.cos(le),Ie=Math.sin(le),Ee=Math.cos(he),Be=Math.sin(he),we=Math.cos(ye),Ue=Math.sin(ye);if(J==="XYZ"){const Fe=Se*we,qe=Se*Ue,He=Ie*we,Ve=Ie*Ue;x[0]=Ee*we,x[4]=-Ee*Ue,x[8]=Be,x[1]=qe+He*Be,x[5]=Fe-Ve*Be,x[9]=-Ie*Ee,x[2]=Ve-Fe*Be,x[6]=He+qe*Be,x[10]=Se*Ee}else if(J==="YXZ"){const Fe=Ee*we,qe=Ee*Ue,He=Be*we,Ve=Be*Ue;x[0]=Fe+Ve*Ie,x[4]=He*Ie-qe,x[8]=Se*Be,x[1]=Se*Ue,x[5]=Se*we,x[9]=-Ie,x[2]=qe*Ie-He,x[6]=Ve+Fe*Ie,x[10]=Se*Ee}else if(J==="ZXY"){const Fe=Ee*we,qe=Ee*Ue,He=Be*we,Ve=Be*Ue;x[0]=Fe-Ve*Ie,x[4]=-Se*Ue,x[8]=He+qe*Ie,x[1]=qe+He*Ie,x[5]=Se*we,x[9]=Ve-Fe*Ie,x[2]=-Se*Be,x[6]=Ie,x[10]=Se*Ee}else if(J==="ZYX"){const Fe=Se*we,qe=Se*Ue,He=Ie*we,Ve=Ie*Ue;x[0]=Ee*we,x[4]=He*Be-qe,x[8]=Fe*Be+Ve,x[1]=Ee*Ue,x[5]=Ve*Be+Fe,x[9]=qe*Be-He,x[2]=-Be,x[6]=Ie*Ee,x[10]=Se*Ee}else if(J==="YZX"){const Fe=Se*Ee,qe=Se*Be,He=Ie*Ee,Ve=Ie*Be;x[0]=Ee*we,x[4]=Ve-Fe*Ue,x[8]=He*Ue+qe,x[1]=Ue,x[5]=Se*we,x[9]=-Ie*we,x[2]=-Be*we,x[6]=qe*Ue+He,x[10]=Fe-Ve*Ue}else if(J==="XZY"){const Fe=Se*Ee,qe=Se*Be,He=Ie*Ee,Ve=Ie*Be;x[0]=Ee*we,x[4]=-Ue,x[8]=Be*we,x[1]=Fe*Ue+Ve,x[5]=Se*we,x[9]=qe*Ue-He,x[2]=He*Ue-qe,x[6]=Ie*we,x[10]=Ve*Ue+Fe}return x[3]=0,x[7]=0,x[11]=0,x[12]=0,x[13]=0,x[14]=0,x[15]=1,x}e.fromEuler=K;function Q(x,D,J,le,he,ye,Se){const Ie=2*ye/(J-D),Ee=2*ye/(le-he),Be=(J+D)/(J-D),we=(le+he)/(le-he),Ue=-(Se+ye)/(Se-ye),Fe=-2*Se*ye/(Se-ye);return x[0]=Ie,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=Ee,x[6]=0,x[7]=0,x[8]=Be,x[9]=we,x[10]=Ue,x[11]=-1,x[12]=0,x[13]=0,x[14]=Fe,x[15]=0,x}e.perspective=Q;function Z(x,D,J,le,he,ye,Se){const Ie=1/(J-D),Ee=1/(le-he),Be=1/(Se-ye),we=(J+D)*Ie,Ue=(le+he)*Ee,Fe=(Se+ye)*Be;return x[0]=2*Ie,x[1]=0,x[2]=0,x[3]=0,x[4]=0,x[5]=2*Ee,x[6]=0,x[7]=0,x[8]=0,x[9]=0,x[10]=-2*Be,x[11]=0,x[12]=-we,x[13]=-Ue,x[14]=-Fe,x[15]=1,x}e.ortho=Z;function ie(x,D,J,le){let he,ye,Se,Ie,Ee,Be,we,Ue,Fe,qe;const He=D[0],Ve=D[1],Xe=D[2],ht=le[0],It=le[1],ot=le[2],nt=J[0],st=J[1],Ke=J[2];return Math.abs(He-nt)<Tt&&Math.abs(Ve-st)<Tt&&Math.abs(Xe-Ke)<Tt?r(x):(we=He-nt,Ue=Ve-st,Fe=Xe-Ke,qe=1/Math.sqrt(we*we+Ue*Ue+Fe*Fe),we*=qe,Ue*=qe,Fe*=qe,he=It*Fe-ot*Ue,ye=ot*we-ht*Fe,Se=ht*Ue-It*we,qe=Math.sqrt(he*he+ye*ye+Se*Se),qe?(qe=1/qe,he*=qe,ye*=qe,Se*=qe):(he=0,ye=0,Se=0),Ie=Ue*Se-Fe*ye,Ee=Fe*he-we*Se,Be=we*ye-Ue*he,qe=Math.sqrt(Ie*Ie+Ee*Ee+Be*Be),qe?(qe=1/qe,Ie*=qe,Ee*=qe,Be*=qe):(Ie=0,Ee=0,Be=0),x[0]=he,x[1]=Ie,x[2]=we,x[3]=0,x[4]=ye,x[5]=Ee,x[6]=Ue,x[7]=0,x[8]=Se,x[9]=Be,x[10]=Fe,x[11]=0,x[12]=-(he*He+ye*Ve+Se*Xe),x[13]=-(Ie*He+Ee*Ve+Be*Xe),x[14]=-(we*He+Ue*Ve+Fe*Xe),x[15]=1,x)}e.lookAt=ie;function L(x,D,J,le){const he=D[0],ye=D[1],Se=D[2],Ie=le[0],Ee=le[1],Be=le[2];let we=he-J[0],Ue=ye-J[1],Fe=Se-J[2],qe=we*we+Ue*Ue+Fe*Fe;qe>0&&(qe=1/Math.sqrt(qe),we*=qe,Ue*=qe,Fe*=qe);let He=Ee*Fe-Be*Ue,Ve=Be*we-Ie*Fe,Xe=Ie*Ue-Ee*we;return qe=He*He+Ve*Ve+Xe*Xe,qe>0&&(qe=1/Math.sqrt(qe),He*=qe,Ve*=qe,Xe*=qe),x[0]=He,x[1]=Ve,x[2]=Xe,x[3]=0,x[4]=Ue*Xe-Fe*Ve,x[5]=Fe*He-we*Xe,x[6]=we*Ve-Ue*He,x[7]=0,x[8]=we,x[9]=Ue,x[10]=Fe,x[11]=0,x[12]=he,x[13]=ye,x[14]=Se,x[15]=1,x}e.targetTo=L;function U(x,D){i(x);for(let J=0;J<4;J++){const le=D[J];l(x,J,le,1)}return x}e.fromPermutation=U;function Y(x){const D=x[0]*x[0]+x[1]*x[1]+x[2]*x[2],J=x[4]*x[4]+x[5]*x[5]+x[6]*x[6],le=x[8]*x[8]+x[9]*x[9]+x[10]*x[10];return Math.sqrt(Math.max(D,J,le))}e.getMaxScaleOnAxis=Y;const fe=[1,0,0],me=[0,1,0],Te=[0,0,1];e.rotX90=j(t(),Er(90),fe),e.rotX180=j(t(),Er(180),fe),e.rotY90=j(t(),Er(90),me),e.rotY180=j(t(),Er(180),me),e.rotY270=j(t(),Er(270),me),e.rotZ90=j(t(),Er(90),Te),e.rotZ180=j(t(),Er(180),Te),e.rotXY90=S(t(),e.rotX90,e.rotY90),e.rotZY90=S(t(),e.rotZ90,e.rotY90),e.rotZYZ90=S(t(),e.rotZY90,e.rotZ90),e.rotZ90X180=S(t(),e.rotZ90,e.rotX180),e.rotY90Z180=S(t(),e.rotY90,e.rotZ180),e.id=n()})(Oe||(Oe={}));function Mn(){return Mn.zero()}(function(e){function t(){const k=[.1,0,0,0,0,0,0,0,0];return k[0]=0,k}e.zero=t;function n(){const k=t();return k[0]=1,k[1]=0,k[2]=0,k[3]=0,k[4]=1,k[5]=0,k[6]=0,k[7]=0,k[8]=1,k}e.identity=n;function r(k){return k[0]=1,k[1]=0,k[2]=0,k[3]=0,k[4]=1,k[5]=0,k[6]=0,k[7]=0,k[8]=1,k}e.setIdentity=r;function i(k,B,F){return B[F+0]=k[0],B[F+1]=k[1],B[F+2]=k[2],B[F+3]=k[3],B[F+4]=k[4],B[F+5]=k[5],B[F+6]=k[6],B[F+7]=k[7],B[F+8]=k[8],B}e.toArray=i;function o(k,B,F){return k[0]=B[F+0],k[1]=B[F+1],k[2]=B[F+2],k[3]=B[F+3],k[4]=B[F+4],k[5]=B[F+5],k[6]=B[F+6],k[7]=B[F+7],k[8]=B[F+8],k}e.fromArray=o;function s(k,B,F,re){return k[0]=B[0],k[1]=B[1],k[2]=B[2],k[3]=F[0],k[4]=F[1],k[5]=F[2],k[6]=re[0],k[7]=re[1],k[8]=re[2],k}e.fromColumns=s;function a(k,B){return k[0]=B[0],k[1]=B[1],k[2]=B[2],k[3]=B[4],k[4]=B[5],k[5]=B[6],k[6]=B[8],k[7]=B[9],k[8]=B[10],k}e.fromMat4=a;const c=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];function u(k,B,F){return Oe.fromEuler(c,B,F),a(k,c)}e.fromEuler=u;function l(k,B,F,re,G,V,K,Q,Z){const ie=t();return ie[0]=k,ie[1]=B,ie[2]=F,ie[3]=re,ie[4]=G,ie[5]=V,ie[6]=K,ie[7]=Q,ie[8]=Z,ie}e.create=l;const d=n();function f(k,B){return m(k,d,typeof B>"u"?Tt:B)}e.isIdentity=f;function h(k){for(let B=0;B<9;B++)if(isNaN(k[B]))return!0;return!1}e.hasNaN=h;function p(k){return b(t(),k)}e.clone=p;function m(k,B,F){for(let re=0;re<9;re++)if(Math.abs(k[re]-B[re])>F)return!1;return!0}e.areEqual=m;function y(k,B,F,re){k[3*F+B]=re}e.setValue=y;function g(k,B,F){return k[3*F+B]}e.getValue=g;function b(k,B){return k[0]=B[0],k[1]=B[1],k[2]=B[2],k[3]=B[3],k[4]=B[4],k[5]=B[5],k[6]=B[6],k[7]=B[7],k[8]=B[8],k}e.copy=b;function v(k,B){if(k===B){const F=B[1],re=B[2],G=B[5];k[1]=B[3],k[2]=B[6],k[3]=F,k[5]=B[7],k[6]=re,k[7]=G}else k[0]=B[0],k[1]=B[3],k[2]=B[6],k[3]=B[1],k[4]=B[4],k[5]=B[7],k[6]=B[2],k[7]=B[5],k[8]=B[8];return k}e.transpose=v;function _(k,B){const F=B[0],re=B[1],G=B[2],V=B[3],K=B[4],Q=B[5],Z=B[6],ie=B[7],L=B[8],U=L*K-Q*ie,Y=-L*V+Q*Z,fe=ie*V-K*Z;let me=F*U+re*Y+G*fe;return me?(me=1/me,k[0]=U*me,k[1]=(-L*re+G*ie)*me,k[2]=(Q*re-G*K)*me,k[3]=Y*me,k[4]=(L*F-G*Z)*me,k[5]=(-Q*F+G*V)*me,k[6]=fe*me,k[7]=(-ie*F+re*Z)*me,k[8]=(K*F-re*V)*me,k):(console.warn("non-invertible matrix.",B),k)}e.invert=_;function A(k,B){return k===B?(k[3]=B[1],k[6]=B[2],k[7]=B[5]):(k[0]=B[0],k[1]=B[1],k[2]=B[2],k[3]=B[1],k[4]=B[4],k[5]=B[5],k[6]=B[2],k[7]=B[5],k[8]=B[8]),k}e.symmtricFromUpper=A;function C(k,B){return k===B?(k[1]=B[3],k[2]=B[6],k[5]=B[7]):(k[0]=B[0],k[1]=B[3],k[2]=B[6],k[3]=B[3],k[4]=B[4],k[5]=B[7],k[6]=B[6],k[7]=B[7],k[8]=B[8]),k}e.symmtricFromLower=C;function I(k){const B=k[0],F=k[1],re=k[2],G=k[3],V=k[4],K=k[5],Q=k[6],Z=k[7],ie=k[8],L=ie*V-K*Z,U=-ie*G+K*Q,Y=Z*G-V*Q;return B*L+F*U+re*Y}e.determinant=I;function S(k){return k[0]+k[4]+k[8]}e.trace=S;function w(k,B,F){return k[0]=B[0]-F[0],k[1]=B[1]-F[1],k[2]=B[2]-F[2],k[3]=B[3]-F[3],k[4]=B[4]-F[4],k[5]=B[5]-F[5],k[6]=B[6]-F[6],k[7]=B[7]-F[7],k[8]=B[8]-F[8],k}e.sub=w;function R(k,B,F){return k[0]=B[0]+F[0],k[1]=B[1]+F[1],k[2]=B[2]+F[2],k[3]=B[3]+F[3],k[4]=B[4]+F[4],k[5]=B[5]+F[5],k[6]=B[6]+F[6],k[7]=B[7]+F[7],k[8]=B[8]+F[8],k}e.add=R;function M(k,B,F){const re=B[0],G=B[1],V=B[2],K=B[3],Q=B[4],Z=B[5],ie=B[6],L=B[7],U=B[8],Y=F[0],fe=F[1],me=F[2],Te=F[3],x=F[4],D=F[5],J=F[6],le=F[7],he=F[8];return k[0]=Y*re+fe*K+me*ie,k[1]=Y*G+fe*Q+me*L,k[2]=Y*V+fe*Z+me*U,k[3]=Te*re+x*K+D*ie,k[4]=Te*G+x*Q+D*L,k[5]=Te*V+x*Z+D*U,k[6]=J*re+le*K+he*ie,k[7]=J*G+le*Q+he*L,k[8]=J*V+le*Z+he*U,k}e.mul=M;function P(k,B,F){return k[0]=B[0]-F,k[1]=B[1]-F,k[2]=B[2]-F,k[3]=B[3]-F,k[4]=B[4]-F,k[5]=B[5]-F,k[6]=B[6]-F,k[7]=B[7]-F,k[8]=B[8]-F,k}e.subScalar=P;function E(k,B,F){return k[0]=B[0]+F,k[1]=B[1]+F,k[2]=B[2]+F,k[3]=B[3]+F,k[4]=B[4]+F,k[5]=B[5]+F,k[6]=B[6]+F,k[7]=B[7]+F,k[8]=B[8]+F,k}e.addScalar=E;function N(k,B,F){return k[0]=B[0]*F,k[1]=B[1]*F,k[2]=B[2]*F,k[3]=B[3]*F,k[4]=B[4]*F,k[5]=B[5]*F,k[6]=B[6]*F,k[7]=B[7]*F,k[8]=B[8]*F,k}e.mulScalar=N;const q=Math.PI/3,j=t();function z(k,B){const F=B[1]*B[1]+B[2]*B[2]+B[5]*B[5];if(F===0)k[0]=B[0],k[1]=B[4],k[2]=B[8];else{const re=S(B)/3,G=B[0]-re,V=B[4]-re,K=B[8]-re,Q=G*G+V*V+K*K+2*F,Z=Math.sqrt(Q/6);N(j,e.Identity,re),w(j,B,j),N(j,j,1/Z);const ie=I(j)/2,L=ie<=-1?q:ie>=1?0:Math.acos(ie)/3;k[0]=re+2*Z*Math.cos(L),k[2]=re+2*Z*Math.cos(L+2*q),k[1]=3*re-k[0]-k[2]}return k}e.symmetricEigenvalues=z;const W=[.1,0,0],se=[.1,0,0],ue=[.1,0,0],$=[.1,0,0],ne=[.1,0,0],de=[.1,0,0];function _e(k,B,F){O.set(W,B[0]-F,B[1],B[2]),O.set(se,B[1],B[4]-F,B[5]),O.set(ue,B[2],B[5],B[8]-F),O.cross($,W,se),O.cross(ne,W,ue),O.cross(de,se,ue);const re=O.dot($,$),G=O.dot(ne,ne),V=O.dot(de,de);let K=re,Q=0;return G>K&&(K=G,Q=1),V>K&&(Q=2),Q===0?O.scale(k,$,1/Math.sqrt(re)):Q===1?O.scale(k,ne,1/Math.sqrt(G)):O.scale(k,de,1/Math.sqrt(V)),k}e.eigenvector=_e;function X(k,B){return a(k,B),_(k,k),v(k,k),k}e.directionTransform=X,e.Identity=n();function ce(k,B){return k[0]*B[0]+k[1]*B[1]+k[2]*B[2]+k[3]*B[3]+k[4]*B[4]+k[5]*B[5]+k[6]*B[6]+k[7]*B[7]+k[8]*B[8]}e.innerProduct=ce})(Mn||(Mn={}));function os(){return os.zero()}(function(e){function t(){const S=[.1,0];return S[0]=0,S}e.zero=t;function n(S){const w=t();return w[0]=S[0],w[1]=S[1],w}e.clone=n;function r(S,w){const R=t();return R[0]=S,R[1]=w,R}e.create=r;function i(S){return isNaN(S[0])||isNaN(S[1])}e.hasNaN=i;function o(S,w,R){return w[R+0]=S[0],w[R+1]=S[1],w}e.toArray=o;function s(S,w,R){return S[0]=w[R+0],S[1]=w[R+1],S}e.fromArray=s;function a(S,w){return S[0]=w[0],S[1]=w[1],S}e.copy=a;function c(S,w,R){return S[0]=w,S[1]=R,S}e.set=c;function u(S,w,R){return S[0]=w[0]+R[0],S[1]=w[1]+R[1],S}e.add=u;function l(S,w,R){return S[0]=w[0]-R[0],S[1]=w[1]-R[1],S}e.sub=l;function d(S,w,R){return S[0]=w[0]*R[0],S[1]=w[1]*R[1],S}e.mul=d;function f(S,w,R){return S[0]=w[0]/R[0],S[1]=w[1]/R[1],S}e.div=f;function h(S,w,R){return S[0]=w[0]*R,S[1]=w[1]*R,S}e.scale=h;function p(S,w){return S[0]=Math.round(w[0]),S[1]=Math.round(w[1]),S}e.round=p;function m(S,w){return S[0]=Math.ceil(w[0]),S[1]=Math.ceil(w[1]),S}e.ceil=m;function y(S,w){return S[0]=Math.floor(w[0]),S[1]=Math.floor(w[1]),S}e.floor=y;function g(S,w){const R=w[0]-S[0],M=w[1]-S[1];return Math.sqrt(R*R+M*M)}e.distance=g;function b(S,w){const R=w[0]-S[0],M=w[1]-S[1];return R*R+M*M}e.squaredDistance=b;function v(S){const w=S[0],R=S[1];return Math.sqrt(w*w+R*R)}e.magnitude=v;function _(S){const w=S[0],R=S[1];return w*w+R*R}e.squaredMagnitude=_;function A(S,w){return S[0]=1/w[0],S[1]=1/w[1],S}e.inverse=A;function C(S,w){return S[0]===w[0]&&S[1]===w[1]}e.areEqual=C;function I(S,w){return`[${S[0].toPrecision(w)} ${S[1].toPrecision(w)}}]`}e.toString=I})(os||(os={}));function ol(){return ol.zero()}(function(e){function t(){const P=[.1,0,0,0];return P[0]=0,P}e.zero=t;function n(P){const E=t();return E[0]=P[0],E[1]=P[1],E[2]=P[2],E[3]=P[3],E}e.clone=n;function r(P,E,N,q){const j=t();return j[0]=P,j[1]=E,j[2]=N,j[3]=q,j}e.create=r;function i(P,E){return P[0]=E.center[0],P[1]=E.center[1],P[2]=E.center[2],P[3]=E.radius,P}e.fromSphere=i;function o(P){return i(t(),P)}e.ofSphere=o;function s(P){return isNaN(P[0])||isNaN(P[1])||isNaN(P[2])||isNaN(P[3])}e.hasNaN=s;function a(P,E,N){return E[N+0]=P[0],E[N+1]=P[1],E[N+2]=P[2],E[N+3]=P[3],E}e.toArray=a;function c(P,E,N){return P[0]=E[N+0],P[1]=E[N+1],P[2]=E[N+2],P[3]=E[N+3],P}e.fromArray=c;function u(P,E,N){E[N+0]=P[0],E[N+1]=P[1],E[N+2]=P[2]}e.toVec3Array=u;function l(P,E,N){return P[0]=E[N+0],P[1]=E[N+1],P[2]=E[N+2],P[3]=0,P}e.fromVec3Array=l;function d(P,E){return P[0]=E[0],P[1]=E[1],P[2]=E[2],P[3]=E[3],P}e.copy=d;function f(P,E,N,q,j){return P[0]=E,P[1]=N,P[2]=q,P[3]=j,P}e.set=f;function h(P,E,N){return P[0]=E[0]+N[0],P[1]=E[1]+N[1],P[2]=E[2]+N[2],P[3]=E[3]+N[3],P}e.add=h;function p(P,E){const N=E[0]-P[0],q=E[1]-P[1],j=E[2]-P[2],z=E[3]-P[3];return Math.sqrt(N*N+q*q+j*j+z*z)}e.distance=p;function m(P,E,N){return P[0]=E[0]*N,P[1]=E[1]*N,P[2]=E[2]*N,P[4]=E[4]*N,P}e.scale=m;function y(P,E){return P[0]=Math.round(E[0]),P[1]=Math.round(E[1]),P[2]=Math.round(E[2]),P[3]=Math.round(E[3]),P}e.round=y;function g(P,E){return P[0]=Math.ceil(E[0]),P[1]=Math.ceil(E[1]),P[2]=Math.ceil(E[2]),P[3]=Math.ceil(E[3]),P}e.ceil=g;function b(P,E){return P[0]=Math.floor(E[0]),P[1]=Math.floor(E[1]),P[2]=Math.floor(E[2]),P[3]=Math.floor(E[3]),P}e.floor=b;function v(P,E){const N=E[0]-P[0],q=E[1]-P[1],j=E[2]-P[2],z=E[3]-P[3];return N*N+q*q+j*j+z*z}e.squaredDistance=v;function _(P){const E=P[0],N=P[1],q=P[2],j=P[3];return Math.sqrt(E*E+N*N+q*q+j*j)}e.norm=_;function A(P){const E=P[0],N=P[1],q=P[2],j=P[3];return E*E+N*N+q*q+j*j}e.squaredNorm=A;function C(P,E,N){const q=E[0],j=E[1],z=E[2],W=E[3];return P[0]=N[0]*q+N[4]*j+N[8]*z+N[12]*W,P[1]=N[1]*q+N[5]*j+N[9]*z+N[13]*W,P[2]=N[2]*q+N[6]*j+N[10]*z+N[14]*W,P[3]=N[3]*q+N[7]*j+N[11]*z+N[15]*W,P}e.transformMat4=C;function I(P,E){return P[0]*E[0]+P[1]*E[1]+P[2]*E[2]+P[3]*E[3]}e.dot=I;function S(P,E){return P[0]=1/E[0],P[1]=1/E[1],P[2]=1/E[2],P[3]=1/E[3],P}e.inverse=S;function w(P,E){return P[0]===E[0]&&P[1]===E[1]&&P[2]===E[2]&&P[3]===E[3]}e.exactEquals=w;function R(P,E){const N=P[0],q=P[1],j=P[2],z=P[3],W=E[0],se=E[1],ue=E[2],$=E[3];return Math.abs(N-W)<=Tt*Math.max(1,Math.abs(N),Math.abs(W))&&Math.abs(q-se)<=Tt*Math.max(1,Math.abs(q),Math.abs(se))&&Math.abs(j-ue)<=Tt*Math.max(1,Math.abs(j),Math.abs(ue))&&Math.abs(z-$)<=Tt*Math.max(1,Math.abs(z),Math.abs($))}e.equals=R;function M(P,E){return`[${P[0].toPrecision(E)} ${P[1].toPrecision(E)} ${P[2].toPrecision(E)}  ${P[3].toPrecision(E)}]`}e.toString=M})(ol||(ol={}));function Ri(e){throw new Error("unreachable")}function Jn(){return Jn.zero()}(function(e){function t(){const B=[.1,0,0,0];return B[0]=0,B}e.zero=t;function n(){const B=t();return B[3]=1,B}e.identity=n;function r(B){B[0]=0,B[1]=0,B[2]=0,B[3]=1}e.setIdentity=r;function i(B){return isNaN(B[0])||isNaN(B[1])||isNaN(B[2])||isNaN(B[3])}e.hasNaN=i;function o(B,F,re,G){const V=n();return V[0]=B,V[1]=F,V[2]=re,V[3]=G,V}e.create=o;function s(B,F,re){re=re*.5;const G=Math.sin(re);return B[0]=G*F[0],B[1]=G*F[1],B[2]=G*F[2],B[3]=Math.cos(re),B}e.setAxisAngle=s;function a(B,F){const re=Math.acos(F[3])*2,G=Math.sin(re/2);return G!==0?(B[0]=F[0]/G,B[1]=F[1]/G,B[2]=F[2]/G):(B[0]=1,B[1]=0,B[2]=0),re}e.getAxisAngle=a;function c(B,F,re){const G=F[0],V=F[1],K=F[2],Q=F[3],Z=re[0],ie=re[1],L=re[2],U=re[3];return B[0]=G*U+Q*Z+V*L-K*ie,B[1]=V*U+Q*ie+K*Z-G*L,B[2]=K*U+Q*L+G*ie-V*Z,B[3]=Q*U-G*Z-V*ie-K*L,B}e.multiply=c;function u(B,F,re){re*=.5;const G=F[0],V=F[1],K=F[2],Q=F[3],Z=Math.sin(re),ie=Math.cos(re);return B[0]=G*ie+Q*Z,B[1]=V*ie+K*Z,B[2]=K*ie-V*Z,B[3]=Q*ie-G*Z,B}e.rotateX=u;function l(B,F,re){re*=.5;const G=F[0],V=F[1],K=F[2],Q=F[3],Z=Math.sin(re),ie=Math.cos(re);return B[0]=G*ie-K*Z,B[1]=V*ie+Q*Z,B[2]=K*ie+G*Z,B[3]=Q*ie-V*Z,B}e.rotateY=l;function d(B,F,re){re*=.5;const G=F[0],V=F[1],K=F[2],Q=F[3],Z=Math.sin(re),ie=Math.cos(re);return B[0]=G*ie+V*Z,B[1]=V*ie-G*Z,B[2]=K*ie+Q*Z,B[3]=Q*ie-K*Z,B}e.rotateZ=d;function f(B,F){const re=F[0],G=F[1],V=F[2];return B[0]=re,B[1]=G,B[2]=V,B[3]=Math.sqrt(Math.abs(1-re*re-G*G-V*V)),B}e.calculateW=f;function h(B,F,re,G){const V=F[0],K=F[1],Q=F[2],Z=F[3];let ie=re[0],L=re[1],U=re[2],Y=re[3],fe,me,Te,x,D;return me=V*ie+K*L+Q*U+Z*Y,me<0&&(me=-me,ie=-ie,L=-L,U=-U,Y=-Y),1-me>1e-6?(fe=Math.acos(me),Te=Math.sin(fe),x=Math.sin((1-G)*fe)/Te,D=Math.sin(G*fe)/Te):(x=1-G,D=G),B[0]=x*V+D*ie,B[1]=x*K+D*L,B[2]=x*Q+D*U,B[3]=x*Z+D*Y,B}e.slerp=h;function p(B,F){const re=F[0],G=F[1],V=F[2],K=F[3],Q=re*re+G*G+V*V+K*K,Z=Q?1/Q:0;return B[0]=-re*Z,B[1]=-G*Z,B[2]=-V*Z,B[3]=K*Z,B}e.invert=p;function m(B,F){return B[0]=-F[0],B[1]=-F[1],B[2]=-F[2],B[3]=F[3],B}e.conjugate=m;function y(B,F){return B[0]*F[0]+B[1]*F[1]+B[2]*F[2]+B[3]*F[3]}e.dot=y;function g(B,F){const re=F[0]+F[4]+F[8];let G;if(re>0)G=Math.sqrt(re+1),B[3]=.5*G,G=.5/G,B[0]=(F[5]-F[7])*G,B[1]=(F[6]-F[2])*G,B[2]=(F[1]-F[3])*G;else{let V=0;F[4]>F[0]&&(V=1),F[8]>F[V*3+V]&&(V=2);const K=(V+1)%3,Q=(V+2)%3;G=Math.sqrt(F[V*3+V]-F[K*3+K]-F[Q*3+Q]+1),B[V]=.5*G,G=.5/G,B[3]=(F[K*3+Q]-F[Q*3+K])*G,B[K]=(F[K*3+V]+F[V*3+K])*G,B[Q]=(F[Q*3+V]+F[V*3+Q])*G}return B}e.fromMat3=g;const b=[0,0,0,0,0,0,0,0,0,0,0,0];function v(B,F){return Mn.fromMat4(b,F),g(B,b)}e.fromMat4=v;function _(B,F,re){const[G,V,K]=F,Q=Math.cos(G/2),Z=Math.cos(V/2),ie=Math.cos(K/2),L=Math.sin(G/2),U=Math.sin(V/2),Y=Math.sin(K/2);switch(re){case"XYZ":B[0]=L*Z*ie+Q*U*Y,B[1]=Q*U*ie-L*Z*Y,B[2]=Q*Z*Y+L*U*ie,B[3]=Q*Z*ie-L*U*Y;break;case"YXZ":B[0]=L*Z*ie+Q*U*Y,B[1]=Q*U*ie-L*Z*Y,B[2]=Q*Z*Y-L*U*ie,B[3]=Q*Z*ie+L*U*Y;break;case"ZXY":B[0]=L*Z*ie-Q*U*Y,B[1]=Q*U*ie+L*Z*Y,B[2]=Q*Z*Y+L*U*ie,B[3]=Q*Z*ie-L*U*Y;break;case"ZYX":B[0]=L*Z*ie-Q*U*Y,B[1]=Q*U*ie+L*Z*Y,B[2]=Q*Z*Y-L*U*ie,B[3]=Q*Z*ie+L*U*Y;break;case"YZX":B[0]=L*Z*ie+Q*U*Y,B[1]=Q*U*ie+L*Z*Y,B[2]=Q*Z*Y-L*U*ie,B[3]=Q*Z*ie-L*U*Y;break;case"XZY":B[0]=L*Z*ie-Q*U*Y,B[1]=Q*U*ie-L*Z*Y,B[2]=Q*Z*Y+L*U*ie,B[3]=Q*Z*ie+L*U*Y;break;default:Ri()}return B}e.fromEuler=_;const A=[0,0,0];function C(B,F,re){let G=O.dot(F,re)+1;return G<Tt?(G=0,Math.abs(F[0])>Math.abs(F[2])?O.set(A,-F[1],F[0],0):O.set(A,0,-F[2],F[1])):O.cross(A,F,re),B[0]=A[0],B[1]=A[1],B[2]=A[2],B[3]=G,z(B,B),B}e.fromUnitVec3=C;const I=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];function S(B,F,re,G){return Oe.fromBasis(I,F,re,G),v(B,I)}e.fromBasis=S;function w(B){const F=t();return F[0]=B[0],F[1]=B[1],F[2]=B[2],F[3]=B[3],F}e.clone=w;function R(B,F,re){return F[re+0]=B[0],F[re+1]=B[1],F[re+2]=B[2],F[re+3]=B[3],F}e.toArray=R;function M(B,F,re){return B[0]=F[re+0],B[1]=F[re+1],B[2]=F[re+2],B[3]=F[re+3],B}e.fromArray=M;function P(B,F){return B[0]=F[0],B[1]=F[1],B[2]=F[2],B[3]=F[3],B}e.copy=P;function E(B,F,re,G,V){return B[0]=F,B[1]=re,B[2]=G,B[3]=V,B}e.set=E;function N(B,F){return B[0]===F[0]&&B[1]===F[1]&&B[2]===F[2]&&B[3]===F[3]}e.exactEquals=N;function q(B,F){const re=B[0],G=B[1],V=B[2],K=B[3],Q=F[0],Z=F[1],ie=F[2],L=F[3];return Math.abs(re-Q)<=Tt*Math.max(1,Math.abs(re),Math.abs(Q))&&Math.abs(G-Z)<=Tt*Math.max(1,Math.abs(G),Math.abs(Z))&&Math.abs(V-ie)<=Tt*Math.max(1,Math.abs(V),Math.abs(ie))&&Math.abs(K-L)<=Tt*Math.max(1,Math.abs(K),Math.abs(L))}e.equals=q;function j(B,F,re){return B[0]=F[0]+re[0],B[1]=F[1]+re[1],B[2]=F[2]+re[2],B[3]=F[3]+re[3],B}e.add=j;function z(B,F){const re=F[0],G=F[1],V=F[2],K=F[3];let Q=re*re+G*G+V*V+K*K;return Q>0&&(Q=1/Math.sqrt(Q),B[0]=re*Q,B[1]=G*Q,B[2]=V*Q,B[3]=K*Q),B}e.normalize=z;const W=[0,0,0],se=[1,0,0],ue=[0,1,0];function $(B,F,re){const G=O.dot(F,re);return G<-.999999?(O.cross(W,se,F),O.magnitude(W)<1e-6&&O.cross(W,ue,F),O.normalize(W,W),s(B,W,Math.PI),B):G>.999999?(B[0]=0,B[1]=0,B[2]=0,B[3]=1,B):(O.cross(W,F,re),B[0]=W[0],B[1]=W[1],B[2]=W[2],B[3]=1+G,z(B,B))}e.rotationTo=$;const ne=t(),de=t();function _e(B,F,re,G,V,K){return h(ne,F,V,K),h(de,re,G,K),h(B,ne,de,2*K*(1-K)),B}e.sqlerp=_e;const X=[0,0,0,0,0,0,0,0,0];function ce(B,F,re,G){return X[0]=re[0],X[3]=re[1],X[6]=re[2],X[1]=G[0],X[4]=G[1],X[7]=G[2],X[2]=-F[0],X[5]=-F[1],X[8]=-F[2],z(B,g(B,X))}e.setAxes=ce;function k(B,F){return`[${B[0].toPrecision(F)} ${B[1].toPrecision(F)} ${B[2].toPrecision(F)}  ${B[3].toPrecision(F)}]`}e.toString=k,e.Identity=n()})(Jn||(Jn={}));var er;(function(e){function t(A,C,I){const S=[];for(let R=0;R<C.length;R++)S[R]=C[C.length-R-1];const w=[1];for(let R=1;R<A.length;R++)w[R]=A[S[R-1]];return{dimensions:A,axisOrderFastToSlow:S,axisOrderSlowToFast:C,accessDimensions:w,defaultCtor:I||Float64Array}}function n(A,C){return{space:A,data:C}}e.create=n;function r(A,C,I){const S=t(A,C,I),{get:w,set:R,add:M,dataOffset:P,getCoords:E}=h(S);return{rank:A.length,dimensions:A,axisOrderSlowToFast:C,create:p(S),get:w,set:R,add:M,dataOffset:P,getCoords:E}}e.Space=r;function i(A){return A}e.Data1=i;function o(A,C){return r([A],[0],C)}e.Vector=o;function s(A,C,I){return r([A,C],[1,0],I)}e.ColumnMajorMatrix=s;function a(A,C,I){return r([A,C],[0,1],I)}e.RowMajorMatrix=a;function c(A,C,I){if(C.rank!==2)throw new Error("Invalid tensor rank");const S=Math.min(4,C.dimensions[0]),w=Math.min(4,C.dimensions[1]);for(let R=0;R<S;R++)for(let M=0;M<w;M++)Oe.setValue(A,R,M,C.get(I,R,M));return A}e.toMat4=c;function u(A,C,I){if(C.rank!==2)throw new Error("Invalid tensor rank");const S=Math.min(3,C.dimensions[0]),w=Math.min(3,C.dimensions[1]);for(let R=0;R<S;R++)for(let M=0;M<w;M++)Mn.setValue(A,R,M,C.get(I,R,M));return A}e.toMat3=u;function l(A,C,I){if(C.rank!==1)throw new Error("Invalid tensor rank");const S=Math.min(3,C.dimensions[0]);for(let w=0;w<S;w++)A[w]=I[w];return A}e.toVec3=l;function d(A,C,I){if(C.rank!==1)throw new Error("Invalid tensor rank");const S=Math.min(4,C.dimensions[0]);for(let w=0;w<S;w++)A[w]=I[w];return A}e.toVec4=d;function f(A,C){const I=A.length;if(I!==C.length)return!1;for(let S=0;S<I;S++)if(A[S]!==C[S])return!1;return!0}e.areEqualExact=f;function h(A){const{dimensions:C,axisOrderFastToSlow:I}=A;switch(C.length){case 1:return{get:(S,w)=>S[w],set:(S,w,R)=>S[w]=R,add:(S,w,R)=>S[w]+=R,dataOffset:S=>S,getCoords:(S,w)=>(w[0]=S,w)};case 2:{if(I[0]===0&&I[1]===1){const S=C[0];return{get:(w,R,M)=>w[M*S+R],set:(w,R,M,P)=>w[M*S+R]=P,add:(w,R,M,P)=>w[M*S+R]+=P,dataOffset:(w,R)=>R*S+w,getCoords:(w,R)=>(R[0]=w%S,R[1]=Math.floor(w/S),R)}}if(I[0]===1&&I[1]===0){const S=C[1];return{get:(w,R,M)=>w[R*S+M],set:(w,R,M,P)=>w[R*S+M]=P,add:(w,R,M,P)=>w[R*S+M]+=P,dataOffset:(w,R)=>w*S+R,getCoords:(w,R)=>(R[0]=Math.floor(w/S),R[1]=w%S,R)}}throw new Error("bad axis order")}case 3:{if(I[0]===0&&I[1]===1&&I[2]===2){const S=C[0],w=C[1],R=S*w;return{get:(M,P,E,N)=>M[P+E*S+N*R],set:(M,P,E,N,q)=>M[P+E*S+N*R]=q,add:(M,P,E,N,q)=>M[P+E*S+N*R]+=q,dataOffset:(M,P,E)=>M+P*S+E*R,getCoords:(M,P)=>{const E=Math.floor(M/S);return P[0]=M%S,P[1]=E%w,P[2]=Math.floor(E/w),P}}}if(I[0]===0&&I[1]===2&&I[2]===1){const S=C[0],w=C[2],R=S*w;return{get:(M,P,E,N)=>M[P+N*S+E*R],set:(M,P,E,N,q)=>M[P+N*S+E*R]=q,add:(M,P,E,N,q)=>M[P+N*S+E*R]+=q,dataOffset:(M,P,E)=>M+E*S+P*R,getCoords:(M,P)=>{const E=Math.floor(M/S);return P[0]=M%S,P[1]=Math.floor(E/w),P[2]=E%w,P}}}if(I[0]===1&&I[1]===0&&I[2]===2){const S=C[1],w=C[0],R=S*w;return{get:(M,P,E,N)=>M[E+P*S+N*R],set:(M,P,E,N,q)=>M[E+P*S+N*R]=q,add:(M,P,E,N,q)=>M[E+P*S+N*R]+=q,dataOffset:(M,P,E)=>P+M*S+E*R,getCoords:(M,P)=>{const E=Math.floor(M/S);return P[0]=E%w,P[1]=M%S,P[2]=Math.floor(E/w),P}}}if(I[0]===1&&I[1]===2&&I[2]===0){const S=C[1],w=C[2],R=S*w;return{get:(M,P,E,N)=>M[E+N*S+P*R],set:(M,P,E,N,q)=>M[E+N*S+P*R]=q,add:(M,P,E,N,q)=>M[E+N*S+P*R]+=q,dataOffset:(M,P,E)=>P+E*S+M*R,getCoords:(M,P)=>{const E=Math.floor(M/S);return P[0]=Math.floor(E/w),P[1]=M%S,P[2]=E%w,P}}}if(I[0]===2&&I[1]===0&&I[2]===1){const S=C[2],w=C[0],R=S*w;return{get:(M,P,E,N)=>M[N+P*S+E*R],set:(M,P,E,N,q)=>M[N+P*S+E*R]=q,add:(M,P,E,N,q)=>M[N+P*S+E*R]+=q,dataOffset:(M,P,E)=>E+M*S+P*R,getCoords:(M,P)=>{const E=Math.floor(M/S);return P[0]=E%w,P[1]=Math.floor(E/w),P[2]=M%S,P}}}if(I[0]===2&&I[1]===1&&I[2]===0){const S=C[2],w=C[1],R=S*w;return{get:(M,P,E,N)=>M[N+E*S+P*R],set:(M,P,E,N,q)=>M[N+E*S+P*R]=q,add:(M,P,E,N,q)=>M[N+E*S+P*R]+=q,dataOffset:(M,P,E)=>E+P*S+M*R,getCoords:(M,P)=>{const E=Math.floor(M/S);return P[0]=Math.floor(E/w),P[1]=E%w,P[2]=M%S,P}}}throw new Error("bad axis order")}default:return{get:(S,...w)=>S[m(A,w)],set:(S,...w)=>S[m(A,w)]=w[w.length-1],add:(S,...w)=>S[m(A,w)]+=w[w.length-1],dataOffset:(...S)=>m(A,S),getCoords:(S,w)=>y(A,S,w)}}}function p(A){const{dimensions:C}=A;let I=1;for(let S=0,w=C.length;S<w;S++)I*=C[S];return S=>new(S||A.defaultCtor)(I)}function m(A,C){const{accessDimensions:I,axisOrderFastToSlow:S}=A,w=I.length-1;let R=I[w]*C[S[w]];for(let M=w-1;M>=0;M--)R=(R+C[S[M]])*I[M];return R}function y(A,C,I){const{dimensions:S,axisOrderFastToSlow:w}=A,R=S.length;let M=C;for(let P=0;P<R;P++){const E=S[w[P]];I[w[P]]=M%E,M=Math.floor(M/E)}return I[w[R+1]]=M,I}function g(A){const C=[];for(let I=0;I<A.length;I++)C[I]=A[A.length-I-1];return C}e.invertAxisOrder=g;function b(A,C){const I=[];for(let S=0;S<A.length;S++)I[S]=A[C[S]];return I}function v(A){const C=new Int32Array(A.length);for(let I=0;I<A.length;I++)C[A[I]]=I;return I=>b(I,C)}e.convertToCanonicalAxisIndicesFastToSlow=v;function _(A){const C=new Int32Array(A.length);for(let I=0;I<A.length;I++)C[A[A.length-I-1]]=I;return I=>b(I,C)}e.convertToCanonicalAxisIndicesSlowToFast=_})(er||(er={}));function Di(e,t,n){for(;t<n&&e.charCodeAt(t)===32;)t++;return Jr(e,t,n)}function Jr(e,t,n){let r=t,i=0,o=1;for(e.charCodeAt(r)===45?(o=-1,++r):e.charCodeAt(r)===43&&++r;r<n;r++){const s=e.charCodeAt(r)-48;if(s>9||s<0)return o*i|0;i=10*i+s|0}return o*i}function np(e,t,n,r){return t.charCodeAt(n)===43&&n++,e*Math.pow(10,Jr(t,n,r))}function uo(e,t,n){let r=t,i=1,o=0,s=0,a=1;for(e.charCodeAt(r)===45?(i=-1,++r):e.charCodeAt(r)===43&&++r;r<n;){let c=e.charCodeAt(r)-48;if(c>=0&&c<10)o=o*10+c,++r;else if(c===-2){for(++r;r<n;)if(c=e.charCodeAt(r)-48,c>=0&&c<10)s=10*s+c,a=10*a,++r;else return c===53||c===21?np(i*(o+s/a),e,r+1,n):i*(o+s/a);return i*(o+s/a)}else{if(c===53||c===21)return np(i*o,e,r+1,n);break}}return i*o}var Ce;(function(e){let t;(function(R){R.str={"@type":"str",T:"",valueType:"str"},R.ustr={"@type":"str",T:"",valueType:"str",transform:"uppercase"},R.lstr={"@type":"str",T:"",valueType:"str",transform:"lowercase"},R.int={"@type":"int",T:0,valueType:"int"},R.coord={"@type":"coord",T:0,valueType:"float"},R.float={"@type":"float",T:0,valueType:"float"};function M(se){var ue;return{"@type":"str",T:(ue=se==null?void 0:se.defaultValue)!==null&&ue!==void 0?ue:"",transform:se==null?void 0:se.transform,valueType:"str"}}R.Str=M;function P(se=0){return{"@type":"int",T:se,valueType:"int"}}R.Int=P;function E(se=0){return{"@type":"float",T:se,valueType:"float"}}R.Float=E;function N(se,ue=R.float){return{"@type":"tensor",T:se.create(),space:se,valueType:"tensor",baseType:ue}}R.Tensor=N;function q(se,ue=R.float){return N(er.Vector(se,ue["@type"]==="int"?Int32Array:Float64Array),ue)}R.Vector=q;function j(se,ue,$=R.float){return N(er.ColumnMajorMatrix(se,ue,$["@type"]==="int"?Int32Array:Float64Array),$)}R.Matrix=j;function z(se){return se}R.Aliased=z;function W(se,ue,$=[]){return{"@type":"list",T:$,separator:se,itemParse:ue,valueType:"list"}}R.List=W})(t=e.Schema||(e.Schema={}));function n(R){return!!R&&!!R.schema&&!!R.value}e.is=n,e.ValueKind={Present:0,NotPresent:1,Unknown:2};function r(R,M){return rp(M.T,R,M,1)}e.Undefined=r;function i(R,M,P){return rp(R,M,P,0)}e.ofConst=i;function o(R){return ss(R)}e.ofLambda=o;function s(R,M){return o({value:P=>P+R,rowCount:Math.max(M-R+1,0),schema:t.int})}e.range=s;function a(R){return hr(R)}e.ofArray=a;function c(R){return hr({array:R,schema:t.int})}e.ofIntArray=c;function u(R){return hr({array:R,schema:t.float})}e.ofFloatArray=u;function l(R){return hr({array:R,schema:t.str})}e.ofStringArray=l;function d(R){return hr({array:R,schema:t.Aliased(t.str)})}e.ofStringAliasArray=d;function f(R,M=","){return hr({array:R,schema:t.List(M,P=>P)})}e.ofStringListArray=f;function h(R){const{count:M,data:P,indices:E}=R;return ss({value:N=>Jr(P,E[2*N],E[2*N+1])||0,rowCount:M,schema:t.int})}e.ofIntTokens=h;function p(R){const{count:M,data:P,indices:E}=R;return ss({value:N=>uo(P,E[2*N],E[2*N+1])||0,rowCount:M,schema:t.float})}e.ofFloatTokens=p;function m(R){const{count:M,data:P,indices:E}=R;return ss({value:N=>{const q=P.substring(E[2*N],E[2*N+1]);return q==="."||q==="?"?"":q},rowCount:M,schema:t.str})}e.ofStringTokens=m;function y(R,M,P){return j3(R,M,P)}e.window=y;function g(R,M,P=!0){return $3(R,M,P)}e.view=g;function b(R){return G3(R)}e.createFirstIndexMap=b;function v(R){return H3(R)}e.createIndexer=v;function _(R,M,P){return Z3(R,M,P||Array)}e.mapToArray=_;function A(R,M){return X3(R,M)}e.areEqual=A;function C(R,M){return ev(R,M)}e.indicesOf=C;function I(R,M){return R.__array?R:R.isDefined?hr({array:R.toArray({array:M}),schema:R.schema,valueKind:R.valueKind}):r(R.rowCount,R.schema)}e.asArrayColumn=I;function S(R,M,P=0){if(!R.isDefined)return;const E=R.__array;if(E)for(let N=0,q=E.length;N<q;N++)M[P+N]=E[N];else for(let N=0,q=R.rowCount;N<q;N++)M[P+N]=R.value(N)}e.copyToArray=S;function w(R){for(let M=0,P=R.rowCount;M<P;M++)if(M!==R.value(M))return!1;return!0}e.isIdentity=w})(Ce||(Ce={}));function G3(e){const t=new Map;for(let n=0,r=e.rowCount;n<r;n++){const i=e.value(n);t.has(i)||t.set(e.value(n),n)}return t}function H3(e){const t=new Map;for(let n=0,r=e.rowCount;n<r;n++){const i=e.value(n);t.has(i)||t.set(e.value(n),n)}return n=>t.has(n)?t.get(n):-1}function rp(e,t,n,r){return{schema:n,__array:void 0,isDefined:r===0,rowCount:t,value:o=>e,valueKind:o=>r,toArray:o=>{const{array:s}=co(t,o);for(let a=0,c=s.length;a<c;a++)s[a]=e;return s},areValuesEqual:(o,s)=>!0}}function ss({value:e,valueKind:t,areValuesEqual:n,rowCount:r,schema:i}){return{schema:i,__array:void 0,isDefined:!0,rowCount:r,value:e,valueKind:t||(o=>0),toArray:o=>{const{array:s,start:a}=co(r,o);for(let c=0,u=s.length;c<u;c++)s[c]=e(c+a);return s},areValuesEqual:n||((o,s)=>e(o)===e(s))}}function hr({array:e,schema:t,valueKind:n}){const r=e.length,i=t.T,o=t.valueType==="str"?t.transform==="lowercase"?a=>{const c=e[a];return typeof c=="string"?c.toLowerCase():`${c??i}`.toLowerCase()}:t.transform==="uppercase"?a=>{const c=e[a];return typeof c=="string"?c.toUpperCase():`${c??i}`.toUpperCase()}:a=>{const c=e[a];return typeof c=="string"?c:`${c??i}`}:a=>e[a],s=el(e);return{schema:t,__array:e,isDefined:!0,rowCount:r,value:o,valueKind:n||(a=>0),toArray:t.valueType==="str"?t.transform==="lowercase"?a=>{const{start:c,end:u}=Bi(r,a),l=new(a&&typeof a.array<"u"?a.array:e.constructor)(u-c);for(let d=0,f=u-c;d<f;d++){const h=e[c+d];l[d]=typeof h=="string"?h.toLowerCase():`${h??i}`.toLowerCase()}return l}:t.transform==="uppercase"?a=>{const{start:c,end:u}=Bi(r,a),l=new(a&&typeof a.array<"u"?a.array:e.constructor)(u-c);for(let d=0,f=u-c;d<f;d++){const h=e[c+d];l[d]=typeof h=="string"?h.toUpperCase():`${h??i}`.toUpperCase()}return l}:a=>{const{start:c,end:u}=Bi(r,a),l=new(a&&typeof a.array<"u"?a.array:e.constructor)(u-c);for(let d=0,f=u-c;d<f;d++){const h=e[c+d];l[d]=typeof h=="string"?h:`${h??i}`}return l}:s?a=>is(e,a):a=>{const{start:c,end:u}=Bi(r,a);if(c===0&&u===e.length)return e;const l=new(a&&typeof a.array<"u"?a.array:e.constructor)(u-c);for(let d=0,f=u-c;d<f;d++)l[d]=e[c+d];return l},areValuesEqual:(a,c)=>e[a]===e[c]}}function j3(e,t,n){return e.isDefined?t===0&&n===e.rowCount?e:e.__array&&el(e.__array)?z3(e,t,n):V3(e,t,n):Ce.Undefined(n-t,e.schema)}function z3(e,t,n){const r=is(e.__array,{start:t,end:n}),i=e.valueKind;return hr({array:r,schema:e.schema,valueKind:o=>i(t+o)})}function V3(e,t,n){const r=e.value,i=e.valueKind,o=e.areValuesEqual,s=t===0?r:c=>r(c+t),a=n-t;return{schema:e.schema,__array:void 0,isDefined:e.isDefined,rowCount:a,value:s,valueKind:t===0?i:c=>i(c+t),toArray:c=>{const{array:u}=co(a,c);for(let l=0,d=u.length;l<d;l++)u[l]=r(l+t);return u},areValuesEqual:t===0?o:(c,u)=>o(c+t,u+t)}}function K3(e,t){if(e.length!==t)return!1;for(let n=0,r=e.length;n<r;n++)if(e[n]!==n)return!1;return!0}function $3(e,t,n){return e.rowCount===0||n&&K3(t,e.rowCount)?e:e.__array&&typeof e.value(0)==typeof e.__array[0]?Y3(e,t):W3(e,t)}function Y3(e,t){const n=e.__array,r=new n.constructor(t.length);for(let o=0,s=t.length;o<s;o++)r[o]=n[t[o]];const i=e.valueKind;return hr({array:r,schema:e.schema,valueKind:o=>i(t[o])})}function W3(e,t){const n=e.value,r=e.valueKind,i=e.areValuesEqual,o=a=>n(t[a]),s=t.length;return{schema:e.schema,__array:void 0,isDefined:e.isDefined,rowCount:s,value:o,valueKind:a=>r(t[a]),toArray:a=>{const{array:c}=co(s,a);for(let u=0,l=c.length;u<l;u++)c[u]=n(t[u]);return c},areValuesEqual:(a,c)=>i(t[a],t[c])}}function Z3(e,t,n){const r=new n(e.rowCount);for(let i=0,o=e.rowCount;i<o;i++)r[i]=t(e.value(i));return r}function X3(e,t){return e===t?!0:e.rowCount!==t.rowCount||e.isDefined!==t.isDefined||e.schema.valueType!==t.schema.valueType?!1:e.__array&&t.__array?Q3(e,t):J3(e,t)}function Q3(e,t){const n=e.__array,r=t.__array;for(let i=0,o=e.rowCount;i<o;i++)if(n[i]!==r[i])return!1;return!0}function J3(e,t){const n=e.value,r=t.value;for(let i=0,o=e.rowCount;i<o;i++)if(n(i)!==r(i))return!1;return!0}function ev(e,t){const n=[],r=e.value;for(let i=0,o=e.rowCount;i<o;i++)t(r(i))&&(n[n.length]=i);return n}function as(e,t,n){return e[t]-e[n]}function ei(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function ip(e,t,n,r){const i=n+r>>1;return t(e,n,r)>0?t(e,n,i)>0?t(e,i,r)>0?i:r:n:t(e,r,i)>0?t(e,i,n)>0?i:n:r}function tv(e,t,n){const{cmp:r,swap:i,data:o,parts:s}=e;let a=t+1,c=n;for(i(o,t,ip(o,r,t,n));r(o,c,t)>0;)--c;for(let u=t+1;u<=c;u++){const l=r(o,u,t);if(l>0){for(i(o,u,c),--c;r(o,c,t)>0;)--c;u--}else l===0&&(i(o,u,a),a++)}for(let u=t;u<a;u++)i(o,u,t+c-u);s[0]=c-a+t+1,s[1]=c}function nv({data:e,cmp:t,swap:n},r,i){for(let o=r+1;o<=i;o++){let s=o-1;for(;s>=r&&t(e,s,s+1)>0;)n(e,s,s+1),s=s-1}}function cs(e,t,n){const{parts:r}=e;for(;t<n;){if(n-t<16){nv(e,t,n);return}tv(e,t,n);const i=r[0],o=r[1];i-t<n-o?(cs(e,t,i-1),t=o+1):(cs(e,o+1,n),n=i-1)}}function rv(e,t,n,r){let i=n+1,o=r;ei(e,n,ip(e,as,n,r));const s=e[n];for(;e[o]>s;)--o;for(let a=n+1;a<=o;a++){const c=e[a];if(c>s){for(ei(e,a,o),--o;e[o]>s;)--o;a--}else c===s&&(ei(e,a,i),++i)}for(let a=n;a<i;a++)ei(e,a,n+o-a);t[0]=o-i+n+1,t[1]=o}function iv(e,t,n){for(let r=t+1;r<=n;r++){const i=e[r];let o=r-1;for(;o>=t&&e[o]>i;)e[o+1]=e[o],o=o-1;e[o+1]=i}}function sl(e,t,n,r){for(;n<r;){if(r-n<16){iv(e,n,r);return}rv(e,t,n,r);const i=t[0],o=t[1];i-n<r-o?(sl(e,t,n,i-1),n=o+1):(sl(e,t,o+1,r),r=i-1)}}function mr(e,t=as){return ov(e,0,e.length,t)}function ov(e,t,n,r=as){return r===as?sl(e,[0,0],t,n-1):cs({data:e,cmp:r,swap:ei,parts:[0,0]},t,n-1),e}function op(e,t,n,r,i){return cs({data:e,cmp:r,swap:i,parts:[0,0]},t,n-1),e}var tr;(function(e){function t(i){return i}e.create=t;function n(i,o){return(i&o)!==0}e.has=n;function r(i,o){return!!o&&(i&o)===o}e.hasAll=r})(tr||(tr={}));var ft;(function(e){function t(_=512){return{current:[],offset:0,capacity:_,chunks:[]}}e.create=t;function n(_){return _.chunks.length?(_.offset>0&&(_.chunks[_.chunks.length]=_.current.length===_.offset?_.current.join(""):_.current.slice(0,_.offset).join("")),_.chunks.join("")):_.current.length===_.offset?_.current.join(""):_.current.splice(0,_.offset).join("")}e.getString=n;function r(_){let A=0;for(const C of _.chunks)A+=C.length;for(let C=0;C<_.offset;C++)A+=_.current[C].length;return A}e.getSize=r;function i(_){return _.offset>0&&(_.current.length===_.offset?_.chunks[_.chunks.length]=_.current.join(""):_.chunks[_.chunks.length]=_.current.slice(0,_.offset).join(""),_.offset=0),_.chunks}e.getChunks=i;const o=[];(function(){let _="";for(let A=0;A<512;A++)o[A]=_,_=_+" "})();function s(_){l(_,`
`)}e.newline=s;function a(_,A){A>0&&l(_,o[A])}e.whitespace=a;function c(_){l(_," ")}e.whitespace1=c;function u(_,A){A&&(_.offset===_.capacity&&(_.chunks[_.chunks.length]=_.current.join(""),_.offset=0),_.current[_.offset++]=A)}e.write=u;function l(_,A){_.offset===_.capacity&&(_.chunks[_.chunks.length]=_.current.join(""),_.offset=0),_.current[_.offset++]=A}e.writeSafe=l;function d(_,A,C){if(!A){a(_,C);return}const I=C-A.length;a(_,I),l(_,A)}e.writePadLeft=d;function f(_,A,C){if(!A){a(_,C);return}const I=C-A.length;l(_,A),a(_,I)}e.writePadRight=f;function h(_,A){l(_,""+A)}e.writeInteger=h;function p(_,A){l(_,""+A+" ")}e.writeIntegerAndSpace=p;function m(_,A,C){const I=""+A,S=C-I.length;a(_,S),l(_,I)}e.writeIntegerPadLeft=m;function y(_,A,C){const I=""+A,S=C-I.length;l(_,I),a(_,S)}e.writeIntegerPadRight=y;function g(_,A,C){l(_,""+Math.round(C*A)/C)}e.writeFloat=g;function b(_,A,C,I){const S=""+Math.round(C*A)/C,w=I-S.length;a(_,w),l(_,S)}e.writeFloatPadLeft=b;function v(_,A,C,I){const S=""+Math.round(C*A)/C,w=I-S.length;l(_,S),a(_,w)}e.writeFloatPadRight=v})(ft||(ft={}));const Tn=function(){if(typeof window<"u"&&window.performance){const e=window.performance;return()=>e.now()}else return typeof process<"u"&&process.hrtime!=="undefined"&&typeof process.hrtime=="function"?()=>{const e=process.hrtime();return e[0]*1e3+e[1]/1e6}:Date.now?()=>Date.now():()=>+new Date}();var ln;(function(e){const t=typeof btoa<"u"?btoa:s=>Buffer.from(s).toString("base64"),n=[];function r(){let s=+new Date+Tn();for(let a=0;a<16;a++)n[a]=String.fromCharCode((s+Math.random()*255)%255|0),s=Math.floor(s/255);return t(n.join("")).replace(/\+/g,"-").replace(/\//g,"_").substr(0,22)}e.create22=r;function i(){let s=+new Date+Tn();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){const u=(s+Math.random()*16)%16|0;return s=Math.floor(s/16),(c==="x"?u:u&3|8).toString(16)})}e.createv4=i;function o(s){return typeof s=="string"}e.is=o})(ln||(ln={}));function sv(e,t){return e-t}function av(e){return Array.prototype.sort.call(e,sv),e}var sp;(function(e){class t{has(p){return!1}forEach(p,m){return m}constructor(){this.size=0}}class n{has(p){return p===this.idx}forEach(p,m){return p(this.idx,m),m}constructor(p){this.idx=p,this.size=1}}class r{has(p){return p<this.length&&!!this.mask[p]}_forEach(p,m){for(let y=0;y<this.length;y++)this.mask[y]&&p(y,m)}forEach(p,m){return this._forEach(p,m),m}constructor(p,m){this.mask=p,this.size=m,this.length=p.length}}class i{has(p){return!0}_forEach(p,m){for(let y=0;y<this.size;y++)p(y,m)}forEach(p,m){return this._forEach(p,m),m}constructor(p){this.size=p}}class o{has(p){return this.set.has(p)}_forEach(p,m){for(const y of this.flatten())p(y,m)}flatten(){if(this._flat)return this._flat;const p=new Int32Array(this.size);let m=0;return this.set.forEach(y=>p[m++]=y),av(p),this._flat=p,this._flat}forEach(p,m){return this._forEach(p,m),m}constructor(p){this.set=p,this._flat=void 0,this.size=p.size}}function s(h){return new i(h)}e.always=s,e.never=new t;function a(h){return new o(h)}e.ofSet=a;function c(h){return new n(h)}e.singleton=c;function u(h){const p=h.length;if(p===0)return new t;if(p===1)return new n(h[0]);let m=0;for(const b of h)b>m&&(m=b);if(p===m)return new i(p);if(p/m<1/12){const b=new Set;for(const v of h)b.add(v);return new o(b)}const g=new Int8Array(m+1);for(const b of h)g[b]=1;return new r(g,h.length)}e.ofUniqueIndices=u;function l(h,p){return new r(h,p)}e.ofMask=l;function d(h,p){for(const m of p)if(h.has(m))return!0;return!1}e.hasAny=d;function f(h,p){let m=0,y=0;if(p.forEach(g=>{h.has(g)||(m++,g>y&&(y=g))}),m/y<1/12){const g=new Set;return p.forEach(b=>{h.has(b)||g.add(b)}),a(g)}else{const g=new Uint8Array(y+1);return p.forEach(b=>{h.has(b)||(g[b]=1)}),l(g,m)}}e.complement=f})(sp||(sp={}));function al(e=0,t=Number.MAX_SAFE_INTEGER){let n=e;return()=>{const r=n;return n=(n+1)%t,r}}var lo;(function(e){function t(r){return{ref:r}}e.create=t;function n(r,i){return r.ref=i,r}e.set=n})(lo||(lo={}));const cv=al(0,2147483647);var Br;(function(e){function t(r,i){return{id:cv(),version:0,value:r,metadata:i}}e.create=t;function n(r,i){return{id:r.id,version:r.version+1,value:i,metadata:r.metadata}}e.withValue=n})(Br||(Br={}));var ap;(function(e){function t(o,s){return lo.create(Br.create(o,s))}e.create=t;function n(o,s){return lo.set(o,Br.withValue(o.ref,s))}e.update=n;function r(o,s){return lo.set(o,s)}e.set=r;function i(o,s){return o.ref.value!==s?n(o,s):o}e.updateIfChanged=i})(ap||(ap={}));function cl(e,t){const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}const uv=Object.prototype.hasOwnProperty;function lv(e,t){if(e===t)return!0;if(!e||!t)return!1;const n=Object.keys(e);if(Object.keys(t).length!==n.length)return!1;for(const r of n)if(!uv.call(e,r)||e[r]!==t[r])return!1;return!0}function cp(e,t){return e!==void 0?e:t}var At;(function(e){function t(_){return _&&typeof _._rowCount=="number"&&!!_._columns&&!!_._schema}e.is=t;function n(_,A,C={}){const I=Object.create(null),S=Object.keys(_);I._rowCount=A._rowCount,I._columns=S,I._schema=_;for(const w of S)if(A[w])I[w]=A[w];else if(C[w])I[w]=C[w];else throw Error(`Cannot find column '${w}'.`);return I}e.pickColumns=n;function r(_,A){const C=Object.keys(A);return{_rowCount:A[C[0]].rowCount,_columns:C,_schema:_,...A}}e.ofColumns=r;function i(_,A,C){const I=Object.create(null),S=Object.keys(_);I._rowCount=C,I._columns=S,I._schema=_;for(const w of S)w in A?I[w]=A[w]:I[w]=Ce.Undefined(C,_[w]);return I}e.ofPartialColumns=i;function o(_,A){const C=Object.create(null),I=Object.keys(_);C._rowCount=A,C._columns=I,C._schema=_;for(const S of I)C[S]=Ce.Undefined(A,_[S]);return C}e.ofUndefinedColumns=o;function s(_,A){const C=Object.create(null),I=A.length,S=Object.keys(_);C._rowCount=I,C._columns=S,C._schema=_;for(const w of S)C[w]=Ce.ofLambda({rowCount:I,schema:_[w],value:R=>A[R][w],valueKind:R=>typeof A[R][w]>"u"?1:0});return C}e.ofRows=s;function a(_,A){var C;const I=Object.create(null),S=Object.keys(_);I._rowCount=0,I._columns=S,I._schema=_;for(const w of S)typeof A[w]<"u"?(I[w]=Ce.ofArray({array:A[w],schema:_[w]}),I._rowCount=(C=A[w])===null||C===void 0?void 0:C.length):I[w]=Ce.Undefined(I._rowCount,_[w]);return I}e.ofArrays=a;function c(_,A,C){const I=Object.create(null),S=Object.keys(A);I._rowCount=C.length,I._columns=S,I._schema=A;for(const w of S)I[w]=Ce.view(_[w],C);return I}e.view=c;function u(_,A,C){const I=[];for(let S=0,w=_._rowCount;S<w;++S)C(S)&&I.push(S);return c(_,A,I)}e.pick=u;function l(_,A,C,I){if(C===0&&I===_._rowCount)return _;const S=Object.create(null),w=Object.keys(A);S._rowCount=I-C,S._columns=w,S._schema=A;for(const R of w)S[R]=Ce.window(_[R],C,I);return S}e.window=l;function d(_,A){const C=Object.create(null),I=Object.keys(A);C._rowCount=0;for(const R of _)C._rowCount+=R._rowCount;const S={};for(const R of I)S[R]=new Array(C._rowCount);C._columns=I,C._schema=A;let w=0;for(const R of _){for(const M of I)Ce.copyToArray(R[M],S[M],w);w+=R._rowCount}for(const R of I)C[R]=Ce.ofArray({array:S[R],schema:A[R]});return C}e.concat=d;function f(_,A,C){_[A]=Ce.asArrayColumn(_[A],C)}e.columnToArray=f;function h(_,A){const C=new Int32Array(_._rowCount);for(let w=0,R=C.length;w<R;w++)C[w]=w;mr(C,(w,R,M)=>A(R,M));let I=!0;for(let w=0,R=C.length;w<R;w++)if(C[w]!==w){I=!1;break}if(I)return _;const S=Object.create(null);S._rowCount=_._rowCount,S._columns=_._columns,S._schema=_._schema;for(const w of _._columns)S[w]=Ce.view(_[w],C,!1);return S}e.sort=h;function p(_,A){if(_._rowCount!==A._rowCount||_._columns.length!==A._columns.length)return!1;for(const C of _._columns)if(!A[C])return!1;for(const C of _._columns)if(!Ce.areEqual(_[C],A[C]))return!1;return!0}e.areEqual=p;function m(_,A){const C=Object.create(null),{_columns:I}=_;for(let S=0;S<I.length;S++){const w=I[S];C[w]=_[w].value(A)}return C}e.getRow=m;function y(_,A){for(let C=0,I=_._rowCount;C<I;++C)if(A(C))return m(_,C)}e.pickRow=y;function g(_){const A=[],{_rowCount:C}=_;for(let I=0;I<C;I++)A[I]=m(_,I);return A}e.getRows=g;function b(_){const A={},{_columns:C}=_;for(let I=0;I<C.length;I++){const S=C[I];A[S]=_[S].toArray()}return A}e.toArrays=b;function v(_){const A=ft.create(),{_columns:C,_rowCount:I}=_;let S=1;ft.write(A,"|");for(let w=0;w<C.length;w++)ft.write(A,C[w]),ft.write(A,"|"),S+=C[w].length+1;ft.newline(A),ft.write(A,new Array(S+1).join("-")),ft.newline(A);for(let w=0;w<I;w++){ft.write(A,"|");for(let R=0;R<C.length;R++){const M=_[C[R]];M.valueKind(w)===0?(ft.write(A,M.value(w)),ft.write(A,"|")):ft.write(A,".|")}ft.newline(A)}return ft.getString(A)}e.formatToString=v})(At||(At={}));var ul;(function(e){function t(r,i,o){const s=Object.keys(o),a=Object.create(null),c=[];a._name=r,a._tableNames=c,a._schema=i;for(const u of s)At.is(o[u])&&(a[u]=o[u],c[c.length]=u);return a}e.ofTables=t;function n(r){const i={};for(const o of r._tableNames)i[o]=At.getRows(r[o]);return i}e.getTablesAsRows=n})(ul||(ul={}));function fv(e){const{data:t,indices:n}=e;return function(r,i){const o=n[2*r],s=n[2*i],a=n[2*r+1]-o;if(a!==n[2*i+1]-s)return!1;for(let c=0;c<a;c++)if(t.charCodeAt(c+o)!==t.charCodeAt(c+s))return!1;return!0}}function dv(e){const{count:t,indices:n}=e;for(let r=0;r<t;++r)if(n[2*r]!==n[2*r+1])return!1;return!0}function up(e,t){return{name:t,blocks:e}}function ll(e,t,n,r=[]){return{categoryNames:e,header:n,categories:t,saveFrames:r,getField(i){const[o,s]=i.split(".");return t[o].getField(s||"")}}}function hv(e,t,n){return{categoryNames:e,header:n,categories:t}}function tn(e,t,n,r){return{rowCount:t,name:e,fieldNames:[...n],getField(i){return r[i]}}}(function(e){function t(i){return{rowCount:0,name:i,fieldNames:[],getField(o){}}}e.empty=t;function n(i,o){const s=Object.keys(o);return{rowCount:s.length>0?o[s[0]].rowCount:0,name:i,fieldNames:s,getField(a){return o[a]}}}e.ofFields=n;function r(i,o){const s={};for(const a of o._columns)s[a]=Ae.ofColumn(o[a]);return n(i,s)}e.ofTable=r})(tn||(tn={}));var Ae;(function(e){function t(a){return n([a])}e.ofString=t;function n(a){const c=a.length,u=h=>{const p=a[h];return!p||p==="."||p==="?"?"":p},l=h=>{const p=a[h];return Jr(p,0,p.length)||0},d=h=>{const p=a[h];return uo(p,0,p.length)||0};return{__array:void 0,binaryEncoding:void 0,isDefined:!0,rowCount:c,str:u,int:l,float:d,valueKind:h=>{const p=a[h],m=p.length;if(m>1)return 0;if(m===0)return 1;const y=p.charCodeAt(0);return y===46?1:y===63?2:0},areValuesEqual:(h,p)=>a[h]===a[p],toStringArray:h=>h?dn(c,u,h):a,toIntArray:h=>dn(c,l,h),toFloatArray:h=>dn(c,d,h)}}e.ofStrings=n;function r(a){const c=a.length,u=h=>""+a[h],l=h=>a[h],d=h=>0,f=h=>!h||h.array&&a instanceof h.array?a:dn(c,l,h);return{__array:void 0,binaryEncoding:void 0,isDefined:!0,rowCount:c,str:u,int:l,float:l,valueKind:d,areValuesEqual:(h,p)=>a[h]===a[p],toStringArray:h=>dn(c,u,h),toIntArray:f,toFloatArray:f}}e.ofNumbers=r;function i(a){const{data:c,indices:u,count:l}=a,d=m=>{const y=c.substring(u[2*m],u[2*m+1]);return y==="."||y==="?"?"":y},f=m=>Jr(c,u[2*m],u[2*m+1])||0,h=m=>uo(c,u[2*m],u[2*m+1])||0;return{__array:void 0,binaryEncoding:void 0,isDefined:!0,rowCount:l,str:d,int:f,float:h,valueKind:m=>{const y=u[2*m],g=u[2*m+1]-y;if(g>1)return 0;if(g===0)return 1;const b=c.charCodeAt(y);return b===46?1:b===63?2:0},areValuesEqual:fv(a),toStringArray:m=>dn(l,d,m),toIntArray:m=>dn(l,f,m),toFloatArray:m=>dn(l,h,m)}}e.ofTokens=i;function o(a){const{rowCount:c,valueKind:u,areValuesEqual:l,isDefined:d}=a;let f,h,p;switch(a.schema.valueType){case"float":case"int":f=y=>""+a.value(y),h=a.value,p=a.value;break;case"str":f=a.value,h=y=>{const g=a.value(y);return Jr(g,0,g.length)||0},p=y=>{const g=a.value(y);return uo(g,0,g.length)||0};break;case"list":const{separator:m}=a.schema;f=y=>a.value(y).join(m),h=y=>NaN,p=y=>NaN;break;default:throw new Error(`unsupported valueType '${a.schema.valueType}'`)}return{__array:void 0,binaryEncoding:void 0,isDefined:d,rowCount:c,str:f,int:h,float:p,valueKind:u,areValuesEqual:l,toStringArray:m=>dn(c,f,m),toIntArray:m=>dn(c,h,m),toFloatArray:m=>dn(c,p,m)}}e.ofColumn=o;function s(a,c){return o(Ce.Undefined(a,c))}e.ofUndefined=s})(Ae||(Ae={}));function mv(e,t,n,r){const i=n?0:1;switch(t){case 1:return r==="brackets"?o=>`${e}[${o+i}]`:o=>`${e}_${o+i}`;case 2:return r==="brackets"?(o,s)=>`${e}[${o+i}][${s+i}]`:(o,s)=>`${e}_${o+i}${s+i}`;case 3:return r==="brackets"?(o,s,a)=>`${e}[${o+i}][${s+i}][${a+i}]`:(o,s,a)=>`${e}_${o+i}${s+i}${a+i}`;default:throw new Error("Tensors with rank > 3 or rank 0 are currently not supported.")}}function pv(e,t,n,r){const i=t.create();if(t.rank===1){const o=t.dimensions[0];for(let s=0;s<o;s++){const a=e.getField(r(s));t.set(i,s,a?a.float(n):0)}}else if(t.rank===2){const o=t.dimensions[0],s=t.dimensions[1];for(let a=0;a<o;a++)for(let c=0;c<s;c++){const u=e.getField(r(a,c));t.set(i,a,c,u?u.float(n):0)}}else if(t.rank===3){const o=t.dimensions[0],s=t.dimensions[1],a=t.dimensions[2];for(let c=0;c<o;c++)for(let u=0;u<s;u++)for(let l=0;l<a;l++){const d=e.getField(r(c,u,l));t.set(i,c,u,l,d?d.float(n):0)}}else throw new Error("Tensors with rank > 3 or rank 0 are currently not supported.");return i}function _v(){const e=function(){const m=typeof window<"u"&&window,y=typeof self<"u"&&typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&self;return m||typeof global<"u"&&global||y}(),t={},n=typeof document<"u"?document:void 0;let r=1,i;function o(m,...y){typeof m!="function"&&(m=new Function(""+m));const g={callback:m,args:y};return t[r]=g,i(r),r++}function s(m){delete t[m]}function a(m){const y=m.callback,g=m.args;switch(g.length){case 0:y();break;case 1:y(g[0]);break;case 2:y(g[0],g[1]);break;case 3:y(g[0],g[1],g[2]);break;default:y.apply(void 0,g);break}}function c(m){const y=t[m];s(m),a(y)}function u(){i=function(m){process.nextTick(function(){c(m)})}}function l(){if(e&&e.postMessage&&!e.importScripts){let m=!0;const y=e.onmessage;return e.onmessage=function(){m=!1},e.postMessage("","*"),e.onmessage=y,m}}function d(){const m="setImmediate$"+Math.random()+"$",y=function(g){g.source===e&&typeof g.data=="string"&&g.data.indexOf(m)===0&&c(+g.data.slice(m.length))};window.addEventListener?window.addEventListener("message",y,!1):window.attachEvent("onmessage",y),i=function(g){window.postMessage(m+g,"*")}}function f(){const m=new MessageChannel;m.port1.onmessage=function(y){const g=y.data;c(g)},i=function(y){m.port2.postMessage(y)}}function h(){const m=n.documentElement;i=function(y){let g=n.createElement("script");g.onreadystatechange=function(){c(y),g.onreadystatechange=null,m.removeChild(g),g=null},m.appendChild(g)}}function p(){i=function(m){setTimeout(c,0,m)}}return typeof process<"u"&&{}.toString.call(process)==="[object process]"?u():l()?d():typeof MessageChannel<"u"?f():n&&"onreadystatechange"in n.createElement("script")?h():p(),{setImmediate:o,clearImmediate:s}}const fl=function(){return typeof setImmediate<"u"?typeof window<"u"?{setImmediate:(e,...t)=>window.setImmediate(e,...t),clearImmediate:e=>window.clearImmediate(e)}:{setImmediate,clearImmediate}:_v()}();function yv(e){fl.setImmediate(e)}const gv={setImmediate:fl.setImmediate,clearImmediate:fl.clearImmediate,immediatePromise(){return new Promise(yv)},delay(e,t=void 0){return new Promise(n=>setTimeout(n,e,t))}};var bv={};let vv=function(){try{return!0}catch{return!1}}(),xv=function(){try{const t=bv.DEBUG;return t==="*"||t==="molstar"}catch{return!1}}();var fo;(function(e){function t(i){}e.markStart=t;function n(i){}e.markEnd=n;function r(i){}e.measure=r})(fo||(fo={}));function Av(e,t,n=250){const r=Iv(e,t,n),i=new hl(r,r.root);return dl(e,i)}function Sv(e,t){return dl(t,e)}function Cv(e,t,n){return e.runChild(t,n)}function lp(e){return{taskId:e.id,taskName:e.name,message:"",startedTime:0,canAbort:!0,isIndeterminate:!0,current:0,max:0}}function Iv(e,t,n){const r={abortRequested:!1,treeAborted:!1,reason:""};return{updateRateMs:n,lastNotified:Tn(),observer:t,abortToken:r,taskId:e.id,root:{progress:lp(e),children:[]},tryAbort:wv(r)}}function wv(e){return t=>{e.abortRequested=!0,e.reason=t||e.reason}}function fp(e){return{progress:{...e.progress},children:e.children.map(fp)}}function dp(e){return e.progress.canAbort&&e.children.every(dp)}function Pv(e){return{root:fp(e.root),canAbort:dp(e.root),requestAbort:e.tryAbort}}async function dl(e,t){fo.markStart(e),t.node.progress.startedTime=Tn();try{const n=await e.f(t);return fo.markEnd(e),fo.measure(e),t.info.abortToken.abortRequested&&hp(t.info),n}catch(n){throw Zt.isAbort(n)&&(t.isAborted=!0,t.node.children.length>0&&await new Promise(r=>{t.onChildrenFinished=r}),e.onAbort&&e.onAbort()),n}}function hp(e){throw e.abortToken.treeAborted||(e.abortToken.treeAborted=!0,mp(e.root),pp(e,Tn())),Zt.Aborted(e.abortToken.reason)}function mp(e){const t=e.progress;t.isIndeterminate=!0,t.canAbort=!1,t.message="Aborting...";for(const n of e.children)mp(n)}function pp(e,t){e.lastNotified=t;const n=Pv(e);e.observer(n)}class hl{checkAborted(){this.info.abortToken.abortRequested&&(this.isAborted=!0,hp(this.info))}get shouldUpdate(){return this.checkAborted(),Tn()-this.lastUpdatedTime>this.info.updateRateMs}updateProgress(t){if(this.checkAborted(),!t)return;const n=this.node.progress;typeof t=="string"?(n.message=t,n.isIndeterminate=!0):(typeof t.canAbort<"u"&&(n.canAbort=t.canAbort),typeof t.message<"u"&&(n.message=t.message),typeof t.current<"u"&&(n.current=t.current),typeof t.max<"u"&&(n.max=t.max),n.isIndeterminate=typeof n.current>"u"||typeof n.max>"u",typeof t.isIndeterminate<"u"&&(n.isIndeterminate=t.isIndeterminate))}update(t,n){if(this.lastUpdatedTime=Tn(),this.updateProgress(t),!n)return pp(this.info,this.lastUpdatedTime),this.checkAborted(),gv.immediatePromise()}async runChild(t,n){this.updateProgress(n);const r={progress:lp(t),children:[]},i=this.node.children;i.push(r);const o=new hl(this.info,r);try{return await dl(t,o)}catch(s){if(Zt.isAbort(s)&&this.isAborted)return;throw s}finally{const s=i.indexOf(r);if(s>=0){for(let a=s,c=i.length-1;a<c;a++)i[a]=i[a+1];i.pop()}i.length===0&&this.onChildrenFinished&&this.onChildrenFinished()}}constructor(t,n){this.isSynchronous=!1,this.isExecuting=!0,this.lastUpdatedTime=0,this.onChildrenFinished=void 0,this.node=n,this.info=t}}class Ev{constructor(){this.shouldUpdate=!1,this.isSynchronous=!0}update(t,n){}}const us=new Ev;var Zt;(function(e){class t{run(f,h=250){return f?Av(this,f,h):this.f(us)}runAsChild(f,h){return f.isSynchronous?this.f(us):Cv(f,this,h)}runInContext(f){return f.isSynchronous?this.f(us):Sv(f,this)}constructor(f,h,p){this.name=f,this.f=h,this.onAbort=p,this.id=l()}}function n(d){const f=d;return!!d&&typeof f.id=="number"&&typeof f.name=="string"&&!!f.run}e.is=n;function r(d){return!!d&&!!d.isAborted}e.isAbort=r;function i(d){return{isAborted:!0,reason:d,toString(){return`Aborted${d?": "+d:""}`}}}e.Aborted=i;function o(d,f,h){return new t(d,f,h)}e.create=o;function s(d,f){return o(d,async h=>f)}e.constant=s;function a(){return o("",async d=>{})}e.empty=a;function c(d,f){return o(d,async h=>{throw new Error(f)})}e.fail=c;function u(d,f){return n(d)?f?d.runInContext(f):d.run():d}e.resolveInContext=u;const l=al(0,1073741823)})(Zt||(Zt={}));var _p;(function(e){e.Synchronous=us})(_p||(_p={}));var yp;(function(e){function t(r,i=""){const o=r.progress;if(!r.children.length)return o.isIndeterminate?`${i}${o.taskName}: ${o.message}`:`${i}${o.taskName}: [${o.current}/${o.max}] ${o.message}`;const s=i+"  |_ ",a=r.children.map(c=>t(c,s));return o.isIndeterminate?`${i}${o.taskName}: ${o.message}
${a.join(`
`)}`:`${i}${o.taskName}: [${o.current}/${o.max}] ${o.message}
${a.join(`
`)}`}function n(r){return t(r.root)}e.format=n})(yp||(yp={}));async function ml(e,t,n,r,i){let o=Math.max(t,0),s=0,a=0;if(e.isSynchronous)return r(Number.MAX_SAFE_INTEGER,n),n;let c=Tn(),u=0,l=0;for(;(u=r(o,n))>0;){s+=u;const d=Tn()-c;l+=d,a+=d,e.shouldUpdate&&(await i(e,n,s),o=Math.round(l*s/a)+1,c=Tn(),l=0)}return e.shouldUpdate&&await i(e,n,s),n}function zt(e){return{data:e,position:0,length:e.length,lineNumber:1,tokenStart:0,tokenEnd:0}}(function(e){function t(v){return v.data.substring(v.tokenStart,v.tokenEnd)}e.getTokenString=t;function n(v){v.position=0,v.lineNumber=1,v.tokenStart=0,v.tokenEnd=0}e.reset=n;function r(v){const{data:_}=v;for(;v.position<v.length;)switch(_.charCodeAt(v.position)){case 10:return v.tokenEnd=v.position,++v.position,++v.lineNumber,!0;case 13:return v.tokenEnd=v.position,++v.position,++v.lineNumber,_.charCodeAt(v.position)===10&&++v.position,!0;default:++v.position;break}return v.tokenEnd=v.position,v.tokenStart!==v.tokenEnd}e.eatLine=r;function i(v){v.tokenStart=v.position}e.markStart=i;function o(v){return v.tokenStart=v.position,r(v)}e.markLine=o;function s(v){return o(v),t(v)}e.readLine=s;function a(v){o(v);const _=v.position;return b(v,v.tokenStart,v.tokenEnd),v.position=_,t(v)}e.readLineTrim=a;function c(v,_,A){let C=0;for(let I=0;I<_;I++){if(!o(v))return C;at.addUnchecked(A,v.tokenStart,v.tokenEnd),C++}return C}function u(v,_){const A=at.create(v.data,_*2);return c(v,_,A),A}e.markLines=u;function l(v,_){const A=[];for(let C=0;C<_;C++)A.push(e.readLine(v));return A}e.readLines=l;async function d(v,_,A,C=1e5){const I=at.create(v.data,_*2);let S=0;return await ml(A,C,v,(w,R)=>{const M=Math.min(_-S,w);return c(R,M,I),S+=M,M},(w,R)=>w.update({message:"Parsing...",current:R.position,max:R.length})),I}e.readLinesAsync=d;function f(v){const _=e(v),A=at.create(_.data,Math.max(v.length/80,2));for(;o(_);)at.add(A,_.tokenStart,_.tokenEnd);return A}e.readAllLines=f;function h(v,_,A){let C=0;for(let I=0;I<_;I++){if(!o(v))return C;at.add(A,v.tokenStart,v.tokenEnd),C++}return C}async function p(v,_,A=1e5){const C=e(v),I=at.create(C.data,Math.max(v.length/80,2));return await ml(_,A,C,(S,w)=>(h(w,S,I),w.position<w.length?S:0),(S,w)=>S.update({message:"Parsing...",current:w.position,max:w.length})),I}e.readAllLinesAsync=p;function m(v){for(;v.position<v.length;)switch(v.data.charCodeAt(v.position)){case 9:case 10:case 13:case 32:v.tokenEnd=v.position;return;default:++v.position;break}v.tokenEnd=v.position}e.eatValue=m;function y(v){let _=-1;for(;v.position<v.length;){const A=v.data.charCodeAt(v.position);switch(A){case 9:case 32:_=A,++v.position;break;case 10:_!==13&&++v.lineNumber,_=A,++v.position;break;case 13:_=A,++v.position,++v.lineNumber;break;default:return _}}return _}e.skipWhitespace=y;function g(v){let _=-1;for(;v.position<v.length;){const A=v.data.charCodeAt(v.position);switch(A){case 9:case 32:_=A,++v.position;break;default:return _}}return _}e.skipStrictWhitespace=g;function b(v,_,A){const{data:C}=v;let I=_,S=A-1,w=C.charCodeAt(I);for(;(w===9||w===32)&&I<=S;)w=C.charCodeAt(++I);for(w=C.charCodeAt(S);(w===9||w===32)&&S>=I;)w=C.charCodeAt(--S);return v.tokenStart=I,v.tokenEnd=S+1,v.position=A,v}e.trim=b})(zt||(zt={}));var at;(function(e){function t(s){const a=new Uint32Array(1.61*s.indices.length|0);a.set(s.indices),s.indices=a,s.indicesLenMinus2=a.length-2|0}function n(s,a,c){const u=s;u.offset>u.indicesLenMinus2&&t(u),u.indices[u.offset++]=a,u.indices[u.offset++]=c,s.count++}e.add=n;function r(s,a){n(s,a.tokenStart,a.tokenEnd)}e.addToken=r;function i(s,a,c){s.indices[s.offset++]=a,s.indices[s.offset++]=c,s.count++}e.addUnchecked=i;function o(s,a){return a=Math.max(10,a),{data:s,indicesLenMinus2:a-2|0,count:0,offset:0,indices:new Uint32Array(a)}}e.create=o})(at||(at={}));var Rr;(function(e){function t(o,s=-1){return new r(o,s)}e.error=t;function n(o,s=[]){return new i(o,s)}e.success=n;class r{toString(){return this.line>=0?`[Line ${this.line}] ${this.message}`:this.message}constructor(s,a){this.message=s,this.line=a,this.isError=!0}}e.Error=r;class i{constructor(s,a){this.result=s,this.warnings=a,this.isError=!1}}e.Success=i})(Rr||(Rr={}));function gp(e){for(;e.position<e.length;)switch(e.data.charCodeAt(e.position)){case 9:case 10:case 13:case 32:e.tokenEnd=e.position;return;default:++e.position;break}e.tokenEnd=e.position}function Bv(e,t){let n,r;for(++e.position;e.position<e.length;)if(r=e.data.charCodeAt(e.position),r===t)switch(n=e.data.charCodeAt(e.position+1),n){case 9:case 10:case 13:case 32:e.tokenStart++,e.tokenEnd=e.position,e.isEscaped=!0,++e.position;return;default:if(n===void 0){e.tokenStart++,e.tokenEnd=e.position,e.isEscaped=!0,++e.position;return}++e.position;break}else{if(r===10||r===13){e.tokenEnd=e.position;return}++e.position}e.tokenEnd=e.position}function Rv(e){for(e.position+=3;e.position<e.length;){if(e.data.charCodeAt(e.position)===39&&bp(e)){e.tokenStart+=3,e.tokenEnd=e.position,e.isEscaped=!0,e.position+=3;return}++e.position}e.tokenEnd=e.position}function Dv(e){let t=59,n=e.position+1,r;for(;n<e.length;)if(r=e.data.charCodeAt(n),r===59&&(t===10||t===13)){for(e.position=n+1,e.tokenStart++,n--,r=e.data.charCodeAt(n);r===10||r===13;)n--,r=e.data.charCodeAt(n);e.tokenEnd=n+1,e.isEscaped=!0;return}else(r===13||r===10&&t!==13)&&e.lineNumber++,t=r,++n;return e.position=n,t}function Nv(e){for(;e.position<e.length;)switch(e.data.charCodeAt(e.position)){case 93:++e.position,e.tokenEnd=e.position,e.isImportGet=!1;return;default:++e.position;break}}function Mv(e){for(;e.position<e.length;){const t=e.data.charCodeAt(e.position);if(t===10||t===13)return;++e.position}}function Tv(e){let t=10;for(;e.position<e.length;){const n=e.data.charCodeAt(e.position);switch(n){case 9:case 32:t=n,++e.position;break;case 10:t!==13&&++e.lineNumber,t=n,++e.position;break;case 13:t=n,++e.position,++e.lineNumber;break;default:return t}}return t}function bp(e){return!(e.length-e.position<2||e.data.charCodeAt(e.position+1)!==39||e.data.charCodeAt(e.position+2)!==39)}function Ov(e){let t=e.data.charCodeAt(e.tokenStart);return!(t!==68&&t!==100||(t=e.data.charCodeAt(e.tokenStart+1),t!==65&&t!==97)||(t=e.data.charCodeAt(e.tokenStart+2),t!==84&&t!==116)||(t=e.data.charCodeAt(e.tokenStart+3),t!==65&&t!==97))}function kv(e){let t=e.data.charCodeAt(e.tokenStart);return!(t!==83&&t!==115||(t=e.data.charCodeAt(e.tokenStart+1),t!==65&&t!==97)||(t=e.data.charCodeAt(e.tokenStart+2),t!==86&&t!==118)||(t=e.data.charCodeAt(e.tokenStart+3),t!==69&&t!==101))}function qv(e){if(e.tokenEnd-e.tokenStart!==5)return!1;let t=e.data.charCodeAt(e.tokenStart);return!(t!==76&&t!==108||(t=e.data.charCodeAt(e.tokenStart+1),t!==79&&t!==111)||(t=e.data.charCodeAt(e.tokenStart+2),t!==79&&t!==111)||(t=e.data.charCodeAt(e.tokenStart+3),t!==80&&t!==112))}function Uv(e){return!(e.tokenEnd-e.tokenStart!==11||e.data.charCodeAt(e.tokenStart+1)!==105||e.data.charCodeAt(e.tokenStart+2)!==109||e.data.charCodeAt(e.tokenStart+3)!==112||e.data.charCodeAt(e.tokenStart+4)!==111||e.data.charCodeAt(e.tokenStart+5)!==114||e.data.charCodeAt(e.tokenStart+6)!==116||e.data.charCodeAt(e.tokenStart+7)!==46||e.data.charCodeAt(e.tokenStart+8)!==103||e.data.charCodeAt(e.tokenStart+9)!==101||e.data.charCodeAt(e.tokenStart+10)!==116)}function Fv(e,t,n){let r;const i=n-t,o=e.tokenStart-t,s=e.tokenEnd-e.tokenStart;if(s<i)return!1;for(r=t;r<n;++r)if(e.data.charCodeAt(r)!==e.data.charCodeAt(r+o))return!1;return i===s||e.data.charCodeAt(r+o)===46}function vp(e){let t;for(t=e.tokenStart;t<e.tokenEnd;++t)if(e.data.charCodeAt(t)===46)return t;return t}function xp(e,t){return e.data.substring(e.tokenStart,t)}function Lv(e){let t;for(t=e.tokenStart;t<e.tokenEnd;++t)if(e.data.charCodeAt(t)===46)return!1;return!0}function pl(e){return e.data.substring(e.tokenStart,e.tokenEnd)}function Ap(e){const t=Tv(e);if(e.position>=e.length){e.tokenType=6;return}e.tokenStart=e.position,e.tokenEnd=e.position,e.isEscaped=!1;const n=e.data.charCodeAt(e.position);switch(n){case 35:Mv(e),e.tokenType=5;break;case 39:if(bp(e)){Rv(e),e.tokenType=3;break}case 34:Bv(e,n),e.tokenType=3;break;case 59:t===10||t===13?Dv(e):gp(e),e.tokenType=3;break;default:e.isImportGet?Nv(e):gp(e),e.isEscaped?e.tokenType=3:e.data.charCodeAt(e.tokenStart)===95?(e.inSaveFrame&&Uv(e)&&(e.isImportGet=!0),e.tokenType=4):e.tokenEnd-e.tokenStart>=5&&e.data.charCodeAt(e.tokenStart+4)===95?Ov(e)?e.tokenType=0:kv(e)?e.tokenType=1:qv(e)?e.tokenType=2:e.tokenType=3:e.tokenType=3;break}}function Dr(e){for(Ap(e);e.tokenType===5;)Ap(e)}function Gv(e,t){return{data:e,length:e.length,position:0,tokenStart:0,tokenEnd:0,tokenType:6,lineNumber:1,isEscaped:!1,isImportGet:!1,inSaveFrame:!1,runtimeCtx:t}}function ls(){return{categoryNames:[],categoryData:Object.create(null)}}function _l(e,t){const n=Object.create(null);for(const r of e){const i=t[r];n[r]=tn(i.name,i.rowCount,i.fieldNames,i.fields)}return n}function Sp(e,t,n){return ll(e.categoryNames,_l(e.categoryNames,e.categoryData),t,n)}function Hv(e,t){return ll(e.categoryNames,_l(e.categoryNames,e.categoryData),t)}function yl(e,t,n,r,i){if(t in e.categoryData){const o=e.categoryData[t];o.fieldNames.push(...r),Object.assign(o.fields,i)}else e.categoryData[t]={name:t,rowCount:n,fieldNames:r,fields:i},e.categoryNames.push(t)}function jv(e,t){const n=e.tokenStart,r=vp(e),i=xp(e,r),o=Object.create(null),s=[];let a=!0;for(;a;){if(e.tokenType!==4||!Fv(e,n,r)){a=!1;break}const c=pl(e).substring(i.length+1);if(Dr(e),e.tokenType!==3)return{hasError:!0,errorLine:e.lineNumber,errorMessage:"Expected value."};o[c]=Ae.ofTokens({data:e.data,indices:[e.tokenStart,e.tokenEnd],count:1}),s[s.length]=c,Dr(e)}return yl(t,i.substr(1),1,s,o),{hasError:!1,errorLine:0,errorMessage:""}}function zv(e,t){const{tokenizer:n,tokens:r,fieldCount:i}=t;let o=t.tokenCount,s=0;for(;n.tokenType===3&&s<e;)at.add(r[o++%i],n.tokenStart,n.tokenEnd),Dr(n),s++;return t.tokenCount=o,s}function Vv(e,t){return e.update({message:"Parsing...",current:t.tokenizer.position,max:t.tokenizer.data.length})}async function Kv(e,t){const n=e.lineNumber;Dr(e);const r=xp(e,vp(e)),i=Lv(e),o=[];for(;e.tokenType===4;)o[o.length]=i?pl(e):pl(e).substring(r.length+1),Dr(e);const s=r==="_atom_site"?e.data.length/100|0:32,a=[],c=o.length;for(let d=0;d<c;d++)a[d]=at.create(e.data,s);const u={fieldCount:c,tokenCount:0,tokenizer:e,tokens:a};if(await ml(e.runtimeCtx,1e6,u,zv,Vv),u.tokenCount%c!==0)return{hasError:!0,errorLine:e.lineNumber,errorMessage:`The number of values for loop starting at line ${n} is not a multiple of the number of columns.`};const l=u.tokenCount/c|0;if(i)for(let d=0;d<c;d++){const f={"":Ae.ofTokens(a[d])};yl(t,o[d].substr(1),l,[""],f)}else{const d=Object.create(null);for(let f=0;f<c;f++)d[o[f]]=Ae.ofTokens(a[f]);yl(t,r.substr(1),l,o,d)}return{hasError:!1,errorLine:0,errorMessage:""}}function Ni(e,t){return Rr.error(t,e)}function $v(e){return Rr.success(e)}async function Yv(e,t){const n=[],r=Gv(e,t);let i="",o=ls(),s=[],a=ls();const c=hv(a.categoryNames,_l(a.categoryNames,a.categoryData),"");let u="";for(t.update({message:"Parsing...",current:0,max:e.length}),Dr(r);r.tokenType!==6;){const l=r.tokenType;if(l===0){if(r.inSaveFrame)return Ni(r.lineNumber,"Unexpected data block inside a save frame.");o.categoryNames.length>0&&n.push(Sp(o,i,s)),i=e.substring(r.tokenStart+5,r.tokenEnd),o=ls(),s=[],Dr(r)}else if(l===1){if(r.tokenEnd-r.tokenStart===5)a.categoryNames.length>0&&(s[s.length]=Hv(a,u)),r.inSaveFrame=!1;else{if(r.inSaveFrame)return Ni(r.lineNumber,"Save frames cannot be nested.");r.inSaveFrame=!0,u=e.substring(r.tokenStart+5,r.tokenEnd),a=ls()}Dr(r)}else if(l===2){const d=await Kv(r,r.inSaveFrame?a:o);if(d.hasError)return Ni(d.errorLine,d.errorMessage)}else if(l===4){const d=jv(r,r.inSaveFrame?a:o);if(d.hasError)return Ni(d.errorLine,d.errorMessage)}else return console.log(r.tokenType,zt.getTokenString(r)),Ni(r.lineNumber,"Unexpected token. Expected data_, loop_, or data name.")}return r.inSaveFrame?Ni(r.lineNumber,`Unfinished save frame (${c.header}).`):((o.categoryNames.length>0||s.length>0)&&n.push(Sp(o,i,s)),$v(up(n)))}function Cp(e){return Zt.create("Parse CIF",async t=>await Yv(e,t))}const Wv="0.3.0";var ct;(function(e){(function(r){r[r.Int8=1]="Int8",r[r.Int16=2]="Int16",r[r.Int32=3]="Int32",r[r.Uint8=4]="Uint8",r[r.Uint16=5]="Uint16",r[r.Uint32=6]="Uint32"})(e.IntDataType||(e.IntDataType={})),function(r){r[r.Float32=32]="Float32",r[r.Float64=33]="Float64"}(e.FloatDataType||(e.FloatDataType={}));function t(r){let i;return r instanceof Int8Array?i=e.IntDataType.Int8:r instanceof Int16Array?i=e.IntDataType.Int16:r instanceof Int32Array?i=e.IntDataType.Int32:r instanceof Uint8Array?i=e.IntDataType.Uint8:r instanceof Uint16Array?i=e.IntDataType.Uint16:r instanceof Uint32Array?i=e.IntDataType.Uint32:r instanceof Float32Array?i=e.FloatDataType.Float32:r instanceof Float64Array?i=e.FloatDataType.Float64:i=e.IntDataType.Int32,i}e.getDataType=t;function n(r){if(r instanceof Int8Array||r instanceof Int16Array||r instanceof Int32Array)return!0;for(let i=0,o=r.length;i<o;i++)if(i<0)return!1;return!0}e.isSignedIntegerDataType=n})(ct||(ct={}));const Zv=new Uint16Array(new Uint8Array([18,52]).buffer)[0]===13330;function Xv(e,t){const n=new ArrayBuffer(e.length),r=new Uint8Array(n);for(let i=0,o=e.length;i<o;i+=t)for(let s=0;s<t;s++)r[i+t-s-1]=e[i+s];return n}function fs(e){let t=e.data;for(let n=e.encoding.length-1;n>=0;n--)t=Qv(t,e.encoding[n]);return t}function Qv(e,t){switch(t.kind){case"ByteArray":switch(t.type){case ct.IntDataType.Uint8:return e;case ct.IntDataType.Int8:return Jv(e);case ct.IntDataType.Int16:return ex(e);case ct.IntDataType.Uint16:return tx(e);case ct.IntDataType.Int32:return nx(e);case ct.IntDataType.Uint32:return rx(e);case ct.FloatDataType.Float32:return ix(e);case ct.FloatDataType.Float64:return ox(e);default:Ri(t.type)}case"FixedPoint":return sx(e,t);case"IntervalQuantization":return ax(e,t);case"RunLength":return cx(e,t);case"Delta":return ux(e,t);case"IntegerPacking":return dx(e,t);case"StringArray":return hx(e,t)}}function Ip(e,t){switch(e){case ct.IntDataType.Int8:return new Int8Array(t);case ct.IntDataType.Int16:return new Int16Array(t);case ct.IntDataType.Int32:return new Int32Array(t);case ct.IntDataType.Uint8:return new Uint8Array(t);case ct.IntDataType.Uint16:return new Uint16Array(t);case ct.IntDataType.Uint32:return new Uint32Array(t);default:return new Int32Array(t)}}function wp(e,t){switch(e){case ct.FloatDataType.Float32:return new Float32Array(t);case ct.FloatDataType.Float64:return new Float64Array(t);default:return new Float64Array(t)}}function Jv(e){return new Int8Array(e.buffer,e.byteOffset)}function Mi(e,t,n){return Zv?new n(e.buffer):new n(Xv(e,t))}function ex(e){return Mi(e,2,Int16Array)}function tx(e){return Mi(e,2,Uint16Array)}function nx(e){return Mi(e,4,Int32Array)}function rx(e){return Mi(e,4,Uint32Array)}function ix(e){return Mi(e,4,Float32Array)}function ox(e){return Mi(e,8,Float64Array)}function sx(e,t){const n=e.length,r=wp(t.srcType,n),i=1/t.factor;for(let o=0;o<n;o++)r[o]=i*e[o];return r}function ax(e,t){const n=e.length,r=wp(t.srcType,n),i=(t.max-t.min)/(t.numSteps-1),o=t.min;for(let s=0;s<n;s++)r[s]=o+i*e[s];return r}function cx(e,t){const n=Ip(t.srcType,t.srcSize);let r=0;for(let i=0,o=e.length;i<o;i+=2){const s=e[i],a=e[i+1];for(let c=0;c<a;++c)n[r++]=s}return n}function ux(e,t){const n=e.length,r=Ip(t.srcType,n);if(!n)return e;r[0]=e[0]+(t.origin|0);for(let i=1;i<n;++i)r[i]=e[i]+r[i-1];return r}function lx(e,t){const n=t.byteCount===1?127:32767,r=-n-1,i=e.length,o=new Int32Array(t.srcSize);let s=0,a=0;for(;s<i;){let c=0,u=e[s];for(;u===n||u===r;)c+=u,s++,u=e[s];c+=u,o[a]=c,s++,a++}return o}function fx(e,t){const n=t.byteCount===1?255:65535,r=e.length,i=new Int32Array(t.srcSize);let o=0,s=0;for(;o<r;){let a=0,c=e[o];for(;c===n;)a+=c,o++,c=e[o];a+=c,i[s]=a,o++,s++}return i}function dx(e,t){return e.length===t.srcSize?e:t.isUnsigned?fx(e,t):lx(e,t)}function hx(e,t){const n=fs({encoding:t.offsetEncoding,data:t.offsets}),r=fs({encoding:t.dataEncoding,data:e}),i=t.stringData,o=new Array(n.length);o[0]="";for(let c=1,u=n.length;c<u;c++)o[c]=i.substring(n[c-1],n[c]);let s=0;const a=new Array(r.length);for(let c=0,u=r.length;c<u;c++)a[s++]=o[r[c]+1];return a}var Ti;(function(e){function t(f){return f.creator&&f.chunkSize}e.is=t;function n(f){const h=f.growBy*f.elementSize;f.currentSize=h,f.currentIndex=0,f.currentChunk=new f.ctor(h),f.allocatedSize+=h,f.chunks[f.chunks.length]=f.currentChunk}function r(f,h,p,m,y){f.currentIndex>=f.currentSize&&n(f);const g=f.currentChunk,b=f.currentIndex;return g[b]=h,g[b+1]=p,g[b+2]=m,g[b+3]=y,f.currentIndex+=4,f.elementCount++}e.add4=r;function i(f,h,p,m){f.currentIndex>=f.currentSize&&n(f);const y=f.currentChunk,g=f.currentIndex;return y[g]=h,y[g+1]=p,y[g+2]=m,f.currentIndex+=3,f.elementCount++}e.add3=i;function o(f,h,p){f.currentIndex>=f.currentSize&&n(f);const m=f.currentChunk,y=f.currentIndex;return m[y]=h,m[y+1]=p,f.currentIndex+=2,f.elementCount++}e.add2=o;function s(f,h){return f.currentIndex>=f.currentSize&&n(f),f.currentChunk[f.currentIndex]=h,f.currentIndex+=1,f.elementCount++}e.add=s;function a(f,h,p){for(let m=0;m<h;m++)f.currentIndex>=f.currentSize&&n(f),f.currentChunk[f.currentIndex++]=p,f.elementCount++;return f.elementCount}e.addRepeat=a;function c(f,h){const{elementSize:p}=f;for(let m=0,y=h.length;m<y;m+=p){f.currentIndex>=f.currentSize&&n(f);const{currentChunk:g}=f;for(let b=0;b<p;b++)g[f.currentIndex++]=h[m+b];f.elementCount++}return f.elementCount}e.addMany=c;function u(f,h=!1){return l(f,h)}e.compact=u;function l(f,h){const{ctor:p,chunks:m,currentIndex:y}=f;if(!m.length)return new p(0);if(m.length===1&&(h||y===f.allocatedSize))return m[0];let g=0;for(let A=0,C=m.length-1;A<C;A++)g+=m[A].length;g+=f.currentIndex;const b=new p(g);let v=0;if(b.buffer)for(let A=0,C=m.length-1;A<C;A++)b.set(m[A],v),v+=m[A].length;else for(let A=0,C=m.length-1;A<C;A++){const I=m[A];for(let S=0,w=I.length;S<w;S++)b[v+S]=I[S];v+=I.length}const _=m[m.length-1];if(b.buffer&&y>=f.currentSize)b.set(_,v);else for(let A=0,C=_.length;A<C;A++)b[v+A]=_[A];return b}e._compact=l;function d(f,h,p,m){const y={ctor:f,elementSize:h,growBy:Math.max(1,Math.ceil(p)),allocatedSize:0,elementCount:0,currentSize:0,currentChunk:void 0,currentIndex:0,chunks:[]};if(typeof m>"u")return y;if(typeof m=="number")return y.currentChunk=new f(m*h),y.allocatedSize=m*h,y.currentSize=y.currentChunk.length,y.chunks[0]=y.currentChunk,y;const g=m;if(g.length%h!==0)throw new Error("initialChunk length must be a multiple of the element size.");return y.currentChunk=g,y.allocatedSize=g.length,y.currentSize=g.length,y.chunks[0]=g,y}e.create=d})(Ti||(Ti={}));function mx(e,t,n){return e[t].key<e[n].key?-1:1}function px(e,t,n,r,i){const o=new Map,s=[];let a=t(e[0]),c=!0;for(let h=r;h<i;h++){const p=t(e[h]);if(o.has(p))o.get(p).count++,a!==p&&(c=!1);else{const m={key:p,count:1,offset:h};o.set(p,m),s[s.length]=m}a=p}const u=new Int32Array(s.length+1);u[s.length]=i;let l=!0;if(n){for(let h=1,p=s.length;h<p;h++)if(s[h-1].key>s[h].key){l=!1;break}}if(c&&l){for(let h=0;h<s.length;h++)u[h]=s[h].offset;return u}n&&!l&&op(s,0,s.length,mx,ei);let d=0;for(let h=0;h<s.length;h++){const p=s[h];p.offset=d,d+=p.count}const f=new Int32Array(i-r);for(let h=r;h<i;h++){const p=t(e[h]),m=o.get(p);f[m.offset++]=e[h]}for(let h=0,p=f.length;h<p;h++)e[h+r]=f[h];u[0]=r;for(let h=1;h<s.length;h++)u[h]=s[h-1].offset+r;return u}function gl(e,t,n){const r=n&&n.start||0,i=n&&n.end||e.length;if(i-r<=0)throw new Error("Can only bucket non-empty collections.");return px(e,t,!!(n&&n.sort),r,i)}class _x{createGroup(t,n){const r=this.id++,i=[t];return this.groups[r]=i,{id:r,keys:i,value:n}}add(t,n){const r=this.getHash(n);if(this.byHash.has(r)){const i=this.byHash.get(r);for(let s=0,a=i.length;s<a;s++){const c=i[s];if(this.areEqual(n,c.value))return c.keys[c.keys.length]=t,c.value}const o=this.createGroup(t,n);return i[i.length]=o,o.value}else{const i=this.createGroup(t,n);return this.byHash.set(r,[i]),i.value}}constructor(t,n){this.getHash=t,this.areEqual=n,this.id=0,this.byHash=new Map,this.groups=[]}}function yx(e,t){return new _x(e,t)}function gx(e){let t=e^e>>4;return t=(t^3735928559)+(t<<5),t=t^t>>11,t}function ds(e,t){let n=23;return n=31*n+e|0,n=31*n+t|0,n=n^n>>4,n=(n^3735928559)+(n<<5),n=n^n>>11,n}function bx(e,t,n){let r=23;return r=31*r+e|0,r=31*r+t|0,r=31*r+n|0,r=r^r>>4,r=(r^3735928559)+(r<<5),r=r^r>>11,r}function vx(e,t,n,r){let i=23;return i=31*i+e|0,i=31*i+t|0,i=31*i+n|0,i=31*i+r|0,i=i^i>>4,i=(i^3735928559)+(i<<5),i=i^i>>11,i}function xx(e){let t=0;for(let n=0,r=e.length;n<r;n++)t=(t<<5)-t+e.charCodeAt(n)|0;return t}function Hn(e,t){return(e+t)*(e+t+1)/2+t}function ho(e,t){return e<t?Hn(e,t):Hn(t,e)}function Ax(e,t){const n=Math.floor((Math.sqrt(8*t+1)-1)/2),r=(n*n+n)/2,i=t-r;return e[0]=n-i,e[1]=i,e}function Oi(e){let t=2166136261;for(let n=0,r=e.length;n<r;++n)t^=e[n],t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}function Sx(e,t){for(let n=0,r=e.length;n<r;n++)if(t(e[n]))return e[n]}function Cx(e){if(Array.from)return Array.from(e);const t=[];for(;;){const{done:n,value:r}=e.next();if(n)break;t[t.length]=r}return t}function bl(e,t,n){const r=t-e+1,i=n?new n(r):new Int32Array(r);for(let o=0;o<r;o++)i[o]=o+e;return i}function Ix(e,t){const n=new(wx(e))(t.length);for(let r=0,i=t.length;r<i;r++)n[r]=e[t[r]];return n}function wx(e){const t=e.constructor;if(!t)throw new Error("data does not define a constructor and it should");return t}function Px(e,t,n){let r=1,i;for(i=0;i<t;i++){const o=r*e;if(Math.abs(Math.round(o)-o)<=n)return i;r*=10}return-1}function Ex(e,t,n){let r=1,i=0;for(let o=0,s=e.length;o<s;o++){if(r>=0){const c=Px(e[o],t,n);c<0?r=-1:c>r&&(r=c)}const a=Math.abs(e[o]);if(a>n){const c=Math.floor(Math.log10(Math.abs(a)))+1;c>i&&(i=c)}}return{mantissaDigits:r,integerDigits:i}}function vl(e){return mo.classify(e)}function Bx(e){return xl.classify(e)}var mo;(function(e){function t(h,p){return h>=0?Math.ceil((h+1)/p):Math.ceil((h+1)/(-p-1))}function n(h){let p=!1;for(let m=0,y=h.length;m<y;m++)if(h[m]<0){p=!0;break}return p?{signed:p,limit8:127,limit16:32767}:{signed:p,limit8:255,limit16:65535}}function r(){return{pack8:0,pack16:0,count:0}}function i({limit8:h,limit16:p},m,y){m.pack8+=t(y,h),m.pack16+=t(y,p),m.count+=1}function o(h,p){h.pack8+=t(p,127),h.pack16+=t(p,32767),h.count+=1}function s(h){return h.count*4<h.pack16*2?{length:h.count*4,elem:4}:h.pack16*2<h.pack8?{length:h.pack16*2,elem:2}:{length:h.pack8,elem:1}}function a(h,p){const m=r();for(let y=0,g=h.length;y<g;y++)i(p,m,h[y]);return{...s(m),kind:"pack"}}function c(h,p){const m=r();let y=h[0];for(let g=1,b=h.length;g<b;g++)o(m,h[g]-y),y=h[g];return{...s(m),kind:"delta"}}function u(h,p){const m=r();let y=1;for(let g=1,b=h.length;g<b;g++)h[g-1]!==h[g]?(i(p,m,h[g-1]),i(p,m,y),y=1):y++;return i(p,m,h[h.length-1]),i(p,m,y),{...s(m),kind:"rle"}}function l(h,p){const m=r();let y=1,g=0,b=0;for(let v=1,_=h.length;v<_;v++){const A=h[v]-g;b!==A?(o(m,b),o(m,y),y=1):y++,b=A,g=h[v]}return o(m,b),o(m,y),{...s(m),kind:"delta-rle"}}function d(h){const p=n(h),m=[a(h,p),u(h,p),c(h),l(h)];return m.sort((y,g)=>y.length-g.length),m}e.getSize=d;function f(h){if(h.length<2)return Qe.by(Qe.byteArray);switch(d(h)[0].kind){case"pack":return Qe.by(Qe.integerPacking);case"rle":return Qe.by(Qe.runLength).and(Qe.integerPacking);case"delta":return Qe.by(Qe.delta).and(Qe.integerPacking);case"delta-rle":return Qe.by(Qe.delta).and(Qe.runLength).and(Qe.integerPacking);default:Ri()}}e.classify=f})(mo||(mo={}));var xl;(function(e){function n(i){const{mantissaDigits:s,integerDigits:a}=Ex(i,4,1e-6);if(s<0||s+a>10)return Qe.by(Qe.byteArray);if(s===0)return mo.classify(i);const c=r(s),u=new Int32Array(i.length);for(let h=0,p=i.length;h<p;h++)u[h]=Math.round(c*i[h]);const d=mo.getSize(u)[0],f=Qe.by(Qe.fixedPoint(c));switch(d.kind){case"pack":return f.and(Qe.integerPacking);case"rle":return f.and(Qe.runLength).and(Qe.integerPacking);case"delta":return f.and(Qe.delta).and(Qe.integerPacking);case"delta-rle":return f.and(Qe.delta).and(Qe.runLength).and(Qe.integerPacking);default:Ri()}}e.classify=n;function r(i){let o=1;for(let s=0;s<i;s++)o*=10;return o}})(xl||(xl={}));class hs{and(t){return new hs(this.providers.concat([t]))}encode(t){const n=[];for(const r of this.providers){const i=r(t);if(!i.encodings.length)throw new Error("Encodings must be non-empty.");t=i.data;for(const o of i.encodings)n.push(o)}if(!(t instanceof Uint8Array))throw new Error("The encoding must result in a Uint8Array. Fix your encoding chain.");return{encoding:n,data:t}}constructor(t){this.providers=t}}var pr;(function(e){function t(i){return new hs([i])}e.by=t;function n(i){let o=t(r(i[0]));for(let s=1;s<i.length&&i[s-1].kind!=="IntegerPacking";s++)o=o.and(r(i[s]));return o}e.fromEncoding=n;function r(i){switch(i.kind){case"ByteArray":return Qe.byteArray;case"FixedPoint":return Qe.fixedPoint(i.factor);case"IntervalQuantization":return Qe.intervalQuantizaiton(i.min,i.max,i.numSteps);case"RunLength":return Qe.runLength;case"Delta":return Qe.delta;case"IntegerPacking":return Qe.integerPacking;case"StringArray":return Qe.stringArray}}})(pr||(pr={}));var Qe;(function(e){function t(_){return new hs([_])}e.by=t;function n(_){return{encodings:[{kind:"ByteArray",type:ct.IntDataType.Uint8}],data:_}}function r(_){return{encodings:[{kind:"ByteArray",type:ct.IntDataType.Int8}],data:new Uint8Array(_.buffer,_.byteOffset)}}const i={[ct.IntDataType.Int16]:function(_,A,C){_.setInt16(2*A,C,!0)},[ct.IntDataType.Uint16]:function(_,A,C){_.setUint16(2*A,C,!0)},[ct.IntDataType.Int32]:function(_,A,C){_.setInt32(4*A,C,!0)},[ct.IntDataType.Uint32]:function(_,A,C){_.setUint32(4*A,C,!0)},[ct.FloatDataType.Float32]:function(_,A,C){_.setFloat32(4*A,C,!0)},[ct.FloatDataType.Float64]:function(_,A,C){_.setFloat64(8*A,C,!0)}},o={[ct.IntDataType.Int16]:2,[ct.IntDataType.Uint16]:2,[ct.IntDataType.Int32]:4,[ct.IntDataType.Uint32]:4,[ct.FloatDataType.Float32]:4,[ct.FloatDataType.Float64]:8};function s(_){const A=ct.getDataType(_);if(A===ct.IntDataType.Int8)return r(_);if(A===ct.IntDataType.Uint8)return n(_);const C=new Uint8Array(_.length*o[A]),I=i[A],S=new DataView(C.buffer);for(let w=0,R=_.length;w<R;w++)I(S,w,_[w]);return{encodings:[{kind:"ByteArray",type:A}],data:C}}e.byteArray=s;function a(_,A){const C=ct.getDataType(_),I=new Int32Array(_.length);for(let S=0,w=_.length;S<w;S++)I[S]=Math.round(_[S]*A);return{encodings:[{kind:"FixedPoint",factor:A,srcType:C}],data:I}}function c(_){return A=>a(A,_)}e.fixedPoint=c;function u(_,A,C,I,S){const w=ct.getDataType(_);if(!_.length)return{encodings:[{kind:"IntervalQuantization",min:A,max:C,numSteps:I,srcType:w}],data:new Int32Array(0)};if(C<A){const P=A;A=C,C=P}const R=(C-A)/(I-1),M=new S(_.length);for(let P=0,E=_.length;P<E;P++){const N=_[P];N<=A?M[P]=0:N>=C?M[P]=I-1:M[P]=Math.round((N-A)/R)|0}return{encodings:[{kind:"IntervalQuantization",min:A,max:C,numSteps:I,srcType:w}],data:M}}function l(_,A,C,I=Int32Array){return S=>u(S,_,A,C,I)}e.intervalQuantizaiton=l;function d(_){let A=ct.getDataType(_);if(A===void 0&&(_=new Int32Array(_),A=ct.IntDataType.Int32),!_.length)return{encodings:[{kind:"RunLength",srcType:A,srcSize:0}],data:new Int32Array(0)};let C=2;for(let R=1,M=_.length;R<M;R++)_[R-1]!==_[R]&&(C+=2);const I=new Int32Array(C);let S=0,w=1;for(let R=1,M=_.length;R<M;R++)_[R-1]!==_[R]?(I[S]=_[R-1],I[S+1]=w,w=1,S+=2):++w;return I[S]=_[_.length-1],I[S+1]=w,{encodings:[{kind:"RunLength",srcType:A,srcSize:_.length}],data:I}}e.runLength=d;function f(_){if(!ct.isSignedIntegerDataType(_))throw new Error("Only signed integer types can be encoded using delta encoding.");let A=ct.getDataType(_);if(A===void 0&&(_=new Int32Array(_),A=ct.IntDataType.Int32),!_.length)return{encodings:[{kind:"Delta",origin:0,srcType:A}],data:new _.constructor(0)};const C=new _.constructor(_.length),I=_[0];C[0]=_[0];for(let S=1,w=_.length;S<w;S++)C[S]=_[S]-_[S-1];return C[0]=0,{encodings:[{kind:"Delta",origin:I,srcType:A}],data:C}}e.delta=f;function h(_){for(let A=0,C=_.length;A<C;A++)if(_[A]<0)return!0;return!1}function p(_,A){let C=0;for(let I=0,S=_.length;I<S;I++)C+=_[I]/A|0;return C+=_.length,C}function m(_,A){const C=-A-1;let I=0;for(let S=0,w=_.length;S<w;S++){const R=_[S];R>=0?I+=R/A|0:I+=R/C|0}return I+=_.length,I}function y(_){const A=h(_),C=A?m(_,127):p(_,255),I=A?m(_,32767):p(_,65535);return _.length*4<I*2?{isSigned:A,size:_.length,bytesPerElement:4}:I*2<C?{isSigned:A,size:I,bytesPerElement:2}:{isSigned:A,size:C,bytesPerElement:1}}function g(_,A){const C=A.isSigned?A.bytesPerElement===1?127:32767:A.bytesPerElement===1?255:65535,I=-C-1,S=_.length,w=A.isSigned?A.bytesPerElement===1?new Int8Array(A.size):new Int16Array(A.size):A.bytesPerElement===1?new Uint8Array(A.size):new Uint16Array(A.size);let R=0;for(let P=0;P<S;P++){let E=_[P];if(E>=0)for(;E>=C;)w[R]=C,++R,E-=C;else for(;E<=I;)w[R]=I,++R,E-=I;w[R]=E,++R}const M=s(w);return{encodings:[{kind:"IntegerPacking",byteCount:A.bytesPerElement,isUnsigned:!A.isSigned,srcSize:S},M.encodings[0]],data:M.data}}function b(_){const A=y(_);return A.bytesPerElement===4?s(_):g(_,A)}e.integerPacking=b;function v(_){const A=Object.create(null),C=[],I=new Int32Array(_.length),S=Ti.create(Int32Array,1,Math.min(1024,_.length<32?_.length+1:Math.round(_.length/8)+1));Ti.add(S,0);let w=0,R=0;for(const j of _){if(j==null){I[R++]=-1;continue}let z=A[j];z===void 0&&(w+=j.length,z=C.length,C[z]=j,A[j]=z,Ti.add(S,w)),I[R++]=z}const M=Ti.compact(S),E=vl(M).encode(M),q=vl(I).encode(I);return{encodings:[{kind:"StringArray",dataEncoding:q.encoding,stringData:C.join(""),offsetEncoding:E.encoding,offsets:E.data}],data:q.data}}e.stringArray=v})(Qe||(Qe={}));function Rx(e){const t=e.mask?fs(e.mask):void 0,n=fs(e.data),r=el(n),i=r?t?u=>t[u]===0?""+n[u]:"":u=>""+n[u]:t?u=>t[u]===0?n[u]:"":u=>n[u],o=r?u=>n[u]:u=>{const l=n[u];return Jr(l,0,l.length)},s=r?u=>n[u]:u=>{const l=n[u];return uo(l,0,l.length)},a=t?u=>t[u]:u=>0,c=n.length;return{__array:n,binaryEncoding:e.data.encoding,isDefined:!0,rowCount:c,str:i,int:o,float:s,valueKind:a,areValuesEqual:(u,l)=>n[u]===n[l],toStringArray:u=>dn(c,i,u),toIntArray:r?u=>is(n,u):u=>dn(c,o,u),toFloatArray:r?u=>is(n,u):u=>dn(c,s,u)}}function ms(e,t,n){for(let r=0,i=n.length;r<i;r++){const o=n.charCodeAt(r);if(o<128){e[t++]=o>>>0&127|0;continue}if(o<2048){e[t++]=o>>>6&31|192,e[t++]=o>>>0&63|128;continue}if(o<65536){e[t++]=o>>>12&15|224,e[t++]=o>>>6&63|128,e[t++]=o>>>0&63|128;continue}if(o<1114112){e[t++]=o>>>18&7|240,e[t++]=o>>>12&63|128,e[t++]=o>>>6&63|128,e[t++]=o>>>0&63|128;continue}throw new Error("bad codepoint "+o)}}const Dx=function(){const e=[];for(let t=0;t<1024;t++)e[t]=String.fromCharCode(t);return e}();function Pp(e){throw new Error(e)}function Nx(e,t,n){const r=Dx;let i,o=0;const s=[],a=512;for(let c=t,u=t+n;c<u;c++){const l=e[c];(l&128)===0?s[o++]=r[l]:(l&224)===192?s[o++]=r[(l&15)<<6|e[++c]&63]:(l&240)===224?s[o++]=String.fromCharCode((l&15)<<12|(e[++c]&63)<<6|(e[++c]&63)<<0):(l&248)===240?s[o++]=String.fromCharCode((l&7)<<18|(e[++c]&63)<<12|(e[++c]&63)<<6|(e[++c]&63)<<0):Pp("Invalid byte "+l.toString(16)),o===a&&(i=i||[],i[i.length]=s.join(""),o=0)}return i?(o>0&&(i[i.length]=s.slice(0,o).join("")),i.join("")):s.slice(0,o).join("")}const Ep=typeof TextDecoder<"u"?new TextDecoder:void 0;function Mx(e,t,n){if(Ep){const r=t||n!==e.length?e.subarray(t,t+n):e;return Ep.decode(r)}else return Nx(e,t,n)}function Bp(e){let t=0;for(let n=0,r=e.length;n<r;n++){const i=e.charCodeAt(n);if(i<128){t+=1;continue}if(i<2048){t+=2;continue}if(i<65536){t+=3;continue}if(i<1114112){t+=4;continue}Pp("bad codepoint "+i)}return t}function Tx(e){return _s({buffer:e,offset:0,dataView:new DataView(e.buffer)})}function Al(e,t){const n={};for(let r=0;r<t;r++){const i=_s(e);n[i]=_s(e)}return n}function Sl(e,t){const n=new Uint8Array(t),r=e.offset;for(let i=0;i<t;i++)n[i]=e.buffer[i+r];return e.offset+=t,n}function ps(e,t){const n=Mx(e.buffer,e.offset,t);return e.offset+=t,n}function Cl(e,t){const n=new Array(t);for(let r=0;r<t;r++)n[r]=_s(e);return n}function _s(e){const t=e.buffer[e.offset];let n,r;if((t&128)===0)return e.offset++,t;if((t&240)===128)return r=t&15,e.offset++,Al(e,r);if((t&240)===144)return r=t&15,e.offset++,Cl(e,r);if((t&224)===160)return r=t&31,e.offset++,ps(e,r);if((t&224)===224)return n=e.dataView.getInt8(e.offset),e.offset++,n;switch(t){case 192:return e.offset++,null;case 194:return e.offset++,!1;case 195:return e.offset++,!0;case 196:return r=e.dataView.getUint8(e.offset+1),e.offset+=2,Sl(e,r);case 197:return r=e.dataView.getUint16(e.offset+1),e.offset+=3,Sl(e,r);case 198:return r=e.dataView.getUint32(e.offset+1),e.offset+=5,Sl(e,r);case 202:return n=e.dataView.getFloat32(e.offset+1),e.offset+=5,n;case 203:return n=e.dataView.getFloat64(e.offset+1),e.offset+=9,n;case 204:return n=e.buffer[e.offset+1],e.offset+=2,n;case 205:return n=e.dataView.getUint16(e.offset+1),e.offset+=3,n;case 206:return n=e.dataView.getUint32(e.offset+1),e.offset+=5,n;case 208:return n=e.dataView.getInt8(e.offset+1),e.offset+=2,n;case 209:return n=e.dataView.getInt16(e.offset+1),e.offset+=3,n;case 210:return n=e.dataView.getInt32(e.offset+1),e.offset+=5,n;case 217:return r=e.dataView.getUint8(e.offset+1),e.offset+=2,ps(e,r);case 218:return r=e.dataView.getUint16(e.offset+1),e.offset+=3,ps(e,r);case 219:return r=e.dataView.getUint32(e.offset+1),e.offset+=5,ps(e,r);case 220:return r=e.dataView.getUint16(e.offset+1),e.offset+=3,Cl(e,r);case 221:return r=e.dataView.getUint32(e.offset+1),e.offset+=5,Cl(e,r);case 222:return r=e.dataView.getUint16(e.offset+1),e.offset+=3,Al(e,r);case 223:return r=e.dataView.getUint32(e.offset+1),e.offset+=5,Al(e,r)}throw new Error("Unknown type 0x"+t.toString(16))}function Ox(e,t){for(let n=0;n<2;n++)if(e[n]>t[n])return!1;return!0}function kx(e){const t=Object.create(null),n=Object.create(null);for(const r of e.columns)t[r.name]=r;return{rowCount:e.rowCount,name:e.name.substr(1),fieldNames:e.columns.map(r=>r.name),getField(r){const i=t[r];if(i)return n[r]||(n[r]=Rx(i)),n[r]}}}function Rp(e){return Zt.create("Parse BinaryCIF",async t=>{const n=[0,3];try{const r=Tx(e);if(!Ox(n,r.version.match(/(\d)\.(\d)\.\d/).slice(1).map(o=>+o)))return Rr.error(`Unsupported format version. Current ${r.version}, required ${n.join(".")}.`);const i=up(r.dataBlocks.map(o=>{const s=Object.create(null);for(const a of o.categories)s[a.name.substr(1)]=kx(a);return ll(o.categories.map(a=>a.name.substr(1)),s,o.header)}));return Rr.success(i)}catch(r){return Rr.error(""+r)}})}var ki;(function(e){function t(i){return i.replace(".","_").replace(/\[/,"_").replace(/(\[|\])/g,"")}e.canonical=t;function n(i,o){return t(i)===t(o)}e.equal=n;function r(i,o,s=!1){const a=`${i}${o?`.${o}`:""}`;return s?t(a):a}e.create=r})(ki||(ki={}));function qx(e,t,n){const r={};for(const i of t.blocks)r[i.header]=nr(e,i,n);return r}function nr(e,t,n){return jx(e,t,n)}function Ux(e,t){return new Np(t,e,!0)}function Fx(e){switch(e.valueType){case"str":return(t,n,r)=>Lx(e,t,t.str,t.toStringArray);case"int":return(t,n,r)=>Dp(e,t,t.int,t.toIntArray);case"float":return(t,n,r)=>Dp(e,t,t.float,t.toFloatArray);case"list":throw new Error("Use createListColumn instead.");case"tensor":throw new Error("Use createTensorColumn instead.")}}function Lx(e,t,n,r){return{schema:e,__array:t.__array,isDefined:t.isDefined,rowCount:t.rowCount,value:e.transform==="lowercase"?i=>n(i).toLowerCase():e.transform==="uppercase"?i=>n(i).toUpperCase():n,valueKind:t.valueKind,areValuesEqual:t.areValuesEqual,toArray:e.transform==="lowercase"?i=>Array.from(r(i)).map(o=>o.toLowerCase()):e.transform==="uppercase"?i=>Array.from(r(i)).map(o=>o.toUpperCase()):r}}function Dp(e,t,n,r){return{schema:e,__array:t.__array,isDefined:t.isDefined,rowCount:t.rowCount,value:n,valueKind:t.valueKind,areValuesEqual:t.areValuesEqual,toArray:r}}function Gx(e,t,n){const r=e.separator,i=e.itemParse,o=t.getField(n),s=o?c=>o.str(c).split(r).map(u=>i(u.trim())).filter(u=>!!u):c=>[],a=c=>dn(t.rowCount,s,c);return{schema:e,__array:void 0,isDefined:!!o,rowCount:t.rowCount,value:s,valueKind:o?o.valueKind:()=>1,areValuesEqual:(c,u)=>cl(s(c),s(u)),toArray:a}}function Hx(e,t,n){const r=e.space,i=t.fieldNames.includes(`${n}[0]`)||t.fieldNames.includes(`${n}[0][0]`)||t.fieldNames.includes(`${n}[0][0][0]`),o=i?0:1,s=t.fieldNames.includes(`${n}_1`)||t.fieldNames.includes(`${n}_11`)||t.fieldNames.includes(`${n}_111`)?"underscore":"brackets",a=mv(n,r.rank,i,s),c=t.getField(a(o,o,o))||Ce.Undefined(t.rowCount,e),u=d=>pv(t,r,d,a),l=d=>dn(t.rowCount,u,d);return{schema:e,__array:void 0,isDefined:c.isDefined,rowCount:t.rowCount,value:u,valueKind:c.valueKind,areValuesEqual:(d,f)=>er.areEqualExact(u(d),u(f)),toArray:l}}class Np{constructor(t,n,r){this._isDefined=r;const i=Object.keys(n);this._rowCount=t.rowCount,this._columns=i,this._schema=n;const o=Object.create(null);for(const s of i)Object.defineProperty(this,s,{get:function(){if(o[s])return o[s];const a=n[s];if(a.valueType==="list")o[s]=Gx(a,t,s);else if(a.valueType==="tensor")o[s]=Hx(a,t,s);else{const c=Fx(a),u=t.getField(s);o[s]=u?c(u,t,s):Ce.Undefined(t.rowCount,a)}return o[s]},enumerable:!0,configurable:!1})}}function jx(e,t,n){const r=Object.create(null);for(const i of Object.keys(e))r[i]=Kx(i,e[i],t,n);return ul.ofTables(t.header,e,r)}function zx(e){const t=Object.create(null);for(const n of Object.keys(e.categories))for(const r of e.categories[n].fieldNames){const i=ki.create(n,r,!0);t[i]=e.categories[n].getField(r)}return t}function Vx(e,t,n,r){const i=ki.create(t,e),o=ki.canonical(i);if(o in n)return n[o];if(r&&i in r)for(const s of r[i]){const a=ki.canonical(s);if(a in n)return n[a]}}function Kx(e,t,n,r){let i=n.categories[e];if(r){const o=zx(n),s=Object.create(null),a=[];let c=0;for(const u of Object.keys(t)){const l=Vx(u,e,o,r);l&&(s[u]=l,a.push(u),c=l.rowCount)}i={rowCount:c,name:e,fieldNames:[...a],getField(u){return s[u]}}}return new Np(i||tn.empty(e),t,!!i)}var _r=Ce.Schema;const T=_r.str,te=_r.int,Ye=_r.float,Il=_r.coord,Me=_r.Aliased,Nr=_r.Matrix,ys=_r.Vector,dt=_r.lstr,ti=_r.List,et={atom_site:{auth_asym_id:T,auth_atom_id:T,auth_comp_id:T,auth_seq_id:te,B_iso_or_equiv:Ye,Cartn_x:Il,Cartn_y:Il,Cartn_z:Il,group_PDB:Me(T),id:te,label_alt_id:T,label_asym_id:T,label_atom_id:T,label_comp_id:T,label_entity_id:T,label_seq_id:te,occupancy:Ye,type_symbol:T,pdbx_PDB_ins_code:T,pdbx_PDB_model_num:te,pdbx_formal_charge:te,pdbx_label_index:te,pdbx_sifts_xref_db_name:T,pdbx_sifts_xref_db_acc:T,pdbx_sifts_xref_db_num:T,pdbx_sifts_xref_db_res:T,ihm_model_id:te},atom_site_anisotrop:{id:te,type_symbol:T,U:Nr(3,3),U_esd:Nr(3,3),pdbx_auth_seq_id:te,pdbx_auth_asym_id:T,pdbx_auth_atom_id:T,pdbx_auth_comp_id:T,pdbx_label_seq_id:te,pdbx_label_alt_id:T,pdbx_label_asym_id:T,pdbx_label_atom_id:T,pdbx_label_comp_id:T,pdbx_PDB_ins_code:T},atom_sites:{entry_id:T,fract_transf_matrix:Nr(3,3),fract_transf_vector:ys(3)},audit_author:{name:T,pdbx_ordinal:te,identifier_ORCID:T},audit_conform:{dict_location:T,dict_name:T,dict_version:T},cell:{angle_alpha:Ye,angle_beta:Ye,angle_gamma:Ye,entry_id:T,length_a:Ye,length_b:Ye,length_c:Ye,Z_PDB:te,pdbx_unique_axis:T},chem_comp:{formula:T,formula_weight:Ye,id:T,mon_nstd_flag:Me(dt),name:T,type:Me(dt),pdbx_synonyms:ti(";",e=>e)},chem_comp_bond:{atom_id_1:T,atom_id_2:T,comp_id:T,value_order:Me(dt),pdbx_ordinal:te,pdbx_stereo_config:Me(dt),pdbx_aromatic_flag:Me(dt)},citation:{book_publisher:T,country:T,id:T,journal_abbrev:T,journal_id_ASTM:T,journal_id_CSD:T,journal_id_ISSN:T,journal_volume:T,page_first:T,page_last:T,title:T,year:te,pdbx_database_id_DOI:T,pdbx_database_id_PubMed:te},citation_author:{citation_id:T,name:T,ordinal:te},database_2:{database_id:Me(dt),database_code:T},entity:{details:T,formula_weight:Ye,id:T,src_method:Me(dt),type:Me(dt),pdbx_description:ti(",",e=>e),pdbx_number_of_molecules:te,pdbx_parent_entity_id:T,pdbx_mutation:T,pdbx_fragment:T,pdbx_ec:ti(",",e=>e)},entity_poly:{entity_id:T,nstd_linkage:Me(dt),nstd_monomer:Me(dt),type:Me(T),pdbx_strand_id:ti(",",e=>e),pdbx_seq_one_letter_code:T,pdbx_seq_one_letter_code_can:T,pdbx_target_identifier:T},entity_poly_seq:{entity_id:T,hetero:Me(dt),mon_id:T,num:te},entry:{id:T},exptl:{entry_id:T,method:Me(T)},software:{classification:T,date:T,description:T,name:T,type:Me(dt),version:T,pdbx_ordinal:te},struct:{entry_id:T,title:T,pdbx_structure_determination_methodology:Me(T),pdbx_descriptor:T},struct_asym:{details:T,entity_id:T,id:T,pdbx_modified:T,pdbx_blank_PDB_chainid_flag:Me(T)},struct_conf:{beg_label_asym_id:T,beg_label_comp_id:T,beg_label_seq_id:te,beg_auth_asym_id:T,beg_auth_comp_id:T,beg_auth_seq_id:te,conf_type_id:Me(dt),details:T,end_label_asym_id:T,end_label_comp_id:T,end_label_seq_id:te,end_auth_asym_id:T,end_auth_comp_id:T,end_auth_seq_id:te,id:T,pdbx_beg_PDB_ins_code:T,pdbx_end_PDB_ins_code:T,pdbx_PDB_helix_class:T,pdbx_PDB_helix_length:te,pdbx_PDB_helix_id:T},struct_conn:{conn_type_id:Me(dt),details:T,id:T,ptnr1_label_asym_id:T,ptnr1_label_atom_id:T,ptnr1_label_comp_id:T,ptnr1_label_seq_id:te,ptnr1_auth_asym_id:T,ptnr1_auth_comp_id:T,ptnr1_auth_seq_id:te,ptnr1_symmetry:T,ptnr2_label_asym_id:T,ptnr2_label_atom_id:T,ptnr2_label_comp_id:T,ptnr2_label_seq_id:te,ptnr2_auth_asym_id:T,ptnr2_auth_comp_id:T,ptnr2_auth_seq_id:te,ptnr2_symmetry:T,pdbx_ptnr1_PDB_ins_code:T,pdbx_ptnr1_label_alt_id:T,pdbx_ptnr1_standard_comp_id:T,pdbx_ptnr2_PDB_ins_code:T,pdbx_ptnr2_label_alt_id:T,pdbx_ptnr3_PDB_ins_code:T,pdbx_ptnr3_label_alt_id:T,pdbx_ptnr3_label_asym_id:T,pdbx_ptnr3_label_atom_id:T,pdbx_ptnr3_label_comp_id:T,pdbx_ptnr3_label_seq_id:te,pdbx_PDB_id:T,pdbx_dist_value:Ye,pdbx_value_order:Me(dt)},struct_conn_type:{criteria:T,id:Me(dt),reference:T},struct_keywords:{entry_id:T,text:ti(",",e=>e),pdbx_keywords:T},struct_mon_prot_cis:{label_alt_id:T,label_asym_id:T,label_comp_id:T,label_seq_id:te,auth_asym_id:T,auth_comp_id:T,auth_seq_id:te,pdbx_auth_asym_id_2:T,pdbx_auth_comp_id_2:T,pdbx_auth_seq_id_2:te,pdbx_label_asym_id_2:T,pdbx_label_comp_id_2:T,pdbx_label_seq_id_2:te,pdbx_PDB_ins_code:T,pdbx_PDB_ins_code_2:T,pdbx_PDB_model_num:te,pdbx_omega_angle:T,pdbx_id:T,pdbx_auth_ins_code:T,pdbx_auth_ins_code_2:T},struct_ncs_oper:{code:Me(T),details:T,id:te,matrix:Nr(3,3),vector:ys(3)},struct_sheet_range:{beg_label_asym_id:T,beg_label_comp_id:T,beg_label_seq_id:te,end_label_asym_id:T,end_label_comp_id:T,end_label_seq_id:te,beg_auth_asym_id:T,beg_auth_comp_id:T,beg_auth_seq_id:te,end_auth_asym_id:T,end_auth_comp_id:T,end_auth_seq_id:te,id:T,sheet_id:T,pdbx_beg_PDB_ins_code:T,pdbx_end_PDB_ins_code:T},struct_site:{details:T,id:T,pdbx_num_residues:te,pdbx_evidence_code:T,pdbx_auth_asym_id:T,pdbx_auth_comp_id:T,pdbx_auth_seq_id:te,pdbx_auth_ins_code:T},struct_site_gen:{details:T,id:T,label_alt_id:T,label_asym_id:T,label_atom_id:T,label_comp_id:T,label_seq_id:te,auth_asym_id:T,auth_atom_id:T,auth_comp_id:T,auth_seq_id:te,site_id:T,symmetry:T,pdbx_auth_ins_code:T,pdbx_num_res:te},struct_site_keywords:{site_id:T,text:T},symmetry:{entry_id:T,cell_setting:Me(dt),Int_Tables_number:te,space_group_name_Hall:T,"space_group_name_H-M":T},pdbx_database_status:{status_code:Me(T),status_code_sf:Me(T),status_code_mr:Me(T),entry_id:T,recvd_initial_deposition_date:T,SG_entry:Me(dt),deposit_site:Me(T),process_site:Me(T),status_code_cs:Me(T),methods_development_category:Me(T),pdb_format_compatible:Me(dt)},pdbx_nonpoly_scheme:{asym_id:T,entity_id:T,mon_id:T,pdb_strand_id:T,ndb_seq_num:T,pdb_seq_num:T,auth_seq_num:T,pdb_mon_id:T,auth_mon_id:T,pdb_ins_code:T},pdbx_database_related:{db_name:Me(T),details:T,db_id:T,content_type:Me(T)},pdbx_entity_nonpoly:{entity_id:T,comp_id:T,name:T},pdbx_chem_comp_synonyms:{name:T,comp_id:T,provenance:Me(T)},pdbx_chem_comp_identifier:{comp_id:T,identifier:T,type:Me(T),program:T,program_version:T},pdbx_unobs_or_zero_occ_residues:{id:te,polymer_flag:Me(dt),occupancy_flag:Me(te),PDB_model_num:te,auth_asym_id:T,auth_comp_id:T,auth_seq_id:te,PDB_ins_code:T,label_asym_id:T,label_comp_id:T,label_seq_id:te},pdbx_struct_mod_residue:{id:te,auth_asym_id:T,auth_comp_id:T,auth_seq_id:te,PDB_ins_code:T,label_asym_id:T,label_comp_id:T,label_seq_id:te,parent_comp_id:T,details:T},pdbx_struct_oper_list:{id:T,type:Me(T),name:T,symmetry_operation:T,matrix:Nr(3,3),vector:ys(3)},pdbx_struct_assembly:{method_details:T,oligomeric_details:T,oligomeric_count:te,details:T,id:T},pdbx_struct_assembly_gen:{asym_id_list:ti(",",e=>e),assembly_id:T,oper_expression:T},pdbx_reference_entity_list:{prd_id:T,ref_entity_id:T,type:Me(dt),details:T,component_id:te},pdbx_reference_entity_link:{link_id:te,prd_id:T,details:T,ref_entity_id_1:T,ref_entity_id_2:T,entity_seq_num_1:te,entity_seq_num_2:te,comp_id_1:T,comp_id_2:T,atom_id_1:T,atom_id_2:T,value_order:Me(dt),component_1:te,component_2:te,link_class:Me(T)},pdbx_reference_entity_poly_link:{link_id:te,prd_id:T,ref_entity_id:T,component_id:te,entity_seq_num_1:te,entity_seq_num_2:te,comp_id_1:T,comp_id_2:T,atom_id_1:T,atom_id_2:T,value_order:Me(dt)},pdbx_molecule:{prd_id:T,instance_id:te,asym_id:T},pdbx_molecule_features:{prd_id:T,class:Me(dt),type:Me(dt),name:T,details:T},entity_src_nat:{entity_id:T,pdbx_organism_scientific:T,pdbx_plasmid_name:T,pdbx_src_id:te,pdbx_beg_seq_num:te,pdbx_end_seq_num:te},entity_src_gen:{entity_id:T,pdbx_gene_src_gene:ti(",",e=>e),pdbx_gene_src_scientific_name:T,plasmid_name:T,pdbx_src_id:te,pdbx_beg_seq_num:te,pdbx_end_seq_num:te},pdbx_entity_src_syn:{organism_scientific:T,entity_id:T,pdbx_src_id:te,pdbx_beg_seq_num:te,pdbx_end_seq_num:te},pdbx_entity_branch_descriptor:{entity_id:T,descriptor:T,type:Me(dt),program:T,program_version:T,ordinal:te},pdbx_entity_instance_feature:{details:T,feature_type:Me(T),auth_asym_id:T,asym_id:T,auth_seq_num:T,seq_num:te,comp_id:T,auth_comp_id:T,ordinal:te},pdbx_entity_branch_list:{entity_id:T,hetero:Me(dt),comp_id:T,num:te},pdbx_entity_branch_link:{link_id:te,details:T,entity_id:T,entity_branch_list_num_1:te,entity_branch_list_num_2:te,comp_id_1:T,comp_id_2:T,atom_id_1:T,leaving_atom_id_1:T,atom_stereo_config_1:Me(dt),atom_id_2:T,leaving_atom_id_2:T,atom_stereo_config_2:Me(dt),value_order:Me(dt)},pdbx_entity_branch:{entity_id:T,type:Me(T)},pdbx_branch_scheme:{entity_id:T,hetero:Me(dt),asym_id:T,mon_id:T,num:te,pdb_asym_id:T,pdb_seq_num:T,pdb_mon_id:T,auth_asym_id:T,auth_seq_num:T,auth_mon_id:T},pdbx_chem_comp_related:{comp_id:T,related_comp_id:T,relationship_type:Me(T),details:T},ihm_starting_model_details:{starting_model_id:T,entity_id:T,entity_description:T,asym_id:T,entity_poly_segment_id:te,starting_model_source:Me(T),starting_model_auth_asym_id:T,starting_model_sequence_offset:te,dataset_list_id:te},ihm_starting_comparative_models:{id:te,starting_model_id:T,starting_model_auth_asym_id:T,starting_model_seq_id_begin:te,starting_model_seq_id_end:te,template_auth_asym_id:T,template_seq_id_begin:te,template_seq_id_end:te,template_sequence_identity:Ye,template_sequence_identity_denominator:Me(te),template_dataset_list_id:te,alignment_file_id:te},ihm_starting_model_seq_dif:{id:te,entity_id:T,asym_id:T,seq_id:te,comp_id:T,starting_model_id:T,db_asym_id:T,db_seq_id:te,db_comp_id:T,details:T},ihm_model_representation:{id:te,name:T,details:T},ihm_model_representation_details:{id:te,representation_id:te,entity_poly_segment_id:te,entity_id:T,entity_description:T,entity_asym_id:T,model_object_primitive:Me(T),starting_model_id:T,model_mode:Me(T),model_granularity:Me(T),model_object_count:te},ihm_struct_assembly_details:{id:te,assembly_id:te,parent_assembly_id:te,entity_description:T,entity_id:T,asym_id:T,entity_poly_segment_id:te},ihm_struct_assembly:{id:te,name:T,description:T},ihm_modeling_protocol:{id:te,num_steps:te,protocol_name:T},ihm_modeling_protocol_details:{id:te,protocol_id:te,step_id:te,struct_assembly_id:te,dataset_group_id:te,struct_assembly_description:T,step_name:T,step_method:T,num_models_begin:te,num_models_end:te,multi_scale_flag:Me(dt),multi_state_flag:Me(dt),ordered_flag:Me(dt),script_file_id:te,software_id:te},ihm_multi_state_modeling:{state_id:te,state_group_id:te,population_fraction:Ye,population_fraction_sd:Ye,state_type:T,state_name:T,experiment_type:Me(T),details:T},ihm_modeling_post_process:{id:te,protocol_id:te,analysis_id:te,step_id:te,type:Me(T),feature:Me(T),num_models_begin:te,num_models_end:te},ihm_ensemble_info:{ensemble_id:te,ensemble_name:T,post_process_id:te,model_group_id:te,ensemble_clustering_method:Me(T),ensemble_clustering_feature:Me(T),num_ensemble_models:te,num_ensemble_models_deposited:te,ensemble_precision_value:Ye,ensemble_file_id:te},ihm_model_list:{model_id:te,model_name:T,assembly_id:te,protocol_id:te,representation_id:te},ihm_model_group:{id:te,name:T,details:T},ihm_model_group_link:{model_id:te,group_id:te},ihm_model_representative:{id:te,model_group_id:te,model_id:te,selection_criteria:Me(T)},ihm_dataset_list:{id:te,data_type:Me(T),database_hosted:Me(dt)},ihm_dataset_group:{id:te,name:T,application:Me(T),details:T},ihm_dataset_group_link:{dataset_list_id:te,group_id:te},ihm_related_datasets:{dataset_list_id_derived:te,dataset_list_id_primary:te},ihm_dataset_related_db_reference:{id:te,dataset_list_id:te,db_name:Me(T),accession_code:T,version:T,details:T},ihm_external_reference_info:{reference_id:te,reference_provider:T,reference_type:Me(T),reference:T,refers_to:Me(T),associated_url:T},ihm_external_files:{id:te,reference_id:te,file_path:T,content_type:Me(T),file_size_bytes:Ye,details:T},ihm_dataset_external_reference:{id:te,dataset_list_id:te,file_id:te},ihm_localization_density_files:{id:te,file_id:te,ensemble_id:te,entity_id:T,entity_poly_segment_id:te,asym_id:T},ihm_predicted_contact_restraint:{id:te,group_id:te,entity_id_1:T,entity_id_2:T,asym_id_1:T,asym_id_2:T,comp_id_1:T,comp_id_2:T,seq_id_1:te,seq_id_2:te,rep_atom_1:Me(T),rep_atom_2:Me(T),distance_lower_limit:Ye,distance_upper_limit:Ye,probability:Ye,restraint_type:Me(T),model_granularity:Me(T),dataset_list_id:te,software_id:te},ihm_cross_link_list:{id:te,group_id:te,entity_description_1:T,entity_description_2:T,entity_id_1:T,entity_id_2:T,comp_id_1:T,comp_id_2:T,seq_id_1:te,seq_id_2:te,linker_type:Me(T),dataset_list_id:te},ihm_cross_link_restraint:{id:te,group_id:te,entity_id_1:T,entity_id_2:T,asym_id_1:T,asym_id_2:T,comp_id_1:T,comp_id_2:T,seq_id_1:te,seq_id_2:te,atom_id_1:T,atom_id_2:T,restraint_type:Me(T),conditional_crosslink_flag:Me(T),model_granularity:Me(T),distance_threshold:Ye,psi:Ye,sigma_1:Ye,sigma_2:Ye},ihm_cross_link_result_parameters:{id:te,restraint_id:te,model_id:te,psi:Ye,sigma_1:Ye,sigma_2:Ye},ihm_2dem_class_average_restraint:{id:te,dataset_list_id:te,number_raw_micrographs:te,pixel_size_width:Ye,pixel_size_height:Ye,image_resolution:Ye,image_segment_flag:Me(dt),number_of_projections:te,struct_assembly_id:te,details:T},ihm_2dem_class_average_fitting:{id:te,restraint_id:te,model_id:te,cross_correlation_coefficient:Ye,rot_matrix:Nr(3,3),tr_vector:ys(3)},ihm_3dem_restraint:{id:te,dataset_list_id:te,model_id:te,struct_assembly_id:te,fitting_method:T,number_of_gaussians:te,cross_correlation_coefficient:Ye},ihm_sas_restraint:{id:te,dataset_list_id:te,model_id:te,struct_assembly_id:te,profile_segment_flag:Me(dt),fitting_atom_type:T,fitting_method:T,fitting_state:Me(T),radius_of_gyration:Ye,chi_value:Ye,details:T},ihm_starting_model_coord:{ordinal_id:te,starting_model_id:T,group_PDB:Me(T),id:te,type_symbol:T,entity_id:T,atom_id:T,comp_id:T,seq_id:te,asym_id:T,Cartn_x:Ye,Cartn_y:Ye,Cartn_z:Ye,B_iso_or_equiv:Ye},ihm_sphere_obj_site:{id:te,entity_id:T,seq_id_begin:te,seq_id_end:te,asym_id:T,Cartn_x:Ye,Cartn_y:Ye,Cartn_z:Ye,object_radius:Ye,rmsf:Ye,model_id:te},ihm_gaussian_obj_site:{id:te,entity_id:T,seq_id_begin:te,seq_id_end:te,asym_id:T,mean_Cartn_x:Ye,mean_Cartn_y:Ye,mean_Cartn_z:Ye,weight:Ye,covariance_matrix:Nr(3,3),model_id:te},ihm_gaussian_obj_ensemble:{id:te,entity_id:T,seq_id_begin:te,seq_id_end:te,asym_id:T,mean_Cartn_x:Ye,mean_Cartn_y:Ye,mean_Cartn_z:Ye,weight:Ye,covariance_matrix:Nr(3,3),ensemble_id:te},ihm_feature_list:{feature_id:te,feature_type:Me(T),entity_type:Me(T)},ihm_poly_residue_feature:{ordinal_id:te,feature_id:te,entity_id:T,asym_id:T,comp_id_begin:T,comp_id_end:T,seq_id_begin:te,seq_id_end:te},ihm_derived_distance_restraint:{id:te,group_id:te,feature_id_1:te,feature_id_2:te,group_conditionality:Me(T),random_exclusion_fraction:Ye,distance_upper_limit:Ye,restraint_type:Me(T),dataset_list_id:te},ma_model_list:{ordinal_id:te,model_id:te,model_group_id:te,model_name:T,model_group_name:T,model_type:Me(T),data_id:te},ma_target_entity:{entity_id:T,data_id:te,origin:Me(T)},ma_target_entity_instance:{asym_id:T,entity_id:T,details:T},ma_target_ref_db_details:{target_entity_id:T,db_name:Me(T),db_code:T,db_accession:T,seq_db_isoform:T,seq_db_align_begin:T,seq_db_align_end:T,ncbi_taxonomy_id:T,organism_scientific:T},ma_data:{id:te,content_type:Me(T),content_type_other_details:T,name:T},ma_software_group:{ordinal_id:te,group_id:te,software_id:te},ma_qa_metric:{id:te,name:T,type:Me(T),mode:Me(T),software_group_id:te},ma_qa_metric_global:{ordinal_id:te,model_id:te,metric_id:te,metric_value:Ye},ma_qa_metric_local:{ordinal_id:te,model_id:te,label_asym_id:T,label_seq_id:te,label_comp_id:T,metric_id:te,metric_value:Ye},ma_qa_metric_local_pairwise:{ordinal_id:te,model_id:te,label_asym_id_1:T,label_seq_id_1:te,label_comp_id_1:T,label_asym_id_2:T,label_seq_id_2:te,label_comp_id_2:T,metric_id:te,metric_value:Ye}};var ni=Ce.Schema;const yt=ni.str,$x=ni.float,Mp=ni.List,rr=ni.lstr,En=ni.Aliased,po=ni.int,qi=ni.coord,Yx={chem_comp:{formula:yt,formula_weight:$x,id:yt,mon_nstd_parent_comp_id:Mp(",",e=>e),name:yt,one_letter_code:yt,three_letter_code:yt,type:En(rr),pdbx_synonyms:Mp(";",e=>e),pdbx_type:yt,pdbx_ambiguous_flag:yt,pdbx_replaced_by:yt,pdbx_replaces:yt,pdbx_formal_charge:po,pdbx_model_coordinates_details:yt,pdbx_model_coordinates_db_code:yt,pdbx_ideal_coordinates_details:yt,pdbx_ideal_coordinates_missing_flag:En(rr),pdbx_model_coordinates_missing_flag:En(rr),pdbx_initial_date:yt,pdbx_modified_date:yt,pdbx_release_status:En(yt),pdbx_processing_site:En(yt)},chem_comp_atom:{alt_atom_id:yt,atom_id:yt,charge:po,model_Cartn_x:qi,model_Cartn_y:qi,model_Cartn_z:qi,comp_id:yt,type_symbol:yt,pdbx_align:po,pdbx_ordinal:po,pdbx_model_Cartn_x_ideal:qi,pdbx_model_Cartn_y_ideal:qi,pdbx_model_Cartn_z_ideal:qi,pdbx_stereo_config:En(rr),pdbx_aromatic_flag:En(rr),pdbx_leaving_atom_flag:En(rr)},chem_comp_bond:{atom_id_1:yt,atom_id_2:yt,comp_id:yt,value_order:En(rr),pdbx_ordinal:po,pdbx_stereo_config:En(rr),pdbx_aromatic_flag:En(rr)},pdbx_chem_comp_descriptor:{comp_id:yt,descriptor:yt,type:En(rr),program:yt,program_version:yt},pdbx_chem_comp_identifier:{comp_id:yt,identifier:yt,type:En(yt),program:yt,program_version:yt}};var _o=Ce.Schema;const $e=_o.str,Wx=_o.float,yr=_o.lstr,yn=_o.Aliased,On=_o.int,Zx={pdbx_reference_molecule:{prd_id:$e,formula_weight:Wx,formula:$e,type:yn(yr),type_evidence_code:$e,class:yn(yr),class_evidence_code:$e,name:$e,represent_as:yn(yr),chem_comp_id:$e,compound_details:$e,description:$e,representative_PDB_id_code:$e,release_status:yn(yr),replaces:$e,replaced_by:$e},pdbx_reference_entity_list:{prd_id:$e,ref_entity_id:$e,type:yn(yr),details:$e,component_id:On},pdbx_reference_entity_nonpoly:{prd_id:$e,ref_entity_id:$e,name:$e,chem_comp_id:$e},pdbx_reference_entity_link:{link_id:On,prd_id:$e,details:$e,ref_entity_id_1:$e,ref_entity_id_2:$e,entity_seq_num_1:On,entity_seq_num_2:On,comp_id_1:$e,comp_id_2:$e,atom_id_1:$e,atom_id_2:$e,value_order:yn(yr),component_1:On,component_2:On,link_class:yn($e)},pdbx_reference_entity_poly_link:{link_id:On,prd_id:$e,ref_entity_id:$e,component_id:On,entity_seq_num_1:On,entity_seq_num_2:On,comp_id_1:$e,comp_id_2:$e,atom_id_1:$e,atom_id_2:$e,value_order:yn(yr)},pdbx_reference_entity_poly:{prd_id:$e,ref_entity_id:$e,type:yn($e),db_code:$e,db_name:$e},pdbx_reference_entity_poly_seq:{prd_id:$e,ref_entity_id:$e,mon_id:$e,parent_mon_id:$e,num:On,observed:yn(yr),hetero:yn(yr)},pdbx_reference_entity_sequence:{prd_id:$e,ref_entity_id:$e,type:yn($e),NRP_flag:yn($e),one_letter_codes:$e},pdbx_reference_entity_src_nat:{prd_id:$e,ref_entity_id:$e,ordinal:On,organism_scientific:$e,taxid:$e,db_code:$e,db_name:$e},pdbx_prd_audit:{prd_id:$e,date:$e,processing_site:yn($e),action_type:yn($e)}};var Tp=Ce.Schema;const Vt=Tp.str,Xx=Tp.float,Qx={datablock:{id:Vt,description:Vt},dictionary:{title:Vt,datablock_id:Vt,version:Vt},dictionary_history:{version:Vt,update:Vt,revision:Vt},sub_category:{id:Vt,description:Vt},category_group_list:{id:Vt,parent_id:Vt,description:Vt},item_type_list:{code:Vt,primitive_code:Vt,construct:Vt,detail:Vt},item_units_list:{code:Vt,detail:Vt},item_units_conversion:{from_code:Vt,to_code:Vt,operator:Vt,factor:Xx}};var yo=Ce.Schema;const go=yo.str,gs=yo.int,gr=yo.float,bs=yo.Aliased,Mr=yo.Vector;bs(go),bs(go),bs(go),bs(go),Mr(3),Mr(3);const Op={volume_data_3d_info:{name:go,axis_order:Mr(3,gs),origin:Mr(3),dimensions:Mr(3),sample_rate:gs,sample_count:Mr(3,gs),spacegroup_number:gs,spacegroup_cell_size:Mr(3),spacegroup_cell_angles:Mr(3),mean_source:gr,mean_sampled:gr,sigma_source:gr,sigma_sampled:gr,min_source:gr,min_sampled:gr,max_source:gr,max_sampled:gr},volume_data_3d:{values:gr}};var vs=Ce.Schema;const qt=vs.float,wl=vs.int,gt=vs.str,Jx=vs.Matrix,eA={cell:{angle_alpha:qt,angle_beta:qt,angle_gamma:qt,formula_units_z:wl,length_a:qt,length_b:qt,length_c:qt,volume:qt},chemical:{melting_point:qt,name_common:gt,name_systematic:gt},chemical_formula:{moiety:gt,sum:gt,weight:qt},space_group:{crystal_system:gt,it_number:wl,"name_h-m_full":gt},space_group_symop:{operation_xyz:gt},geom_bond:{atom_site_label_1:gt,atom_site_label_2:gt,distance:qt,publ_flag:gt,site_symmetry_1:gt,site_symmetry_2:gt,valence:qt},audit:{block_doi:gt},database_code:{cod:gt,csd:gt,depnum_ccdc_archive:gt,depnum_ccdc_fiz:gt,icsd:gt,mdf:gt,nbs:gt},atom_site:{adp_type:gt,calc_flag:gt,disorder_assembly:gt,disorder_group:gt,fract_x:qt,fract_y:qt,fract_z:qt,label:gt,occupancy:qt,refinement_flags:gt,site_symmetry_multiplicity:wl,type_symbol:gt,u_iso_or_equiv:qt},atom_site_aniso:{label:gt,u_11:qt,u:Jx(3,3),u_12:qt,u_13:qt,u_22:qt,u_23:qt,u_33:qt},atom_type:{description:gt,symbol:gt},atom_type_scat:{dispersion_imag:qt,dispersion_real:qt,source:gt}},tA={"cell.formula_units_z":["cell_formula_units_Z"],"space_group.it_number":["space_group_IT_number","symmetry_Int_Tables_number"],"space_group.name_h-m_full":["symmetry_space_group_name_H-M"],"space_group_symop.operation_xyz":["symmetry_equiv_pos_as_xyz"],"geom_bond.atom_site_label_1":["geom_bond_atom_site_id_1"],"geom_bond.atom_site_label_2":["geom_bond_atom_site_id_2"],"geom_bond.distance":["geom_bond_dist"],"audit.block_doi":["audit_block_DOI"],"database_code.cod":["database_code_COD"],"database_code.csd":["database_code_CSD"],"database_code.depnum_ccdc_archive":["database_code_depnum_CCDC_archive"],"database_code.depnum_ccdc_fiz":["database_code_depnum_CCDC_fiz"],"database_code.icsd":["database_code_ICSD"],"database_code.mdf":["database_code_MDF"],"database_code.nbs":["database_code_NBS"],"atom_site.adp_type":["atom_site_ADP_type","atom_site_thermal_displace_type"],"atom_site.label":["atom_site_id"],"atom_site.site_symmetry_multiplicity":["atom_site_symmetry_multiplicity"],"atom_site.u_iso_or_equiv":["atom_site_U_iso_or_equiv"],"atom_site_aniso.label":["atom_site_anisotrop_id"],"atom_site_aniso.u_11":["atom_site_aniso_U_11","atom_site_anisotrop_U_11"],"atom_site_aniso.u_12":["atom_site_aniso_U_12","atom_site_anisotrop_U_12"],"atom_site_aniso.u_13":["atom_site_aniso_U_13","atom_site_anisotrop_U_13"],"atom_site_aniso.u_22":["atom_site_aniso_U_22","atom_site_anisotrop_U_22"],"atom_site_aniso.u_23":["atom_site_aniso_U_23","atom_site_anisotrop_U_23"],"atom_site_aniso.u_33":["atom_site_aniso_U_33","atom_site_anisotrop_U_33"]};var nA=Ce.Schema;const Pl=nA.int,rA={volume_data_3d_info:Op.volume_data_3d_info,segmentation_data_table:{set_id:Pl,segment_id:Pl},segmentation_data_3d:{values:Pl}},El={parse:e=>typeof e=="string"?Cp(e):Rp(e),parseText:Cp,parseBinary:Rp,toDatabaseCollection:qx,toDatabase:nr,schema:{mmCIF:e=>nr(et,e),CCD:e=>nr(Yx,e),BIRD:e=>nr(Zx,e),dic:e=>nr(Qx,e),cifCore:e=>nr(eA,e,tA),densityServer:e=>nr(Op,e),segmentation:e=>nr(rA,e)}};function iA(e,t,n=!1){return Zt.create("Parse PDB",async r=>Rr.success({lines:await zt.readAllLinesAsync(e,r),id:t,isPdbqt:n}))}function ri(e){return e}(function(e){function t(n){return n.__key||(n.__key=ln.create22()),n.__key}e.getUUID=t})(ri||(ri={}));class xs{constructor(){this._list=[],this._set=new Set,this._refs=new Map,this._assets=new Map}get all(){return this._list}add(t){this._set.has(t)||(this._list.push(t),this._set.add(t))}reference(t,n){let r=this._refs.get(t)||0;r+=n?1:-1,this._refs.set(t,Math.max(r,0))}hasReference(t){return(this._refs.get(t)||0)>0}has(t){return this._set.has(t)}assets(t,n){const r=this._assets.get(t);if(r)for(const i of r)i.dispose();n?this._assets.set(t,n):this._assets.delete(t)}dispose(){this._assets.forEach(t=>{for(const n of t)n.dispose()})}}const oA=Object.prototype.hasOwnProperty;function Bl(e){if(e===null||typeof e!="object")return e;if(e instanceof Array){const t=[];for(let n=0,r=e.length;n<r;n++)t[n]=Bl(e[n]);return t}if(typeof e=="object"&&!("prototype"in e)){const t={};for(const n in e)oA.call(e,n)&&(t[n]=Bl(e[n]));return t}throw new Error(`Can't clone, type "${typeof e}" unsupported`)}function kn(e){let t=1/0,n=-1/0;for(let r=0,i=e.length;r<i;++r)e[r]<t&&(t=e[r]),e[r]>n&&(n=e[r]);return[t,n]}function kp(e,t){for(let n=0,r=e.length;n<r;++n)e[n]=n;return e}function qp(e,t){return e.indexOf(t)>=0?!1:(e.push(t),!0)}function sA(e,t){const n=e.indexOf(t);if(n<0)return!1;for(let r=n,i=e.length-1;r<i;r++)e[r]=e[r+1];return e.pop(),!0}function aA(e){for(let t=0,n=e.length;t<n;t++)if(e[t]!==t)return!1;return!0}function cA(e,t){const n=[],r=[],i=[];e.x.length&&(n.push(...kn(e.x)),r.push(...kn(e.y)),i.push(...kn(e.z))),t&&(t.spheres.x.length&&(n.push(...kn(t.spheres.x)),r.push(...kn(t.spheres.y)),i.push(...kn(t.spheres.z))),t.gaussians.x.length&&(n.push(...kn(t.gaussians.x)),r.push(...kn(t.gaussians.y)),i.push(...kn(t.gaussians.z))));const[o,s]=kn(n),[a,c]=kn(r),[u,l]=kn(i),d=o+(s-o)/2,f=a+(c-a)/2,h=u+(l-u)/2;return O.create(d,f,h)}function uA(e){const t=new Set,n=new Set;return e.properties.structAsymMap.forEach(({auth_id:r},i)=>{t.add(r),n.add(i)}),{auth:t.size,label:n.size}}var Rl;(function(e){function t(c,u,l){const d=!!c[0].cell,f=!!c[0].velocities,h=!!c[0].forces;return{id:ln.create22(),frames:c,hasCell:d,hasVelocities:f,hasForces:h,deltaTime:u,timeOffset:l}}e.create=t;function n(c,u,l){var d,f;let{x:h,y:p,z:m}=c;return c.xyzOrdering.frozen?l?c.xyzOrdering.isIdentity?(h=s(h,l),p=s(p,l),m=s(m,l)):cl(c.xyzOrdering.index,l)||(h=o(h,c.xyzOrdering.index,l),p=o(p,c.xyzOrdering.index,l),m=o(m,c.xyzOrdering.index,l)):c.xyzOrdering.isIdentity||(h=a(h,c.xyzOrdering.index),p=a(p,c.xyzOrdering.index),m=a(m,c.xyzOrdering.index)):l&&(c.xyzOrdering.isIdentity?(c.xyzOrdering.isIdentity=!1,c.xyzOrdering.index=l,i(h,l),i(p,l),i(m,l)):cl(c.xyzOrdering.index,l)||(h=o(h,c.xyzOrdering.index,l),p=o(p,c.xyzOrdering.index,l),m=o(m,c.xyzOrdering.index,l))),c.xyzOrdering.frozen=!0,{id:ln.create22(),atomId:u.atomId,occupancy:(d=u.occupancy)!==null&&d!==void 0?d:Ce.ofConst(1,c.elementCount,Ce.Schema.int),B_iso_or_equiv:(f=u.B_iso_or_equiv)!==null&&f!==void 0?f:Ce.ofConst(0,c.elementCount,Ce.Schema.float),xyzDefined:!0,x:h,y:p,z:m}}e.getAtomicConformation=n;const r=[.123];function i(c,u){const l=r;for(let d=0,f=c.length;d<f;d++)l[d]=c[u[d]];for(let d=0,f=c.length;d<f;d++)c[d]=l[d]}function o(c,u,l){const d=new Float32Array(c.length);for(let f=0,h=c.length;f<h;f++)d[f]=c[u[l[f]]];return d}function s(c,u){const l=new Float32Array(c.length);for(let d=0,f=c.length;d<f;d++)l[d]=c[u[d]];return l}function a(c,u){const l=new Float32Array(c.length);for(let d=0,f=c.length;d<f;d++)l[u[d]]=c[d];return l}})(Rl||(Rl={}));var Kt;(function(e){e.Zero=0;const{_int32:t,_float64:n,_int32_1:r,_float64_1:i}=function(){const m=new ArrayBuffer(8),y=new ArrayBuffer(8);return{_int32:new Int32Array(m),_float64:new Float64Array(m),_int32_1:new Int32Array(y),_float64_1:new Float64Array(y)}}();function o(m){return typeof m=="number"}e.is=o;function s(m,y){return t[0]=m,t[1]=y,n[0]}e.create=s;function a(m){return n[0]=m,t[1]-t[0]}e.diff=a;function c(m){return n[0]=m,t[0]}e.fst=c;function u(m){return n[0]=m,t[1]}e.snd=u;function l(m,y){return n[0]=m,i[0]=y,t[0]===r[0]&&t[1]===r[1]}e.areEqual=l;function d(m,y){n[0]=m,i[0]=y;const g=t[0]-r[0];return g!==0?g:t[1]-r[1]}e.compare=d;function f(m,y,g){n[0]=m[y],i[0]=m[g];const b=t[0]-r[0];return b!==0?b:t[1]-r[1]}e.compareInArray=f;function h(m){return n[0]=m,ds(t[0],t[1])}e.hashCode=h;function p(m){return n[0]=m,`(${t[0]}, ${t[1]})`}e.toString=p})(Kt||(Kt={}));const Up=Kt.Zero;function Fp(e,t){return t<e?Kt.create(e,e):Kt.create(e,t+1)}function Dl(e,t){return t<=e?Kt.create(e,e):Kt.create(e,t)}function lA(e){return e<0?Kt.create(0,0):Kt.create(0,e)}const fA=Kt.is,br=Kt.fst,Tr=Kt.snd,As=Kt.fst;function Ss(e){return Kt.snd(e)-1}const ii=Kt.diff,dA=Kt.hashCode,hA=Kt.toString;function mA(e,t){return Kt.fst(e)<=t&&t<Kt.snd(e)}function pA(e,t){const n=br(e);return t>=n&&t<Tr(e)?t-n:-1}function _A(e,t){return Kt.fst(e)+t}const yA=Kt.areEqual;function Lp(e,t){const n=ii(e),r=ii(t);return n===0&&r===0?!0:n>0&&r>0&&Ss(e)>=As(t)&&As(e)<=Ss(t)}function gA(e,t){return ii(e)?ii(t)?br(e)<=br(t)&&Tr(e)>=Tr(t):!0:ii(t)===0}function Nl(e,t){const n=br(e);if(t<=n)return 0;const r=Tr(e);return t>=r?r-n:t-n}function bA(e,t,n){const r=br(n),i=br(e);if(t<=r+i)return r;const o=Tr(n);return t>=o+i?o:t-i}function Gp(e,t,n){return Dl(Nl(e,t),Nl(e,n+1))}function vA(e,t){return Lp(e,t)?Dl(Math.max(br(e),br(t)),Math.min(Tr(e),Tr(t))):Up}function xA(e,t){return ii(Gp(e,As(t),Ss(t)))}var pe;(function(e){e.Empty=Up,e.ofSingleton=t=>Fp(t,t),e.ofRange=Fp,e.ofBounds=Dl,e.ofLength=lA,e.is=fA,e.has=mA,e.indexOf=pA,e.getAt=_A,e.start=br,e.end=Tr,e.min=As,e.max=Ss,e.size=ii,e.hashCode=dA,e.toString=hA,e.areEqual=yA,e.areIntersecting=Lp,e.isSubInterval=gA,e.findPredecessorIndex=Nl,e.findPredecessorIndexInInterval=bA,e.findRange=Gp,e.intersectionSize=xA,e.intersect=vA})(pe||(pe={}));const bo=[];function AA(e){return[e]}function SA(e){return e}function CA(e){return mr(e),e}function Hp(e,t){if(t<e)return[];const n=new Int32Array(t-e+1);for(let r=e;r<=t;r++)n[r-e]=r;return n}function IA(e){return e&&(Array.isArray(e)||!!e.buffer)}function jp(e){return e[e.length-1]-e[0]+1===e.length}function Ml(e){return e[0]}function Tl(e){return e[e.length-1]+1}function wA(e){return e[0]}function PA(e){return e[e.length-1]}function zp(e){return e.length}function EA(e){const t=e.length;return t?t>2?vx(t,e[0],e[t-1],e[t>>1]):bx(t,e[0],e[t-1]):0}function BA(e){const t=e.length;return t>5?`[${e[0]}, ${e[1]}, ..., ${e[t-1]}], length ${t}`:`[${e.join(", ")}]`}function Vp(e,t){const n=e.length;return n===0?-1:e[0]<=t&&t<=e[n-1]?Yp(e,t,0,n):-1}function RA(e,t,n){return Kp(e,t,pe.start(n),pe.end(n))}function Kp(e,t,n,r){return e.length===0||r<=n?-1:e[n]<=t&&t<=e[r-1]?Yp(e,t,n,r):-1}function DA(e,t){return Vp(e,t)>=0}function $p(e,t){if(e===t)return!0;let n=e.length;if(n!==t.length||e[0]!==t[0]||e[n-1]!==t[n-1])return!1;if(jp(e))return!0;n--;for(let r=1;r<n;r++)if(e[r]!==t[r])return!1;return!0}function oi(e,t){return Wp(e,t,0,e.length)}function NA(e,t,n){return Wp(e,t,pe.start(n),pe.end(n))}function MA(e,t,n){return pe.ofBounds(oi(e,t),oi(e,n+1))}function Yp(e,t,n,r){let i=n,o=r-1;for(;i<=o;){if(i+11>o){for(let c=i;c<=o;c++)if(t===e[c])return c;return-1}const s=i+o>>1,a=e[s];if(t<a)o=s-1;else if(t>a)i=s+1;else return s}return-1}function Wp(e,t,n,r){if(n===r||e[n]>=t)return n;if(e[r-1]<t)return r;let i=n,o=r;for(;o-i>4;){const s=i+o>>1;e[s]>=t?o=s:i=s+1}for(let s=i;s<o;s++)if(e[s]>=t)return s;return o}function TA(e,t){if(e===t)return!0;let{startI:n,startJ:r,endI:i,endJ:o}=si(e,t);for(;n<i&&r<o;){const s=e[n],a=t[r];if(s<a)n++;else if(s>a)r++;else return!0}return!1}function OA(e,t){if(e===t)return!0;const n=t.length;let{startI:r,startJ:i,endI:o,endJ:s}=si(e,t);if(s-i<n||o-r<n)return!1;let a=0;for(;r<o&&i<s;){const c=e[r],u=t[i];c<u?r++:c>u?i++:(r++,i++,a++)}return a===n}function Zp(e,t){if(e===t)return e;const n=e.length,r=t.length;if(n===0)return t;if(r===0)return e;if(e[0]>t[0])return Zp(t,e);const{startI:i,startJ:o,endI:s,endJ:a}=si(e,t),c=Ol(e,t,i,o,s,a);if(c===n&&c===r||c===r)return e;if(c===n)return t;const u=new Int32Array(n+r-c);let l=0,d=0,f=0;for(l=0;l<i;l++)u[f++]=e[l];for(;d<a&&e[i]>t[d];)u[f++]=t[d++];for(;l<s&&d<a;){const h=e[l],p=t[d];h<p?(u[f++]=h,l++):h>p?(u[f++]=p,d++):(u[f++]=h,l++,d++)}for(;l<s;l++)u[f++]=e[l];for(;d<a;d++)u[f++]=t[d];for(;l<n;l++)u[f++]=e[l];for(;d<r;d++)u[f++]=t[d];return u}function kA(e,t){if(e===t)return zp(e);const{startI:n,startJ:r,endI:i,endJ:o}=si(e,t);return Ol(e,t,n,r,i,o)}function Ol(e,t,n,r,i,o){let s=n,a=r,c=0;for(;s<i&&a<o;){const u=e[s],l=t[a];u<l?s++:u>l?a++:(s++,a++,c++)}return c}function qA(e,t){if(e===t)return e;const{startI:n,startJ:r,endI:i,endJ:o}=si(e,t),s=Ol(e,t,n,r,i,o),a=e.length,c=t.length;if(!s)return bo;if(s===a&&s===c||s===c)return t;if(s===a)return e;const u=new Int32Array(s);let l=0,d=n,f=r;for(;d<i&&f<o;){const h=e[d],p=t[f];h<p?d++:(h>p||(u[l++]=h,d++),f++)}return u}function UA(e,t){if(e===t)return bo;const n=e.length,{startI:r,startJ:i,endI:o,endJ:s}=si(e,t);let a=r,c=i,u=0;for(;a<o&&c<s;){const f=e[a],h=t[c];f<h?a++:f>h?c++:(a++,c++,u++)}if(!u)return e;if(u>=n)return bo;const l=new Int32Array(n-u);let d=0;for(let f=0;f<r;f++)l[d++]=e[f];for(a=r,c=i;a<o&&c<s;){const f=e[a],h=t[c];f<h?(l[d++]=f,a++):(f>h||a++,c++)}for(;a<n;a++)l[d++]=e[a];return l}function FA(e){if(e.length<2)return e;let t=1;for(let i=0,o=e.length-1;i<o;i++)e[i]!==e[i+1]&&t++;if(t===e.length)return e;const n=new Int32Array(t);let r=0;for(let i=0,o=e.length-1;i<o;i++)e[i]!==e[i+1]&&(n[r++]=e[i]);return n[r]=e[e.length-1],n}function LA(e,t){if($p(e,t))return bl(0,e.length-1);const{startI:n,startJ:r,endI:i,endJ:o}=si(e,t);let s=n,a=r,c=0;for(;s<i&&a<o;){const f=e[s],h=t[a];f<h?s++:f>h?a++:(s++,a++,c++)}const u=e.length;if(!c)return bo;if(c===u)return bl(0,e.length-1);const l=new Int32Array(c);let d=0;for(s=n,a=r;s<i&&a<o;){const f=e[s],h=t[a];f<h?s++:(f>h||(l[d++]=s,s++),a++)}return l}const vr={startI:0,startJ:0,endI:0,endJ:0};function si(e,t){const n=e.length,r=t.length,i=n/r;return n>=128||r>=128||i<=.34||i>=2.99?(vr.startI=oi(e,Ml(t)),vr.startJ=oi(t,Ml(e)),vr.endI=oi(e,Tl(t)),vr.endJ=oi(t,Tl(e))):(vr.startI=0,vr.startJ=0,vr.endI=n,vr.endJ=r),vr}var ve;(function(e){e.Empty=bo,e.ofUnsortedArray=CA,e.ofSingleton=AA,e.ofSortedArray=SA,e.ofRange=Hp,e.ofBounds=(t,n)=>Hp(t,n-1),e.is=IA,e.isRange=jp,e.has=DA,e.indexOf=Vp,e.indexOfInInterval=RA,e.indexOfInRange=Kp,e.start=Ml,e.end=Tl,e.min=wA,e.max=PA,e.size=zp,e.hashCode=EA,e.toString=BA,e.areEqual=$p,e.areIntersecting=TA,e.isSubset=OA,e.union=Zp,e.intersect=qA,e.subtract=UA,e.findPredecessorIndex=oi,e.findPredecessorIndexInInterval=NA,e.findRange=MA,e.intersectionSize=kA,e.deduplicate=FA,e.indicesOf=LA})(ve||(ve={}));const ir=pe.Empty,GA=pe.ofSingleton,HA=pe.ofRange,jA=pe.ofBounds;function jn(e){return e.length?ve.isRange(e)?pe.ofRange(e[0],e[e.length-1]):e:ir}function ai(e){return pe.is(e)?pe.size(e):ve.size(e)}function zA(e,t){return pe.is(e)?pe.has(e,t):ve.has(e,t)}function VA(e,t){return pe.is(e)?pe.indexOf(e,t):ve.indexOf(e,t)}function kl(e,t){return pe.is(e)?pe.getAt(e,t):e[t]}function Ui(e){return pe.is(e)?pe.min(e):ve.min(e)}function Fi(e){return pe.is(e)?pe.max(e):ve.max(e)}function KA(e){return pe.is(e)?pe.start(e):ve.start(e)}function $A(e){return pe.is(e)?pe.end(e):ve.end(e)}function YA(e){return pe.is(e)?pe.hashCode(e):ve.hashCode(e)}function WA(e){return pe.is(e)?pe.toString(e):ve.toString(e)}function ZA(e,t){return pe.is(e)?pe.is(t)?pe.areEqual(e,t):Xp(e,t):pe.is(t)?Xp(t,e):ve.areEqual(e,t)}function XA(e,t){return pe.is(e)?pe.is(t)?pe.areIntersecting(e,t):Qp(t,e):pe.is(t)?Qp(e,t):ve.areIntersecting(e,t)}function QA(e,t){return pe.is(e)?pe.is(t)?pe.isSubInterval(e,t):a4(e,t):pe.is(t)?s4(e,t):ve.isSubset(e,t)}function JA(e,t){return pe.is(e)?pe.findPredecessorIndex(e,t):ve.findPredecessorIndex(e,t)}function e4(e,t,n){return pe.is(e)?pe.findPredecessorIndexInInterval(e,t,n):ve.findPredecessorIndexInInterval(e,t,n)}function t4(e,t,n){return pe.is(e)?pe.findRange(e,t,n):ve.findRange(e,t,n)}function n4(e,t){return pe.is(e)?pe.is(t)?pe.intersectionSize(e,t):e2(t,e):pe.is(t)?e2(e,t):ve.intersectionSize(e,t)}function r4(e,t){return pe.is(e)?pe.is(t)?l4(e,t):Jp(t,e):pe.is(t)?Jp(e,t):jn(ve.union(e,t))}function i4(e,t){return pe.is(e)?pe.is(t)?pe.intersect(e,t):t2(t,e):pe.is(t)?t2(e,t):jn(ve.intersect(e,t))}function o4(e,t){return pe.is(e)?pe.is(t)?f4(e,t):h4(e,t):pe.is(t)?d4(e,t):jn(ve.subtract(e,t))}function Xp(e,t){return pe.size(e)===ve.size(t)&&pe.start(e)===ve.start(t)&&pe.end(e)===ve.end(t)}function Qp(e,t){return e.length!==0&&pe.size(ve.findRange(e,pe.min(t),pe.max(t)))!==0}function s4(e,t){const n=pe.min(t),r=pe.max(t);if(r-n+1===0)return!0;const i=ve.min(e),o=ve.max(e);if(n<i||r>o)return!1;const s=ve.findRange(e,n,r);return pe.size(s)===pe.size(t)}function a4(e,t){const n=pe.min(e),r=pe.max(e);if(r-n+1===0)return!1;const i=ve.min(t),o=ve.max(t);return i>=n&&o<=r}function c4(e,t){const n=ai(e),r=ai(t);return n===0&&r===0?!0:n>0&&r>0&&Fi(e)>=Ui(t)&&Ui(e)<=Fi(t)}function u4(e,t){return ai(e)?ai(t)?Ui(e)<=Ui(t)&&Fi(e)>=Fi(t):!0:ai(t)===0}function l4(e,t){if(pe.areEqual(e,t))return e;const n=pe.size(e),r=pe.size(t);if(!r)return e;if(!n)return t;const i=pe.min(e),o=pe.min(t);if(c4(e,t))return pe.ofRange(Math.min(i,o),Math.max(pe.max(e),pe.max(t)));let s,a,c,u;i<o?(s=n,a=i,c=r,u=o):(s=r,a=o,c=n,u=i);const l=new Int32Array(n+r);for(let d=0;d<s;d++)l[d]=d+a;for(let d=0;d<c;d++)l[d+s]=d+u;return jn(l)}function Jp(e,t){const n=pe.size(t);if(!n)return e;if(u4(t,e))return t;const r=pe.min(t),i=pe.max(t),o=ve.findRange(e,r,i),s=pe.start(o),a=pe.end(o),c=new Int32Array(s+(e.length-a)+n);let u=0;for(let l=0;l<s;l++)c[u++]=e[l];for(let l=r;l<=i;l++)c[u++]=l;for(let l=a,d=e.length;l<d;l++)c[u++]=e[l];return jn(c)}function e2(e,t){if(!pe.size(t))return 0;const n=ve.findRange(e,pe.min(t),pe.max(t));return pe.end(n)-pe.start(n)}function t2(e,t){if(!pe.size(t))return ir;const n=ve.findRange(e,pe.min(t),pe.max(t)),r=pe.start(n),i=pe.end(n),o=i-r;if(!o)return ir;if(o===e.length)return e;const s=new Int32Array(o);let a=0;for(let c=r;c<i;c++)s[a++]=e[c];return jn(s)}function f4(e,t){if(pe.areEqual(e,t))return ir;if(!pe.areIntersecting(e,t))return e;const n=pe.min(e),r=pe.max(e),i=pe.min(t),o=pe.max(t);if(r<n||o<i)return e;if(pe.isSubInterval(t,e))return ir;if(pe.isSubInterval(e,t)){const s=i-n,a=r-o;if(s<=0)return pe.ofRange(o+1,o+a);if(a<=0)return pe.ofRange(n,n+s-1);const c=new Int32Array(s+a);let u=0;for(let l=0;l<s;l++)c[u++]=n+l;for(let l=1;l<=a;l++)c[u++]=o+l;return jn(c)}return n<i?pe.ofRange(n,i-1):pe.ofRange(o+1,r)}function d4(e,t){const n=pe.min(t),r=pe.max(t);if(r<n)return e;const i=ve.findRange(e,n,r),o=pe.start(i),s=pe.end(i),a=e.length-(s-o);if(a<=0)return ir;if(a===e.length)return e;const c=new Int32Array(a);let u=0;for(let l=0;l<o;l++)c[u++]=e[l];for(let l=s,d=e.length;l<d;l++)c[u++]=e[l];return jn(c)}function h4(e,t){const n=pe.min(e),r=pe.max(e);if(r<n)return e;const i=r-n+1,o=ve.findRange(t,n,r),s=pe.start(o),a=pe.end(o),c=a-s;if(c===0)return e;const u=i-c;if(u<=0)return ir;const l=new Int32Array(u),d=t.length-1,f=t[Math.min(s,d)],h=t[Math.min(a,d)];let p=0;for(let m=n;m<f;m++)l[p++]=m;for(let m=f;m<=h;m++)ve.indexOfInInterval(t,m,o)<0&&(l[p++]=m);for(let m=h+1;m<=r;m++)l[p++]=m;return jn(l)}function m4(e,t,n){if(pe.is(e)){const r=pe.min(e);for(let i=r,o=pe.max(e);i<=o;i++)t(i,i-r,n)}else for(let r=0,i=e.length;r<i;r++)t(e[r],r,n);return n}function p4(e,t,n,r){if(pe.is(e)){let i=0;for(let o=pe.min(e),s=pe.max(e);o<=s;o++){const a=t(o);let c=o+1;for(;c<s&&t(c)===a;)c++;o=c-1,n(a,i,r),i++}}else{let i=0;for(let o=0,s=e.length;o<s;o++){const a=t(e[o]);let c=o+1;for(;c<s&&t(e[c])===a;)c++;o=c-1,n(a,i,r),i++}}return r}function _4(e,t,n){if(t===n)return e;const r=ai(e),i=t.length,o=n.length;if(r===0||i===0||o===0)return ir;const s=ve.findPredecessorIndex(n,t[Ui(e)]),a=ve.findPredecessorIndex(n,t[Fi(e)]+1);let c=0,u=0,l=0,d=s;for(;l<r&&d<a;){const h=t[kl(e,l)],p=n[d];h<p?l++:(h>p||(c++,l++),d++)}if(c===0)return ir;if(c===i&&c===o)return e;const f=new Int32Array(c);for(u=0,l=0,d=s;l<r&&d<a;){const h=t[kl(e,l)],p=n[d];h<p?l++:(h>p||(f[u++]=d,l++),d++)}return jn(f)}var Re;(function(e){e.Empty=ir,e.ofSingleton=GA,e.ofRange=HA,e.ofBounds=jA,e.ofSortedArray=jn,e.has=zA,e.indexOf=VA,e.getAt=kl,e.min=Ui,e.max=Fi,e.start=KA,e.end=$A,e.size=ai,e.hashCode=YA,e.areEqual=ZA,e.areIntersecting=XA,e.isSubset=QA,e.union=r4,e.intersect=i4,e.indexedIntersect=_4,e.subtract=o4,e.findPredecessorIndex=JA,e.findPredecessorIndexInInterval=e4,e.findRange=t4,e.intersectionSize=n4;function t(a,c,u){return m4(a,c,u)}e.forEach=t;function n(a,c,u,l){return p4(a,c,u,l)}e.forEachSegment=n;function r(a){return pe.is(a)}e.isInterval=r;function i(a){return!pe.is(a)}e.isSortedArray=i;function o(a){const c=[];return e.forEach(a,u=>c.push(u)),c}e.toArray=o;function s(a){return WA(a)}e.toString=s})(Re||(Re={}));function n2(e){const t=ve.ofSortedArray(e),n=ve.max(t),r=new Int32Array(n);for(let i=0,o=e.length-1;i<o;i++)for(let s=e[i],a=e[i+1];s<a;s++)r[s]=i;return{offsets:t,index:r,count:e.length-1}}function y4(e,t){const n=pe.start(t),r=new Int32Array(e.length+1);for(let i=0,o=e.length;i<o;i++)r[i]=e[i]-n;return r[e.length]=pe.end(t)-n,n2(r)}function g4({count:e}){return e}function b4({index:e},t){return e[t]}function v4({offsets:e},t,n){const r=Re.max(e),i=n>=r?-1:Re.findPredecessorIndex(e,n-1);return Re.findRange(t,Re.getAt(e,i),Re.getAt(e,i+1)-1)}class x4{move(){for(;this.hasNext;)if(this.updateValue()){this.value.index=this.segmentMin++,this.hasNext=this.segmentMax>=this.segmentMin&&pe.size(this.setRange)>0;break}else this.updateSegmentRange();return this.value}updateValue(){const t=this.segments[this.segmentMin+1],n=Re.findPredecessorIndexInInterval(this.set,t,this.setRange);return this.value.start=pe.start(this.setRange),this.value.end=n,this.setRange=pe.ofBounds(n,pe.end(this.setRange)),n>this.value.start}updateSegmentRange(){const t=pe.min(this.setRange),n=pe.max(this.setRange);if(n<t){this.hasNext=!1;return}this.segmentMin=this.segmentMap[Re.getAt(this.set,t)],this.segmentMax=this.segmentMap[Re.getAt(this.set,n)],this.hasNext=this.segmentMax>=this.segmentMin}setSegment(t){this.setRange=pe.ofBounds(t.start,t.end),this.updateSegmentRange()}constructor(t,n,r,i){this.segments=t,this.segmentMap=n,this.set=r,this.segmentMin=0,this.segmentMax=0,this.setRange=pe.Empty,this.value={index:0,start:0,end:0},this.hasNext=!1,this.setRange=i,this.updateSegmentRange()}}function A4(e,t,n){const r=typeof n<"u"?pe.ofBounds(n.start,n.end):pe.ofBounds(0,Re.size(t));return new x4(e.offsets,e.index,t,r)}var mt;(function(e){e.create=n2,e.ofOffsets=y4,e.count=g4,e.getSegment=b4,e.projectValue=v4,e.transientSegments=A4})(mt||(mt={}));function S4(e){return new C4(e)}class C4{remove(t){const{prev:n,next:r}=this,i=n[t],o=r[t];i>=0&&(r[i]=o,n[t]=-1),o>=0&&(n[o]=i,r[t]=-1),t===this.head&&(i<0?this.head=o:this.head=i)}has(t){return this.prev[t]>=0||this.next[t]>=0||this.head===t}constructor(t){this.head=t>0?0:-1,this.prev=new Int32Array(t),this.next=new Int32Array(t);for(let n=0;n<t;n++)this.next[n]=n+1,this.prev[n]=n-1;this.prev[0]=-1,this.next[t-1]=-1}}var ci;(function(e){e.Empty=new Map;function t(s){return Cx(s.keys())}e.keyArray=t;function n(){return new Map}e.Mutable=n;function r(s){return s}e.asImmutable=r;function i(s){const a=n(),c=s.keys();for(;;){const{done:u,value:l}=c.next();if(u)break;a.set(l,s.get(l))}return a}e.copy=i;function o(s,a){const c=a.keys();for(;;){const{done:u,value:l}=c.next();if(u)break;s.set(l,a.get(l))}return s}e.addFrom=o})(ci||(ci={}));class I4{move(){return++this.index,this.lastValue=this.xs[this.index],this.hasNext=this.index<this.length-1,this.lastValue}constructor(t){this.xs=[],this.index=-1,this.length=0,this.hasNext=!1,this.length=t.length,this.hasNext=t.length>0,this.xs=t,this.index=-1,this.lastValue=t.length>0?t[0]:void 0}}class r2{move(){return++this.value,this.hasNext=this.value<this.max,this.value}constructor(t,n){this.max=n,this.value=0,this.hasNext=!1,this.value=t-1,this.hasNext=n>=t}}class w4{move(){return this.hasNext=!1,this.value}constructor(t){this.value=t,this.hasNext=!0}}class P4{move(){const t=this.f(this.base.move());return this.hasNext=this.base.hasNext,t}constructor(t,n){this.base=t,this.f=n,this.hasNext=!1,this.hasNext=t.hasNext}}class E4{move(){const t=this.next;return this.hasNext=this.findNext(),t}findNext(){for(;this.base.hasNext;)if(this.next=this.base.move(),this.p(this.next))return!0;return!1}constructor(t,n){this.base=t,this.p=n,this.hasNext=this.findNext()}}var Cs;(function(e){e.Empty=new r2(0,-1);function t(a){return new I4(a)}e.Array=t;function n(a){return new w4(a)}e.Value=n;function r(a,c){return new r2(a,c)}e.Range=r;function i(a,c){return new P4(a,c)}e.map=i;function o(a,c){return new E4(a,c)}e.filter=o;function s(a,c,u){for(;a.hasNext;)if(c(a.move(),u))return u;return u}e.forEach=s})(Cs||(Cs={}));var or;(function(e){function t(d,f){if(d===f)return!0;if(d.vertexCount!==f.vertexCount||d.edgeCount!==f.edgeCount)return!1;const{a:h,b:p,offset:m}=d,{a:y,b:g,offset:b}=f;for(let v=0,_=d.a.length;v<_;v++)if(h[v]!==y[v])return!1;for(let v=0,_=d.b.length;v<_;v++)if(p[v]!==g[v])return!1;for(let v=0,_=d.offset.length;v<_;v++)if(m[v]!==b[v])return!1;for(const v of Object.keys(d.edgeProps)){const _=d.edgeProps[v],A=f.edgeProps[v];if(!A)return!1;for(let C=0,I=_.length;C<I;C++)if(_[C]!==A[C])return!1}return!0}e.areEqual=t;class n{getEdgeIndex(f,h){let p,m;f<h?(p=f,m=h):(p=h,m=f);for(let y=this.offset[p],g=this.offset[p+1];y<g;y++)if(this.b[y]===m)return y;return-1}getDirectedEdgeIndex(f,h){for(let p=this.offset[f],m=this.offset[f+1];p<m;p++)if(this.b[p]===h)return p;return-1}getVertexEdgeCount(f){return this.offset[f+1]-this.offset[f]}constructor(f,h,p,m,y,g){this.offset=f,this.a=h,this.b=p,this.edgeCount=m,this.props=g,this.vertexCount=f.length-1,this.edgeProps=y||{}}}function r(d,f,h,p,m,y){return new n(d,f,h,p,m,y)}e.create=r;class i{createGraph(f,h){return r(this.offsets,this.a,this.b,this.edgeCount,f,h)}addNextEdge(){const f=this.xs[this.current],h=this.ys[this.current],p=this.offsets[f]+this.bucketFill[f];this.a[p]=f,this.b[p]=h,this.bucketFill[f]++;const m=this.offsets[h]+this.bucketFill[h];this.a[m]=h,this.b[m]=f,this.bucketFill[h]++,this.current++,this.curA=p,this.curB=m}addAllEdges(){for(let f=0;f<this.edgeCount;f++)this.addNextEdge()}assignProperty(f,h){f[this.curA]=h,f[this.curB]=h}assignDirectedProperty(f,h,p,m){f[this.curA]=h,f[this.curB]=m,p[this.curB]=h,p[this.curA]=m}constructor(f,h,p){this.vertexCount=f,this.xs=h,this.ys=p,this.current=0,this.curA=0,this.curB=0,this.edgeCount=h.length,this.offsets=new Int32Array(this.vertexCount+1),this.bucketFill=new Int32Array(this.vertexCount);const m=new Int32Array(this.vertexCount);for(let g=0,b=this.xs.length;g<b;g++)m[this.xs[g]]++;for(let g=0,b=this.ys.length;g<b;g++)m[this.ys[g]]++;let y=0;for(let g=0;g<this.vertexCount;g++)this.offsets[g]=y,y+=m[g];this.offsets[this.vertexCount]=y,this.slotCount=y,this.a=new Int32Array(y),this.b=new Int32Array(y)}}e.EdgeBuilder=i;class o{createGraph(f,h){return r(this.offsets,this.a,this.b,this.edgeCount,f,h)}addNextEdge(){const f=this.xs[this.current],h=this.ys[this.current],p=this.offsets[f]+this.bucketFill[f];this.a[p]=f,this.b[p]=h,this.bucketFill[f]++,this.current++,this.curA=p}addAllEdges(){for(let f=0;f<this.edgeCount;f++)this.addNextEdge()}assignProperty(f,h){f[this.curA]=h}constructor(f,h,p){this.vertexCount=f,this.xs=h,this.ys=p,this.current=0,this.curA=0,this.edgeCount=h.length,this.offsets=new Int32Array(this.vertexCount+1),this.bucketFill=new Int32Array(this.vertexCount);const m=new Int32Array(this.vertexCount);for(let g=0,b=this.xs.length;g<b;g++)m[this.xs[g]]++;let y=0;for(let g=0;g<this.vertexCount;g++)this.offsets[g]=y,y+=m[g];this.offsets[this.vertexCount]=y,this.slotCount=y,this.a=new Int32Array(y),this.b=new Int32Array(y)}}e.DirectedEdgeBuilder=o;class s{addEdge(f,h){let p=f,m=h;f>h&&(p=h,m=f);const y=Hn(p,m);return this.included.has(y)?!1:(this.included.add(y),this.xs[this.xs.length]=p,this.ys[this.ys.length]=m,!0)}getGraph(){return a(this.vertexCount,this.xs,this.ys)}getEdgeBuiler(){return new i(this.vertexCount,this.xs,this.ys)}constructor(f){this.vertexCount=f,this.xs=[],this.ys=[],this.included=new Set}}e.UniqueEdgeBuilder=s;function a(d,f,h){const p=new e.EdgeBuilder(d,f,h);return p.addAllEdges(),p.createGraph({})}e.fromVertexPairs=a;function c(d,f,h){const{b:p,offset:m,vertexCount:y,edgeProps:g}=d,b=new Int32Array(y);for(let M=0,P=f.length;M<P;M++)b[f[M]]=M+1;let v=0;for(let M=0;M<y;M++)if(b[M]!==0)for(let P=m[M],E=m[M+1];P<E;P++)p[P]>M&&b[p[P]]!==0&&v++;const _=new Int32Array(f.length+1),A=new Int32Array(2*v),C=new Int32Array(2*v),I=new Int32Array(2*v);let S=0,w=0;for(let M=0;M<y;M++){if(b[M]===0)continue;const P=b[M]-1;for(let E=m[M],N=m[M+1];E<N;E++){const q=b[p[E]];q!==0&&(C[S]=P,I[S]=q-1,A[S]=E,S++)}_[++w]=S}const R={};for(const M of Object.keys(g))R[M]=Ix(g[M],A);return r(_,C,I,v,R,h)}e.induceByVertices=c;function u(d){const f=d.vertexCount;if(f===0)return{componentCount:0,componentIndex:new Int32Array(0)};if(d.edgeCount===0){const v=new Int32Array(f);for(let _=0,A=f;_<A;_++)v[_]=_;return{componentCount:f,componentIndex:v}}const h=new Int32Array(f);for(let v=0,_=f;v<_;v++)h[v]=-1;let p=0;h[0]=p;const{offset:m,b:y}=d,g=[0],b=S4(f);for(b.remove(0);g.length>0;){const v=g.pop(),_=h[v];for(let A=m[v],C=m[v+1];A<C;A++){const I=y[A];b.has(I)&&(b.remove(I),g.push(I),h[I]=_)}g.length===0&&b.head>=0&&(g.push(b.head),h[b.head]=++p,b.remove(b.head))}return{componentCount:f,componentIndex:h}}e.connectedComponents=u;function l(d,f,h,p){if(ve.areIntersecting(f,h))return!0;if(p<1)return!1;const m=new Set;for(let y=0,g=f.length;y<g;++y)m.add(f[y]);return i2(d,f,h,p,m)}e.areVertexSetsConnected=l})(or||(or={}));function i2(e,t,n,r,i){const{b:o,offset:s}=e,a=[];for(let c=0,u=t.length;c<u;++c){const l=t[c];for(let d=s[l],f=s[l+1];d<f;++d){const h=o[d];if(!i.has(h)){if(ve.has(n,h))return!0;i.add(h),a[a.length]=h}}}return r>1?i2(e,a,n,r-1,i):!1}class B4{constructor(){this.map=new Map,this.applicable=new Map}add(t,n,r){this.map.set(t,n),r&&this.applicable.set(t,r)}remove(t){this.map.delete(t),this.applicable.delete(t)}get(t){return this.map.get(t)}isApplicable(t){if(!this.map.has(t.sourceData.kind))return!1;const n=this.applicable.get(t.sourceData.kind);return n?n(t):!0}}var sr;(function(e){function t(n,r){const{name:i}=n,o=new B4;return{descriptor:n,formatRegistry:o,isApplicable(s){return o.isApplicable(s)},get(s){const a=r!=null&&r.asDynamic?s._dynamicPropertyData:s._staticPropertyData;if(a[i])return a[i];if(s.customProperties.has(n))return;const c=o.get(s.sourceData.kind);if(c)return a[i]=c(s),s.customProperties.add(n),a[i]},set(s,a){r!=null&&r.asDynamic?s._dynamicPropertyData[i]=a:s._staticPropertyData[i]=a},delete(s){r!=null&&r.asDynamic?delete s._dynamicPropertyData[i]:delete s._staticPropertyData[i]}}}e.create=t})(sr||(sr={}));function R4(e,t,n,r){const i=new or.EdgeBuilder(r,e,t),o=new Int32Array(i.slotCount),s=new Array(i.slotCount),a=new Array(i.slotCount),c=new Int8Array(i.slotCount),u=new Array(i.slotCount),l=new Array(i.slotCount);for(let d=0,f=i.edgeCount;d<f;d++)i.addNextEdge(),i.assignProperty(o,n.key?n.key[d]:-1),i.assignDirectedProperty(s,n.operatorA?n.operatorA[d]:-1,a,n.operatorB?n.operatorB[d]:-1),i.assignProperty(c,n.order?n.order[d]:1),i.assignProperty(u,n.distance?n.distance[d]:-1),i.assignProperty(l,n.flag?n.flag[d]:1);return i.createGraph({key:o,operatorA:s,operatorB:a,order:c,distance:u,flag:l})}var xn;(function(e){e.Descriptor={name:"index_pair_bonds"},e.Provider=sr.create(e.Descriptor,{asDynamic:!0}),e.DefaultProps={maxDistance:-1,cacheable:!0};function t(r,i={}){const o={...e.DefaultProps,...i},{pairs:s,count:a}=r,c=s.indexA.toArray(),u=s.indexB.toArray(),l=s.key&&s.key.toArray(),d=s.operatorA&&s.operatorA.toArray(),f=s.operatorB&&s.operatorB.toArray(),h=s.order&&s.order.toArray(),p=s.distance&&s.distance.toArray(),m=s.flag&&s.flag.toArray();let y=!1;if(d&&f){y=!0;for(let v=0,_=d.length;v<_;++v)if(d[v]===-1||f[v]===-1){y=!1;break}}const g=R4(c,u,{key:l,operatorA:d,operatorB:f,order:h,distance:p,flag:m},a),b=new Map;if(y){const{operatorA:v,operatorB:_}=g.edgeProps;for(let A=0,C=v.length;A<C;++A)if(v[A]===_[A]){const I=v[A];b.has(I)?b.get(I).push(A):b.set(I,[A])}}return{bonds:g,maxDistance:o.maxDistance,cacheable:o.cacheable,hasOperators:y,bySameOperator:b}}e.fromData=t;function n(r,i,o,s,a){let c,u,l,d;i<o?(c=i,u=o,l=s,d=a):(c=o,u=i,l=a,d=s);for(let f=r.offset[c],h=r.offset[c+1];f<h;f++)if(r.b[f]===u&&r.edgeProps.operatorA[f]===l&&r.edgeProps.operatorB[f]===d)return f;return-1}e.getEdgeIndexForOperators=n})(xn||(xn={}));var St;(function(e){e.DefaultName="1_555",e.Default=t(e.DefaultName,Oe.identity()),e.RotationTranslationEpsilon=.005;function t(b,v,_){let{assembly:A,ncsId:C,hkl:I,spgrOp:S,key:w}=_||{};const R=I?O.clone(I):O();S=S??-1,w=w??-1,C=C||-1;const M=Oe.isIdentity(v),P=r(_,M);return M?{name:b,assembly:A,matrix:v,inverse:Oe.identity(),isIdentity:!0,hkl:R,spgrOp:S,ncsId:C,suffix:P,key:w}:(Oe.isRotationAndTranslation(v,e.RotationTranslationEpsilon)||console.warn(`Symmetry operator (${b}) should be a composition of rotation and translation.`),{name:b,assembly:A,matrix:v,inverse:Oe.invert(Oe(),v),isIdentity:!1,hkl:R,spgrOp:S,key:w,ncsId:C,suffix:P})}e.create=t;function n(b){return!!b&&!!b.matrix&&!!b.inverse&&typeof b.name=="string"}function r(b,v){if(!b)return"";if(b.assembly)return n(b)?b.suffix:v?"":`_${b.assembly.operId}`;if(typeof b.spgrOp<"u"&&typeof b.hkl<"u"&&b.spgrOp!==-1){const[_,A,C]=b.hkl;return`-${b.spgrOp+1}_${5+_}${5+A}${5+C}`}return b.ncsId!==-1?`_${b.ncsId}`:""}const i=Oe();function o(b,v){Oe.setIdentity(i);for(let _=0;_<3;_++)for(let A=0;A<3;A++)Oe.setValue(i,_,A,Mn.getValue(b,_,A));return Oe.setTranslation(i,v),Oe.isRotationAndTranslation(i,e.RotationTranslationEpsilon)}e.checkIfRotationAndTranslation=o;function s(b,v,_,A){const C=Oe.identity();for(let I=0;I<3;I++)for(let S=0;S<3;S++)Oe.setValue(C,I,S,Mn.getValue(v,I,S));return Oe.setTranslation(C,_),t(b,C,{ncsId:A})}e.ofRotationAndOffset=s;const a=Jn.identity(),c=Jn(),u=Jn(),l=O();function d(b,v,_){const A=v.inverse;if(v.isIdentity)return Oe.copy(b,A);const C=1-_;Oe.getRotation(c,A),Jn.slerp(c,a,c,C);const I=Jn.getAxisAngle(l,c);return Oe.fromRotation(b,I,l),Oe.setValue(b,0,3,C*Oe.getValue(A,0,3)),Oe.setValue(b,1,3,C*Oe.getValue(A,1,3)),Oe.setValue(b,2,3,C*Oe.getValue(A,2,3)),b}e.lerpFromIdentity=d;function f(b,v,_,A){if(Math.abs(A)<=1e-5)return Oe.copy(b,v);if(Math.abs(A-1)<=1e-5)return Oe.copy(b,_);Oe.getRotation(c,v),Oe.getRotation(u,_),Jn.slerp(u,c,u,A);const C=Jn.getAxisAngle(l,u);return Oe.fromRotation(b,C,l),Oe.setValue(b,0,3,tl(Oe.getValue(v,0,3),Oe.getValue(_,0,3),A)),Oe.setValue(b,1,3,tl(Oe.getValue(v,1,3),Oe.getValue(_,1,3),A)),Oe.setValue(b,2,3,tl(Oe.getValue(v,2,3),Oe.getValue(_,2,3),A)),b}e.slerp=f;function h(b,v){const _=Oe.mul(Oe(),v.matrix,b.matrix);return t(v.name,_,v)}e.compose=h;class p{constructor(v,_,A=Is){this.operator=v,this.coordinates=_,this.r=A,this._x=_.x,this._y=_.y,this._z=_.z,this._m=v.matrix}invariantPosition(v,_){return _[0]=this._x[v],_[1]=this._y[v],_[2]=this._z[v],_}position(v,_){return _[0]=this._x[v],_[1]=this._y[v],_[2]=this._z[v],O.transformMat4(_,_,this._m),_}x(v){const _=this._m,A=_[0],C=_[4],I=_[8],S=_[12],w=this._x[v],R=this._y[v],M=this._z[v],P=_[3]*w+_[7]*R+_[11]*M+_[15]||1;return(A*w+C*R+I*M+S)/P}y(v){const _=this._m,A=_[1],C=_[5],I=_[9],S=_[13],w=this._x[v],R=this._y[v],M=this._z[v],P=_[3]*w+_[7]*R+_[11]*M+_[15]||1;return(A*w+C*R+I*M+S)/P}z(v){const _=this._m,A=_[2],C=_[6],I=_[10],S=_[14],w=this._x[v],R=this._y[v],M=this._z[v],P=_[3]*w+_[7]*R+_[11]*M+_[15]||1;return(A*w+C*R+I*M+S)/P}}class m{constructor(v,_,A=Is){this.operator=v,this.coordinates=_,this.r=A,this._x=_.x,this._y=_.y,this._z=_.z,this._m=v.matrix}invariantPosition(v,_){return _[0]=this._x[v],_[1]=this._y[v],_[2]=this._z[v],_}position(v,_){return _[0]=this.x(v),_[1]=this.y(v),_[2]=this.z(v),_}x(v){const _=this._m;return _[0]*this._x[v]+_[4]*this._y[v]+_[8]*this._z[v]+_[12]}y(v){const _=this._m;return _[1]*this._x[v]+_[5]*this._y[v]+_[9]*this._z[v]+_[13]}z(v){const _=this._m;return _[2]*this._x[v]+_[6]*this._y[v]+_[10]*this._z[v]+_[14]}}class y{constructor(v,_,A=Is){this.operator=v,this.coordinates=_,this.r=A,this._x=_.x,this._y=_.y,this._z=_.z}invariantPosition(v,_){return _[0]=this._x[v],_[1]=this._y[v],_[2]=this._z[v],_}position(v,_){return _[0]=this._x[v],_[1]=this._y[v],_[2]=this._z[v],_}x(v){return this._x[v]}y(v){return this._y[v]}z(v){return this._z[v]}}function g(b,v,_=Is){return Oe.isIdentity(b.matrix)?new y(b,v,_):D4(b.matrix)?new m(b,v,_):new p(b,v,_)}e.createMapping=g})(St||(St={}));function Is(e){return 0}function D4(e){return e[3]===0&&e[7]===0&&e[11]===0&&e[15]===1}const ql=[[1,0,0,0],[0,1,0,0],[0,0,1,0],[-1,0,0,0],[0,-1,0,0],[0,0,-1,0],[0,1,0,.5],[1,0,0,.5],[-1,0,0,.5],[0,0,1,.5],[0,-1,0,.5],[0,0,-1,.5],[1,0,0,.25],[0,-1,0,.25],[0,0,1,.25],[-1,0,0,.25],[0,1,0,.25],[0,-1,0,.75],[0,0,1,.75],[0,1,0,.75],[1,0,0,.75],[-1,0,0,.75],[0,0,-1,.25],[0,0,-1,.75],[1,-1,0,0],[-1,1,0,0],[0,0,1,1/3],[0,0,1,2/3],[1,0,0,2/3],[0,1,0,1/3],[0,-1,0,2/3],[1,-1,0,1/3],[-1,1,0,2/3],[-1,0,0,1/3],[1,0,0,1/3],[0,1,0,2/3],[0,-1,0,1/3],[1,-1,0,2/3],[-1,1,0,1/3],[-1,0,0,2/3],[0,0,-1,1/3],[0,0,-1,2/3],[0,0,1,5/6],[0,0,1,1/6],[0,0,-1,5/6],[0,0,-1,1/6]],N4=[[0,1,2],[3,4,5],[3,1,5],[3,6,5],[7,6,2],[8,6,5],[0,4,2],[0,4,9],[7,10,2],[7,10,9],[0,10,2],[8,10,5],[3,1,11],[3,6,11],[0,10,9],[8,6,11],[3,4,2],[0,4,5],[3,4,9],[7,10,5],[8,4,9],[8,10,9],[8,10,2],[0,6,9],[3,10,9],[0,10,11],[7,1,9],[8,1,11],[7,4,11],[7,6,9],[7,10,11],[3,10,2],[8,1,5],[0,4,11],[3,1,2],[3,1,9],[7,4,2],[8,1,2],[8,1,9],[3,6,9],[7,4,9],[8,6,2],[8,6,9],[3,6,2],[12,13,14],[15,16,14],[12,17,18],[15,19,18],[20,13,18],[21,16,18],[20,17,14],[21,19,14],[0,1,5],[8,10,11],[7,6,11],[7,6,5],[8,4,2],[7,4,5],[7,1,5],[7,1,11],[0,10,5],[0,1,11],[0,6,11],[0,6,5],[3,10,11],[8,4,11],[15,13,22],[12,16,22],[15,17,23],[12,19,23],[21,13,23],[20,16,23],[21,17,22],[20,19,22],[4,0,2],[1,3,2],[4,0,14],[1,3,18],[4,0,9],[1,3,9],[4,0,18],[1,3,14],[10,7,9],[6,8,9],[4,7,14],[6,3,18],[10,0,18],[1,8,14],[1,3,5],[4,0,5],[6,8,11],[10,7,11],[1,3,11],[4,0,11],[10,7,2],[6,8,2],[3,10,22],[7,1,23],[8,4,23],[0,6,22],[1,0,5],[4,3,5],[1,0,23],[4,3,22],[10,7,14],[6,8,18],[8,6,22],[7,10,23],[4,3,11],[1,0,11],[1,0,22],[4,3,23],[10,7,18],[6,8,14],[8,6,23],[7,10,22],[6,7,11],[10,8,11],[8,1,23],[0,10,22],[3,6,22],[7,4,23],[4,3,2],[1,0,2],[10,8,2],[6,7,2],[4,3,9],[1,0,9],[10,8,9],[6,7,9],[4,8,14],[6,0,18],[10,3,18],[1,7,14],[4,8,18],[6,0,14],[10,3,14],[1,7,18],[6,7,5],[10,8,5],[6,8,5],[10,7,5],[8,1,22],[0,10,23],[3,6,23],[7,4,22],[4,24,2],[25,3,2],[4,24,26],[25,3,27],[4,24,27],[25,3,26],[28,29,26],[30,31,26],[32,33,26],[34,35,27],[36,37,27],[38,39,27],[2,0,1],[1,2,0],[1,25,5],[24,0,5],[39,36,40],[35,38,40],[37,34,40],[33,30,41],[29,32,41],[31,28,41],[5,3,4],[4,5,3],[25,1,5],[0,24,5],[24,4,5],[3,25,5],[4,3,41],[25,1,40],[24,4,41],[3,25,40],[4,3,40],[25,1,41],[24,4,40],[3,25,41],[35,34,40],[37,36,40],[39,38,40],[29,28,41],[31,30,41],[33,32,41],[3,5,4],[5,4,3],[25,1,2],[0,24,2],[24,4,2],[3,25,2],[25,1,9],[0,24,9],[24,4,9],[3,25,9],[30,33,26],[32,29,26],[28,31,26],[36,39,27],[38,35,27],[34,37,27],[0,2,1],[2,1,0],[30,33,42],[32,29,42],[28,31,42],[36,39,43],[38,35,43],[34,37,43],[7,9,6],[9,6,7],[25,1,11],[0,24,11],[24,4,11],[3,25,11],[35,34,44],[37,36,44],[39,38,44],[29,28,45],[31,30,45],[33,32,45],[8,11,10],[11,10,8],[1,25,2],[24,0,2],[1,25,42],[24,0,43],[1,25,43],[24,0,42],[1,25,27],[24,0,26],[1,25,26],[24,0,27],[1,25,9],[24,0,9],[4,24,5],[25,3,5],[4,24,11],[25,3,11],[1,0,40],[4,3,44],[0,24,45],[1,0,41],[4,3,45],[0,24,44],[0,24,40],[0,24,41],[2,3,4],[5,3,1],[5,0,4],[4,2,3],[1,5,3],[4,5,0],[2,7,6],[2,8,10],[5,8,6],[5,7,10],[1,9,7],[4,9,8],[1,11,8],[4,11,7],[9,0,6],[9,3,10],[11,3,6],[11,0,10],[6,2,7],[10,2,8],[6,5,8],[10,5,7],[9,7,1],[9,8,4],[11,8,1],[11,7,4],[6,9,0],[10,9,3],[6,11,3],[10,11,0],[9,7,6],[9,8,10],[11,8,6],[11,7,10],[6,9,7],[10,9,8],[6,11,8],[10,11,7],[2,3,10],[5,8,1],[11,0,4],[10,2,3],[1,5,8],[4,11,0],[5,0,1],[2,0,4],[2,3,1],[1,5,0],[4,2,0],[1,2,3],[11,8,10],[11,7,6],[9,7,10],[9,8,6],[10,11,8],[6,11,7],[10,9,7],[6,9,8],[5,8,10],[5,7,6],[2,7,10],[2,8,6],[4,11,8],[1,11,7],[4,9,7],[1,9,8],[11,3,10],[11,0,6],[9,0,10],[9,3,6],[10,5,8],[6,5,7],[10,2,7],[6,2,8],[11,8,4],[11,7,1],[9,7,4],[9,8,1],[10,11,3],[6,11,0],[10,9,0],[6,9,3],[22,15,13],[22,12,16],[14,12,13],[14,15,16],[13,22,15],[16,22,12],[13,14,12],[16,14,15],[22,21,17],[22,20,19],[14,20,17],[14,21,19],[13,23,21],[16,23,20],[13,18,20],[16,18,21],[23,15,17],[23,12,19],[18,12,17],[18,15,19],[17,22,21],[19,22,20],[17,14,20],[19,14,21],[23,21,13],[23,20,16],[18,20,13],[18,21,16],[17,23,15],[19,23,12],[17,18,12],[19,18,15],[5,0,6],[2,7,4],[9,3,1],[6,5,0],[4,2,7],[1,9,3],[0,2,4],[3,2,1],[0,5,1],[2,1,3],[2,4,0],[5,1,0],[7,9,10],[8,9,6],[7,11,6],[9,6,8],[9,10,7],[11,6,7],[1,7,11],[4,8,11],[1,8,9],[4,7,9],[0,9,10],[3,9,6],[3,11,10],[0,11,6],[2,6,8],[2,10,7],[5,6,7],[5,10,8],[6,0,11],[10,3,11],[6,3,9],[10,0,9],[7,2,10],[8,2,6],[8,5,10],[7,5,6],[9,1,8],[9,4,7],[11,1,7],[11,4,8],[7,9,4],[8,9,1],[8,11,4],[7,11,1],[9,6,3],[9,10,0],[11,6,0],[11,10,3],[19,12,23],[13,15,22],[16,21,18],[17,20,14],[20,14,17],[21,18,16],[15,22,13],[12,23,19],[18,16,21],[14,17,20],[23,19,12],[22,13,15],[19,20,22],[13,21,23],[16,15,14],[17,12,18],[20,18,13],[21,14,19],[15,23,17],[12,22,16],[18,19,15],[14,13,12],[23,16,20],[22,17,21],[16,12,22],[17,15,23],[19,21,14],[13,20,18],[12,14,13],[15,18,19],[21,22,17],[20,23,16],[14,16,15],[18,17,12],[22,19,20],[23,13,21],[16,20,23],[17,21,22],[19,15,18],[13,12,14],[12,18,17],[15,14,16],[21,23,13],[20,22,19],[14,19,21],[18,13,20],[22,16,12],[23,17,15],[19,12,22],[17,21,23],[16,15,18],[13,20,14],[20,14,13],[15,18,16],[21,23,17],[12,22,19],[18,16,15],[14,13,20],[22,19,12],[23,17,21],[3,2,4],[3,5,1],[0,5,4],[2,4,3],[5,1,3],[5,4,0],[1,7,9],[4,8,9],[1,8,11],[4,7,11],[0,9,6],[3,9,10],[3,11,6],[0,11,10],[2,6,7],[2,10,8],[5,6,8],[5,10,7],[6,0,9],[10,3,9],[6,3,11],[10,0,11],[7,2,6],[8,2,10],[8,5,6],[7,5,10],[9,1,7],[9,4,8],[11,1,8],[11,4,7],[7,9,1],[8,9,4],[8,11,1],[7,11,4],[9,6,0],[9,10,3],[11,6,3],[11,10,0],[8,9,10],[8,11,6],[7,11,10],[9,10,8],[11,6,8],[11,10,7],[6,0,2],[10,3,2],[6,3,5],[10,0,5],[7,2,1],[8,2,4],[8,5,1],[7,5,4],[9,1,0],[9,4,3],[11,1,3],[11,4,0],[1,7,2],[4,8,2],[1,8,5],[4,7,5],[0,9,1],[3,9,4],[3,11,1],[0,11,4],[2,6,0],[2,10,3],[5,6,3],[5,10,0],[0,2,6],[3,2,10],[3,5,6],[0,5,10],[2,1,7],[2,4,8],[5,1,8],[5,4,7],[16,12,14],[13,21,18],[19,15,23],[17,20,22],[12,14,16],[21,18,13],[15,23,19],[20,22,17],[14,16,12],[18,13,21],[23,19,15],[22,17,20],[19,20,18],[17,15,14],[16,21,22],[13,12,23],[20,18,19],[15,14,17],[21,22,16],[12,23,13],[18,19,20],[14,17,15],[22,16,21],[23,13,12],[6,0,5],[10,3,5],[6,3,2],[10,0,2],[7,2,4],[8,2,1],[8,5,4],[7,5,1],[9,1,3],[9,4,0],[11,1,0],[11,4,3],[1,7,5],[4,8,5],[1,8,2],[4,7,2],[0,9,4],[3,9,1],[3,11,4],[0,11,1],[2,6,3],[2,10,0],[5,6,0],[5,10,3],[0,2,10],[3,2,6],[3,5,10],[0,5,6],[2,1,8],[2,4,7],[5,1,7],[5,4,8],[21,17,23],[20,16,22],[12,13,18],[15,19,14],[23,21,17],[22,20,16],[18,12,13],[14,15,19],[17,23,21],[16,22,20],[13,18,12],[19,14,15],[21,13,22],[20,19,23],[12,17,14],[15,16,18],[23,15,13],[22,12,19],[18,20,17],[14,21,16],[17,22,15],[16,23,12],[13,14,20],[19,18,21],[15,17,22],[12,16,23],[20,13,14],[21,19,18],[22,21,13],[23,20,19],[14,12,17],[18,15,16],[13,23,15],[19,22,12],[17,18,20],[16,14,21],[15,13,23],[12,19,22],[20,17,18],[21,16,14],[22,15,17],[23,12,16],[14,20,13],[18,21,19],[13,22,21],[19,23,20],[17,14,12],[16,18,15],[6,5,3],[4,9,3],[9,3,4],[5,7,4],[4,5,7],[5,3,6]],M4=[[0],[0,1],[0,2],[0,3],[0,2,4,5],[0,6],[0,7],[0,6,4,8],[0,7,4,9],[0,6,2,1],[0,3,1,10],[0,6,2,1,4,8,5,11],[0,12,1,7],[0,1,13,14],[0,12,1,7,4,15,11,9],[0,16,2,17],[0,18,12,17],[0,16,5,19],[0,20,13,19],[0,18,12,17,4,21,15,19],[0,16,2,17,4,22,5,19],[0,16,2,17,23,24,13,25,26,20,27,28,4,22,5,19],[0,16,17,2,29,21,30,15],[0,20,13,19,29,31,32,33],[0,16,6,34],[0,18,7,34],[0,16,7,35],[0,16,36,37],[0,18,36,38],[0,16,14,39],[0,20,40,34],[0,16,8,41],[0,18,8,42],[0,16,9,42],[0,16,6,34,4,22,8,41],[0,18,7,34,4,21,9,41],[0,16,7,35,4,22,9,42],[0,16,6,34,23,24,14,39],[0,16,10,43,23,24,7,35],[0,16,36,37,23,24,9,42],[0,16,8,41,23,24,40,38],[0,16,6,34,23,24,14,39,26,20,40,38,4,22,8,41],[0,16,44,45,23,24,46,47,26,20,48,49,4,22,50,51],[0,16,6,34,29,21,9,42],[0,16,8,41,29,21,7,35],[0,16,36,37,29,21,14,39],[0,16,2,17,1,52,6,34],[0,16,2,17,53,54,9,42],[0,16,12,33,1,52,7,35],[0,16,2,17,11,55,8,41],[0,56,2,57,1,58,6,37],[0,56,15,25,1,58,9,39],[0,20,27,17,1,59,40,34],[0,56,12,28,1,58,7,38],[0,16,5,19,1,52,8,41],[0,22,13,28,1,55,14,38],[0,18,13,60,1,61,14,43],[0,16,15,30,1,52,9,42],[0,16,5,19,11,55,6,34],[0,21,12,19,1,54,7,41],[0,20,13,19,1,59,14,41],[0,20,3,30,1,59,10,42],[0,18,12,17,1,61,7,34,4,21,15,19,11,54,9,41],[0,24,13,17,1,62,14,34,4,20,27,19,11,59,40,41],[0,16,2,17,1,52,6,34,4,22,5,19,11,55,8,41],[0,16,12,33,1,52,7,35,4,22,15,30,11,55,9,42],[0,31,3,17,1,63,10,34,4,56,32,19,11,58,36,41],[0,22,2,19,64,59,14,38,4,16,5,17,65,62,40,39],[0,16,2,17,1,52,6,34,23,24,13,25,64,62,14,39,26,20,27,28,65,59,40,38,4,22,5,19,11,55,8,41],[0,16,2,17,66,67,44,45,23,24,13,25,68,69,46,47,26,20,27,28,70,71,48,49,4,22,5,19,72,73,50,51],[0,16,2,17,1,52,6,34,29,21,15,30,53,54,9,42],[0,16,5,19,1,52,8,41,29,21,12,33,53,54,7,35],[0,20,13,19,1,59,14,41,29,31,32,33,53,63,36,35],[0,31,3,17,1,63,10,34,29,20,27,30,53,59,40,42],[0,16,74,75],[0,18,76,77],[0,16,78,79],[0,18,80,81],[0,16,74,75,29,21,82,83],[0,21,84,85,29,16,86,87],[0,16,88,89],[0,16,88,89,29,21,90,91],[0,16,74,75,1,52,88,89],[0,16,78,79,1,52,92,93],[0,16,94,95,11,55,88,89],[0,16,82,83,53,54,88,89],[0,16,74,75,1,52,88,89,29,21,82,83,53,54,90,91],[0,21,84,85,96,97,88,91,29,16,86,87,98,99,90,89],[0,16,74,75,2,17,100,101],[0,16,94,95,5,19,100,101],[0,18,76,77,2,33,102,103],[0,18,104,105,106,107,100,108],[0,16,78,79,2,17,109,108],[0,16,82,83,15,30,100,101],[0,18,80,81,2,33,110,111],[0,18,112,113,114,115,100,108],[0,16,74,75,2,17,100,101,29,21,82,83,15,30,116,117],[0,21,84,85,118,119,116,101,29,16,86,87,120,121,100,117],[0,16,74,75,6,34,122,123],[0,16,74,75,8,41,124,125],[0,16,78,79,7,35,122,123],[0,16,82,83,9,42,122,123],[0,16,74,75,7,35,126,127],[0,16,74,75,9,42,128,129],[0,16,78,79,6,34,126,127],[0,16,78,79,8,41,128,129],[0,16,74,75,6,34,122,123,29,21,82,83,9,42,128,129],[0,16,74,75,7,35,126,127,29,21,82,83,8,41,124,125],[0,21,84,85,6,42,130,131,29,16,86,87,9,34,132,133],[0,21,84,85,7,41,134,135,29,16,86,87,8,35,136,137],[0,16,89,88,2,17,122,123],[0,16,89,88,12,33,126,127],[0,16,89,88,5,19,124,125],[0,16,89,88,15,30,128,129],[0,16,88,89,6,34,100,101],[0,16,89,88,7,35,109,108],[0,16,89,88,8,41,138,139],[0,16,89,88,9,42,116,117],[0,16,89,88,6,34,100,101,29,21,91,90,9,42,116,117],[0,16,89,88,7,35,109,108,29,21,91,90,8,41,138,139],[0,16,89,88,2,17,122,123,29,21,91,90,15,30,128,129],[0,16,89,88,118,121,132,131,29,21,91,90,120,119,130,133],[0,16,74,75,2,17,100,101,1,52,88,89,6,34,122,123],[0,16,74,75,12,33,109,108,1,52,88,89,7,35,126,127],[0,16,74,75,2,17,100,101,11,55,140,141,8,41,124,125],[0,16,74,75,2,17,100,101,53,54,90,91,9,42,128,129],[0,16,74,75,5,19,138,139,1,52,88,89,8,41,124,125],[0,16,74,75,15,30,116,117,1,52,88,89,9,42,128,129],[0,16,94,95,5,19,100,101,11,55,88,89,6,34,124,125],[0,16,94,95,15,30,109,108,11,55,88,89,7,35,128,129],[0,16,78,79,2,17,109,108,1,52,92,93,6,34,126,127],[0,16,78,79,12,33,100,101,1,52,92,93,7,35,122,123],[0,16,82,83,12,33,138,139,53,54,88,89,8,41,126,127],[0,16,82,83,2,17,116,117,53,54,88,89,9,42,122,123],[0,16,78,79,5,19,116,117,1,52,92,93,8,41,128,129],[0,16,82,83,15,30,100,101,1,52,90,91,9,42,122,123],[0,16,82,83,15,30,100,101,53,54,88,89,6,34,128,129],[0,16,82,83,5,19,109,108,53,54,88,89,7,35,124,125],[0,16,74,75,2,17,100,101,1,52,88,89,6,34,122,123,29,21,82,83,15,30,116,117,53,54,90,91,9,42,128,129],[0,16,74,75,12,33,109,108,1,52,88,89,7,35,126,127,29,21,82,83,5,19,138,139,53,54,90,91,8,41,124,125],[0,21,84,85,118,119,116,101,96,97,88,91,9,34,132,133,29,16,86,87,120,121,100,117,98,99,90,89,6,42,130,131],[0,21,84,85,142,143,138,108,96,97,88,91,8,35,136,137,29,16,86,87,144,145,109,139,98,99,90,89,7,41,134,135],[0,146,147],[0,148,149],[0,150,151],[0,146,147,152,153,154,155,156,157],[0,158,159],[0,146,147,1,160,161],[0,146,147,1,160,161,152,153,154,162,163,164,155,156,157,165,166,167],[0,158,159,1,168,169],[0,146,147,101,170,171],[0,146,147,100,172,173],[0,148,149,174,175,171],[0,148,149,100,176,177],[0,150,151,178,179,171],[0,150,151,100,180,181],[0,146,147,100,172,173,152,153,154,182,183,184,155,156,157,185,186,187],[0,158,159,101,188,189],[0,146,147,122,190,191],[0,146,147,123,192,193],[0,146,147,126,194,195],[0,146,147,127,196,197],[0,146,147,122,190,191,152,153,154,198,199,200,155,156,157,201,202,203],[0,158,159,123,204,205],[0,146,147,126,194,195,152,153,154,206,207,208,155,156,157,209,210,211],[0,158,159,129,212,213],[0,146,147,101,170,171,1,160,161,123,192,193],[0,146,147,108,214,215,1,160,161,127,196,197],[0,146,147,100,172,173,1,160,161,122,190,191],[0,146,147,109,216,217,1,160,161,126,194,195],[0,146,147,100,172,173,1,160,161,122,190,191,152,153,154,182,183,184,162,163,164,198,199,200,155,156,157,185,186,187,165,166,167,201,202,203],[0,158,159,101,188,189,1,168,169,123,204,205],[0,146,147,109,216,217,1,160,161,126,194,195,152,153,154,218,219,220,162,163,164,206,207,208,155,156,157,221,222,223,165,166,167,209,210,211],[0,158,159,117,224,225,1,168,169,129,212,213],[0,146,147,16,226,227],[0,148,149,18,228,229],[0,150,151,18,230,231],[0,150,151,16,232,233],[0,148,149,16,234,235],[0,146,147,18,236,237],[0,146,147,52,238,239],[0,146,147,16,226,227,1,160,161,52,238,239],[0,146,147,18,236,237,1,160,161,61,240,241],[0,146,147,16,226,227,100,172,173,101,170,171],[0,148,149,18,228,229,242,172,181,243,214,244],[0,150,151,18,230,231,245,172,177,246,214,247],[0,150,151,16,232,233,245,172,177,174,170,248],[0,148,149,16,234,235,242,172,181,178,170,249],[0,146,147,18,236,237,100,172,173,108,214,215],[0,146,147,16,226,227,122,190,191,123,192,193],[0,146,147,16,226,227,126,194,195,127,196,197],[0,146,147,18,236,237,126,194,195,123,192,193],[0,146,147,18,236,237,122,190,191,127,196,197],[0,146,147,52,238,239,122,190,191,101,170,171],[0,146,147,61,240,241,126,194,195,101,170,171],[0,146,147,52,238,239,100,172,173,123,192,193],[0,146,147,61,240,241,100,172,173,127,196,197],[0,146,147,16,226,227,100,172,173,101,170,171,1,160,161,52,239,238,122,190,191,123,192,193],[0,146,147,16,226,227,109,216,217,108,214,215,1,160,161,52,239,238,126,194,195,127,196,197],[0,146,147,18,236,237,109,216,217,101,170,171,1,160,161,61,241,240,126,194,195,123,192,193],[0,146,147,18,236,237,100,172,173,108,214,215,1,160,161,61,241,240,122,190,191,127,196,197],[0,16,2,17,158,250,251,252,159,253,254,255],[0,16,2,17,158,250,251,252,159,253,254,255,23,24,13,25,256,257,258,259,260,261,262,263,26,20,27,28,264,265,266,267,268,269,270,271,4,22,5,19,272,273,274,275,276,277,278,279],[0,16,2,17,158,250,251,252,159,253,254,255,29,21,15,30,280,281,282,283,284,285,286,287],[0,20,13,19,158,273,266,259,159,261,278,271],[0,20,13,19,158,273,266,259,159,261,278,271,29,31,32,33,280,288,289,290,284,291,292,293],[0,16,2,17,158,250,251,252,159,253,254,255,1,52,6,34,168,294,295,296,169,297,298,299],[0,16,2,17,158,250,251,252,159,253,254,255,53,54,9,42,300,301,302,303,304,305,306,307],[0,16,2,17,158,250,251,252,159,253,254,255,1,52,6,34,168,294,295,296,169,297,298,299,23,24,13,25,256,257,258,259,260,261,262,263,64,62,14,39,308,309,310,311,312,313,314,315,26,20,27,28,264,265,266,267,268,269,270,271,65,59,40,38,316,317,318,319,320,321,322,323,4,22,5,19,272,273,274,275,276,277,278,279,11,55,8,41,324,325,326,327,328,329,330,331],[0,16,2,17,158,250,251,252,159,253,254,255,66,67,44,45,332,333,334,335,336,337,338,339,23,24,13,25,256,257,258,259,260,261,262,263,68,69,46,47,340,341,342,343,344,345,346,347,26,20,27,28,264,265,266,267,268,269,270,271,70,71,48,49,348,349,350,351,352,353,354,355,4,22,5,19,272,273,274,275,276,277,278,279,72,73,50,51,356,357,358,359,360,361,362,363],[0,16,2,17,158,250,251,252,159,253,254,255,1,52,6,34,168,294,295,296,169,297,298,299,29,21,15,30,280,281,282,283,284,285,286,287,53,54,9,42,300,301,302,303,304,305,306,307],[0,20,13,19,158,273,266,259,159,261,278,271,1,59,14,41,168,325,318,311,169,313,330,323],[0,20,13,19,158,273,266,259,159,261,278,271,1,59,14,41,168,325,318,311,169,313,330,323,29,31,32,33,280,288,289,290,284,291,292,293,53,63,36,35,300,364,365,366,304,367,368,369],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,23,24,13,25,256,257,258,259,260,261,262,263,382,383,384,385,386,387,388,389,390,391,392,393,26,20,27,28,264,265,266,267,268,269,270,271,394,395,396,397,398,399,400,401,402,403,404,405,4,22,5,19,272,273,274,275,276,277,278,279,138,139,95,94,406,407,408,409,410,411,412,413],[0,24,5,28,158,265,258,275,159,277,270,263,414,415,416,417,418,419,420,421,422,423,424,425,23,16,27,19,256,273,251,267,260,269,278,255,426,427,428,429,430,431,432,433,434,435,436,437,26,22,13,17,264,250,274,259,268,261,254,279,438,439,440,441,442,443,444,445,446,447,448,449,4,20,2,25,272,257,266,252,276,253,262,271,450,451,452,453,454,455,456,457,458,459,460,461],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,29,21,15,30,280,281,282,283,284,285,286,287,116,117,83,82,376,377,224,378,379,380,381,225],[0,20,13,19,158,273,266,259,159,261,278,271,450,415,440,429,454,431,420,445,458,447,436,425],[0,20,13,19,158,273,266,259,159,261,278,271,462,463,464,465,466,467,468,469,470,471,472,473],[0,20,13,19,158,273,266,259,159,261,278,271,462,463,464,465,466,467,468,469,470,471,472,473,29,31,32,33,280,288,289,290,284,291,292,293,450,415,440,429,454,431,420,445,458,447,436,425],[0,16,2,17,158,250,251,252,159,253,254,255,123,122,88,89,204,474,475,476,205,477,478,479],[0,16,2,17,158,250,251,252,159,253,254,255,123,122,88,89,204,474,475,476,205,477,478,479,23,24,13,25,256,257,258,259,260,261,262,263,480,481,482,483,484,485,486,487,488,489,490,491,26,20,27,28,264,265,266,267,268,269,270,271,492,493,494,495,496,497,498,499,500,501,502,503,4,22,5,19,272,273,274,275,276,277,278,279,125,124,140,141,504,505,506,507,508,509,510,511],[0,16,2,17,158,250,251,252,159,253,254,255,123,122,88,89,204,474,475,476,205,477,478,479,29,21,15,30,280,281,282,283,284,285,286,287,129,128,90,91,212,512,513,514,213,515,516,517],[0,16,2,17,158,250,251,252,159,253,254,255,129,128,90,91,212,512,513,514,213,515,516,517],[0,16,2,17,158,250,251,252,159,253,254,255,129,128,90,91,212,512,513,514,213,515,516,517,23,24,13,25,256,257,258,259,260,261,262,263,518,519,520,521,522,523,524,525,526,527,528,529,26,20,27,28,264,265,266,267,268,269,270,271,530,531,532,533,534,535,536,537,538,539,540,541,4,22,5,19,272,273,274,275,276,277,278,279,127,126,92,93,542,543,544,545,546,547,548,549],[0,20,13,19,158,273,266,259,159,261,278,271,550,551,552,553,554,555,556,557,558,559,560,561,29,31,32,33,280,288,289,290,284,291,292,293,562,563,564,565,566,567,568,569,570,571,572,573],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,1,52,6,34,168,294,295,296,169,297,298,299,122,123,89,88,475,476,204,474,479,478,477,205],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,53,54,9,42,300,301,302,303,304,305,306,307,128,129,91,90,513,514,212,512,517,516,515,213],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225,1,52,6,34,168,294,295,296,169,297,298,299,128,129,91,90,513,514,212,512,517,516,515,213],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225,53,54,9,42,300,301,302,303,304,305,306,307,122,123,89,88,475,476,204,474,479,478,477,205],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,1,52,6,34,168,294,295,296,169,297,298,299,122,123,89,88,475,476,204,474,479,478,477,205,23,24,13,25,256,257,258,259,260,261,262,263,382,383,384,385,386,387,388,389,390,391,392,393,64,62,14,39,308,309,310,311,312,313,314,315,481,480,483,482,486,487,484,485,491,490,489,488,26,20,27,28,264,265,266,267,268,269,270,271,394,395,396,397,398,399,400,401,402,403,404,405,65,59,40,38,316,317,318,319,320,321,322,323,493,492,495,494,498,499,496,497,503,502,501,500,4,22,5,19,272,273,274,275,276,277,278,279,138,139,95,94,406,407,408,409,410,411,412,413,11,55,8,41,324,325,326,327,328,329,330,331,124,125,141,140,506,507,504,505,511,510,509,508],[0,16,2,17,158,250,251,252,159,253,254,255,116,117,83,82,376,377,224,378,379,380,381,225,1,52,6,34,168,294,295,296,169,297,298,299,128,129,91,90,513,514,212,512,517,516,515,213,23,24,13,25,256,257,258,259,260,261,262,263,574,575,576,577,578,579,580,581,582,583,584,585,64,62,14,39,308,309,310,311,312,313,314,315,519,518,521,520,524,525,522,523,529,528,527,526,26,20,27,28,264,265,266,267,268,269,270,271,586,587,588,589,590,591,592,593,594,595,596,597,65,59,40,38,316,317,318,319,320,321,322,323,531,530,533,532,536,537,534,535,541,540,539,538,4,22,5,19,272,273,274,275,276,277,278,279,109,108,79,78,598,599,600,601,602,603,604,605,11,55,8,41,324,325,326,327,328,329,330,331,126,127,93,92,544,545,542,543,549,548,547,546],[0,24,5,28,158,265,258,275,159,277,270,263,414,415,416,417,418,419,420,421,422,423,424,425,66,69,50,49,332,349,342,359,336,361,354,347,493,123,483,140,498,507,204,485,503,490,509,205,23,16,27,19,256,273,251,267,260,269,278,255,426,427,428,429,430,431,432,433,434,435,436,437,68,67,48,51,340,357,334,351,344,353,362,339,124,480,89,494,506,499,484,474,511,478,501,488,26,22,13,17,264,250,274,259,268,261,254,279,438,439,440,441,442,443,444,445,446,447,448,449,70,73,46,45,348,333,358,343,352,345,338,363,122,492,141,482,475,487,496,505,479,510,489,500,4,20,2,25,272,257,266,252,276,253,262,271,450,451,452,453,454,455,456,457,458,459,460,461,72,71,44,47,356,341,350,335,360,337,346,355,481,125,495,88,486,476,504,497,491,502,477,508],[0,24,5,28,158,265,258,275,159,277,270,263,414,415,416,417,418,419,420,421,422,423,424,425,606,607,608,609,610,611,612,613,614,615,616,617,531,129,521,92,536,545,212,523,541,528,547,213,23,16,27,19,256,273,251,267,260,269,278,255,426,427,428,429,430,431,432,433,434,435,436,437,618,619,620,621,622,623,624,625,626,627,628,629,126,518,91,532,544,537,522,512,549,516,539,526,26,22,13,17,264,250,274,259,268,261,254,279,438,439,440,441,442,443,444,445,446,447,448,449,630,631,632,633,634,635,636,637,638,639,640,641,128,530,93,520,513,525,534,543,517,548,527,538,4,20,2,25,272,257,266,252,276,253,262,271,450,451,452,453,454,455,456,457,458,459,460,461,642,643,644,645,646,647,648,649,650,651,652,653,519,127,533,90,524,514,542,535,529,540,515,546],[0,16,2,17,158,250,251,252,159,253,254,255,100,101,75,74,370,371,188,372,373,374,375,189,1,52,6,34,168,294,295,296,169,297,298,299,122,123,89,88,475,476,204,474,479,478,477,205,29,21,15,30,280,281,282,283,284,285,286,287,116,117,83,82,376,377,224,378,379,380,381,225,53,54,9,42,300,301,302,303,304,305,306,307,128,129,91,90,513,514,212,512,517,516,515,213],[0,20,13,19,158,273,266,259,159,261,278,271,462,463,464,465,466,467,468,469,470,471,472,473,1,59,14,41,168,325,318,311,169,313,330,323,551,550,553,552,556,557,554,555,561,560,559,558,29,31,32,33,280,288,289,290,284,291,292,293,450,415,440,429,454,431,420,445,458,447,436,425,53,63,36,35,300,364,365,366,304,367,368,369,563,562,565,564,568,569,566,567,573,572,571,570],[0,16],[0,18],[0,16,26,20],[0,2,23,13],[0,3,4,32],[0,2,29,15],[0,3,29,27],[0,52],[0,63],[0,52,26,59],[0,63,26,54],[0,52,16,1],[0,18,1,61],[0,52,16,1,26,59,20,65],[0,31,1,63],[0,1,24,62],[0,15,1,9],[0,5,1,8],[0,31,1,63,26,21,65,54],[0,2,57,56],[0,60,3,16],[0,22,57,3],[0,2,28,20],[0,17,13,24],[0,20,19,13,4,24,17,27],[0,22,57,3,4,16,60,32],[0,22,57,3,23,20,30,12,26,24,33,15,4,16,60,32],[0,22,57,3,29,18,27,25],[0,22,3,57,1,55,10,37],[0,22,385,396,3,57,109,117],[0,22,57,3,159,279,654,655,158,274,656,657,29,18,25,27,284,658,262,269,280,659,257,267]],vo={"P 1":0,"P -1":1,"P 1 2 1":2,"P 1 21 1":3,"C 1 2 1":4,"P 1 m 1":5,"P 1 c 1":6,"C 1 m 1":7,"C 1 c 1":8,"P 1 2/m 1":9,"P 1 21/m 1":10,"C 1 2/m 1":11,"P 1 2/c 1":12,"P 1 21/c 1":13,"C 1 2/c 1":14,"P 2 2 2":15,"P 2 2 21":16,"P 21 21 2":17,"P 21 21 21":18,"C 2 2 21":19,"C 2 2 2":20,"F 2 2 2":21,"I 2 2 2":22,"I 21 21 21":23,"P m m 2":24,"P m c 21":25,"P c c 2":26,"P m a 2":27,"P c a 21":28,"P n c 2":29,"P m n 21":30,"P b a 2":31,"P n a 21":32,"P n n 2":33,"C m m 2":34,"C m c 21":35,"C c c 2":36,"A m m 2":37,"A b m 2":38,"A m a 2":39,"A b a 2":40,"F m m 2":41,"F d d 2":42,"I m m 2":43,"I b a 2":44,"I m a 2":45,"P 2/m 2/m 2/m":46,"P m m m":46,"P 2/n 2/n 2/n":47,"P n n n":47,"P 2/c 2/c 2/m":48,"P c c m":48,"P 2/b 2/a 2/n":49,"P b a n":49,"P 21/m 2/m 2/a":50,"P m m a":50,"P 2/n 21/n 2/a":51,"P n n a":51,"P 2/m 2/n 21/a":52,"P m n a":52,"P 21/c 2/c 2/a":53,"P c c a":53,"P 21/b 21/a 2/m":54,"P b a m":54,"P 21/c 21/c 2/n":55,"P c c n":55,"P 2/b 21/c 21/m":56,"P b c m":56,"P 21/n 21/n 2/m":57,"P n n m":57,"P 21/m 21/m 2/n":58,"P m m n":58,"P 21/b 2/c 21/n":59,"P b c n":59,"P 21/b 21/c 21/a":60,"P b c a":60,"P 21/n 21/m 21/a":61,"P n m a":61,"C 2/m 2/c 21/m":62,"C m c m":62,"C 2/m 2/c 21/a":63,"C m c a":63,"C 2/m 2/m 2/m":64,"C m m m":64,"C 2/c 2/c 2/m":65,"C c c m":65,"C 2/m 2/m 2/a":66,"C m m a":66,"C 2/c 2/c 2/a":67,"C c c a":67,"F 2/m 2/m 2/m":68,"F m m m":68,"F 2/d 2/d 2/d":69,"F d d d":69,"I 2/m 2/m 2/m":70,"I m m m":70,"I 2/b 2/a 2/m":71,"I b a m":71,"I 21/b 21/c 21/a":72,"I b c a":72,"I 21/m 21/m 21/a":73,"I m m a":73,"P 4":74,"P 41":75,"P 42":76,"P 43":77,"I 4":78,"I 41":79,"P -4":80,"I -4":81,"P 4/m":82,"P 42/m":83,"P 4/n":84,"P 42/n":85,"I 4/m":86,"I 41/a":87,"P 4 2 2":88,"P 4 21 2":89,"P 41 2 2":90,"P 41 21 2":91,"P 42 2 2":92,"P 42 21 2":93,"P 43 2 2":94,"P 43 21 2":95,"I 4 2 2":96,"I 41 2 2":97,"P 4 m m":98,"P 4 b m":99,"P 42 c m":100,"P 42 n m":101,"P 4 c c":102,"P 4 n c":103,"P 42 m c":104,"P 42 b c":105,"I 4 m m":106,"I 4 c m":107,"I 41 m d":108,"I 41 c d":109,"P -4 2 m":110,"P -4 2 c":111,"P -4 21 m":112,"P -4 21 c":113,"P -4 m 2":114,"P -4 c 2":115,"P -4 b 2":116,"P -4 n 2":117,"I -4 m 2":118,"I -4 c 2":119,"I -4 2 m":120,"I -4 2 d":121,"P 4/m 2/m 2/m":122,"P4/m m m":122,"P 4/m 2/c 2/c":123,"P4/m c c":123,"P 4/n 2/b 2/m":124,"P4/n b m":124,"P 4/n 2/n 2/c":125,"P4/n n c":125,"P 4/m 21/b 2/m":126,"P4/m b m":126,"P 4/m 21/n 2/c":127,"P4/m n c":127,"P 4/n 21/m 2/m":128,"P4/n m m":128,"P 4/n 2/c 2/c":129,"P4/n c c":129,"P 42/m 2/m 2/c":130,"P42/m m c":130,"P 42/m 2/c 2/m":131,"P42/m c m":131,"P 42/n 2/b 2/c":132,"P42/n b c":132,"P 42/n 2/n 2/m":133,"P42/n n m":133,"P 42/m 21/b 2/c":134,"P42/m b c":134,"P 42/m 21/n 2/m":135,"P42/m n m":135,"P 42/n 21/m 2/c":136,"P42/n m c":136,"P 42/n 21/c 2/m":137,"P42/n c m":137,"I 4/m 2/m 2/m":138,"I4/m m m":138,"I 4/m 2/c 2/m":139,"I4/m c m":139,"I 41/a 2/m 2/d":140,"I41/a m d":140,"I 41/a 2/c 2/d":141,"I41/a c d":141,"P 3":142,"P 31":143,"P 32":144,"H 3":145,"R 3":146,"P -3":147,"H -3":148,"R -3":149,"P 3 1 2":150,"P 3 2 1":151,"P 31 1 2":152,"P 31 2 1":153,"P 32 1 2":154,"P 32 2 1":155,"H 3 2":156,"R 3 2":157,"P 3 m 1":158,"P 3 1 m":159,"P 3 c 1":160,"P 3 1 c":161,"H 3 m":162,"R 3 m":163,"H 3 c":164,"R 3 c":165,"P -3 1 2/m":166,"P -3 1 m":166,"P -3 1 2/c":167,"P -3 1 c":167,"P -3 2/m 1":168,"P -3 m 1":168,"P -3 2/c 1":169,"P -3 c 1":169,"H -3 2/m":170,"H -3 m":170,"R -3 2/m":171,"R -3 m":171,"H -3 2/c":172,"H -3 c":172,"R -3 2/c":173,"R -3 c":173,"P 6":174,"P 61":175,"P 65":176,"P 62":177,"P 64":178,"P 63":179,"P -6":180,"P 6/m":181,"P 63/m":182,"P 6 2 2":183,"P 61 2 2":184,"P 65 2 2":185,"P 62 2 2":186,"P 64 2 2":187,"P 63 2 2":188,"P 6 m m":189,"P 6 c c":190,"P 63 c m":191,"P 63 m c":192,"P -6 m 2":193,"P -6 c 2":194,"P -6 2 m":195,"P -6 2 c":196,"P 6/m 2/m 2/m":197,"P 6/m m m":197,"P 6/m 2/c 2/c":198,"P 6/m c c":198,"P 63/m 2/c 2/m":199,"P 63/m c m":199,"P 63/m 2/m 2/c":200,"P 63/m m c":200,"P 2 3":201,"F 2 3":202,"I 2 3":203,"P 21 3":204,"I 21 3":205,"P 2/m -3":206,"P m -3":206,"P 2/n -3":207,"P n -3":207,"F 2/m -3":208,"F m -3":208,"F 2/d -3":209,"F d -3":209,"I 2/m -3":210,"I m -3":210,"P 21/a -3":211,"P a -3":211,"I 21/a -3":212,"I a -3":212,"P 4 3 2":213,"P 42 3 2":214,"F 4 3 2":215,"F 41 3 2":216,"I 4 3 2":217,"P 43 3 2":218,"P 41 3 2":219,"I 41 3 2":220,"P -4 3 m":221,"F -4 3 m":222,"I -4 3 m":223,"P -4 3 n":224,"F -4 3 c":225,"I -4 3 d":226,"P 4/m -3 2/m":227,"P m -3 m":227,"P 4/n -3 2/n":228,"P n -3 n":228,"P 42/m -3 2/n":229,"P m -3 n":229,"P 42/n -3 2/m":230,"P n -3 m":230,"F 4/m -3 2/m":231,"F m -3 m":231,"F 4/m -3 2/c":232,"F m -3 c":232,"F 41/d -3 2/m":233,"F d -3 m":233,"F 41/d -3 2/c":234,"F d -3 c":234,"I 4/m -3 2/m":235,"I m -3 m":235,"I 41/a -3 2/d":236,"I a -3 d":236,"P 1 1 2":237,"P 1 1 21":238,"B 1 1 2":239,"B 2":239,"A 1 2 1":240,"C 1 21 1":241,"I 1 2 1":242,"I 2":242,"I 1 21 1":243,"P 1 1 m":244,"P 1 1 b":245,"B 1 1 m":246,"B 1 1 b":247,"P 1 1 2/m":248,"P 1 1 21/m":249,"B 1 1 2/m":250,"P 1 1 2/b":251,"P 1 1 21/b":252,"P 1 21/n 1":253,"P 1 21/a 1":254,"B 1 1 2/b":255,"P 21 2 2":256,"P 2 21 2":257,"P 21 21 2 (a)":258,"P 21 2 21":259,"P 2 21 21":260,"C 2 2 21a)":261,"C 2 2 2a":262,"F 2 2 2a":263,"I 2 2 2a":264,"P 21/m 21/m 2/n a":265,"P 42 21 2a":266,"I 2 3a":267};function T4(e){switch(e){case 1146:return 146;case 1148:return 149;case 1155:return 157;case 1160:return 163;case 1161:return 165;case 1166:return 171;case 1167:return 173;case 1003:return 237;case 1004:return 238;case 1005:return 239;case 2005:return 240;case 3005:return 241;case 4005:return 242;case 5005:return 243;case 1006:return 244;case 1007:return 245;case 1008:return 246;case 1009:return 247;case 1010:return 248;case 1011:return 249;case 1012:return 250;case 1013:return 251;case 1014:return 252;case 2014:return 253;case 3014:return 254;case 1015:return 255;case 1017:return 256;case 2017:return 257;case 1018:return 258;case 2018:return 259;case 3018:return 260;case 1020:return 261;case 1021:return 262;case 1022:return 263;case 1023:return 264;case 1059:return 265;case 1094:return 266;case 1197:return 267}let t=0;return e>146&&++t,e>148&&++t,e>155&&++t,e>160&&++t,e>161&&++t,e>166&&++t,e>167&&++t,e-1+t}function O4(e){if(e<146)return e+1;if(e===146)return 1146;if(e<149)return e+1-1;if(e===149)return 1148;if(e<157)return e+1-2;if(e===157)return 1155;if(e<163)return e+1-3;if(e===163)return 1160;if(e<165)return e+1-4;if(e===165)return 1161;if(e<171)return e+1-5;if(e===171)return 1166;if(e<173)return e+1-6;if(e===173)return 1167;if(e<237)return e+1-7;if(e===237)return 1003;if(e===238)return 1004;if(e===239)return 1005;if(e===240)return 2005;if(e===241)return 3005;if(e===242)return 4005;if(e===243)return 5005;if(e===244)return 1006;if(e===245)return 1007;if(e===246)return 1008;if(e===247)return 1009;if(e===248)return 1010;if(e===249)return 1011;if(e===250)return 1012;if(e===251)return 1013;if(e===252)return 1014;if(e===253)return 2014;if(e===254)return 3014;if(e===255)return 1015;if(e===256)return 1017;if(e===257)return 2017;if(e===258)return 1018;if(e===259)return 2018;if(e===260)return 3018;if(e===261)return 1020;if(e===262)return 1021;if(e===263)return 1022;if(e===264)return 1023;if(e===265)return 1059;if(e===266)return 1094;if(e===267)return 1197;throw new Error(`unknown spacegroup index '${e}'`)}const o2=function(){const e=Object.create(null);for(const t of Object.keys(vo))e[vo[t]]=t;return e}(),k4=function(){const e=Object.create(null);for(const t of Object.keys(vo)){const n=vo[t];e[n]=O4(n)}return e}();function q4(e){const t=typeof e=="number"?T4(e):vo[e];return typeof t>"u"||typeof o2[t]>"u"?-1:t}var ui;(function(e){e.Zero=n("P 1",O.create(1,1,1),O.create(Math.PI/2,Math.PI/2,Math.PI/2));function t(r){return r?r.index===0&&r.size[0]===1&&r.size[1]===1&&r.size[1]===1:!0}e.isZero=t;function n(r,i,o){const s=q4(r);if(s<0)return console.warn(`Unknown spacegroup '${r}', returning a 'P 1' with cellsize [1, 1, 1]`),e.Zero;const a=i[0]*i[1]*i[2],c=o[0],u=o[1],l=o[2],d=i[0],f=i[1],h=i[2],p=Math.cos(u),m=(Math.cos(c)-Math.cos(u)*Math.cos(l))/Math.sin(l),y=Math.sqrt(1-p*p-m*m),g=[d,0,0],b=[Math.cos(l)*f,Math.sin(l)*f,0],v=[p*h,m*h,y*h],_=Oe.ofRows([[g[0],b[0],v[0],0],[0,b[1],v[1],0],[0,0,v[2],0],[0,0,0,1]]),A=Oe.invert(Oe.zero(),_);return{index:s,size:i,volume:a,anglesInRadians:o,toFractional:A,fromFractional:_}}e.create=n})(ui||(ui={}));var zn;(function(e){e.ZeroP1=t(ui.Zero);function t(y){const g=M4[y.index].map(_=>d(N4[_])),b=o2[y.index],v=k4[y.index];return{name:b,num:v,cell:y,operators:g}}e.create=t;const n=O(),r=Oe();function i(y,g,b,v,_,A){return O.set(n,b,v,_),Oe.fromTranslation(r,n),Oe.mul(A,Oe.mul(A,Oe.mul(A,y.cell.fromFractional,r),y.operators[g]),y.cell.toFractional)}e.setOperatorMatrix=i;function o(y,g,b,v,_){const A=i(y,g,b,v,_,Oe.zero());return St.create(`${g+1}_${5+b}${5+v}${5+_}`,A,{hkl:O.create(b,v,_),spgrOp:g})}e.getSymmetryOperator=o;const s=O(),a=O(),c=O(),u=O();function l(y,g,b,v,_,A){const C=Oe.zero();O.set(n,b,v,_),O.floor(s,A),Oe.copy(C,y.operators[g]),O.floor(a,O.transformMat4(a,A,C)),Oe.getTranslation(u,C),O.sub(u,u,a),O.add(u,u,s),O.add(u,u,n),Oe.setTranslation(C,u),Oe.mul(C,y.cell.fromFractional,C),Oe.mul(C,C,y.cell.toFractional),O.sub(c,a,s);const I=b-c[0],S=v-c[1],w=_-c[2];return St.create(`${g+1}_${5+I}${5+S}${5+w}`,C,{hkl:O.create(I,S,w),spgrOp:g})}e.getSymmetryOperatorRef=l;function d(y){const g=ql[y[0]],b=ql[y[1]],v=ql[y[2]];return Oe.ofRows([g,b,v,[0,0,0,1]])}function f(y){return[m(h(y[0],y[4],y[8]),p(y[12])),m(h(y[1],y[5],y[9]),p(y[13])),m(h(y[2],y[6],y[10]),p(y[14]))].join(",")}e.getOperatorXyz=f;function h(y,g,b){const v=[];if(y>0?v.push("+X"):y<0&&v.push("-X"),g>0?v.push("+Y"):g<0&&v.push("-Y"),b>0?v.push("+Z"):b<0&&v.push("-Z"),v.length===1)return v[0].charAt(0)==="+"?v[0].substr(1):v[0];if(v.length===2){const _=v[0].charAt(0),A=v[1].charAt(0);if(_==="+")return`${v[0].substr(1)}${v[1]}`;if(A==="+")return`${v[1].substr(1)}${v[0]}`}throw new Error(`unknown rotation '${v}', ${y} ${g} ${b}`)}function p(y){switch(y){case 1/2:return"1/2";case 1/4:return"1/4";case 3/4:return"3/4";case 1/3:return"1/3";case 2/3:return"2/3";case 1/6:return"1/6";case 5/6:return"5/6"}return""}function m(y,g){return g===""?y:y.length>2?`${y}+${g}`:y.charAt(0)==="-"?`${g}${y}`:`${g}+${y}`}})(zn||(zn={}));var gn;(function(e){function t(o,s,a){o.squaredDistances[o.count]=a,o.indices[o.count++]=s}e.add=t;function n(o){o.count=0}e.reset=n;function r(){return{count:0,indices:[],squaredDistances:[]}}e.create=r;function i(o,s){for(let a=0;a<s.count;++a)o.indices[a]=s.indices[a],o.squaredDistances[a]=s.squaredDistances[a];return o.count=s.count,o}e.copy=i})(gn||(gn={}));function Vn(){return Vn.empty()}(function(e){function t(f,h,p,m){return{origin:f,dirA:h,dirB:p,dirC:m}}e.create=t;function n(){return{origin:O(),dirA:O(),dirB:O(),dirC:O()}}e.empty=n;function r(f,h){return O.copy(f.origin,h.origin),O.copy(f.dirA,h.dirA),O.copy(f.dirB,h.dirB),O.copy(f.dirC,h.dirC),f}e.copy=r;function i(f){return r(n(),f)}e.clone=i;function o(f,h){return O.set(f,O.magnitude(h.dirA)*2,O.magnitude(h.dirB)*2,O.magnitude(h.dirC)*2)}e.size=o;const s=O();function a(f){return o(s,f),s[0]*s[1]*s[2]}e.volume=a;function c(f,h){return O.copy(f.origin,h.origin),O.normalize(f.dirA,h.dirA),O.normalize(f.dirB,h.dirB),O.normalize(f.dirC,h.dirC),f}e.normalize=c;const u=Mn();function l(f,h,p){O.transformMat4(f.origin,h.origin,p);const m=Mn.directionTransform(u,p);return O.transformMat3(f.dirA,h.dirA,m),O.transformMat3(f.dirB,h.dirB,m),O.transformMat3(f.dirC,h.dirC,m),f}e.transform=l;function d(f,h,p){return O.scale(f.dirA,h.dirA,p),O.scale(f.dirB,h.dirB,p),O.scale(f.dirC,h.dirC,p),f}e.scale=d})(Vn||(Vn={}));var Xt;(function(e){function t(f,h,p=Float32Array){const m=f*h;return{data:new p(m),size:m,cols:f,rows:h}}e.create=t;function n(f,h,p){return f.data[f.rows*p+h]}e.get=n;function r(f,h,p,m){return f.data[f.rows*p+h]=m,f}e.set=r;function i(f,h,p,m){return f.data[f.rows*p+h]+=m,f}e.add=i;function o(f){return f.data.fill(0),f}e.makeZero=o;function s(f){return{data:f.data.slice(),size:f.size,cols:f.cols,rows:f.rows}}e.clone=s;function a(f,h,p){return{data:f,size:h*p,cols:h,rows:p}}e.fromArray=a;function c(f,h){if(f.cols!==h.rows||f.rows!==h.cols)throw new Error("transpose: matrix dimensions incompatible");if(f.data===h.data)throw new Error("transpose: matrices share memory");const p=h.rows,m=h.cols,y=h.data,g=f.data;for(let b=0,v=0,_=0;b<p;_+=1,v+=m,++b){let A=_;for(let C=0;C<m;A+=p,C++)g[A]=y[v+C]}return f}e.transpose=c;function u(f,h,p){const m=h.cols,y=h.rows,g=p.rows,b=h.data,v=p.data,_=f.data;for(let A=0,C=0,I=0;A<y;C+=m,A++)for(let S=0,w=0;w<g;I++,w++){let R=0,M=C;for(let P=0;P<m;M++,S++,P++)R+=b[M]*v[S];_[I]=R}return f}e.multiplyABt=u;function l(f){const h=f.rows,p=f.cols,m=f.data,y=new Array(p);for(let g=0;g<p;++g)y[g]=0;for(let g=0,b=0;g<h;++g)for(let v=0;v<p;++v,++b)y[v]+=m[b];for(let g=0;g<p;++g)y[g]/=h;return y}e.meanRows=l;function d(f,h){const p=f.rows,m=f.cols,y=f.data;for(let g=0,b=0;g<p;++g)for(let v=0;v<m;++v,++b)y[b]-=h[v];return f}e.subRows=d})(Xt||(Xt={}));function Ul(e,t,n,r){r=e[t],e[t]=e[n],e[n]=r}function U4(e,t){return e=Math.abs(e),t=Math.abs(t),e>t?(t/=e,e*Math.sqrt(1+t*t)):t>0?(e/=t,t*Math.sqrt(1+e*e)):0}const F4=1192092896e-16,L4=1e-37;function G4(e,t,n,r,i,o,s,a){const c=F4*2,u=L4;let l=0,d=0,f=0,h=0;const p=Math.max(o,30);let m=0,y=0,g=0,b=0,v=0,_=0,A=0,C=0,I=0,S=0,w=0,R=0,M=0,P=0,E=0,N=0,q=0,j=4660,z=0,W=0,se=0;const ue=new Float64Array(s<<3);for(;l<s;l++){for(f=0,w=0;f<o;f++)C=e[l*t+f],w+=C*C;if(ue[l]=w,r){for(f=0;f<s;f++)r[l*i+f]=0;r[l*i+l]=1}}for(;h<p;h++){for(v=0,l=0;l<s-1;l++)for(d=l+1;d<s;d++){for(m=l*t|0,y=d*t|0,E=ue[l],N=0,q=ue[d],f=2,N+=e[m]*e[y],N+=e[m+1]*e[y+1];f<o;f++)N+=e[m+f]*e[y+f];if(!(Math.abs(N)<=c*Math.sqrt(E*q))){for(N*=2,R=E-q,M=U4(N,R),R<0?(P=(M-R)*.5,A=Math.sqrt(P/M),_=N/(M*A*2)):(_=Math.sqrt((M+R)/(M*2)),A=N/(M*_*2)),E=0,q=0,f=2,I=_*e[m]+A*e[y],S=-A*e[m]+_*e[y],e[m]=I,e[y]=S,E+=I*I,q+=S*S,I=_*e[m+1]+A*e[y+1],S=-A*e[m+1]+_*e[y+1],e[m+1]=I,e[y+1]=S,E+=I*I,q+=S*S;f<o;f++)I=_*e[m+f]+A*e[y+f],S=-A*e[m+f]+_*e[y+f],e[m+f]=I,e[y+f]=S,E+=I*I,q+=S*S;if(ue[l]=E,ue[d]=q,v=1,r)for(g=l*i|0,b=d*i|0,f=2,I=_*r[g]+A*r[b],S=-A*r[g]+_*r[b],r[g]=I,r[b]=S,I=_*r[g+1]+A*r[b+1],S=-A*r[g+1]+_*r[b+1],r[g+1]=I,r[b+1]=S;f<s;f++)I=_*r[g+f]+A*r[b+f],S=-A*r[g+f]+_*r[b+f],r[g+f]=I,r[b+f]=S}}if(v===0)break}for(l=0;l<s;l++){for(f=0,w=0;f<o;f++)C=e[l*t+f],w+=C*C;ue[l]=Math.sqrt(w)}for(l=0;l<s-1;l++){for(d=l,f=l+1;f<s;f++)ue[d]<ue[f]&&(d=f);if(l!==d&&(Ul(ue,l,d,w),r)){for(f=0;f<o;f++)Ul(e,l*t+f,d*t+f,C);for(f=0;f<s;f++)Ul(r,l*i+f,d*i+f,C)}}for(l=0;l<s;l++)n[l]=ue[l];if(r)for(l=0;l<a;l++){for(w=l<s?ue[l]:0;w<=u;){for(W=1/o,f=0;f<o;f++)j=j*214013+2531011,z=(j>>16&32767&256)!==0?W:-W,e[l*t+f]=z;for(h=0;h<2;h++)for(d=0;d<l;d++){for(w=0,f=0;f<o;f++)w+=e[l*t+f]*e[d*t+f];for(se=0,f=0;f<o;f++)C=e[l*t+f]-w*e[d*t+f],e[l*t+f]=C,se+=Math.abs(C);for(se=se?1/se:0,f=0;f<o;f++)e[l*t+f]*=se}for(w=0,f=0;f<o;f++)C=e[l*t+f],w+=C*C;w=Math.sqrt(w)}for(A=1/w,f=0;f<o;f++)e[l*t+f]*=A}}function H4(e,t,n,r){let i=0,o=0;const s=e.rows,a=e.cols;let c=s,u=a;c<u&&(i=1,o=c,c=u,u=o);const l=Xt.create(c,c),d=Xt.create(1,u),f=Xt.create(u,u);if(i===0)Xt.transpose(l,e);else{for(o=0;o<a*s;o++)l.data[o]=e.data[o];for(;o<u*c;o++)l.data[o]=0}if(G4(l.data,c,d.data,f.data,u,c,u,c),t){for(o=0;o<u;o++)t.data[o]=d.data[o];for(;o<a;o++)t.data[o]=0}i===0?(n&&Xt.transpose(n,l),r&&Xt.transpose(r,f)):(n&&Xt.transpose(n,f),r&&Xt.transpose(r,l))}var xr;(function(e){function t(s){const a=n(s),c=o(s,a);return{momentsAxes:a,boxAxes:c}}e.ofPositions=t;function n(s){if(s.length===3)return Vn.create(O.fromArray(O(),s,0),O.create(1,0,0),O.create(0,1,0),O.create(0,0,1));const a=Xt.fromArray(s,3,s.length/3),c=a.rows,u=c/3,l=Xt.create(3,3),d=Xt.create(1,3),f=Xt.create(3,3),h=Xt.create(3,3),p=Xt.meanRows(a),m=Xt.subRows(Xt.clone(a),p),y=Xt.transpose(Xt.create(c,3),m);Xt.multiplyABt(l,y,y),H4(l,d,f,h);const g=O.create(p[0],p[1],p[2]),b=O.create(f.data[0],f.data[3],f.data[6]),v=O.create(f.data[1],f.data[4],f.data[7]),_=O.create(f.data[2],f.data[5],f.data[8]);return O.scale(b,b,Math.sqrt(d.data[0]/u)),O.scale(v,v,Math.sqrt(d.data[1]/u)),O.scale(_,_,Math.sqrt(d.data[2]/u)),Vn.create(g,b,v,_)}e.calculateMomentsAxes=n;function r(s){const a=Vn.clone(s);return O.magnitude(a.dirC)<Tt&&O.cross(a.dirC,a.dirA,a.dirB),Vn.normalize(a,a)}e.calculateNormalizedAxes=r;const i=O();function o(s,a){if(s.length===3)return Vn.clone(a);let c=-1/0,u=-1/0,l=-1/0,d=-1/0,f=-1/0,h=-1/0;const p=O(),m=O(),y=a.origin,g=r(a);for(let R=0,M=s.length;R<M;R+=3){O.projectPointOnVector(p,O.fromArray(p,s,R),g.dirA,y);const P=O.dot(g.dirA,O.normalize(m,O.sub(m,p,y))),E=O.distance(p,y);P>0?E>c&&(c=E):E>u&&(u=E),O.projectPointOnVector(p,O.fromArray(p,s,R),g.dirB,y);const N=O.dot(g.dirB,O.normalize(m,O.sub(m,p,y))),q=O.distance(p,y);N>0?q>l&&(l=q):q>d&&(d=q),O.projectPointOnVector(p,O.fromArray(p,s,R),g.dirC,y);const j=O.dot(g.dirC,O.normalize(m,O.sub(m,p,y))),z=O.distance(p,y);j>0?z>f&&(f=z):z>h&&(h=z)}const b=O.setMagnitude(O(),g.dirA,(c+u)/2),v=O.setMagnitude(O(),g.dirB,(l+d)/2),_=O.setMagnitude(O(),g.dirC,(f+h)/2),A=O.isFinite(b),C=O.isFinite(v),I=O.isFinite(_),S=O(),w=function(R,M,P){O.copy(i,y),A&&O.scaleAndAdd(i,i,g.dirA,R),C&&O.scaleAndAdd(i,i,g.dirB,M),I&&O.scaleAndAdd(i,i,g.dirC,P),O.add(S,S,i)};return w(c,l,f),w(c,l,-h),w(c,-d,-h),w(c,-d,f),w(-u,-d,-h),w(-u,-d,f),w(-u,l,f),w(-u,l,-h),O.scale(S,S,1/8),Vn.create(S,b,v,_)}e.calculateBoxAxes=o})(xr||(xr={}));function hn(){return hn.zero()}(function(e){function t(P){return P.extrema!==void 0}e.hasExtrema=t;function n(P,E){return{center:P,radius:E}}e.create=n;function r(){return{center:O(),radius:0}}e.zero=r;function i(P){const E=n(O.clone(P.center),P.radius);return t(P)&&(E.extrema=P.extrema.map(N=>O.clone(N))),E}e.clone=i;function o(P,E,N){return O.copy(P.center,E),P.radius=N,P}e.set=o;function s(P,E){return O.copy(P.center,E.center),P.radius=E.radius,t(E)&&a(P,E.extrema.map(N=>O.clone(N))),P}e.copy=s;function a(P,E){return P.extrema!==void 0?(P.extrema.length=0,P.extrema.push(...E)):P.extrema=E,P}e.setExtrema=a;function c(P){const{x:E,y:N,z:q,indices:j}=P;let z=0,W=0,se=0,ue=0;const $=Re.size(j);for(let ne=0;ne<$;ne++){const de=Re.getAt(j,ne);z+=E[de],W+=N[de],se+=q[de]}$>0&&(z/=$,W/=$,se/=$);for(let ne=0;ne<$;ne++){const de=Re.getAt(j,ne),_e=E[de]-z,X=N[de]-W,ce=q[de]-se,k=_e*_e+X*X+ce*ce;k>ue&&(ue=k)}return{center:O.create(z,W,se),radius:Math.sqrt(ue)}}e.computeBounding=c;function u(P,E,N){return O.transformMat4(P.center,E.center,N),P.radius=E.radius*Oe.getMaxScaleOnAxis(N),t(E)&&a(P,E.extrema.map(q=>O.transformMat4(O(),q,N))),P}e.transform=u;function l(P,E,N){return O.add(P.center,E.center,N),t(E)&&a(P,E.extrema.map(q=>O.add(O(),q,N))),P}e.translate=l;function d(P,E,N){return O.toArray(P.center,E,N),E[N+3]=P.radius,E}e.toArray=d;function f(P,E,N){return O.fromArray(P.center,E,N),P.radius=E[N+3],P}e.fromArray=f;function h(P,E){return O.scale(P.center,O.add(P.center,E.max,E.min),.5),P.radius=O.distance(P.center,E.max),e.setExtrema(P,[O.create(E.min[0],E.min[1],E.min[2]),O.create(E.max[0],E.max[1],E.max[2]),O.create(E.max[0],E.min[1],E.min[2]),O.create(E.min[0],E.max[1],E.max[2]),O.create(E.min[0],E.min[1],E.max[2]),O.create(E.max[0],E.min[1],E.max[2]),O.create(E.max[0],E.max[1],E.min[2]),O.create(E.min[0],E.max[1],E.min[2])]),P}e.fromBox3D=h;function p(P,E){return O.copy(P.center,E.origin),P.radius=Math.max(O.magnitude(E.dirA),O.magnitude(E.dirB),O.magnitude(E.dirC)),P}e.fromAxes3D=p;const m=O();function y(P,E,N){const[q,j,z]=E,W=O.create(0,0,0);O.transformMat4(W,W,N);const se=O.create(q,j,z);O.transformMat4(se,se,N);const ue=O.create(q,0,0);O.transformMat4(ue,ue,N);const $=O.create(0,j,z);O.transformMat4($,$,N);const ne=O.create(0,0,z);O.transformMat4(ne,ne,N);const de=O.create(q,0,z);O.transformMat4(de,de,N);const _e=O.create(q,j,0);O.transformMat4(_e,_e,N);const X=O.create(0,j,0);O.transformMat4(X,X,N),O.add(m,W,se),O.scale(m,m,.5);const ce=Math.max(O.distance(W,se),O.distance(ue,$));return e.set(P,m,ce/2),e.setExtrema(P,[W,se,ue,$,ne,de,_e,X]),P}e.fromDimensionsAndTransform=y;const g=O();function b(P,E,N){return O.distance(E.center,N)<E.radius?e.copy(P,E):(O.sub(g,E.center,N),O.sub(g,E.center,g),O.setMagnitude(g,g,E.radius),O.scale(P.center,O.add(g,g,N),.5),P.radius=O.distance(P.center,N),P)}e.addVec3=b;function v(P,E,N){return O.copy(P.center,E.center),P.radius=Math.max(E.radius,O.distance(E.center,N.center)+N.radius),t(E)&&t(N)&&a(P,[...E.extrema.map(q=>O.clone(q)),...N.extrema.map(q=>O.clone(q))]),P}e.expandBySphere=v;const _=O();function A(P,E,N){var q,j;if(O.copy(P.center,E.center),P.radius=E.radius+N,E.radius<1e-12||((j=(q=E.extrema)===null||q===void 0?void 0:q.length)!==null&&j!==void 0?j:0)<=1)return P.extrema=void 0,P;if(t(E)){const z=new Float32Array(E.extrema.length*3);for(let se=0;se<E.extrema.length;se++)O.toArray(E.extrema[se],z,se*3);const W=xr.calculateMomentsAxes(z);Vn.scale(W,Vn.normalize(W,W),N),a(P,E.extrema.map(se=>{O.normalize(_,O.sub(_,se,E.center));const ue=O.clone(se),$=O.dot(_,W.dirA)<0?-1:1;O.scaleAndAdd(ue,ue,W.dirA,$);const ne=O.dot(_,W.dirB)<0?-1:1;O.scaleAndAdd(ue,ue,W.dirB,ne);const de=O.dot(_,W.dirC)<0?-1:1;return O.scaleAndAdd(ue,ue,W.dirC,de),O.distance(P.center,ue)>P.radius&&(E.extrema.length>=14&&O.normalize(_,O.sub(_,ue,E.center)),O.scaleAndAdd(ue,P.center,_,P.radius)),ue}))}return P}e.expand=A;function C(P,E){return P.radius===E.radius&&O.exactEquals(P.center,E.center)}e.exactEquals=C;function I(P,E){const N=P.radius,q=E.radius;return Math.abs(N-q)<=Tt*Math.max(1,Math.abs(N),Math.abs(q))&&O.equals(P.center,E.center)}e.equals=I;function S(P,E){if(t(E)){for(const N of E.extrema)if(O.distance(P.center,N)>P.radius)return!1;return!0}else return O.distance(P.center,E.center)+E.radius<=P.radius}e.includes=S;function w(P,E){return O.distance(P.center,E.center)<=P.radius+E.radius}e.overlaps=w;function R(P,E){return O.distance(P.center,E.center)-P.radius+E.radius}e.distance=R;function M(P,E){const{center:N,radius:q}=P;return O.distance(E,N)-q}e.distanceToVec=M})(hn||(hn={}));function Kn(){return Kn.zero()}(function(e){function t(N,q){return{min:N,max:q}}e.create=t;function n(){return{min:O(),max:O()}}e.zero=n;function r(N,q){return O.copy(N.min,q.min),O.copy(N.max,q.max),N}e.copy=r;function i(N,q,j){return O.copy(N.min,q),O.copy(N.max,j),N}e.set=i;function o(N){return r(n(),N)}e.clone=o;const s=O();function a(N,q){return hn.hasExtrema(q)&&q.extrema.length>=14?u(N,q.extrema):(O.set(s,q.radius,q.radius,q.radius),O.sub(N.min,q.center,s),O.add(N.max,q.center,s),N)}e.fromSphere3D=a;function c(N,q){for(let j=0,z=q.length;j<z;j++)g(N,q[j]);return N}e.addVec3Array=c;function u(N,q){return y(N),c(N,q),N}e.fromVec3Array=u;function l(N,q){return hn.hasExtrema(q)&&q.extrema.length>=14?c(N,q.extrema):(g(N,O.subScalar(s,q.center,q.radius)),g(N,O.addScalar(s,q.center,q.radius)),N)}e.addSphere3D=l;function d(N,q){return O.clamp(s,q.center,N.min,N.max),O.squaredDistance(s,q.center)<=q.radius*q.radius}e.intersectsSphere3D=d;function f(N){const q=O.create(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),j=O.create(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),{x:z,y:W,z:se,indices:ue}=N;for(let $=0,ne=Re.size(ue);$<ne;$++){const de=Re.getAt(ue,$);q[0]=Math.min(z[de],q[0]),q[1]=Math.min(W[de],q[1]),q[2]=Math.min(se[de],q[2]),j[0]=Math.max(z[de],j[0]),j[1]=Math.max(W[de],j[1]),j[2]=Math.max(se[de],j[2])}return{min:q,max:j}}e.computeBounding=f;function h(N,q){return O.sub(N,q.max,q.min)}e.size=h;const p=O();function m(N){return h(p,N),p[0]*p[1]*p[2]}e.volume=m;function y(N){return O.set(N.min,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),O.set(N.max,-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),N}e.setEmpty=y;function g(N,q){return O.min(N.min,N.min,q),O.max(N.max,N.max,q),N}e.add=g;function b(N,q,j){return O.sub(N.min,q.min,j),O.add(N.max,q.max,j),N}e.expand=b;function v(N,q,j){return O.subScalar(N.min,q.min,j),O.addScalar(N.max,q.max,j),N}e.expandUniformly=v;function _(N,q,j){return O.scale(N.min,q.min,j),O.scale(N.max,q.max,j),N}e.scale=_;const A=O();function C(N,q,j){const[z,W,se]=q.min,[ue,$,ne]=q.max;return y(N),g(N,O.transformMat4(A,O.set(A,z,W,se),j)),g(N,O.transformMat4(A,O.set(A,z,W,ne),j)),g(N,O.transformMat4(A,O.set(A,z,$,se),j)),g(N,O.transformMat4(A,O.set(A,z,$,ne),j)),g(N,O.transformMat4(A,O.set(A,ue,W,se),j)),g(N,O.transformMat4(A,O.set(A,ue,W,ne),j)),g(N,O.transformMat4(A,O.set(A,ue,$,se),j)),g(N,O.transformMat4(A,O.set(A,ue,$,ne),j)),N}e.transform=C;function I(N,q){return!(q[0]<N.min[0]||q[0]>N.max[0]||q[1]<N.min[1]||q[1]>N.max[1]||q[2]<N.min[2]||q[2]>N.max[2])}e.containsVec3=I;function S(N,q){return!(N.max[0]<q.min[0]||N.min[0]>q.max[0]||N.max[1]<q.min[1]||N.min[1]>q.max[1]||N.max[2]<q.min[2]||N.min[2]>q.max[2])}e.overlaps=S;function w(N,q){const j=q.center,z=q.radius;return!(j[0]-z<N.min[0]||j[0]+z>N.max[0]||j[1]-z<N.min[1]||j[1]+z>N.max[1]||j[2]-z<N.min[2]||j[2]+z>N.max[2])}e.containsSphere3D=w;function R(N,q,j,z){const[W,se,ue]=q.min,[$,ne,de]=q.max,[_e,X,ce]=j,k=1/z[0],B=1/z[1],F=1/z[2];let re,G,V;return k>=0?re=(W-_e)*k:re=($-_e)*k,B>=0?G=(se-X)*B:G=(ne-X)*B,F>=0?V=(ue-ce)*F:V=(de-ce)*F,G>re&&(re=G),V>re&&(re=V),O.scale(N,z,re),O.set(N,N[0]+_e,N[1]+X,N[2]+ce)}e.nearestIntersectionWithRay=R;function M(N,q){return O.center(N,q.max,q.min)}e.center=M;function P(N,q){return O.exactEquals(N.min,q.min)&&O.exactEquals(N.max,q.max)}e.exactEquals=P;function E(N,q){return O.equals(N.min,q.min)&&O.equals(N.max,q.max)}e.equals=E})(Kn||(Kn={}));let j4=class{constructor(t,n){this.parent=null,this.child=null,this.degree=0,this.isMarked=!1,this.key=t,this.value=n,this.prev=this,this.next=this}};class z4{constructor(t){if(this._index=-1,this._items=[],this._len=0,t){let n=t,r=0;do this._items[r++]=n,n=n.next;while(t!==n);this._len=r}}hasNext(){return this._index<this._len-1}next(){return this._items[++this._index]}reset(t){this._index=-1,this._len=0;let n=t,r=0;do this._items[r++]=n,n=n.next;while(t!==n);this._len=r}}const Fl=new z4;class s2{constructor(t){this._minNode=null,this._nodeCount=0,this._compare=t||this._defaultCompare}clear(){this._minNode=null,this._nodeCount=0}decreaseKey(t,n){if(!t)throw new Error("Cannot decrease key of non-existent node");if(this._compare({key:n},{key:t.key})>0)throw new Error("New key is larger than old key");t.key=n;const r=t.parent;r&&this._compare(t,r)<0&&(this._cut(t,r,this._minNode),this._cascadingCut(r,this._minNode)),this._compare(t,this._minNode)<0&&(this._minNode=t)}delete(t){const n=t.parent;n&&(this._cut(t,n,this._minNode),this._cascadingCut(n,this._minNode)),this._minNode=t,this.extractMinimum()}extractMinimum(){const t=this._minNode;if(t){if(t.child){let r=t.child;do r.parent=null,r=r.next;while(r!==t.child)}let n=null;t.next!==t&&(n=t.next),this._removeNodeFromList(t),this._nodeCount--,this._minNode=this._mergeLists(n,t.child),this._minNode&&(this._minNode=this._consolidate(this._minNode))}return t}findMinimum(){return this._minNode}insert(t,n){const r=new j4(t,n);return this._minNode=this._mergeLists(this._minNode,r),this._nodeCount++,r}isEmpty(){return this._minNode===null}size(){return this._minNode===null?0:this._getNodeListSize(this._minNode)}union(t){this._minNode=this._mergeLists(this._minNode,t._minNode),this._nodeCount+=t._nodeCount}_defaultCompare(t,n){return t.key>n.key?1:t.key<n.key?-1:0}_cut(t,n,r){t.parent=null,n.degree--,t.next===t?n.child=null:n.child=t.next,this._removeNodeFromList(t);const i=this._mergeLists(r,t);return t.isMarked=!1,i}_cascadingCut(t,n){const r=t.parent;return r&&(t.isMarked?(n=this._cut(t,r,n),n=this._cascadingCut(r,n)):t.isMarked=!0),n}_consolidate(t){const n=[];for(Fl.reset(t);Fl.hasNext();){let i=Fl.next(),o=n[i.degree];for(;o;){if(this._compare(i,o)>0){const s=i;i=o,o=s}this._linkHeaps(o,i),n[i.degree]=null,i.degree++,o=n[i.degree]}n[i.degree]=i}let r=null;for(let i=0;i<n.length;i++){const o=n[i];o&&(o.next=o,o.prev=o,r=this._mergeLists(r,o))}return r}_removeNodeFromList(t){const n=t.prev,r=t.next;n.next=r,r.prev=n,t.next=t,t.prev=t}_linkHeaps(t,n){this._removeNodeFromList(t),n.child=this._mergeLists(t,n.child),t.parent=n,t.isMarked=!1}_mergeLists(t,n){if(!t)return n||null;if(!n)return t;const r=t.next;return t.next=n.next,t.next.prev=t,n.next=r,n.next.prev=n,this._compare(t,n)<0?t:n}_getNodeListSize(t){let n=0,r=t;do n++,r.child&&(n+=this._getNodeListSize(r.child)),r=r.next;while(r!==t);return n}}function a2(e){const t=new Map;return n=>{if(t.has(n))return t.get(n);const r=e(n);return t.set(n,r),r}}function ws(e,t,n){return new V4(e,t,n)}class V4{find(t,n,r,i,o){this.ctx.x=t,this.ctx.y=n,this.ctx.z=r,this.ctx.radius=i,this.ctx.isCheck=!1;const s=o??this.result;return u2(this.ctx,s),s}nearest(t,n,r,i=1,o,s){this.ctx.x=t,this.ctx.y=n,this.ctx.z=r,this.ctx.k=i,this.ctx.stopIf=o;const a=s??this.result;return t5(this.ctx,a),a}check(t,n,r,i){return this.ctx.x=t,this.ctx.y=n,this.ctx.z=r,this.ctx.radius=i,this.ctx.isCheck=!0,u2(this.ctx,this.result)}approxNearest(t,n,r,i,o){this.ctx.x=t,this.ctx.y=n,this.ctx.z=r,this.ctx.radius=i,this.ctx.isCheck=!1;const s=o??this.result;return X4(this.ctx,s),s}constructor(t,n,r){const i=$4(t,n,r);this.ctx=Y4(i),this.boundary={box:i.boundingBox,sphere:i.boundingSphere},this.buckets={offset:i.bucketOffset,count:i.bucketCounts,array:i.bucketArray},this.result=gn.create()}}function K4(e){const{expandedBox:t,size:[n,r,i],data:{x:o,y:s,z:a,radius:c,indices:u},elementCount:l,delta:d}=e,f=n*r*i,{min:[h,p,m]}=t;let y=0,g=0;const b=new Uint32Array(f),v=new Int32Array(l);for(let S=0;S<l;S++){const w=Re.getAt(u,S),R=Math.floor((o[w]-h)/d[0]),M=Math.floor((s[w]-p)/d[1]),P=Math.floor((a[w]-m)/d[2]),E=(R*r+M)*i+P;(b[E]+=1)===1&&(g+=1),v[S]=E}if(c)for(let S=0;S<l;S++){const w=Re.getAt(u,S);c[w]>y&&(y=c[w])}const _=new Int32Array(g);for(let S=0,w=0;S<f;S++){const R=b[S];R>0&&(b[S]=w+1,_[w]=R,w+=1)}const A=new Uint32Array(g);for(let S=1;S<g;++S)A[S]+=A[S-1]+_[S-1];const C=new Int32Array(g),I=new Int32Array(l);for(let S=0;S<l;S++){const w=b[v[S]];if(w>0){const R=w-1;I[A[R]+C[R]]=S,C[R]+=1}}return{size:e.size,bucketArray:I,bucketCounts:_,bucketOffset:A,grid:b,delta:d,min:e.expandedBox.min,data:e.data,maxRadius:y,expandedBox:e.expandedBox,boundingBox:e.boundingBox,boundingSphere:e.boundingSphere}}const c2=2**24;function $4(e,t,n){const r=Kn.expand(Kn(),t.box,O.create(.5,.5,.5)),{indices:i}=e,o=Kn.size(O(),r);let s,a;const c=Re.size(i),u=typeof n=="number"?n:32,l=Array.isArray(n)&&n;if(l&&!O.isZero(l))a=[Math.ceil(o[0]/l[0]),Math.ceil(o[1]/l[1]),Math.ceil(o[2]/l[2])],s=l;else if(c>0){const p=Math.ceil(c/u),m=Math.pow(p/(o[0]*o[1]*o[2]),1/3);a=[Math.ceil(o[0]*m),Math.ceil(o[1]*m),Math.ceil(o[2]*m)],s=[o[0]/a[0],o[1]/a[1],o[2]/a[2]]}else s=o,a=[1,1,1];const d=a[0]*a[1]*a[2];if(d>c2){const p=Math.cbrt(d/c2);a=[Math.ceil(a[0]/p),Math.ceil(a[1]/p),Math.ceil(a[2]/p)],s=[o[0]/a[0],o[1]/a[1],o[2]/a[2]]}const f={x:e.x,y:e.y,z:e.z,indices:i,radius:e.radius},h={size:a,data:f,expandedBox:r,boundingBox:t.box,boundingSphere:t.sphere,elementCount:c,delta:s};return K4(h)}function Y4(e){return{grid:e,x:.1,y:.1,z:.1,k:1,stopIf:void 0,radius:.1,isCheck:!1}}function u2(e,t){const{min:n,size:[r,i,o],bucketOffset:s,bucketCounts:a,bucketArray:c,grid:u,data:{x:l,y:d,z:f,indices:h,radius:p},delta:m,maxRadius:y}=e.grid,{radius:g,isCheck:b,x:v,y:_,z:A}=e,C=g+y,I=C*C;gn.reset(t);const S=Math.max(0,Math.floor((v-C-n[0])/m[0])),w=Math.max(0,Math.floor((_-C-n[1])/m[1])),R=Math.max(0,Math.floor((A-C-n[2])/m[2])),M=Math.min(r-1,Math.floor((v+C-n[0])/m[0])),P=Math.min(i-1,Math.floor((_+C-n[1])/m[1])),E=Math.min(o-1,Math.floor((A+C-n[2])/m[2]));if(S>M||w>P||R>E)return!1;for(let N=S;N<=M;N++)for(let q=w;q<=P;q++)for(let j=R;j<=E;j++){const z=u[(N*i+q)*o+j];if(z===0)continue;const W=z-1,se=s[W],ue=a[W],$=se+ue;for(let ne=se;ne<$;ne++){const de=Re.getAt(h,c[ne]),_e=l[de]-v,X=d[de]-_,ce=f[de]-A,k=_e*_e+X*X+ce*ce;if(k<=I){if(y>0&&Math.sqrt(k)-p[de]>g)continue;if(b)return!0;gn.add(t,c[ne],k)}}}return t.count>0}function W4(e){const t=[],n=e*2+1;for(let r=0;r<n;++r)for(let i=0;i<n;++i)for(let o=0;o<n;++o)t.push(O.create(r-e,i-e,o-e));return t.sort((r,i)=>O.squaredMagnitude(r)-O.squaredMagnitude(i)),t.flat()}const Z4=a2(W4);function X4(e,t){const{min:n,size:[r,i,o],bucketOffset:s,bucketCounts:a,bucketArray:c,grid:u,data:{x:l,y:d,z:f,indices:h},delta:p}=e.grid,{radius:m,x:y,y:g,z:b}=e,v=m*m;gn.reset(t);const _=Math.max(0,Math.floor((y-m-n[0])/p[0])),A=Math.max(0,Math.floor((g-m-n[1])/p[1])),C=Math.max(0,Math.floor((b-m-n[2])/p[2])),I=Math.min(r-1,Math.floor((y+m-n[0])/p[0])),S=Math.min(i-1,Math.floor((g+m-n[1])/p[1])),w=Math.min(o-1,Math.floor((b+m-n[2])/p[2]));if(_>I||A>S||C>w)return!1;const R=Math.floor((y-n[0])/p[0]),M=Math.floor((g-n[1])/p[1]),P=Math.floor((b-n[2])/p[2]),E=Z4(Math.max(I-_,S-A,w-C)+1);for(let N=0,q=E.length;N<q;N+=3){const j=R+E[N],z=M+E[N+1],W=P+E[N+2];if(j<_||j>I||z<A||z>S||W<C||W>w)continue;const se=u[(j*i+z)*o+W];if(se===0)continue;const ue=se-1,$=s[ue],ne=a[ue],de=$+ne;let _e=Number.MAX_VALUE;for(let X=$;X<de;X++){const ce=Re.getAt(h,c[X]),k=l[ce]-y,B=d[ce]-g,F=f[ce]-b,re=k*k+B*B+F*F;re<=v&&re<_e&&(gn.add(t,c[X],re),_e=re)}if(_e!==Number.MAX_VALUE)return!0}return t.count>0}const l2=O(),Or=O(),xo=new Set,Ll=new Set,Q4=[.1],J4=[.1],e5=[.1],Li=new s2;function t5(e,t){const{min:n,expandedBox:r,boundingSphere:{center:i},size:[o,s,a],bucketOffset:c,bucketCounts:u,bucketArray:l,grid:d,data:{x:f,y:h,z:p,indices:m,radius:y},delta:g,maxRadius:b}=e.grid,{x:v,y:_,z:A,k:C,stopIf:I}=e,S=Re.size(m);if(gn.reset(t),S===0||C<=0)return!1;let w,R,M,P=!1,E=1,N=!0,q=0,j=Q4,z=J4,W=0,se=!0,ue,$=!1;const ne=e5,de=b*b;j.length=0,ne.length=0,xo.clear(),Li.clear(),O.set(Or,v,_,A),Kn.containsVec3(r,Or)?(w=Math.floor((v-n[0])/g[0]),R=Math.floor((_-n[1])/g[1]),M=Math.floor((A-n[2])/g[2])):(Kn.nearestIntersectionWithRay(Or,r,Or,O.normalize(l2,O.sub(l2,i,Or))),w=Math.max(0,Math.min(o-1,Math.floor((Or[0]-n[0])/g[0]))),R=Math.max(0,Math.min(s-1,Math.floor((Or[1]-n[1])/g[1]))),M=Math.max(0,Math.min(a-1,Math.floor((Or[2]-n[2])/g[2]))));const _e=b!==0?Math.max(1,Math.min(o-1,Math.ceil(b/g[0]))):1,X=b!==0?Math.max(1,Math.min(s-1,Math.ceil(b/g[1]))):1,ce=b!==0?Math.max(1,Math.min(a-1,Math.ceil(b/g[2]))):1;for(j.push(w,R,M,(w*s+R)*a+M);t.count<S;){const k=E*4;for(let B=0;B<k;B+=4)if(ue=j[B+3],!xo.has(ue)){xo.add(ue),$=xo.size>=d.length;const F=d[ue];if(F!==0){const re=W,G=F-1,V=c[G],K=u[G],Q=V+K;for(let Z=V;Z<Q;Z++){const ie=l[Z],L=Re.getAt(m,ie),U=f[L]-v,Y=h[L]-_,fe=p[L]-A;let me=U*U+Y*Y+fe*fe;if(b!==0){const Te=y[L];me-=Te*Te}se&&me>W&&(W=me),Li.insert(me,ie)}re<W&&(se=!1)}}z.length=0,q=0,Ll.clear();for(let B=0;B<k;B+=4){w=j[B],R=j[B+1],M=j[B+2];for(let F=-_e;F<=_e;F++){const re=w+F;if(!(re<0||re>=o))for(let G=-X;G<=X;G++){const V=R+G;if(!(V<0||V>=s))for(let K=-ce;K<=ce;K++){const Q=M+K;if(!(Q<0||Q>=a)&&(ue=(re*s+V)*a+Q,!Ll.has(ue)&&(Ll.add(ue),!xo.has(ue)))){if(!N){const Z=n[0]+re*g[0]-v,ie=n[1]+V*g[1]-_,L=n[2]+Q*g[2]-A;if(Z*Z+ie*ie+L*L-de>W){ne.push(re,V,Q,ue);continue}}z.push(re,V,Q,ue),q++}}}}}if(N=!1,q===0){if(C===1){const B=Li.findMinimum();if(B){const{key:F,value:re}=B;return gn.add(t,re,F),!0}}else for(;!Li.isEmpty()&&($||Li.findMinimum().key<=W)&&t.count<C;){const B=Li.extractMinimum(),F=B.key,re=B.value;gn.add(t,re,F),I&&!P&&(P=I(re,F))}if(t.count>=C||P||t.count>=S)return t.count>0;if(N=!0,se=!0,ne.length>0){for(let B=0,F=ne.length;B<F;B++)j.push(ne[B]);ne.length=0,E=j.length}}else{const B=j;j=z,z=B,E=q}}return t.count>0}var Ze;(function(e){function t(h,p,m){return{kind:"element-location",structure:h,unit:p,element:m||0}}e.create=t;function n(h){return t(h.structure,h.unit,h.element)}e.clone=n;function r(h,p,m,y){return p&&(h.structure=p),m&&(h.unit=m),y!==void 0&&(h.element=y),h}e.set=r;function i(h,p){return h.unit=p.unit,h.element=p.element,h}e.copy=i;function o(h){return!!h&&h.kind==="element-location"}e.is=o;function s(h,p){return h.unit===p.unit&&h.element===p.element}e.areEqual=s;const a=O(),c=O();function u(h,p){return h.unit.conformation.position(h.element,a),p.unit.conformation.position(p.element,c),O.distance(a,c)}e.distance=u;function l(h,p){return p.unit.conformation.position(p.element,h)}e.position=l;function d(h){return h.unit.model.atomicHierarchy.residueAtomSegments.index[h.element]}e.residueIndex=d;function f(h){return h.unit.model.atomicHierarchy.chainAtomSegments.index[h.element]}e.chainIndex=f})(Ze||(Ze={}));class n5{add(t){const n=this.getHash(t);if(this.byHash.has(n)){const r=this.byHash.get(n);for(let i=0,o=r.length;i<o;i++)if(this.areEqual(t,r[i]))return!1;return r[r.length]=t,this.size++,!0}else return this.byHash.set(n,[t]),this.size++,!0}has(t){const n=this.getHash(t);if(!this.byHash.has(n))return!1;const r=this.byHash.get(n);for(let i=0,o=r.length;i<o;i++)if(this.areEqual(t,r[i]))return!0;return!1}constructor(t,n){this.getHash=t,this.areEqual=n,this.size=0,this.byHash=new Map}}function r5(e,t){return new n5(e,t)}var mn;(function(e){function t(){return{keys:new Set,array:[]}}e.create=t;function n({keys:i,array:o},s,a){return i.has(s)?!1:(i.add(s),o[o.length]=a,!0)}e.add=n;function r({keys:i},o){return i.has(o)}e.has=r})(mn||(mn={}));var oe;(function(e){function t(a,c,u){return{kind:"variable",name:a,type:c,isConstraint:u}}e.Variable=t;function n(a,c,u){return{kind:"value",namespace:a,name:c,parent:u}}e.Value=n;function r(a,c,u,l){return{kind:"container",namespace:a,name:c,child:u,alias:l}}e.Container=r;function i(a){return{kind:"union",types:a}}e.Union=i;function o(a,c,u,l){const d=Object.create(null);for(const f of l)d[f]=!0;return{kind:"oneof",namespace:a,name:c,type:u,values:d}}e.OneOf=o,e.Any={kind:"any"},e.AnyValue={kind:"any-value"},e.Num=n("","Number"),e.Str=n("","String"),e.Bool=o("","Bool",e.Str,["true","false"]);function s({values:a}){return Object.keys(a).sort()}e.oneOfValues=s})(oe||(oe={}));var kr;(function(e){function t(c){return{name:c}}e.Symbol=t;function n(c,u){return u?{head:c,args:u}:{head:c}}e.Apply=n;function r(c){return!!c&&Array.isArray(c)}e.isArgumentsArray=r;function i(c){return!!c&&!Array.isArray(c)}e.isArgumentsMap=i;function o(c){return!s(c)&&!a(c)}e.isLiteral=o;function s(c){return!!c&&!!c.head&&typeof c=="object"}e.isApply=s;function a(c){return!!c&&typeof c.name=="string"}e.isSymbol=a})(kr||(kr={}));function xe(e,t){const{description:n=void 0,isOptional:r=!1,isRest:i=!1,defaultValue:o=void 0}=t||{};return{type:e,isOptional:r,isRest:i,defaultValue:o,description:n}}var je;(function(e){e.None=t({});function t(r){return{kind:"dictionary",map:r,"@type":0}}e.Dictionary=t;function n(r,i){const{nonEmpty:o=!1}=i||{};return{kind:"list",type:r,nonEmpty:o,"@type":0}}e.List=n})(je||(je={}));function i5(e,t,n,r){const i=function(o){return kr.Apply(kr.Symbol(i.id),o)};return i.info={namespace:"",name:e,description:r},i.id="",i.args=t,i.type=n,i}function Ps(e){const t=e;return typeof t=="function"&&!!t.info&&!!t.args&&typeof t.info.namespace=="string"&&!!t.type}function ze(e,t,n){return i5("",e,t,n)}function f2(e){m2("","",e)}function d2(e){const t=[];return p2(e,t),t}function h2(e){const t=/([a-z])([A-Z])([a-z]|$)/g;return e.replace(t,(n,r,i,o)=>`${r}-${i.toLocaleLowerCase()}${o}`).replace(t,(n,r,i,o)=>`${r}-${i.toLocaleLowerCase()}${o}`)}function m2(e,t,n){if(Ps(n)){n.info.namespace=e,n.info.name=n.info.name||h2(t),n.id=`${n.info.namespace}.${n.info.name}`;return}const r=`${n["@namespace"]||h2(t)}`,i=e?`${e}.${r}`:r;for(const o of Object.keys(n))typeof n[o]!="object"&&!Ps(n[o])||m2(i,o,n[o])}function p2(e,t){if(Ps(e)){t.push(e);return}for(const n of Object.keys(e))typeof e[n]!="object"&&!Ps(e[n])||p2(e[n],t)}var rt;(function(e){e.AnyVar=oe.Variable("a",oe.Any),e.AnyValueVar=oe.Variable("a",oe.Any),e.ConstrainedVar=oe.Variable("a",oe.Any,!0),e.Regex=oe.Value("Core","Regex"),e.Set=t=>oe.Container("Core","Set",t||e.AnyValueVar),e.List=t=>oe.Container("Core","List",t||e.AnyVar),e.Fn=(t,n)=>oe.Container("Core","Fn",t||e.AnyVar,n),e.Flags=(t,n)=>oe.Container("Core","Flags",t,n),e.BitFlags=e.Flags(oe.Num,"BitFlags")})(rt||(rt={}));function Qt(e,t){return ze(je.Dictionary({0:xe(e)}),e,t)}function qr(e,t){return ze(je.List(e,{nonEmpty:!0}),e,t)}function qn(e,t,n){return ze(je.Dictionary({0:xe(e),1:xe(e)}),t,n)}je.Dictionary({0:xe(oe.Num),1:xe(oe.Num)});const o5={"@header":"Types",bool:ze(je.Dictionary({0:xe(oe.AnyValue)}),oe.Bool,"Convert a value to boolean."),num:ze(je.Dictionary({0:xe(oe.AnyValue)}),oe.Num,"Convert a value to number."),str:ze(je.Dictionary({0:xe(oe.AnyValue)}),oe.Str,"Convert a value to string."),regex:ze(je.Dictionary({0:xe(oe.Str,{description:"Expression"}),1:xe(oe.Str,{isOptional:!0,description:"Flags, e.g. 'i' for ignore case"})}),rt.Regex,"Creates a regular expression from a string using the ECMAscript syntax."),list:ze(je.List(rt.AnyVar),rt.List()),set:ze(je.List(rt.AnyValueVar),rt.Set()),bitflags:ze(je.Dictionary({0:xe(oe.Num)}),rt.BitFlags,"Interpret a number as bitflags."),compositeKey:ze(je.List(oe.AnyValue),oe.AnyValue)},s5={"@header":"Logic",not:Qt(oe.Bool),and:qr(oe.Bool),or:qr(oe.Bool)},a5={"@header":"Control",eval:ze(je.Dictionary({0:xe(rt.Fn(rt.AnyVar))}),rt.AnyVar,"Evaluate a function."),fn:ze(je.Dictionary({0:xe(rt.AnyVar)}),rt.Fn(rt.AnyVar),'Wrap an expression to a "lazy" function.'),if:ze(je.Dictionary({0:xe(oe.Bool,{description:"Condition"}),1:xe(oe.Variable("a",oe.Any),{description:"If true"}),2:xe(oe.Variable("b",oe.Any),{description:"If false"})}),oe.Union([oe.Variable("a",oe.Any),oe.Variable("b",oe.Any)])),assoc:ze(je.Dictionary({0:xe(oe.Str,{description:"Name"}),1:xe(oe.Variable("a",oe.Any),{description:"Value to assign"})}),oe.Variable("a",oe.Any))},c5={"@header":"Relational",eq:qn(oe.Variable("a",oe.AnyValue,!0),oe.Bool),neq:qn(oe.Variable("a",oe.AnyValue,!0),oe.Bool),lt:qn(oe.Num,oe.Bool),lte:qn(oe.Num,oe.Bool),gr:qn(oe.Num,oe.Bool),gre:qn(oe.Num,oe.Bool),inRange:ze(je.Dictionary({0:xe(oe.Num,{description:"Value to test"}),1:xe(oe.Num,{description:"Minimum value"}),2:xe(oe.Num,{description:"Maximum value"})}),oe.Bool,"Check if the value of the 1st argument is >= 2nd and <= 3rd.")},u5={"@header":"Math",add:qr(oe.Num),sub:qr(oe.Num),mult:qr(oe.Num),div:qn(oe.Num,oe.Num),pow:qn(oe.Num,oe.Num),mod:qn(oe.Num,oe.Num),min:qr(oe.Num),max:qr(oe.Num),cantorPairing:qn(oe.Num,oe.Num),sortedCantorPairing:qn(oe.Num,oe.Num),invertCantorPairing:ze(je.Dictionary({0:xe(oe.Num)}),rt.List(oe.Num)),floor:Qt(oe.Num),ceil:Qt(oe.Num),roundInt:Qt(oe.Num),trunc:Qt(oe.Num),abs:Qt(oe.Num),sign:Qt(oe.Num),sqrt:Qt(oe.Num),cbrt:Qt(oe.Num),sin:Qt(oe.Num),cos:Qt(oe.Num),tan:Qt(oe.Num),asin:Qt(oe.Num),acos:Qt(oe.Num),atan:Qt(oe.Num),sinh:Qt(oe.Num),cosh:Qt(oe.Num),tanh:Qt(oe.Num),exp:Qt(oe.Num),log:Qt(oe.Num),log10:Qt(oe.Num),atan2:qn(oe.Num,oe.Num)},l5={"@header":"Strings",concat:qr(oe.Str),match:ze(je.Dictionary({0:xe(rt.Regex),1:xe(oe.Str)}),oe.Bool)},f5={"@header":"Lists",getAt:ze(je.Dictionary({0:xe(rt.List()),1:xe(oe.Num)}),rt.AnyVar),equal:ze(je.Dictionary({0:xe(rt.List()),1:xe(rt.List())}),oe.Bool)},d5={"@header":"Sets",has:ze(je.Dictionary({0:xe(rt.Set(rt.ConstrainedVar)),1:xe(rt.ConstrainedVar)}),oe.Bool,"Check if the the 1st argument includes the value of the 2nd."),isSubset:ze(je.Dictionary({0:xe(rt.Set(rt.ConstrainedVar)),1:xe(rt.Set(rt.ConstrainedVar))}),oe.Bool,"Check if the the 1st argument is a subset of the 2nd.")},h5={"@header":"Flags",hasAny:ze(je.Dictionary({0:xe(rt.Flags(rt.ConstrainedVar)),1:xe(rt.Flags(rt.ConstrainedVar))}),oe.Bool,"Check if the the 1st argument has at least one of the 2nd one's flags."),hasAll:ze(je.Dictionary({0:xe(rt.Flags(rt.ConstrainedVar)),1:xe(rt.Flags(rt.ConstrainedVar))}),oe.Bool,"Check if the the 1st argument has all 2nd one's flags.")},Gl={"@header":"Language Primitives",type:o5,logic:s5,ctrl:a5,rel:c5,math:u5,str:l5,list:f5,set:d5,flags:h5};f2(Gl);const m5=d2(Gl);(function(){const e=Object.create(null);for(const t of m5)e[t.id]=t;return e})();var ke;(function(e){e.ElementSymbol=oe.Value("Structure","ElementSymbol"),e.AtomName=oe.Value("Structure","AtomName"),e.BondFlag=oe.OneOf("Structure","BondFlag",oe.Str,["covalent","metallic","ion","hydrogen","sulfide","computed","aromatic"]),e.BondFlags=rt.Flags(e.BondFlag,"BondFlags"),e.SecondaryStructureFlag=oe.OneOf("Structure","SecondaryStructureFlag",oe.Str,["alpha","beta","3-10","pi","sheet","strand","helix","turn","none"]),e.SecondaryStructureFlags=rt.Flags(e.SecondaryStructureFlag,"SecondaryStructureFlag"),e.RingFingerprint=oe.Value("Structure","RingFingerprint"),e.EntityType=oe.OneOf("Structure","EntityType",oe.Str,["polymer","non-polymer","water","branched"]),e.EntitySubtype=oe.OneOf("Structure","EntitySubtype",oe.Str,["other","polypeptide(D)","polypeptide(L)","polydeoxyribonucleotide","polyribonucleotide","polydeoxyribonucleotide/polyribonucleotide hybrid","cyclic-pseudo-peptide","peptide nucleic acid","oligosaccharide"]),e.ObjectPrimitive=oe.OneOf("Structure","ObjectPrimitive",oe.Str,["atomistic","sphere","gaussian","other"]),e.ResidueId=oe.Value("Structure","ResidueId"),e.ElementSet=oe.Value("Structure","ElementSet"),e.ElementSelection=oe.Value("Structure","ElementSelection"),e.ElementReference=oe.Value("Structure","ElementReference"),e.ElementSelectionQuery=rt.Fn(e.ElementSelection,"ElementSelectionQuery")})(ke||(ke={}));const p5={"@header":"Types",elementSymbol:ze(je.Dictionary({0:xe(oe.Str)}),ke.ElementSymbol,"Create element symbol representation from a string value."),atomName:ze(je.Dictionary({0:xe(oe.AnyValue)}),ke.AtomName,"Convert a value to an atom name."),entityType:ze(je.Dictionary({0:xe(ke.EntityType)}),ke.EntityType,`Create normalized representation of entity type: ${oe.oneOfValues(ke.EntityType).join(", ")}.`),bondFlags:ze(je.List(ke.BondFlag),ke.BondFlags,`Create bond flags representation from a list of strings. Allowed flags: ${oe.oneOfValues(ke.BondFlag).join(", ")}.`),ringFingerprint:ze(je.List(ke.ElementSymbol,{nonEmpty:!0}),ke.RingFingerprint,"Create ring fingerprint from the supplied atom element list."),secondaryStructureFlags:ze(je.List(ke.SecondaryStructureFlag),ke.SecondaryStructureFlags,`Create secondary structure flags representation from a list of strings. Allowed flags: ${oe.oneOfValues(ke.SecondaryStructureFlag).join(", ")}.`),authResidueId:ze(je.Dictionary({0:xe(oe.Str,{description:"auth_asym_id"}),1:xe(oe.Num,{description:"auth_seq_id"}),2:xe(oe.Str,{description:"pdbx_PDB_ins_code",isOptional:!0})}),ke.ResidueId,'Residue identifier based on "auth_" annotation.'),labelResidueId:ze(je.Dictionary({0:xe(oe.Str,{description:"label_entity_id"}),1:xe(oe.Str,{description:"label_asym_id"}),2:xe(oe.Num,{description:"label_seq_id"}),3:xe(oe.Str,{description:"pdbx_PDB_ins_code",isOptional:!0})}),ke.ResidueId,`Residue identifier based on mmCIF's "label_" annotation.`)},_5={"@header":"Iteration Slots",element:ze(je.None,ke.ElementReference,"A reference to the current element."),elementSetReduce:ze(je.None,oe.Variable("a",oe.AnyValue,!0),"Current value of the element set reducer.")},y5={"@header":"Generators",all:ze(je.None,ke.ElementSelectionQuery,"The entire structure."),atomGroups:ze(je.Dictionary({"entity-test":xe(oe.Bool,{isOptional:!0,defaultValue:!0,description:"Test for the 1st atom of every entity"}),"chain-test":xe(oe.Bool,{isOptional:!0,defaultValue:!0,description:"Test for the 1st atom of every chain"}),"residue-test":xe(oe.Bool,{isOptional:!0,defaultValue:!0,description:"Test for the 1st atom every residue"}),"atom-test":xe(oe.Bool,{isOptional:!0,defaultValue:!0}),"group-by":xe(oe.Any,{isOptional:!0,defaultValue:"atom-key",description:"Group atoms to sets based on this property. Default: each atom has its own set"})}),ke.ElementSelectionQuery,"Return all atoms for which the tests are satisfied, grouped into sets."),bondedAtomicPairs:ze(je.Dictionary({0:xe(oe.Bool,{isOptional:!0,defaultValue:"true for covalent bonds",description:"Test each bond with this predicate. Each bond is visited twice with swapped atom order."})}),ke.ElementSelectionQuery,"Return all pairs of atoms for which the test is satisfied."),rings:ze(je.Dictionary({fingerprint:xe(ke.RingFingerprint,{isOptional:!0}),"only-aromatic":xe(oe.Bool,{isOptional:!0,defaultValue:!1})}),ke.ElementSelectionQuery,"Return all rings or those with the specified fingerprint and/or only aromatic rings."),queryInSelection:ze(je.Dictionary({0:xe(ke.ElementSelectionQuery),query:xe(ke.ElementSelectionQuery),"in-complement":xe(oe.Bool,{isOptional:!0,defaultValue:!1})}),ke.ElementSelectionQuery,"Executes query only on atoms that are in the source selection."),empty:ze(je.None,ke.ElementSelectionQuery,"Nada.")},g5={"@header":"Selection Modifications",queryEach:ze(je.Dictionary({0:xe(ke.ElementSelectionQuery),query:xe(ke.ElementSelectionQuery)}),ke.ElementSelectionQuery,"Query every atom set in the input selection separately."),intersectBy:ze(je.Dictionary({0:xe(ke.ElementSelectionQuery),by:xe(ke.ElementSelectionQuery)}),ke.ElementSelectionQuery,"Intersect each atom set from the first sequence from atoms in the second one."),exceptBy:ze(je.Dictionary({0:xe(ke.ElementSelectionQuery),by:xe(ke.ElementSelectionQuery)}),ke.ElementSelectionQuery,"Remove all atoms from 'selection' that occur in 'by'."),unionBy:ze(je.Dictionary({0:xe(ke.ElementSelectionQuery),by:xe(ke.ElementSelectionQuery)}),ke.ElementSelectionQuery,"For each atom set A in the orginal sequence, combine all atoms sets in the target selection that intersect with A."),union:ze(je.Dictionary({0:xe(ke.ElementSelectionQuery)}),ke.ElementSelectionQuery,"Collects all atom sets in the sequence into a single atom set."),cluster:ze(je.Dictionary({0:xe(ke.ElementSelectionQuery),"min-distance":xe(oe.Num,{isOptional:!0,defaultValue:0}),"max-distance":xe(oe.Num),"min-size":xe(oe.Num,{description:"Minimal number of sets to merge, must be at least 2",isOptional:!0,defaultValue:2}),"max-size":xe(oe.Num,{description:"Maximal number of sets to merge, if not set, no limit",isOptional:!0})}),ke.ElementSelectionQuery,"Combines atom sets that have mutual distance in the interval [min-radius, max-radius]. Minimum/maximum size determines how many atom sets can be combined."),includeSurroundings:ze(je.Dictionary({0:xe(ke.ElementSelectionQuery),radius:xe(oe.Num),"atom-radius":xe(oe.Num,{isOptional:!0,defaultValue:0,description:"Value added to each atom before the distance check, for example VDW radius. Using this argument is computationally demanding."}),"as-whole-residues":xe(oe.Bool,{isOptional:!0})}),ke.ElementSelectionQuery,"For each atom set in the selection, include all surrouding atoms/residues that are within the specified radius."),surroundingLigands:ze(je.Dictionary({0:xe(ke.ElementSelectionQuery),radius:xe(oe.Num),"include-water":xe(oe.Bool,{isOptional:!0,defaultValue:!0})}),ke.ElementSelectionQuery,"Find all ligands components around the source query."),includeConnected:ze(je.Dictionary({0:xe(ke.ElementSelectionQuery),"bond-test":xe(oe.Bool,{isOptional:!0,defaultValue:"true for covalent bonds"}),"layer-count":xe(oe.Num,{isOptional:!0,defaultValue:1,description:"Number of bonded layers to include."}),"fixed-point":xe(oe.Bool,{isOptional:!0,defaultValue:!1,description:"Continue adding layers as long as new connections exist."}),"as-whole-residues":xe(oe.Bool,{isOptional:!0})}),ke.ElementSelectionQuery,"Pick all atom sets that are connected to the target."),wholeResidues:ze(je.Dictionary({0:xe(ke.ElementSelectionQuery)}),ke.ElementSelectionQuery,"Expand the selection to whole residues."),expandProperty:ze(je.Dictionary({0:xe(ke.ElementSelectionQuery),property:xe(oe.AnyValue)}),ke.ElementSelectionQuery,"To each atom set in the selection, add all atoms that have the same property value that was already present in the set.")},b5={"@header":"Selection Filters",pick:ze(je.Dictionary({0:xe(ke.ElementSelectionQuery),test:xe(oe.Bool)}),ke.ElementSelectionQuery,"Pick all atom sets that satisfy the test."),first:ze(je.Dictionary({0:xe(ke.ElementSelectionQuery)}),ke.ElementSelectionQuery,"Take the 1st atom set in the sequence."),withSameAtomProperties:ze(je.Dictionary({0:xe(ke.ElementSelectionQuery),source:xe(ke.ElementSelectionQuery),property:xe(oe.Any)}),ke.ElementSelectionQuery,"Pick all atom sets for which the set of given atom properties is a subset of the source properties."),intersectedBy:ze(je.Dictionary({0:xe(ke.ElementSelectionQuery),by:xe(ke.ElementSelectionQuery)}),ke.ElementSelectionQuery,"Pick all atom sets that have non-zero intersection with the target."),within:ze(je.Dictionary({0:xe(ke.ElementSelectionQuery),target:xe(ke.ElementSelectionQuery),"min-radius":xe(oe.Num,{isOptional:!0,defaultValue:0}),"max-radius":xe(oe.Num),"atom-radius":xe(oe.Num,{isOptional:!0,defaultValue:0,description:"Value added to each atom before the distance check, for example VDW radius. Using this argument is computationally demanding."}),invert:xe(oe.Bool,{isOptional:!0,defaultValue:!1,description:"If true, pick only atom sets that are further than the specified radius."})}),ke.ElementSelectionQuery,"Pick all atom sets from selection that have any atom within the radius of any atom from target."),isConnectedTo:ze(je.Dictionary({0:xe(ke.ElementSelectionQuery),target:xe(ke.ElementSelectionQuery),"bond-test":xe(oe.Bool,{isOptional:!0,defaultValue:"true for covalent bonds"}),disjunct:xe(oe.Bool,{isOptional:!0,defaultValue:!0,description:"If true, there must exist a bond to an atom that lies outside the given atom set to pass test."}),invert:xe(oe.Bool,{isOptional:!0,defaultValue:!1,description:"If true, return atom sets that are not connected."})}),ke.ElementSelectionQuery,"Pick all atom sets that are connected to the target.")},v5={"@header":"Selection Combinators",intersect:ze(je.List(ke.ElementSelectionQuery),ke.ElementSelectionQuery,"Return all unique atom sets that appear in all of the source selections."),merge:ze(je.List(ke.ElementSelectionQuery),ke.ElementSelectionQuery,"Merges multiple selections into a single one. Only unique atom sets are kept."),distanceCluster:ze(je.Dictionary({matrix:xe(rt.List(rt.List(oe.Num)),{description:"Distance matrix, represented as list of rows (num[][])). Lower triangle is min distance, upper triangle is max distance."}),selections:xe(rt.List(ke.ElementSelectionQuery),{description:"A list of held selections."})}),ke.ElementSelectionQuery,"Pick combinations of atom sets from the source sequences that are mutually within distances specified by a matrix.")},x5={"@header":"Atom Sets",atomCount:ze(je.None,oe.Num),countQuery:ze(je.Dictionary({0:xe(ke.ElementSelectionQuery)}),oe.Num,"Counts the number of occurences of a specific query inside the current atom set."),reduce:ze(je.Dictionary({initial:xe(oe.Variable("a",oe.AnyValue,!0),{description:"Initial value assigned to slot.atom-set-reduce. Current atom is set to the 1st atom of the current set for this."}),value:xe(oe.Variable("a",oe.AnyValue,!0),{description:"Expression executed for each atom in the set"})}),oe.Variable("a",oe.AnyValue,!0),"Execute the value expression for each atom in the current atom set and return the result. Works the same way as Array.reduce in JavaScript (``result = value(value(...value(initial)))``)"),propertySet:ze(je.Dictionary({0:xe(rt.ConstrainedVar)}),rt.Set(rt.ConstrainedVar),"Returns a set with all values of the given property in the current atom set.")},A5={"@header":"Atom Properties",core:{"@header":"Core Properties",elementSymbol:tt(ke.ElementSymbol),vdw:tt(oe.Num,"Van der Waals radius"),mass:tt(oe.Num,"Atomic weight"),atomicNumber:tt(oe.Num,"Atomic number"),x:tt(oe.Num,"Cartesian X coordinate"),y:tt(oe.Num,"Cartesian Y coordinate"),z:tt(oe.Num,"Cartesian Z coordinate"),atomKey:tt(oe.AnyValue,"Unique value for each atom. Main use case is grouping of atoms."),bondCount:ze(je.Dictionary({0:xe(ke.ElementReference,{isOptional:!0,defaultValue:"slot.current-atom"}),flags:xe(ke.BondFlags,{isOptional:!0,defaultValue:"covalent"})}),oe.Num,"Number of bonds (by default only covalent bonds are counted)."),sourceIndex:tt(oe.Num,"Index of the atom/element in the input file."),operatorName:tt(oe.Str,"Name of the symmetry operator applied to this element."),operatorKey:tt(oe.Num,"Key of the symmetry operator applied to this element."),modelIndex:tt(oe.Num,"Index of the model in the input file."),modelLabel:tt(oe.Str,"Label/header of the model in the input file.")},topology:{connectedComponentKey:tt(oe.AnyValue,"Unique value for each connected component.")},macromolecular:{"@header":"Macromolecular Properties (derived from the mmCIF format)",authResidueId:tt(ke.ResidueId,"type.auth-residue-id symbol executed on current atom's residue"),labelResidueId:tt(ke.ResidueId,"type.label-residue-id symbol executed on current atom's residue"),residueKey:tt(oe.AnyValue,"Unique value for each tuple ``(label_entity_id,auth_asym_id, auth_seq_id, pdbx_PDB_ins_code)``, main use case is grouping of atoms"),chainKey:tt(oe.AnyValue,"Unique value for each tuple ``(label_entity_id, auth_asym_id)``, main use case is grouping of atoms"),entityKey:tt(oe.AnyValue,"Unique value for each tuple ``label_entity_id``, main use case is grouping of atoms"),isHet:tt(oe.Bool,"Equivalent to atom_site.group_PDB !== ATOM"),id:tt(oe.Num,"_atom_site.id"),label_atom_id:tt(ke.AtomName),label_alt_id:tt(oe.Str),label_comp_id:tt(oe.Str),label_asym_id:tt(oe.Str),label_entity_id:tt(oe.Str),label_seq_id:tt(oe.Num),auth_atom_id:tt(ke.AtomName),auth_comp_id:tt(oe.Str),auth_asym_id:tt(oe.Str),auth_seq_id:tt(oe.Num),pdbx_PDB_ins_code:tt(oe.Str),pdbx_formal_charge:tt(oe.Num),occupancy:tt(oe.Num),B_iso_or_equiv:tt(oe.Num),entityType:tt(ke.EntityType,"Type of the entity as defined in mmCIF (polymer, non-polymer, branched, water)"),entitySubtype:tt(ke.EntitySubtype,"Subtype of the entity as defined in mmCIF _entity_poly.type and _pdbx_entity_branch.type (other, polypeptide(D), polypeptide(L), polydeoxyribonucleotide, polyribonucleotide, polydeoxyribonucleotide/polyribonucleotide hybrid, cyclic-pseudo-peptide, peptide nucleic acid, oligosaccharide)"),entityPrdId:tt(oe.Str,"The PRD ID of the entity."),entityDescription:tt(rt.List(oe.Str)),objectPrimitive:tt(ke.ObjectPrimitive,"Type of the primitive object used to model this segment as defined in mmCIF/IHM (atomistic, sphere, gaussian, other)"),secondaryStructureKey:tt(oe.AnyValue,"Unique value for each secondary structure element."),secondaryStructureFlags:tt(ke.SecondaryStructureFlags),isModified:tt(oe.Bool,"True if the atom belongs to modification of a standard residue."),modifiedParentName:tt(oe.Str,"'3-letter' code of the modifed parent residue."),isNonStandard:tt(oe.Bool,"True if this is a non-standard residue."),chemCompType:tt(oe.Str,"Type of the chemical component as defined in mmCIF.")},ihm:{hasSeqId:ze(je.Dictionary({0:xe(oe.Num)}),oe.Bool,"Checks if the current element represents a given sequence id"),overlapsSeqIdRange:ze(je.Dictionary({beg:xe(oe.Num),end:xe(oe.Num)}),oe.Bool,"Checks if the current element overlaps with the specified residue range")}},S5={"@header":"Bond Properties",flags:Gi(ke.BondFlags),order:Gi(oe.Num),key:Gi(oe.Num),length:Gi(oe.Num),atomA:Gi(ke.ElementReference),atomB:Gi(ke.ElementReference)};function tt(e,t){return ze(je.Dictionary({0:xe(ke.ElementReference,{isOptional:!0,defaultValue:"slot.current-atom"})}),e,t)}function Gi(e,t){return ze(je.None,e,t)}const C5={"@header":"Structure Queries",type:p5,slot:_5,generator:y5,modifier:g5,filter:b5,combinator:v5,atomSet:x5,atomProperty:A5,bondProperty:S5},I5={"@header":"Internal Queries",generator:{"@header":"Generators",bundleElement:ze(je.Dictionary({groupedUnits:xe(oe.Any),set:xe(oe.Any),ranges:xe(oe.Any)}),oe.Any),bundle:ze(je.Dictionary({elements:xe(oe.Any)}),ke.ElementSelectionQuery,"A selection with single structure containing represented by the bundle."),current:ze(je.None,ke.ElementSelectionQuery,"Current selection provided by the query context. Avoid using this in State Transforms.")}},Ao={core:Gl,structureQuery:C5,internal:I5};f2(Ao);const w5=d2(Ao);(function(){const e=Object.create(null);for(const t of w5)e[t.id]=t;return e})();var ut;(function(e){e.core=Ao.core,e.struct=Ao.structureQuery,e.internal=Ao.internal;function t(b){return e.struct.type.atomName([b])}e.atomName=t;function n(b){return e.struct.type.elementSymbol([b])}e.es=n;function r(...b){return e.core.type.list(b)}e.list=r;function i(...b){return e.core.type.set(b)}e.set=i;function o(b,v){return e.core.type.regex([b,v])}e.re=o;function s(b){return e.core.ctrl.fn([b])}e.fn=s;function a(b){return e.core.ctrl.eval([b])}e.evaluate=a;const c=e.struct.atomProperty.core,u=e.struct.atomProperty.macromolecular,l=e.struct.atomProperty.topology;function d(b){return c[b]()}e.acp=d;function f(b){return l[b]()}e.atp=f;function h(b){return u[b]()}e.ammp=h;const p=e.struct.atomSet.propertySet;function m(b){return p([d(b)])}e.acpSet=m;function y(b){return p([f(b)])}e.atpSet=y;function g(b){return p([h(b)])}e.ammpSet=g})(ut||(ut={}));function Un(){return Un.zero()}(function(e){function t(){const P=[.1,0,0];return P[0]=0,P}e.zero=t;function n(P,E,N){const q=t();return q[0]=P,q[1]=E,q[2]=N,q}e.create=n;function r(P,E,N,q){return P[0]=E,P[1]=N,P[2]=q,P}e.set=r;function i(P,E){const N=E[0]-P[0],q=E[1]-P[1],j=E[2]-P[2];return Math.sqrt(N*N+q*q+j*j)}e.distance=i;function o(P,E){const[N,q,j]=ar.toRgb(E),[z,W,se]=M(N,q,j),ue=116*W-16;return P[0]=ue<0?0:ue,P[1]=500*(z-W),P[2]=200*(W-se),P}e.fromColor=o;function s(P,E){return Ar.toLab(P,E)}e.fromHcl=s;function a(P){let E=(P[0]+16)/116,N=isNaN(P[1])?E:E+P[1]/500,q=isNaN(P[2])?E:E-P[2]/200;E=g*S(E),N=y*S(N),q=b*S(q);const j=I(3.2404542*N-1.5371385*E-.4985314*q),z=I(-.969266*N+1.8760108*E+.041556*q),W=I(.0556434*N-.2040259*E+1.0572252*q);return ar.fromRgb(Math.round(Pr(j,0,255)),Math.round(Pr(z,0,255)),Math.round(Pr(W,0,255)))}e.toColor=a;function c(P,E){const[N,q,j]=E,z=Math.sqrt(q*q+j*j);let W=(Qr(Math.atan2(j,q))+360)%360;return Math.round(z*1e4)===0&&(W=Number.NaN),P[0]=W,P[1]=z,P[2]=N,P}e.toHcl=c;function u(P,E){return P[0]=E[0],P[1]=E[1],P[2]=E[2],P}e.copy=u;function l(P,E,N){return P[0]=E[0]-m*N,P[1]=E[1],P[2]=E[2],P}e.darken=l;function d(P,E,N){return l(P,E,-N)}e.lighten=d;const f=[0,0,0];function h(P,E,N){return c(f,E),Ar.toLab(P,Ar.saturate(f,f,N))}e.saturate=h;function p(P,E,N){return h(P,E,-N)}e.desaturate=p;const m=18,y=.95047,g=1,b=1.08883,v=.137931034,_=.206896552,A=.12841855,C=.008856452;function I(P){return 255*(P<=.00304?12.92*P:1.055*Math.pow(P,1/2.4)-.055)}function S(P){return P>_?P*P*P:A*(P-v)}function w(P){return(P/=255)<=.04045?P/12.92:Math.pow((P+.055)/1.055,2.4)}function R(P){return P>C?Math.pow(P,1/3):P/A+v}function M(P,E,N){P=w(P),E=w(E),N=w(N);const q=R((.4124564*P+.3575761*E+.1804375*N)/y),j=R((.2126729*P+.7151522*E+.072175*N)/g),z=R((.0193339*P+.119192*E+.9503041*N)/b);return[q,j,z]}})(Un||(Un={}));function Ar(){return Ar.zero()}(function(e){function t(){const b=[.1,0,0];return b[0]=0,b}e.zero=t;function n(b,v,_){const A=t();return A[0]=b,A[1]=v,A[2]=_,A}e.create=n;function r(b,v,_,A){return b[0]=v,b[1]=_,b[2]=A,b}e.set=r;function i(b){return!isNaN(b[0])}e.hasHue=i;const o=[0,0,0];function s(b,v){return Un.toHcl(b,Un.fromColor(o,v))}e.fromColor=s;function a(b,v){return Un.toHcl(b,v)}e.fromLab=a;const c=[0,0,0];function u(b){return Un.toColor(l(c,b))}e.toColor=u;function l(b,v){let[_,A,C]=v;return isNaN(_)&&(_=0),_=Er(_),b[0]=C,b[1]=Math.cos(_)*A,b[2]=Math.sin(_)*A,b}e.toLab=l;function d(b,v){return b[0]=v[0],b[1]=v[1],b[2]=v[2],b}e.copy=d;function f(b,v,_){return b[0]=v[0],b[1]=Math.max(0,v[1]+g*_),b[2]=v[2],b}e.saturate=f;function h(b,v,_){return f(b,v,-_)}e.desaturate=h;const p=[0,0,0];function m(b,v,_){return l(p,v),Un.toHcl(b,Un.darken(p,p,_))}e.darken=m;function y(b,v,_){return m(b,v,-_)}e.lighten=y;const g=18})(Ar||(Ar={}));function ar(e){return e}(function(e){function t(j){return`rgb(${j>>16&255}, ${j>>8&255}, ${j&255})`}e.toStyle=t;function n(j){return"#"+("000000"+j.toString(16)).slice(-6)}e.toHexStyle=n;function r(j){return"0x"+("000000"+j.toString(16)).slice(-6)}e.toHexString=r;function i(j){return`RGB: ${e.toRgb(j).join(", ")}`}e.toRgbString=i;function o(j){return[j>>16&255,j>>8&255,j&255]}e.toRgb=o;function s(j){return[(j>>16&255)/255,(j>>8&255)/255,(j&255)/255]}e.toRgbNormalized=s;function a(j){return parseInt(j.replace("#","0x"))}e.fromHexStyle=a;function c(j){return parseInt(j)}e.fromHexString=c;function u(j,z,W){return j<<16|z<<8|W}e.fromRgb=u;function l(j,z,W){return j*255<<16|z*255<<8|W*255}e.fromNormalizedRgb=l;function d(j,z){return u(j[z],j[z+1],j[z+2])}e.fromArray=d;function f(j,z){return l(j[z],j[z+1],j[z+2])}e.fromNormalizedArray=f;function h(j,z,W){return z[W]=j>>16&255,z[W+1]=j>>8&255,z[W+2]=j&255,z}e.toArray=h;function p(j,z,W){return z[W]=(j>>16&255)/255,z[W+1]=(j>>8&255)/255,z[W+2]=(j&255)/255,z}e.toArrayNormalized=p;function m(j,z){return j[0]=z>>16&255,j[1]=z>>8&255,j[2]=z&255,j}e.toVec3=m;function y(j,z){return j[0]=(z>>16&255)/255,j[1]=(z>>8&255)/255,j[2]=(z&255)/255,j}e.toVec3Normalized=y;function g(j,z,W){const se=j>>16&255,ue=j>>8&255,$=j&255,ne=z>>16&255,de=z>>8&255,_e=z&255,X=se+(ne-se)*W,ce=ue+(de-ue)*W,k=$+(_e-$)*W;return X<<16|ce<<8|k}e.interpolate=g;function b(j){const z=j>>16&255,W=j>>8&255,se=j&255;return z!==W||z!==se}e.hasHue=b;const v=[0,0,0];function _(j,z){return b(j)?(Ar.fromColor(v,j),Ar.toColor(Ar.saturate(v,v,z))):j}e.saturate=_;function A(j,z){return _(j,-z)}e.desaturate=A;const C=[0,0,0];function I(j,z){return Un.fromColor(C,j),Un.toColor(Un.darken(C,C,z))}e.darken=I;function S(j,z){return I(j,-z)}e.lighten=S;function w(j){return j<=.03928?j/12.92:Math.pow((j+.055)/1.055,2.4)}function R(j){const z=w((j>>16&255)/255),W=w((j>>8&255)/255),se=w((j&255)/255);return .2126*z+.7152*W+.0722*se}e.luminance=R;function M(j,z){const W=R(j),se=R(z);return W>se?(W+.05)/(se+.05):(se+.05)/(W+.05)}e.contrast=M;function P(j){return j<.04045?j*.0773993808:Math.pow(j*.9478672986+.0521327014,2.4)}function E(j){return l(P((j>>16&255)/255),P((j>>8&255)/255),P((j&255)/255))}e.sRGBToLinear=E;function N(j){return j<.0031308?j*12.92:1.055*Math.pow(j,.41666)-.055}function q(j){return l(N((j>>16&255)/255),N((j>>8&255)/255),N((j&255)/255))}e.linearToSRGB=q})(ar||(ar={}));function it(e,t,n,r){return{label:e,description:n,list:r,type:t}}function I8(e){return e}function P5(e,t=" "){return e.replace(/([a-z\xE0-\xFF])([A-Z\xC0\xDF])/g,`$1${t}$2`)}const E5=e=>e.toUpperCase();function _2(e){return e.toLowerCase().replace(/^\w|\s\w/g,E5)}function B5(e){return e.replace(/_/g," ")}function R5(e){return e.replace(/-/g," ")}function So(e){return _2(P5(B5(R5(e))))}function Ut(e,t,n,r){const i=r.length;if(i>n-t)return!1;for(let o=0;o<i;o++)if(e.charCodeAt(t+o)!==r.charCodeAt(o))return!1;return!0}const Sr={"orange-red":it("Orange-Red","sequential","Orange-Red, sequential color scheme from ColorBrewer 2.0",[16775148,16705736,16635038,16628612,16551257,15689032,14102559,11730944,8323072]),"purple-blue":it("Purple-Blue","sequential","Purple-Blue, sequential color scheme from ColorBrewer 2.0",[16775163,15525874,13685222,10927579,7645647,3576e3,356528,285325,145496]),"blue-purple":it("Blue-Purple","sequential","Blue-Purple, sequential color scheme from ColorBrewer 2.0",[16252157,14740724,12571622,10403034,9213638,9202609,8929693,8458108,5046347]),oranges:it("Oranges","sequential","",[16774635,16705230,16634018,16625259,16616764,15821075,14239745,10892803,8333060]),"blue-green":it("Blue-Green","sequential","",[16252157,15070713,13429990,10082505,6734500,4304502,2329413,27948,17435]),"yellow-orange-brown":it("Yellow-Orange-Brown","sequential","",[16777189,16775100,16704401,16696399,16685353,15495188,13388802,10040324,6694150]),"yellow-green":it("Yellow-Green","sequential","",[16777189,16252089,14282915,11394446,7915129,4303709,2327619,26679,17705]),reds:it("Reds","sequential","",[16774640,16703698,16563105,16552562,16476746,15678252,13309981,10817301,6750221]),"red-purple":it("Red-Purple","sequential","",[16775155,16638173,16565696,16424885,16214177,14496919,11403646,7995767,4784234]),greens:it("Greens","sequential","",[16252149,15070688,13101504,10607003,7652470,4303709,2329413,27948,17435]),"yellow-green-blue":it("Yellow-Green-Blue","sequential","",[16777177,15595697,13101492,8375739,4306628,1937856,2252456,2438292,531800]),purples:it("Purples","sequential","",[16579581,15724021,14342891,12369372,10394312,8420794,6967715,5515151,4128893]),"green-blue":it("Green-Blue","sequential","",[16252144,14742491,13429701,11066805,8113348,5157843,2854078,551084,540801]),greys:it("Greys","sequential","",[16777215,15790320,14277081,12434877,9868950,7566195,5395026,2434341,0]),"yellow-orange-red":it("Yellow-Orange-Red","sequential","",[16777164,16772512,16701814,16691788,16616764,16535082,14883356,12386342,8388646]),"purple-red":it("Purple-Red","sequential","",[16250105,15196655,13941210,13210823,14640560,15149450,13505110,9961539,6750239]),blues:it("Blues","sequential","",[16251903,14609399,13032431,10406625,7057110,4362950,2191797,545180,536683]),"purple-blue-green":it("Purple-Blue-Green","sequential","",[16775163,15524592,13685222,10927579,6793679,3576e3,164234,93273,83510]),spectral:it("Spectral","diverging","",[10355010,13975119,16018755,16625249,16703627,16777151,15136152,11263396,6734501,3311805,6180770]),"red-yellow-green":it("Red-Yellow-Green","diverging","",[10813478,14102567,16018755,16625249,16703627,16777151,14282635,10934634,6733155,1742928,26679]),"red-blue":it("Red-Blue","diverging","",[6750239,11671595,14049357,16033154,16636871,16250871,13755888,9618910,4428739,2188972,340065]),"pink-yellow-green":it("Pink-Yellow-Green","diverging","",[9306450,12917629,14579630,15840986,16638191,16250871,15136208,12116358,8371265,5083681,2581529]),"purple-green":it("Purple-Green","diverging","",[4194379,7744131,10055851,12756431,15193320,16250871,14282963,10935200,5942881,1800247,17435]),"red-yellow-blue":it("Red-Yellow-Blue","diverging","Red-Yellow-Blue, diverging color scheme from ColorBrewer 2.0",[10813478,14102567,16018755,16625249,16703632,16777151,14742520,11262441,7646673,4552116,3225237]),"brown-white-green":it("Brown-White-Green","diverging","",[5517317,9195786,12550445,14664317,16181443,16119285,13101797,8441281,3512207,91742,15408]),"red-grey":it("Red-Grey","diverging","",[6750239,11671595,14049357,16033154,16636871,16777215,14737632,12237498,8882055,5066061,1710618]),"orange-purple":it("Orange-Purple","diverging","",[8338184,11753478,14713364,16627811,16703670,16250871,14211819,11709394,8418220,5515144,2949195]),"set-2":it("Set-2","qualitative","",[6734501,16551266,9281739,15174339,10934356,16767279,15058068,11776947]),accent:it("Accent","qualitative","",[8374655,12496596,16629894,16777113,3697840,15729279,12540695,6710886]),"set-1":it("Set-1","qualitative","",[14948892,3636920,5091146,9981603,16744192,16777011,10901032,16220607,10066329]),"set-3":it("Set-3","qualitative","",[9294791,16777139,12499674,16482418,8434131,16626786,11787881,16567781,14277081,12353725,13429701,16772463]),"dark-2":it("Dark-2","qualitative","",[1810039,14245634,7696563,15149450,6727198,15117058,10909213,6710886]),paired:it("Paired","qualitative","",[10931939,2062516,11722634,3383340,16489113,14883356,16629615,16744192,13284054,6962586,16777113,11622696]),"pastel-2":it("Pastel-2","qualitative","",[11789005,16633260,13358568,16042724,15136201,16773806,15852236,13421772]),"pastel-1":it("Pastel-1","qualitative","",[16495790,11783651,13429701,14601188,16701862,16777164,15063229,16636652,15921906]),"many-distinct":it("Many-Distinct","qualitative","",[1810039,14245634,7696563,15149450,6727198,15117058,10909213,6710886,14948892,3636920,5091146,9981603,16744192,16777011,10901032,16220607,10066329,6734501,16551266,9281739,15174339,10934356,16767279,15058068,11776947]),magma:it("Magma","sequential","Perceptually uniform shades of black-red-white",[4329332,4853881,5378684,5903742,6363263,6888576,7413633,7938689,8463745,8988801,9513600,10038655,10563454,11088508,11613562,12138360,12728949,13254258,13714030,14239338,14699366,15094114,15489119,15753309,16017499,16216411,16350045,16483424,16551523,16619368,16621934,16689780,16692091,16694402,16696969,16633746,16636058,16638371,16575148,16577461,16514239]),inferno:it("Inferno","sequential","Perceptually uniform shades of black-red-yellow",[4721514,5246316,5771373,6296430,6821486,7346542,7871597,8396651,8921450,9446504,9971557,10496610,10956127,11481435,12006486,12466258,12926285,13386056,13780802,14241085,14570295,14965297,15229227,15558693,15757342,15956248,16154897,16288267,16421638,16489734,16492043,16494612,16496926,16368426,16305463,16111429,15982678,15853928,15856253,16119953,16580260]),plasma:it("Plasma","sequential","Perceptually uniform shades of blue-red-yellow",[1771148,2426257,3081365,3671193,4195228,4784799,5308834,5833124,6357158,6815911,7340200,7864744,8324007,8783782,9309348,9769377,10164126,10624154,11018902,11413393,11808141,12137352,12466307,12795519,13124730,13453685,13717361,14046573,14309992,14573668,14837344,15035483,15299159,15497299,15695438,15893834,16091974,16224833,16357693,16425017,16557877,16625457,16627245,16629289,16631334,16567845,16438820,16310052,16115494,15921190,15726625]),viridis:it("Viridis","sequential","Perceptually uniform shades of blue-green-yellow",[4524123,4656994,4658793,4726127,4727668,4663929,4599933,4535937,4406404,4276870,4081800,3952010,3822475,3627148,3497356,3302029,3172237,3042446,2912654,2782862,2652814,2523022,2393229,2328973,2198924,2069132,2004874,2005897,2007175,2139525,2337154,2666111,3060348,3520376,4045684,4570991,5227369,5883748,6605661,7392854,8180303,8967495,9819967,10672695,11525166,12443174,13295646,14148121,15000344,15852828,16639780]),cividis:it("Cividis","sequential","Perceptually uniform shades of blue-green-yellow, should look effectively identical to colorblind and non-colorblind users",[11367,12400,537456,1455727,2046574,2571629,3031404,3425388,3754092,4148075,4476779,4805227,5133932,5396844,5725549,5988462,6317166,6580079,6843249,7171698,7434867,7697781,7960951,8289656,8618104,8881272,9209976,9538679,9867127,10195830,10524533,10853235,11181938,11510640,11839343,12168045,12497002,12891240,13219941,13548642,13943134,14271834,14666326,14995025,15389516,15718470,16112703,16507190,16639799]),twilight:it("Twilight","sequential","Perceptually uniform shades of white-blue-black-red-white, cyclic",[14670305,14211037,13554648,12766675,11847630,10993866,10139847,9351365,8628419,8036290,7509952,7048895,6718653,6519739,6386105,6252470,6184114,6181293,6112935,6044831,5976470,5777291,5447293,5052270,4592479,4067665,3674181,3281211,3150646,3543352,4067644,4657728,5379141,6166345,6953549,7741007,8463184,9120336,9777743,10304079,10830671,11291984,11687762,12083541,12348505,12613471,12878439,13077872,13211771,13411209,13545111,13809830,14074293,14338756,14537169,14735067,14801121]),turbo:it("Turbo","sequential","Improved (smooth) rainbow colormap for visualization",[4866485,4872413,4354034,3770361,3120629,2667241,2475736,2611140,3073454,3928216,5109892,6487408,8126047,9829201,11531332,13167162,14605618,15780908,16693543,16753699,16748063,16741916,16146200,15026195,13644558,12198408,10818563,9833728]),rainbow:it("Rainbow","sequential","",[3367393,3516485,16383744,15501073,12526114]),"red-white-blue":it("Red-White-Blue","diverging","",[12526114,16777215,3367393])},y2=Object.keys(Sr).map(e=>[e,Sr[e].label,_2(Sr[e].type)]);y2.filter(e=>Sr[e[0]].type==="diverging"||Sr[e[0]].type==="sequential"),y2.filter(e=>Sr[e[0]].type==="qualitative");function g2(e){return e in Sr?Sr[e]:(console.warn(`unknown color list named '${e}'`),Sr["red-yellow-blue"])}function D5(e,t,n){return{kind:"scale-legend",minLabel:e,maxLabel:t,colors:n}}const N5={domain:[0,1],reverse:!1,listOrName:"red-yellow-blue",minLabel:"",maxLabel:""};var b2;(function(e){function t(c){return r(c,"continuous")}e.create=t;function n(c){return r(c,"discrete")}e.createDiscrete=n;function r(c,u){const{domain:l,reverse:d,listOrName:f}={...N5,...c},h=typeof f=="string"?g2(f).list:f,p=d?h.slice().reverse():h;let m=0,y=0,g=0;function b(I,S){y=I,g=S,m=g-y||1}b(l[0],l[1]);const v=cp(c.minLabel,y.toString()),_=cp(c.maxLabel,g.toString());let A;if(p.every(I=>Array.isArray(I))){const I=[...p];I.sort((M,P)=>M[1]-P[1]);const S=I.map(M=>M[0]),w=ve.ofSortedArray(I.map(M=>M[1])),R=S.length-1;switch(u){case"continuous":A=M=>i(M,S,w,y,R,m);break;case"discrete":A=M=>s(M,S,w,y,R,m);break}}else switch(u){case"continuous":A=I=>o(I,p,y,g,m);break;case"discrete":A=I=>a(I,p,y,g,m);break}return{color:A,colorToArray:(I,S,w)=>{ar.toArray(A(I),S,w)},normalizedColorToArray:(I,S,w)=>{ar.toArrayNormalized(A(I),S,w)},setDomain:b,get legend(){return D5(v,_,p)}}}function i(c,u,l,d,f,h){const p=Pr((c-d)/h,0,1),m=ve.findPredecessorIndex(l,p);if(m===0)return u[d];if(m>f)return u[f];const y=l[m-1],g=l[m],b=Pr((p-y)/(g-y),0,1);return ar.interpolate(u[m-1],u[m],b)}function o(c,u,l,d,f){const h=Math.min(u.length-1,Math.max(0,(c-l)/f*u.length-1)),p=Math.floor(h),m=u[p],y=u[Math.ceil(h)];return ar.interpolate(m,y,h-p)}function s(c,u,l,d,f,h){if(u.length===0)return ar.fromRgb(0,0,0);const p=Pr((c-d)/h,0,1),m=ve.findPredecessorIndex(l,p);return m===0?u[d]:m>f?u[f]:u[m]}function a(c,u,l,d,f){if(u.length===0)return ar.fromRgb(0,0,0);const h=f/u.length;if(c<=l)return u[0];if(c>=d)return u[u.length-1];const p=Math.min(u.length-1,Math.floor((c-l)/h));return u[p]}})(b2||(b2={}));const v2=new Set(["145","147","149","289","291","293","445","475","491","510","604","045","05L","07E","07Y","08U","09X","0AT","0BD","0H0","0HX","0LP","0MK","0NZ","0TS","0UB","0V4","0WK","0XY","0YT","10M","12E","14T","15L","16F","16G","16O","17T","18D","18O","18T","1AR","1BW","1CF","1FT","1GL","1GN","1JB","1LL","1NA","1S3","1S4","1SD","1X4","20S","20X","22O","22S","23V","24S","25E","26M","26O","26Q","26R","26V","26W","26Y","27C","2DG","2DR","2F8","2FG","2FL","2FP","2GL","2GS","2H5","2HA","2M4","2M5","2M8","2OS","2SI","2WP","2WS","32O","34V","38J","3BU","3CM","3DO","3DY","3FM","3GR","3HD","3J3","3J4","3LJ","3LR","3MF","3MG","3MK","3R3","3S6","3SA","3YW","40J","42D","44S","46D","46M","46Z","48Z","49A","49S","49T","49V","4AM","4CQ","4GC","4GL","4GP","4JA","4N2","4NN","4QY","4R1","4RS","4SG","4U0","4U1","4U2","4UZ","4V5","50A","51N","56N","57S","5DI","5GF","5GO","5II","5KQ","5KS","5KT","5KV","5L2","5L3","5LS","5LT","5MM","5N6","5QP","5RP","5SA","5SP","5TH","5TJ","5TK","5TM","61J","62I","64K","66O","6BG","6C2","6DM","6GB","6GP","6GR","6K3","6KH","6KL","6KS","6KU","6KW","6LA","6LS","6LW","6MJ","6MN","6PG","6PY","6PZ","6S2","6SA","6UD","6Y6","6YR","6ZC","73E","79J","7CV","7D1","7GP","7JZ","7K2","7K3","7NU","7SA","83Y","89Y","8B7","8B9","8EX","8GA","8GG","8GP","8I4","8LM","8LR","8OQ","8PK","8S0","8YV","95Z","96O","98U","9AM","9C1","9CD","9GP","9KJ","9MR","9OK","9PG","9QG","9QZ","9RN","9S7","9SG","9SJ","9SM","9SP","9T1","9T7","9VP","9WJ","9WN","9WZ","9YW","A0K","A1AIO","A1H03","A1H0P","A1H0Z","A1H10","A1H1B","A1H1F","A1H1V","A1Q","A2G","A5C","A6P","AAL","AAO","ABC","ABD","ABE","ABF","ABL","AC1","ACG","ACR","ACX","ADA","ADG","ADR","AF1","AFD","AFL","AFO","AFP","AFR","AGC","AGH","AGL","AGR","AH2","AH8","AHG","AHM","AHR","AIG","ALL","ALX","AMG","AMN","AMU","AMV","ANA","AOG","AOS","AQA","ARA","ARB","ARE","ARI","ARW","ASC","ASG","ASO","AXP","AXR","AY9","AZC","B0D","B16","B1H","B1N","B2G","B4G","B6D","B7G","B8D","B9D","BBK","BBV","BCD","BCW","BDF","BDG","BDP","BDR","BDZ","BEM","BFN","BFP","BG6","BG8","BGC","BGL","BGN","BGP","BGS","BHG","BM3","BM7","BMA","BMX","BND","BNG","BNX","BO1","BOG","BQY","BRI","BS7","BTG","BTU","BW3","BWG","BXF","BXP","BXX","BXY","BZD","C3B","C3G","C3X","C4B","C4W","C4X","C5X","CAP","CBF","CBI","CBK","CDR","CE5","CE6","CE8","CEG","CEX","CEY","CEZ","CGF","CJB","CKB","CKP","CNP","CR1","CR6","CRA","CT3","CTO","CTR","CTT","D0N","D1M","D5E","D6G","DAF","DAG","DAN","DDA","DDB","DDL","DEG","DEL","DFR","DFX","DG0","DGC","DGD","DGM","DGO","DGS","DGU","DIG","DJB","DJE","DK4","DKX","DKZ","DL6","DLD","DLF","DLG","DMU","DNO","DO8","DOM","DP5","DPC","DQQ","DQR","DR2","DR3","DR4","DR5","DRI","DSR","DT6","DVC","DYM","E3M","E4P","E5G","EAG","EBG","EBQ","EEN","EEQ","EGA","EJT","EMP","EMZ","EPG","EQP","EQV","ERE","ERI","ETT","EUS","F1P","F1X","F55","F58","F6P","F8X","FBP","FCA","FCB","FCT","FDP","FDQ","FFC","FFX","FIF","FIX","FK9","FKD","FMF","FMO","FNG","FNY","FRU","FSA","FSI","FSM","FSR","FSW","FU4","FUB","FUC","FUD","FUF","FUL","FUY","FVQ","FX1","FYJ","G0S","G16","G1P","G20","G28","G2F","G3F","G3I","G4D","G4S","G6D","G6P","G6S","G7P","G8Z","GAA","GAC","GAD","GAF","GAL","GAT","GBH","GC1","GC4","GC9","GCB","GCD","GCN","GCO","GCS","GCT","GCU","GCV","GCW","GDA","GDL","GE1","GE3","GFP","GIV","GL0","GL1","GL2","GL4","GL5","GL6","GL7","GL9","GLA","GLB","GLC","GLD","GLF","GLG","GLO","GLP","GLS","GLT","GLW","GM0","GMB","GMH","GMT","GMZ","GN1","GN4","GNS","GNX","GP0","GP1","GP4","GPH","GPK","GPM","GPO","GPQ","GPU","GPV","GPW","GQ1","GRF","GRX","GS1","GS4","GS9","GSA","GSD","GTE","GTH","GTK","GTM","GTR","GU0","GU1","GU2","GU3","GU4","GU5","GU6","GU8","GU9","GUF","GUL","GUP","GUZ","GXL","GXV","GYE","GYG","GYP","GYU","GYV","GZL","H1M","H1S","H2P","H3S","H53","H6Q","H6Z","HBZ","HD4","HDL","HMS","HNV","HNW","HSG","HSH","HSJ","HSQ","HSR","HSU","HSX","HSY","HSZ","HTG","HTM","HVC","I57","IAB","IDC","IDF","IDG","IDR","IDS","IDT","IDU","IDX","IDY","IEM","IN1","IPT","ISD","ISL","ISX","IVG","IXD","J5B","JFZ","JHM","JLT","JRV","JS2","JSV","JV4","JVA","JVS","JZR","K5B","K99","KBA","KBG","KD5","KDA","KDB","KDD","KDE","KDF","KDM","KDN","KDO","KDR","KFN","KG1","KGM","KHP","KME","KO1","KO2","KOT","KQC","KTU","L1L","L6N","L6S","L6T","LAG","LAH","LAI","LAK","LAO","LAT","LB2","LBS","LBT","LCN","LDY","LEC","LER","LFC","LFR","LGC","LGU","LKA","LKS","LM2","LMO","LMT","LMU","LNV","LOG","LOX","LPK","LRH","LSM","LTG","LTM","LVO","LVZ","LXB","LXC","LXZ","LZ0","M1F","M1P","M2F","M3M","M3N","M55","M6D","M6P","M7B","M7P","M8C","MA1","MA2","MA3","MA8","MAB","MAF","MAG","MAL","MAN","MAT","MAV","MAW","MBE","MBF","MBG","MCU","MDA","MDP","MFA","MFB","MFU","MG5","MGA","MGC","MGL","MGS","MJJ","MLB","MLR","MMA","MMN","MN0","MNA","MQG","MQT","MRH","MRP","MSX","MTT","MUB","MUG","MUR","MVP","MXY","MXZ","MYG","N1L","N3U","N9S","NA1","NAA","NAG","NBG","NBX","NBY","NDG","NED","NFG","NG1","NG6","NGA","NGB","NGC","NGE","NGF","NGK","NGL","NGR","NGS","NGY","NGZ","NHF","NLC","NM6","NM9","NNG","NOJ","NPF","NSQ","NT1","NTF","NTO","NTP","NXD","NYT","O1G","OAK","OEL","OI7","OPM","ORP","OSU","OTG","OTN","OTU","OX2","P53","P6P","P8E","PA1","PA5","PAV","PDX","PH5","PKM","PNA","PNG","PNJ","PNW","PPC","PRP","PSG","PSJ","PSV","PTQ","PUF","PZU","QDK","QIF","QKH","QPS","QV4","R1P","R1X","R2B","R2G","R5P","RAA","RAE","RAF","RAM","RAO","RAT","RB5","RBL","RCD","RDP","REL","RER","RF5","RG1","RGG","RHA","RHC","RI2","RIB","RIP","RM4","RNS","RNT","ROB","ROR","RP3","RP5","RP6","RPA","RR7","RRJ","RRY","RST","RTG","RTV","RUB","RUG","RUU","RV7","RVG","RVM","RWI","RY7","RZM","S6P","S7P","S81","SA0","SCG","SCR","SDD","SDY","SEJ","SF6","SF9","SFJ","SFU","SG4","SG5","SG6","SG7","SGA","SGC","SGD","SGN","SGS","SHB","SHD","SHG","SI3","SIA","SID","SIO","SIZ","SLB","SLM","SLT","SMD","SN5","SNG","SOE","SOG","SOL","SOR","SR1","SSG","SSH","STW","STZ","SUC","SUP","SUS","SWE","SZZ","T68","T6D","T6P","T6T","TA6","TAG","TCB","TCG","TDG","TEU","TF0","TFU","TGA","TGK","TGR","TGY","TH1","TM5","TM6","TM9","TMR","TMX","TNX","TOA","TOC","TQY","TRE","TRV","TS8","TT7","TTV","TTZ","TU4","TUG","TUJ","TUP","TUR","TVD","TVG","TVM","TVS","TVV","TVY","TW7","TWA","TWD","TWG","TWJ","TWY","TXB","TY6","TYV","U1Y","U2A","U2D","U63","U8V","U97","U9A","U9D","U9G","U9J","U9M","UAP","UBH","UBO","UCD","UDC","UEA","V3M","V3P","V71","VDF","VG1","VJ1","VJ4","VKN","VTB","W9T","WIA","WOO","WT8","WUN","WZ1","WZ2","WZ4","X0X","X1P","X1X","X2F","X2Y","X34","X4S","X5S","X6N","X6X","X6Y","X6Z","XBP","XDP","XDX","XGP","XIL","XIQ","XKJ","XLF","XLS","XMM","XS2","XUL","XXM","XXR","XXX","XY6","XY9","XYB","XYF","XYL","XYP","XYS","XYT","XYZ","YDR","YIO","YJM","YKR","YO5","YX0","YX1","YYB","YYD","YYH","YYJ","YYK","YYM","YYQ","YYR","YZ0","YZT","Z0F","Z15","Z16","Z2D","Z2T","Z3K","Z3L","Z3Q","Z3U","Z4K","Z4R","Z4S","Z4U","Z4V","Z4W","Z4Y","Z57","Z5J","Z5L","Z61","Z6G","Z6H","Z6J","Z6W","Z8H","Z8T","Z9D","Z9E","Z9H","Z9K","Z9L","Z9M","Z9N","Z9W","ZB0","ZB1","ZB2","ZB3","ZCD","ZCZ","ZD0","ZDC","ZDM","ZDO","ZEE","ZEL","ZGE","ZMR","UMQ","SQD"]);var An;(function(e){e[e.FilledSphere=0]="FilledSphere",e[e.FilledCube=1]="FilledCube",e[e.CrossedCube=2]="CrossedCube",e[e.DividedDiamond=3]="DividedDiamond",e[e.FilledCone=4]="FilledCone",e[e.DevidedCone=5]="DevidedCone",e[e.FlatBox=6]="FlatBox",e[e.FilledStar=7]="FilledStar",e[e.FilledDiamond=8]="FilledDiamond",e[e.FlatDiamond=9]="FlatDiamond",e[e.FlatHexagon=10]="FlatHexagon",e[e.Pentagon=11]="Pentagon",e[e.DiamondPrism=12]="DiamondPrism",e[e.PentagonalPrism=13]="PentagonalPrism",e[e.HexagonalPrism=14]="HexagonalPrism",e[e.HeptagonalPrism=15]="HeptagonalPrism"})(An||(An={}));const Le={Blue:37052,Green:42577,Yellow:16765952,Orange:16021792,Pink:16162465,Purple:10830745,LightBlue:9424105,Brown:10582605,Red:15539236,Secondary:15854817};var De;(function(e){e[e.Hexose=0]="Hexose",e[e.HexNAc=1]="HexNAc",e[e.Hexosamine=2]="Hexosamine",e[e.Hexuronate=3]="Hexuronate",e[e.Deoxyhexose=4]="Deoxyhexose",e[e.DeoxyhexNAc=5]="DeoxyhexNAc",e[e.DiDeoxyhexose=6]="DiDeoxyhexose",e[e.Pentose=7]="Pentose",e[e.Deoxynonulosonate=8]="Deoxynonulosonate",e[e.DiDeoxynonulosonate=9]="DiDeoxynonulosonate",e[e.Unknown=10]="Unknown",e[e.Assigned=11]="Assigned"})(De||(De={})),De.Hexose+"",De.HexNAc+"",De.Hexosamine+"",De.Hexuronate+"",De.Deoxyhexose+"",De.DeoxyhexNAc+"",De.DiDeoxyhexose+"",De.Pentose+"",De.Deoxynonulosonate+"",De.DiDeoxynonulosonate+"",De.Unknown+"",De.Assigned+"",De.Hexose+"",An.FilledSphere,De.HexNAc+"",An.FilledCube,De.Hexosamine+"",An.CrossedCube,De.Hexuronate+"",An.DividedDiamond,De.Deoxyhexose+"",An.FilledCone,De.DeoxyhexNAc+"",An.DevidedCone,De.DiDeoxyhexose+"",An.FlatBox,De.Pentose+"",An.FilledStar,De.Deoxynonulosonate+"",An.FilledDiamond,De.DiDeoxynonulosonate+"",An.FlatDiamond,De.Unknown+"",An.FlatHexagon,De.Assigned+"",An.Pentagon;const Hl={abbr:"Unk",name:"Unknown",color:Le.Secondary,type:De.Unknown},Hi=[{abbr:"Glc",name:"Glucose",color:Le.Blue,type:De.Hexose},{abbr:"Man",name:"Mannose",color:Le.Green,type:De.Hexose},{abbr:"Gal",name:"Galactose",color:Le.Yellow,type:De.Hexose},{abbr:"Gul",name:"Gulose",color:Le.Orange,type:De.Hexose},{abbr:"Alt",name:"Altrose",color:Le.Pink,type:De.Hexose},{abbr:"All",name:"Allose",color:Le.Purple,type:De.Hexose},{abbr:"Tal",name:"Talose",color:Le.LightBlue,type:De.Hexose},{abbr:"Ido",name:"Idose",color:Le.Brown,type:De.Hexose},{abbr:"GlcNAc",name:"N-Acetyl Glucosamine",color:Le.Blue,type:De.HexNAc},{abbr:"ManNAc",name:"N-Acetyl Mannosamine",color:Le.Green,type:De.HexNAc},{abbr:"GalNAc",name:"N-Acetyl Galactosamine",color:Le.Yellow,type:De.HexNAc},{abbr:"GulNAc",name:"N-Acetyl Gulosamine",color:Le.Orange,type:De.HexNAc},{abbr:"AltNAc",name:"N-Acetyl Altrosamine",color:Le.Pink,type:De.HexNAc},{abbr:"AllNAc",name:"N-Acetyl Allosamine",color:Le.Purple,type:De.HexNAc},{abbr:"TalNAc",name:"N-Acetyl Talosamine",color:Le.LightBlue,type:De.HexNAc},{abbr:"IdoNAc",name:"N-Acetyl Idosamine",color:Le.Brown,type:De.HexNAc},{abbr:"GlcN",name:"Glucosamine",color:Le.Blue,type:De.Hexosamine},{abbr:"ManN",name:"Mannosamine",color:Le.Green,type:De.Hexosamine},{abbr:"GalN",name:"Galactosamine",color:Le.Yellow,type:De.Hexosamine},{abbr:"GulN",name:"Gulosamine",color:Le.Orange,type:De.Hexosamine},{abbr:"AltN",name:"Altrosamine",color:Le.Pink,type:De.Hexosamine},{abbr:"AllN",name:"Allosamine",color:Le.Purple,type:De.Hexosamine},{abbr:"TalN",name:"Talosamine",color:Le.LightBlue,type:De.Hexosamine},{abbr:"IdoN",name:"Idosamine",color:Le.Brown,type:De.Hexosamine},{abbr:"GlcA",name:"Glucuronic Acid",color:Le.Blue,type:De.Hexuronate},{abbr:"ManA",name:"Mannuronic Acid",color:Le.Green,type:De.Hexuronate},{abbr:"GalA",name:"Galacturonic Acid",color:Le.Yellow,type:De.Hexuronate},{abbr:"GulA",name:"Guluronic Acid",color:Le.Orange,type:De.Hexuronate},{abbr:"AltA",name:"Altruronic Acid",color:Le.Pink,type:De.Hexuronate},{abbr:"AllA",name:"Alluronic Acid",color:Le.Purple,type:De.Hexuronate},{abbr:"TalA",name:"Taluronic Acid",color:Le.LightBlue,type:De.Hexuronate},{abbr:"IdoA",name:"Iduronic Acid",color:Le.Brown,type:De.Hexuronate},{abbr:"Qui",name:"Quinovose",color:Le.Blue,type:De.Deoxyhexose},{abbr:"Rha",name:"Rhamnose",color:Le.Green,type:De.Deoxyhexose},{abbr:"6dGul",name:"6-Deoxy Gulose",color:Le.Orange,type:De.Deoxyhexose},{abbr:"6dAlt",name:"6-Deoxy Altrose",color:Le.Pink,type:De.Deoxyhexose},{abbr:"6dTal",name:"6-Deoxy Talose",color:Le.LightBlue,type:De.Deoxyhexose},{abbr:"Fuc",name:"Fucose",color:Le.Red,type:De.Deoxyhexose},{abbr:"QuiNAc",name:"N-Acetyl Quinovosamine",color:Le.Blue,type:De.DeoxyhexNAc},{abbr:"RhaNAc",name:"N-Acetyl Rhamnosamine",color:Le.Green,type:De.DeoxyhexNAc},{abbr:"6dAltNAc",name:"N-Acetyl 6-Deoxy Altrosamine",color:Le.Pink,type:De.DeoxyhexNAc},{abbr:"6dTalNAc",name:"N-Acetyl 6-Deoxy Talosamine",color:Le.LightBlue,type:De.DeoxyhexNAc},{abbr:"FucNAc",name:"N-Acetyl Fucosamine",color:Le.Red,type:De.DeoxyhexNAc},{abbr:"Oli",name:"Olivose",color:Le.Blue,type:De.DiDeoxyhexose},{abbr:"Tyv",name:"Tyvelose",color:Le.Green,type:De.DiDeoxyhexose},{abbr:"Abe",name:"Abequose",color:Le.Orange,type:De.DiDeoxyhexose},{abbr:"Par",name:"Paratose",color:Le.Pink,type:De.DiDeoxyhexose},{abbr:"Dig",name:"Digitoxose",color:Le.Purple,type:De.DiDeoxyhexose},{abbr:"Col",name:"Colitose",color:Le.LightBlue,type:De.DiDeoxyhexose},{abbr:"Ara",name:"Arabinose",color:Le.Green,type:De.Pentose},{abbr:"Lyx",name:"Lyxose",color:Le.Yellow,type:De.Pentose},{abbr:"Xyl",name:"Xylose",color:Le.Orange,type:De.Pentose},{abbr:"Rib",name:"Ribose",color:Le.Pink,type:De.Pentose},{abbr:"Kdn",name:"Keto-Deoxy Nonulonic Acid",color:Le.Green,type:De.Deoxynonulosonate},{abbr:"Neu5Ac",name:"N-Acetyl Neuraminic Acid",color:Le.Purple,type:De.Deoxynonulosonate},{abbr:"Neu5Gc",name:"N-Glycolyl Neuraminic Acid",color:Le.LightBlue,type:De.Deoxynonulosonate},{abbr:"Neu",name:"Neuraminic Acid",color:Le.Brown,type:De.Deoxynonulosonate},{abbr:"Sia",name:"Sialic acid",color:Le.Red,type:De.Deoxynonulosonate},{abbr:"Pse",name:"Pseudaminic Acid",color:Le.Green,type:De.DiDeoxynonulosonate},{abbr:"Leg",name:"Legionaminic Acid",color:Le.Yellow,type:De.DiDeoxynonulosonate},{abbr:"Aci",name:"Acinetaminic Acid",color:Le.Pink,type:De.DiDeoxynonulosonate},{abbr:"4eLeg",name:"4-Epilegionaminic Acid",color:Le.LightBlue,type:De.DiDeoxynonulosonate},{abbr:"Bac",name:"Bacillosamine",color:Le.Blue,type:De.Unknown},{abbr:"LDmanHep",name:"L-Glycero-D-Manno Heptose",color:Le.Green,type:De.Unknown},{abbr:"Kdo",name:"Keto-Deoxy Octulonic Acid",color:Le.Yellow,type:De.Unknown},{abbr:"Dha",name:"3-Deoxy Lyxo-Heptulosaric Acid",color:Le.Orange,type:De.Unknown},{abbr:"DDmanHep",name:"D-Glycero-D-Manno-Heptose",color:Le.Pink,type:De.Unknown},{abbr:"MurNAc",name:"N-Acetyl Muramic Acid",color:Le.Purple,type:De.Unknown},{abbr:"MurNGc",name:"N-Glycolyl Muramic Acid",color:Le.LightBlue,type:De.Unknown},{abbr:"Mur",name:"Muramic Acid",color:Le.Brown,type:De.Unknown},{abbr:"Api",name:"Apicose",color:Le.Green,type:De.Assigned},{abbr:"Fru",name:"Fructose",color:Le.Green,type:De.Assigned},{abbr:"Tag",name:"Tagatose",color:Le.Yellow,type:De.Assigned},{abbr:"Sor",name:"Sorbose",color:Le.Orange,type:De.Assigned},{abbr:"Psi",name:"Psicose",color:Le.Pink,type:De.Assigned}],M5=function(){const e=new Map;for(let t=0,n=Hi.length;t<n;++t){const r=Hi[t];e.set(r.abbr,r)}return e}();Le.Blue,Le.Green,Le.Yellow,Le.Orange,Le.Pink,Le.Purple,Le.LightBlue,Le.Brown,Le.Red,Le.Secondary;const x2={Glc:["GLC","BGC","Z8T","TRE","MLR"],Man:["MAN","BMA"],Gal:["GLA","GAL","GZL","GXL","GIV"],Gul:["4GL","GL0","GUP","Z8H"],Alt:["Z6H","3MK","SHD"],All:["AFD","ALL","WOO","Z2D"],Tal:["ZEE","A5C","SDY"],Ido:["ZCD","Z0F","4N2"],GlcNAc:["NDG","NAG","NGZ"],ManNAc:["BM3","BM7"],GalNAc:["A2G","NGA","YYQ"],GulNAc:["LXB"],AltNAc:[],AllNAc:["NAA"],TalNAc:[],IdoNAc:["LXZ","HSQ"],GlcN:["PA1","GCS"],ManN:["95Z"],GalN:["X6X","1GN"],GulN:[],AltN:[],AllN:[],TalN:[],IdoN:[],GlcA:["GCU","BDP"],ManA:["MAV","BEM"],GalA:["ADA","GTR","GTK"],GulA:["LGU"],AltA:[],AllA:[],TalA:["X1X","X0X"],IdoA:["IDR"],Qui:["G6D","YYK"],Rha:["RAM","RM4","XXR"],"6dGul":["66O"],"6dAlt":[],"6dTal":[],Fuc:["FUC","FUL","FCA","FCB","GYE"],QuiNAc:["Z9W"],RhaNAc:[],"6dAltNAc":[],"6dTalNAc":[],FucNAc:["49T"],Oli:["DDA","RAE","Z5J"],Tyv:["TYV"],Abe:["ABE"],Par:["PZU"],Dig:["Z3U"],Col:[],Ara:["64K","ARA","ARB","AHR","FUB","BXY","BXX","SEJ"],Lyx:["LDY","Z4W"],Xyl:["XYS","XYP","XYZ","HSY","LXC"],Rib:["YYM","RIP","RIB","BDR","0MK","Z6J","32O"],Kdn:["KDM","KDN"],Neu5Ac:["SIA","SLB"],Neu5Gc:["NGC","NGE"],Neu:[],Sia:[],Pse:[],Leg:[],Aci:[],"4eLeg":[],Bac:[],LDmanHep:["GMH"],Kdo:["KDO"],Dha:[],DDmanHep:["289"],MurNAc:["MUB","AMU"],MurNGc:[],Mur:["1S4","MUR"],Api:["XXM"],Fru:["BDF","Z9N","FRU","LFR"],Tag:["T6T"],Sor:["SOE","UEA"],Psi:["PSV","SF6","SF9","TTV"]},A2={Glc:["AGLC","BGLC"],GlcNAc:["AGLCNA","BGLCNA","BGLCN0"],GlcA:["AGLCA","BGLCA","BGLCA0"],Man:["AMAN","BMAN"],Rha:["ARHM","BRHM"],Ara:["AARB","BARB"],Gal:["AGAL","BGAL"],GalNAc:["AGALNA","BGALNA"],Gul:["AGUL","BGUL"],Alt:["AALT","BALT"],All:["AALL","BALL"],Tal:["ATAL","BTAL"],Ido:["AIDO","BIDO"],IdoA:["AIDOA","BIDOA"],Fuc:["AFUC","BFUC"],Lyx:["ALYF","BLYF"],Xyl:["AXYL","BXYL","AXYF","BXYF"],Rib:["ARIB","BRIB"],Fru:["AFRU","BFRU"],Neu5Ac:["ANE5AC","BNE5AC"]},T5={Glc:["0GA","0GB","1GA","1GB","2GA","2GB","3GA","3GB","4GA","4GB","6GA","6GB","ZGA","ZGB","YGA","YGB","XGA","XGB","WGA","WGB","VGA","VGB","UGA","UGB","TGA","TGB","SGA","SGB","RGA","RGB","QGA","QGB","PGA","PGB","0gA","0gB","1gA","1gB","2gA","2gB","3gA","3gB","4gA","4gB","6gA","6gB","ZgA","ZgB","YgA","YgB","XgA","XgB","WgA","WgB","VgA","VgB","UgA","UgB","TgA","TgB","SgA","SgB","RgA","RgB","QgA","QgB","PgA","PgB"],GlcNAc:["0YA","0YB","1YA","1YB","3YA","3YB","4YA","4YB","6YA","6YB","WYA","WYB","VYA","VYB","UYA","UYB","QYA","QYB","0yA","0yB","1yA","1yB","3yA","3yB","4yA","4yB","6yA","6yB","WyA","WyB","VyA","VyB","UyA","UyB","QyA","QyB","0YS","0Ys","3YS","3Ys","4YS","4Ys","6YS","6Ys","QYS","QYs","UYS","UYs","VYS","VYs","WYS","WYs","0yS","0ys","3yS","3ys","4yS","4ys"],GlcA:["0ZA","0ZB","1ZA","1ZB","2ZA","2ZB","3ZA","3ZB","4ZA","4ZB","ZZA","ZZB","YZA","YZB","WZA","WZB","TZA","TZB","0zA","0zB","1zA","1zB","2zA","2zB","3zA","3zB","4zA","4zB","ZzA","ZzB","YzA","YzB","WzA","WzB","TzA","TzB","0ZBP"],GlcN:["0YN","3YN","4YN","6YN","WYN","VYN","UYN","QYN","3Yn","4Yn","WYn","0Yn","0YP","3YP","4YP","6YP","WYP","VYP","UYP","QYP","0Yp","3Yp","4Yp","WYp"],Man:["0MA","0MB","1MA","1MB","2MA","2MB","3MA","3MB","4MA","4MB","6MA","6MB","ZMA","ZMB","YMA","YMB","XMA","XMB","WMA","WMB","VMA","VMB","UMA","UMB","TMA","TMB","SMA","SMB","RMA","RMB","QMA","QMB","PMA","PMB","0mA","0mB","1mA","1mB","2mA","2mB","3mA","3mB","4mA","4mB","6mA","6mB","ZmA","ZmB","YmA","YmB","XmA","XmB","WmA","WmB","VmA","VmB","UmA","UmB","TmA","TmB","SmA","SmB","RmA","RmB","QmA","QmB","PmA","PmB"],ManNAc:["0WA","0WB","1WA","1WB","3WA","3WB","4WA","4WB","6WA","6WB","WWA","WWB","VWA","VWB","UWA","UWB","QWA","QWB","0wA","0wB","1wA","1wB","3wA","3wB","4wA","4wB","6wA","6wB","WwA","WwB","VwA","VwB","UwA","UwB","QwA","QwB"],Ara:["0AA","0AB","1AA","1AB","2AA","2AB","3AA","3AB","4AA","4AB","ZAA","ZAB","YAA","YAB","WAA","WAB","TAA","TAB","0AD","0AU","1AD","1AU","2AD","2AU","3AD","3AU","5AD","5AU","ZAD","ZAU","0aA","0aB","1aA","1aB","2aA","2aB","3aA","3aB","4aA","4aB","ZaA","ZaB","YaA","YaB","WaA","WaB","TaA","TaB","0aD","0aU","1aD","1aU","2aD","2aU","3aD","3aU","5aD","5aU","ZaD","ZaU"],Gal:["0LA","0LB","1LA","1LB","2LA","2LB","3LA","3LB","4LA","4LB","6LA","6LB","ZLA","ZLB","YLA","YLB","XLA","XLB","WLA","WLB","VLA","VLB","ULA","ULB","TLA","TLB","SLA","SLB","RLA","RLB","QLA","QLB","PLA","PLB","0lA","0lB","1lA","1lB","2lA","2lB","3lA","3lB","4lA","4lB","6lA","6lB","ZlA","ZlB","YlA","YlB","XlA","XlB","WlA","WlB","VlA","VlB","UlA","UlB","TlA","TlB","SlA","SlB","RlA","RlB","QlA","QlB","PlA","PlB"],GalNAc:["0VA","0VB","1VA","1VB","3VA","3VB","4VA","4VB","6VA","6VB","WVA","WVB","VVA","VVB","UVA","UVB","QVA","QVB","0vA","0vB","1vA","1vB","3vA","3vB","4vA","4vB","6vA","6vB","WvA","WvB","VvA","VvB","UvA","UvB","QvA","QvB"],GalA:["0OA","0OB","1OA","1OB","2OA","2OB","3OA","3OB","4OA","4OB","ZOA","ZOB","YOA","YOB","WOA","WOB","TOA","TOB","0oA","0oB","1oA","1oB","2oA","2oB","3oA","3oB","4oA","4oB","ZoA","ZoB","YoA","YoB","WoA","WoB","ToA","ToB"],Gul:["0KA","0KB","1KA","1KB","2KA","2KB","3KA","3KB","4KA","4KB","6KA","6KB","ZKA","ZKB","YKA","YKB","XKA","XKB","WKA","WKB","VKA","VKB","UKA","UKB","TKA","TKB","SKA","SKB","RKA","RKB","QKA","QKB","PKA","PKB","0kA","0kB","1kA","1kB","2kA","2kB","3kA","3kB","4kA","4kB","6kA","6kB","ZkA","ZkB","YkA","YkB","XkA","XkB","WkA","WkB","VkA","VkB","UkA","UkB","TkA","TkB","SkA","SkB","RkA","RkB","QkA","QkB","PkA","PkB"],Alt:["0EA","0EB","1EA","1EB","2EA","2EB","3EA","3EB","4EA","4EB","6EA","6EB","ZEA","ZEB","YEA","YEB","XEA","XEB","WEA","WEB","VEA","VEB","UEA","UEB","TEA","TEB","SEA","SEB","REA","REB","QEA","QEB","PEA","PEB","0eA","0eB","1eA","1eB","2eA","2eB","3eA","3eB","4eA","4eB","6eA","6eB","ZeA","ZeB","YeA","YeB","XeA","XeB","WeA","WeB","VeA","VeB","UeA","UeB","TeA","TeB","SeA","SeB","ReA","ReB","QeA","QeB","PeA","PeB"],All:["0NA","0NB","1NA","1NB","2NA","2NB","3NA","3NB","4NA","4NB","6NA","6NB","ZNA","ZNB","YNA","YNB","XNA","XNB","WNA","WNB","VNA","VNB","UNA","UNB","TNA","TNB","SNA","SNB","RNA","RNB","QNA","QNB","PNA","PNB","0nA","0nB","1nA","1nB","2nA","2nB","3nA","3nB","4nA","4nB","6nA","6nB","ZnA","ZnB","YnA","YnB","XnA","XnB","WnA","WnB","VnA","VnB","UnA","UnB","TnA","TnB","SnA","SnB","RnA","RnB","QnA","QnB","PnA","PnB"],Tal:["0TA","0TB","1TA","1TB","2TA","2TB","3TA","3TB","4TA","4TB","6TA","6TB","ZTA","ZTB","YTA","YTB","XTA","XTB","WTA","WTB","VTA","VTB","UTA","UTB","TTA","TTB","STA","STB","RTA","RTB","QTA","QTB","PTA","PTB","0tA","0tB","1tA","1tB","2tA","2tB","3tA","3tB","4tA","4tB","6tA","6tB","ZtA","ZtB","YtA","YtB","XtA","XtB","WtA","WtB","VtA","VtB","UtA","UtB","TtA","TtB","StA","StB","RtA","RtB","QtA","QtB","PtA","PtB"],Ido:["0IA","0IB","1IA","1IB","2IA","2IB","3IA","3IB","4IA","4IB","6IA","6IB","ZIA","ZIB","YIA","YIB","XIA","XIB","WIA","WIB","VIA","VIB","UIA","UIB","TIA","TIB","SIA","SIB","RIA","RIB","QIA","QIB","PIA","PIB","0iA","0iB","1iA","1iB","2iA","2iB","3iA","3iB","4iA","4iB","6iA","6iB","ZiA","ZiB","YiA","YiB","XiA","XiB","WiA","WiB","ViA","ViB","UiA","UiB","TiA","TiB","SiA","SiB","RiA","RiB","QiA","QiB","PiA","PiB"],IdoA:["0UA","0UB","1UA","1UB","2UA","2UB","3UA","3UB","4UA","4UB","ZUA","ZUB","YUA","YUB","WUA","WUB","TUA","TUB","0uA","0uB","1uA","1uB","2uA","2uB","3uA","3uB","4uA","4uB","ZuA","ZuB","YuA","YuB","WuA","WuB","TuA","TuB","YuAP"],Fuc:["0FA","0FB","1FA","1FB","2FA","2FB","3FA","3FB","4FA","4FB","ZFA","ZFB","YFA","YFB","WFA","WFB","TFA","TFB","0fA","0fB","1fA","1fB","2fA","2fB","3fA","3fB","4fA","4fB","ZfA","ZfB","YfA","YfB","WfA","WfB","TfA","TfB"],Rha:["0HA","0HB","1HA","1HB","2HA","2HB","3HA","3HB","4HA","4HB","ZHA","ZHB","YHA","YHB","WHA","WHB","THA","THB","0hA","0hB","1hA","1hB","2hA","2hB","3hA","3hB","4hA","4hB","ZhA","ZhB","YhA","YhB","WhA","WhB","ThA","ThB"],Qui:["0QA","0QB","1QA","1QB","2QA","2QB","3QA","3QB","4QA","4QB","ZQA","ZQB","YQA","YQB","WQA","WQB","TQA","TQB","0qA","0qB","1qA","1qB","2qA","2qB","3qA","3qB","4qA","4qB","ZqA","ZqB","YqA","YqB","WqA","WqB","TqA","TqB"],Lyx:["0DA","0DB","1DA","1DB","2DA","2DB","3DA","3DB","4DA","4DB","ZDA","ZDB","YDA","YDB","WDA","WDB","TDA","TDB","0DD","0DU","1DD","1DU","2DD","2DU","3DD","3DU","5DD","5DU","ZDD","ZDU","0dA","0dB","1dA","1dB","2dA","2dB","3dA","3dB","4dA","4dB","ZdA","ZdB","YdA","YdB","WdA","WdB","TdA","TdB","0dD","0dU","1dD","1dU","2dD","2dU","3dD","3dU","5dD","5dU","ZdD","ZdU"],Xyl:["0XA","0XB","1XA","1XB","2XA","2XB","3XA","3XB","4XA","4XB","ZXA","ZXB","YXA","YXB","WXA","WXB","TXA","TXB","0XD","0XU","1XD","1XU","2XD","2XU","3XD","3XU","5XD","5XU","ZXD","ZXU","0xA","0xB","1xA","1xB","2xA","2xB","3xA","3xB","4xA","4xB","ZxA","ZxB","YxA","YxB","WxA","WxB","TxA","TxB","0xD","0xU","1xD","1xU","2xD","2xU","3xD","3xU","5xD","5xU","ZxD","ZxU"],Rib:["0RA","0RB","1RA","1RB","2RA","2RB","3RA","3RB","4RA","4RB","ZRA","ZRB","YRA","YRB","WRA","WRB","TRA","TRB","0RD","0RU","1RD","1RU","2RD","2RU","3RD","3RU","5RD","5RU","ZRD","ZRU","0rA","0rB","1rA","1rB","2rA","2rB","3rA","3rB","4rA","4rB","ZrA","ZrB","YrA","YrB","WrA","WrB","TrA","TrB","0rD","0rU","1rD","1rU","2rD","2rU","3rD","3rU","5rD","5rU","ZrD","ZrU"],Fru:["0CA","0CB","1CA","1CB","2CA","2CB","3CA","3CB","4CA","4CB","5CA","5CB","WCA","WCB","0CD","0CU","1CD","1CU","2CD","2CU","3CD","3CU","4CD","4CU","6CD","6CU","WCD","WCU","VCD","VCU","UCD","UCU","QCD","QCU","0cA","0cB","1cA","1cB","2cA","2cB","3cA","3cB","4cA","4cB","5cA","5cB","WcA","WcB","0cD","0cU","1cD","1cU","2cD","2cU","3cD","3cU","4cD","4cU","6cD","6cU","WcD","WcU","VcD","VcU","UcD","UcU","QcD","QcU"],Tag:["0JA","0JB","1JA","1JB","2JA","2JB","3JA","3JB","4JA","4JB","5JA","5JB","WJA","WJB","0JD","0JU","1JD","1JU","2JD","2JU","3JD","3JU","4JD","4JU","6JD","6JU","WJD","WJU","VJD","VJU","UJD","UJU","QJD","QJU","0jA","0jB","1jA","1jB","2jA","2jB","3jA","3jB","4jA","4jB","5jA","5jB","WjA","WjB","0jD","0jU","1jD","1jU","2jD","2jU","3jD","3jU","4jD","4jU","6jD","6jU","WjD","WjU","VjD","VjU","UjD","UjU","QjD","QjU"],Sor:["0BA","0BB","1BA","1BB","2BA","2BB","3BA","3BB","4BA","4BB","5BA","5BB","WBA","WBB","0BD","0BU","1BD","1BU","2BD","2BU","3BD","3BU","4BD","4BU","6BD","6BU","WBD","WBU","VBD","VBU","UBD","UBU","QBD","QBU","0bA","0bB","1bA","1bB","2bA","2bB","3bA","3bB","4bA","4bB","5bA","5bB","WbA","WbB","0bD","0bU","1bD","1bU","2bD","2bU","3bD","3bU","4bD","4bU","6bD","6bU","WbD","WbU","VbD","VbU","UbD","UbU","QbD","QbU"],Psi:["0PA","0PB","1PA","1PB","2PA","2PB","3PA","3PB","4PA","4PB","5PA","5PB","WPA","WPB","0PD","0PU","1PD","1PU","2PD","2PU","3PD","3PU","4PD","4PU","6PD","6PU","WPD","WPU","VPD","VPU","UPD","UPU","QPD","QPU","0pA","0pB","1pA","1pB","2pA","2pB","3pA","3pB","4pA","4pB","5pA","5pB","WpA","WpB","0pD","0pU","1pD","1pU","2pD","2pU","3pD","3pU","4pD","4pU","6pD","6pU","WpD","WpU","VpD","VpU","UpD","UpU","QpD","QpU"],Neu5Ac:["0SA","0SB","4SA","4SB","7SA","7SB","8SA","8SB","9SA","9SB","ASA","ASB","BSA","BSB","CSA","CSB","DSA","DSB","ESA","ESB","FSA","FSB","GSA","GSB","HSA","HSB","ISA","ISB","JSA","JSB","KSA","KSB","0sA","0sB","4sA","4sB","7sA","7sB","8sA","8sB","9sA","9sB","AsA","AsB","BsA","BsB","CsA","CsB","DsA","DsB","EsA","EsB","FsA","FsB","GsA","GsB","HsA","HsB","IsA","IsB","JsA","JsB","KsA","KsB"],Neu5Gc:["0GL","4GL","7GL","8GL","9GL","CGL","DGL","EGL","FGL","GGL","HGL","IGL","JGL","KGL","0gL","4gL","7gL","8gL","9gL","AgL","BgL","CgL","DgL","EgL","FgL","GgL","HgL","IgL","JgL","KgL"],Tyv:["0TV","0Tv","1TV","1Tv","2TV","2Tv","4TV","4Tv","YTV","YTv","0tV","0tv","1tV","1tv","2tV","2tv","4tV","4tv","YtV","Ytv"],Abe:["0AE","2AE","4AE","YGa","0AF","2AF","4AF","YAF"],Bac:["0BC","3BC","0bC","3bC"],Kdn:["0KN","4KN","5KN","7KN","8KN","9KN","AKN","BKN","CKN","DKN","EKN","FKN","GKN","HKN","IKN","JKN","KKN","LKN","MKN","NKN","OKN","PKN","QKN","RKN","SKN","TKN","UKN","VKN","WKN","XKN","YKN","0Kn","4Kn","5Kn","7Kn","8Kn","9Kn","AKn","BKn","CKn","DKn","EKn","FKn","GKn","HKn","IKn","JKn","KKn","LKn","MKn","NKn","OKn","PKn","QKn","RKn","SKn","TKn","UKn","VKn","WKn","XKn","YKn"],Kdo:["0KO","4KO","5KO","7KO","8KO","AKO","BKO","CKO","DKO","EKO","FKO","GKO","HKO","IKO","JKO","KKO","0Ko","4Ko","5Ko","7Ko","8Ko","AKo","BKo","CKo","DKo","EKo","FKo","GKo","HKo","IKo","JKo","KKo"]},O5=function(){const e=new Map;for(let t=0,n=Hi.length;t<n;++t){const r=Hi[t],i=x2[r.abbr];if(i)for(let s=0,a=i.length;s<a;++s)e.set(i[s],r);const o=A2[r.abbr];if(o)for(let s=0,a=o.length;s<a;++s)e.set(o[s],r)}return v2.forEach(t=>{e.has(t)||e.set(t,Hl)}),e}();(function(){const e=new Map;for(let t=0,n=Hi.length;t<n;++t){const r=Hi[t],i=x2[r.abbr];if(i)for(let a=0,c=i.length;a<c;++a)e.set(i[a],r);const o=A2[r.abbr];if(o)for(let a=0,c=o.length;a<c;++a)e.set(o[a],r);const s=T5[r.abbr];if(s)for(let a=0,c=s.length;a<c;++a)e.has(s[a])||e.set(s[a],r)}return v2.forEach(t=>{e.has(t)||e.set(t,Hl)}),e})();let Ur=O5;var Fr;(function(e){function t(h){return Array.from(h.values())}e.toArray=t;function n(h,p){if(h===p)return!0;if(h.size<p.size)return!1;for(const m of p)if(!h.has(m))return!1;return!0}e.isSuperset=n;function r(h,...p){for(let m=0;m<p.length;m++)for(const y of p[m])h.add(y);return h}e.add=r;function i(h,p){const m=new Set(h);if(h===p)return m;for(const y of p)m.add(y);return m}e.union=i;function o(...h){if(h.length===0)return new Set;const p=new Set(h[0]);for(let m=1,y=h.length;m<y;m++)for(const g of h[m])p.add(g);return p}e.unionMany=o;function s(h){if(h.length===0)return new Set;const p=new Set(h[0]);for(let m=1;m<h.length;m++)for(const y of h[m])p.add(y);return p}e.unionManyArrays=s;function a(h,p){if(h===p)return new Set(h);const m=new Set;for(const y of p)h.has(y)&&m.add(y);return m}e.intersection=a;function c(h,p){if(h===p)return h.size>0;h.size<p.size&&([h,p]=[p,h]);for(const m of p)if(h.has(m))return!0;return!1}e.areIntersecting=c;function u(h,p){if(h===p)return h.size;h.size<p.size&&([h,p]=[p,h]);let m=0;for(const y of p)h.has(y)&&(m+=1);return m}e.intersectionSize=u;function l(h,p){if(h===p)return new Set;const m=new Set(h);for(const y of p)m.delete(y);return m}e.difference=l;function d(h,p){if(h===p)return 0;let m=h.size;for(const y of h)p.has(y)&&(m-=1);return m}e.differenceSize=d;function f(h,p){if(h===p)return!0;if(h.size!==p.size)return!1;for(const m of p)if(!h.has(m))return!1;return!0}e.areEqual=f})(Fr||(Fr={}));const S2=new Set(["DAPC","DBPC","DFPC","DGPC","DIPC","DLPC","DNPC","DOPC","DPPC","DRPC","DTPC","DVPC","DXPC","DYPC","LPPC","PAPC","PEPC","PGPC","PIPC","POPC","PRPC","PUPC","DAPE","DBPE","DFPE","DGPE","DIPE","DLPE","DNPE","DOPE","DPPE","DRPE","DTPE","DUPE","DVPE","DXPE","DYPE","LPPE","PAPE","PGPE","PIPE","POPE","PQPE","PRPE","PUPE","DAPS","DBPS","DFPS","DGPS","DIPS","DLPS","DNPS","DOPS","DPPS","DRPS","DTPS","DUPS","DVPS","DXPS","DYPS","LPPS","PAPS","PGPS","PIPS","POPS","PQPS","PRPS","PUPS","DAPA","DBPA","DFPA","DGPA","DIPA","DLPA","DNPA","DOPA","DPPA","DRPA","DTPA","DVPA","DXPA","DYPA","LPPA","PAPA","PGPA","PIPA","POPA","PRPA","PUPA","DAPG","DBPG","DFPG","DGPG","DIPG","DLPG","DNPG","DOPG","DPPG","DRPG","DTPG","DVPG","DXPG","DYPG","LPPG","PAPG","PGPG","PIPG","POPG","PRPG","DMPC","DPP","DPPI","PAPI","PIPI","POP","POPI","PUPI","PVP","PVPI","PADG","PIDG","PODG","PUDG","PVDG","APC","CPC","IPC","LPC","OPC","PPC","TPC","UPC","VPC","BNSM","DBSM","DPSM","DXSM","PGSM","PNSM","POSM","PVSM","XNSM","DPCE","DXCE","PNCE","XNCE"]),C2=new Set(["118","119","543","1AL","1CU","2FK","2HP","2OF","3CO","3MT","3NI","3OF","3P8","4MO","4PU","4TI","6MO","ACT","AG","AL","ALF","AM","ATH","AU","AU3","AUC","AZI","BA","BCT","BEF","BF4","BO4","BR","BS3","BSY","CA","CAC","CD","CD1","CD3","CD5","CE","CF","CHT","CL","CO","CO3","CO5","CON","CR","CS","CSB","CU","CU1","CU3","CUA","CUZ","CYN","DME","DMI","DSC","DTI","DY","E4N","EDR","EMC","ER3","EU","EU3","F","FE","FE2","FPO","GA","GD3","GEP","HAI","HG","HGC","IN","IOD","IR","IR3","IRI","IUM","K","KO4","LA","LCO","LCP","LI","LU","MAC","MG","MH2","MH3","MLI","MMC","MN","MN3","MN5","MN6","MO1","MO2","MO3","MO4","MO5","MO6","MOO","MOS","MOW","MW1","MW2","MW3","NA","NA2","NA5","NA6","NAO","NAW","ND","NET","NH4","NI","NI1","NI2","NI3","NO2","NO3","NRU","NT3","O4M","OAA","OC1","OC2","OC3","OC4","OC5","OC6","OC7","OC8","OCL","OCM","OCN","OCO","OF1","OF2","OF3","OH","OS","OS4","OXL","PB","PBM","PD","PDV","PER","PI","PO3","PO4","PR","PT","PT4","PTN","RB","RH3","RHD","RHF","RU","SB","SCN","SE4","SEK","SM","SMO","SO3","SO4","SR","T1A","TB","TBA","TCN","TEA","TH","THE","TL","TMA","TRA","UNX","V","VN3","VO4","W","WO5","Y1","YB","YB2","YH","YT3","ZCM","ZN","ZN2","ZN3","ZNO","ZO3","ZR","ZTM","NCO","OHX"]),k5=function(){const e=Object.create(null),t=[];for(let n=65;n<=90;n++)t[t.length]=String.fromCharCode(n);for(let n=97;n<=122;n++)t[t.length]=String.fromCharCode(n);for(let n=48;n<=57;n++)t[t.length]=String.fromCharCode(n);for(const n of t){e[n]=n.toUpperCase();for(const r of t){e[n+r]=(n+r).toUpperCase();for(const i of t)e[n+r+i]=(n+r+i).toUpperCase()}}return e}();function Co(e){return k5[e]||e.toUpperCase()}new Map([[1,"H"],[2,"He"],[3,"Li"],[4,"Be"],[5,"B"],[6,"C"],[7,"N"],[8,"O"],[9,"F"],[10,"Ne"],[11,"Na"],[12,"Mg"],[13,"Al"],[14,"Si"],[15,"P"],[16,"S"],[17,"Cl"],[18,"Ar"],[19,"K"],[20,"Ca"],[21,"Sc"],[22,"Ti"],[23,"V"],[24,"Cr"],[25,"Mn"],[26,"Fe"],[27,"Co"],[28,"Ni"],[29,"Cu"],[30,"Zn"],[31,"Ga"],[32,"Ge"],[33,"As"],[34,"Se"],[35,"Br"],[36,"Kr"],[37,"Rb"],[38,"Sr"],[39,"Y"],[40,"Zr"],[41,"Nb"],[42,"Mo"],[43,"Tc"],[44,"Ru"],[45,"Rh"],[46,"Pd"],[47,"Ag"],[48,"Cd"],[49,"In"],[50,"Sn"],[51,"Sb"],[52,"Te"],[53,"I"],[54,"Xe"],[55,"Cs"],[56,"Ba"],[57,"La"],[58,"Ce"],[59,"Pr"],[60,"Nd"],[61,"Pm"],[62,"Sm"],[63,"Eu"],[64,"Gd"],[65,"Tb"],[66,"Dy"],[67,"Ho"],[68,"Er"],[69,"Tm"],[70,"Yb"],[71,"Lu"],[72,"Hf"],[73,"Ta"],[74,"W"],[75,"Re"],[76,"Os"],[77,"Ir"],[78,"Pt"],[79,"Au"],[80,"Hg"],[81,"Tl"],[82,"Pb"],[83,"Bi"],[84,"Po"],[85,"At"],[86,"Rn"],[87,"Fr"],[88,"Ra"],[89,"Ac"],[90,"Th"],[91,"Pa"],[92,"U"],[93,"Np"],[94,"Pu"],[95,"Am"],[96,"Cm"],[97,"Bk"],[98,"Cf"],[99,"Es"],[100,"Fm"],[101,"Md"],[102,"No"],[103,"Lr"],[104,"Rf"],[105,"Db"],[106,"Sg"],[107,"Bh"],[108,"Hs"],[109,"Mt"],[110,"Ds"],[111,"Rg"],[112,"Cn"],[113,"Uut"],[114,"Fl"],[115,"Uup"],[116,"Lv"],[117,"Uus"],[118,"Uuo"]].map(e=>[e[0],Co(e[1])]));var I2;(function(e){e[e.unknown=0]="unknown",e[e.polymer=1]="polymer",e[e["non-polymer"]=2]="non-polymer",e[e.macrolide=3]="macrolide",e[e.water=4]="water",e[e.branched=5]="branched"})(I2||(I2={}));const q5={0:{trace:new Set,directionFrom:new Set,directionTo:new Set,backboneStart:new Set,backboneEnd:new Set,coarseBackbone:new Set},1:{trace:new Set(["CA"]),directionFrom:new Set(["C"]),directionTo:new Set(["O","OC1","O1","OX1","OXT","OT1"]),backboneStart:new Set(["N"]),backboneEnd:new Set(["C"]),coarseBackbone:new Set(["CA","CA1","BB","BAS"])},2:{trace:new Set(["CA"]),directionFrom:new Set(["C"]),directionTo:new Set(["O"]),backboneStart:new Set(["N"]),backboneEnd:new Set(["CD"]),coarseBackbone:new Set(["CA"])},3:{trace:new Set(["CA"]),directionFrom:new Set(["C"]),directionTo:new Set(["O"]),backboneStart:new Set(["N"]),backboneEnd:new Set(["CG"]),coarseBackbone:new Set(["CA"])},4:{trace:new Set(["O3'","O3*"]),directionFrom:new Set(["C4'","C4*"]),directionTo:new Set(["C3'","C3*"]),backboneStart:new Set(["P"]),backboneEnd:new Set(["O3'","O3*"]),coarseBackbone:new Set(["P"])},5:{trace:new Set(["O3'","O3*"]),directionFrom:new Set(["C3'","C3*"]),directionTo:new Set(["C1'","C1*"]),backboneStart:new Set(["P"]),backboneEnd:new Set(["O3'","O3*"]),coarseBackbone:new Set(["P"])},6:{trace:new Set(["N4'","N4*"]),directionFrom:new Set(["N4'","N4*"]),directionTo:new Set(["C7'","C7*"]),backboneStart:new Set(["N1'","N1*"]),backboneEnd:new Set(["C'","C*"]),coarseBackbone:new Set(["P"])}},w2=new Set(["d-peptide linking","d-peptide nh3 amino terminus","d-peptide cooh carboxy terminus","d-gamma-peptide, c-delta linking","d-beta-peptide, c-gamma linking"]),P2=new Set(["l-peptide linking","l-peptide nh3 amino terminus","l-peptide cooh carboxy terminus","l-gamma-peptide, c-delta linking","l-beta-peptide, c-gamma linking"]),U5=new Set(["d-gamma-peptide, c-delta linking","l-gamma-peptide, c-delta linking"]),F5=new Set(["d-beta-peptide, c-gamma linking","l-beta-peptide, c-gamma linking"]),L5=new Set(["d-peptide nh3 amino terminus","d-peptide cooh carboxy terminus","l-peptide nh3 amino terminus","l-peptide cooh carboxy terminus"]),E2=new Set(["peptide linking","peptide-like"]),G5=Fr.unionMany(w2,P2,E2),B2=new Set(["dna linking","l-dna linking","dna oh 5 prime terminus","dna oh 3 prime terminus"]),R2=new Set(["rna linking","l-rna linking","rna oh 5 prime terminus","rna oh 3 prime terminus"]),D2=Fr.unionMany(new Set(["d-saccharide, beta linking","l-saccharide, beta linking","d-saccharide, alpha linking","l-saccharide, alpha linking","l-saccharide","d-saccharide","saccharide"]),new Set(["d-saccharide 1,4 and 1,4 linking","l-saccharide 1,4 and 1,4 linking","d-saccharide 1,4 and 1,6 linking","l-saccharide 1,4 and 1,6 linking"])),H5=new Set(["non-polymer","other"]),j5=new Set(["ion"]),z5=new Set(["lipid"]),jl=new Set(["SOL","WAT","HOH","H2O","W","DOD","D3O","TIP","TIP3","TIP4","SPC"]),N2=new Set(["HIS","ARG","LYS","ILE","PHE","LEU","TRP","ALA","MET","PRO","CYS","ASN","VAL","GLY","SER","GLN","TYR","ASP","GLU","THR","SEC","PYL","UNK","MSE","SEP","TPO","PTR","PCA","HYP","HSD","HSE","HSP","LSN","ASPP","GLUP","HID","HIE","HIP","LYN","ASH","GLH"]),M2=new Set(["DAL","DAR","DSG","DAS","DCY","DGL","DGN","DHI","DIL","DLE","DLY","MED","DPN","DPR","DSN","DTH","DTR","DTY","DVA","DNE"]),Es=Fr.unionMany(N2,M2),Bs=new Set(["A","C","T","G","I","U","N"]),Rs=new Set(["DA","DC","DT","DG","DI","DU","DN"]),zl=new Set(["APN","CPN","TPN","GPN"]),T2=Fr.unionMany(Bs,Rs,zl),Vl=Fr.unionMany(Es,T2);function Kl(e,t){return t=t.toUpperCase(),zl.has(t)?8:G5.has(e)?5:R2.has(e)?6:B2.has(e)?7:D2.has(e)?9:jl.has(t)?2:C2.has(t)?3:S2.has(t)?4:H5.has(e)?Ur.has(t)?9:Es.has(t)?5:Bs.has(t)?6:Rs.has(t)?7:1:0}function V5(e,t){return t===5?U5.has(e)?2:F5.has(e)?3:L5.has(e)?0:1:t===6?4:t===7?5:t===8?6:0}function O2(e){return e=e.toUpperCase(),Es.has(e)?"peptide linking":Bs.has(e)?"rna linking":Rs.has(e)?"dna linking":Ur.has(e)?"saccharide":"other"}function K5(e){return{formula:"",formula_weight:0,id:e,name:e,mon_nstd_flag:Vl.has(e)?"y":"n",pdbx_synonyms:[],type:O2(e)}}function $5(e){return e=e.toUpperCase(),jl.has(e)?"water":Vl.has(e)?"polymer":Ur.has(e)?"branched":"non-polymer"}function Y5(e,t){return e=e.toUpperCase(),P2.has(t)?"polypeptide(L)":w2.has(t)?"polypeptide(D)":R2.has(t)?"polyribonucleotide":B2.has(t)?"polydeoxyribonucleotide":D2.has(t)||Ur.has(e)?"oligosaccharide":zl.has(e)?"peptide nucleic acid":N2.has(e)?"polypeptide(L)":M2.has(e)?"polypeptide(D)":Bs.has(e)?"polyribonucleotide":Rs.has(e)?"polydeoxyribonucleotide":j5.has(t)||C2.has(e)?"ion":z5.has(t)||S2.has(e)?"lipid":E2.has(t)?"peptide-like":"other"}function $l(e){return k2(e)||Yl(e)}function k2(e){return e===7||e===6||e===8}function Yl(e){return e===5}var Dt;(function(e){e.is=tr.has,e.create=tr.create,e.SecondaryStructureMmcif={helx_lh_27_p:1058,helx_lh_3t_p:2082,helx_lh_al_p:4130,helx_lh_a_n:524321,helx_lh_b_n:1048609,helx_lh_ga_p:8226,helx_lh_n:33,helx_lh_om_p:16418,helx_lh_ot_n:131105,helx_lh_ot_p:546,helx_lh_p:34,helx_lh_pi_p:32802,helx_lh_pp_p:65570,helx_lh_z_n:262177,helx_n:1,helx_ot_n:1,helx_ot_p:2,helx_p:2,helx_rh_27_p:1090,helx_rh_3t_p:2114,helx_rh_al_p:4162,helx_rh_a_n:524353,helx_rh_b_n:1048641,helx_rh_ga_p:8258,helx_rh_n:65,helx_rh_om_p:16450,helx_rh_ot_n:131137,helx_rh_ot_p:578,helx_rh_p:66,helx_rh_pi_p:32834,helx_rh_pp_p:65602,helx_rh_z_n:262209,strn:4194308,turn_ot_p:33554448,turn_p:16,turn_ty1p_p:67109136,turn_ty1_p:67109008,turn_ty2p_p:134218e3,turn_ty2_p:134217872,turn_ty3p_p:268435728,turn_ty3_p:268435600,bend:8,other:0},e.SecondaryStructurePdb={1:4162,2:16450,3:32834,4:8258,5:2114,6:4130,7:16418,8:8226,9:1026,10:65538},e.SecondaryStructureStride={H:4098,G:2050,I:32770,E:8388612,B:4194308,T:16,C:536870912},e.SecondaryStructureDssp={H:4098,B:4194308,E:8388612,G:2050,I:32770,T:16,S:8}})(Dt||(Dt={}));var $n;(function(e){e.is=tr.has;function t(a){return tr.create(a)}e.create=t;function n(a){return(a&1)!==0}e.isCovalent=n;function r(a){return a===Math.pow(2,6)-1}e.isAll=r,e.Names={covalent:1,"metal-coordination":2,"hydrogen-bond":4,disulfide:8,aromatic:16,computed:32};function i(a){return a in e.Names}e.isName=i;function o(a){switch(a){case"covalent":return 1;case"metal-coordination":return 2;case"hydrogen-bond":return 4;case"disulfide":return 8;case"aromatic":return 16;case"computed":return 32}}e.fromName=o;function s(a){let c=0;for(let u=0,l=a.length;u<l;++u)c|=o(a[u]);return c}e.fromNames=s})($n||($n={}));var q2;(function(e){function t(n,r,i,o){return{id:ln.create22(),label:n,basic:r,sourceData:o,bonds:i}}e.create=t})(q2||(q2={}));function U2(e,t){if(t.length===0)return xt.Empty;if(t.length===1)return t[0];const n=new Map,r=new Set;for(const{units:o}of t)for(let s=0,a=o.length;s<a;s++){const c=o[s];if(n.has(c.id)){if(r.has(c.id))continue;const u=ve.union(n.get(c.id),c.elements);n.set(c.id,u),u.length===e.unitMap.get(c.id).elements.length&&r.add(c.id)}else n.set(c.id,c.elements),c.elements.length===e.unitMap.get(c.id).elements.length&&r.add(c.id)}const i=e.subsetBuilder(!0);return n.forEach(W5,i),i.getStructure()}function W5(e,t){this.setUnit(t,e)}function Z5(e,t){if(e===t)return!0;let n,r;e.units.length<t.units.length?(n=e,r=t):(n=t,r=e);const i=n.units,o=r.unitMap;for(let s=0,a=i.length;s<a;s++){const c=i[s];if(!o.has(c.id))continue;const u=o.get(c.id);if(ve.areIntersecting(c.elements,u.elements))return!0}return!1}function X5(e,t){if(e===t)return xt.Empty;if(!Z5(e,t))return e;const n=e.units,r=t.unitMap,i=[];for(let o=0,s=n.length;o<s;o++){const a=n[o];if(!r.has(a.id)){i[i.length]=a;continue}const c=r.get(a.id),u=ve.subtract(a.elements,c.elements);u.length>0&&(i[i.length]=a.getChild(u))}return xt.create(i,{parent:e.parent||t.parent})}var wt;(function(e){function t(g,b){return{kind:"singletons",source:g,structure:b}}e.Singletons=t;function n(g,b){return{kind:"sequence",source:g,structures:b}}e.Sequence=n;function r(g){return t(g,xt.Empty)}e.Empty=r;function i(g){return g.kind==="singletons"}e.isSingleton=i;function o(g){return i(g)?g.structure.units.length===0:g.structures.length===0}e.isEmpty=o;function s(g){return i(g)?g.structure.elementCount:g.structures.length}e.structureCount=s;function a(g){return o(g)?xt.Empty:i(g)?g.structure:U2(g.source,g.structures)}e.unionStructure=a;function c(g){const b=[],{unitMap:v}=g.source;for(const _ of a(g).units)_===v.get(_.id)?b[b.length]={unit:_,indices:Re.ofBounds(0,_.elements.length)}:b[b.length]={unit:_,indices:Re.ofSortedArray(ve.indicesOf(v.get(_.id).elements,_.elements))};return Cn(g.source,b)}e.toLociWithCurrentUnits=c;function u(g){const b=[],{unitMap:v}=g.source;for(const _ of a(g).units){const A=v.get(_.id);A===_?b[b.length]={unit:A,indices:Re.ofBounds(0,A.elements.length)}:b[b.length]={unit:A,indices:Re.ofSortedArray(ve.indicesOf(A.elements,_.elements))}}return Cn(g.source,b)}e.toLociWithSourceUnits=u;function l(g,b,v){return b.length===0?r(g):v?t(g,U2(g,b)):n(g,b)}class d{add(b){const v=b.elementCount;v!==0&&(this.structures[this.structures.length]=b,v!==1&&(this.allSingletons=!1))}getSelection(){return l(this.source,this.structures,this.allSingletons)}constructor(b){this.source=b,this.structures=[],this.allSingletons=!0}}class f{add(b){const v=b.elementCount;v===0||!this.uniqueSets.add(b)||(this.structures[this.structures.length]=b,v!==1&&(this.allSingletons=!1))}getSelection(){return l(this.structure,this.structures,this.allSingletons)}constructor(b){this.structure=b,this.structures=[],this.allSingletons=!0,this.uniqueSets=r5(xt.hashCode,xt.areUnitIdsAndIndicesEqual)}}function h(g){return new d(g)}e.LinearBuilder=h;function p(g){return new f(g)}e.UniqueBuilder=p;function m(g,b){let v=0;if(e.isSingleton(g))for(const _ of g.structure.units){const{elements:A}=_;for(let C=0,I=A.length;C<I;C++){const S=xt.create([_.getChild(ve.ofSingleton(A[C]))],{parent:g.source});b(S,v++)}}else for(const _ of g.structures)b(_,v++)}e.forEach=m;function y(g,b){return i(g)?t(b,g.structure):n(b,g.structures)}e.withInputStructure=y})(wt||(wt={}));var Nt;(function(e){function t(_){return ve.ofSortedArray(_)}e.ofSortedRanges=t;function n(_){return _[0]}e.start=n;function r(_){return _[_.length-1]+1}e.end=r;function i(_){return _[0]}e.min=i;function o(_){return _[_.length-1]}e.max=o;function s(_){let A=0;for(let C=0,I=_.length;C<I;C+=2)A+=_[C+1]-_[C]+1;return A}e.size=s;function a(_){return _.length/2}e.count=a;function c(_,A){return _[A*2]}e.startAt=c;function u(_,A){return _[A*2+1]+1}e.endAt=u;function l(_,A){return _[A*2]}e.minAt=l;function d(_,A){return _[A*2+1]}e.maxAt=d;function f(_,A){if(_.length!==A.length)return!1;for(let C=0,I=_.length;C<I;++C)if(_[C]!==A[C])return!1;return!0}e.areEqual=f;function h(_,A){let C=0;for(let I=0,S=_.length;I<S;I+=2)for(let w=_[I],R=_[I+1];w<=R;++w)A(w,C),++C}e.forEach=h;function p(_,A){return y(_,A)!==-1}e.has=p;function m(_,A,C){return g(_,A,C)!==-1}e.hasFrom=m;function y(_,A){return g(_,A,0)}e.firstIntersectionIndex=y;function g(_,A,C){if(l(_,C)>Re.max(A)||o(_)<Re.min(A))return-1;for(let I=C,S=a(_);I<S;++I){const w=pe.ofRange(l(_,I),d(_,I));if(Re.areIntersecting(w,A))return I}return-1}e.firstIntersectionIndexFrom=g;function b(_,A){return new v(_,A)}e.transientSegments=b;class v{updateValue(){this.value.index=this.curIndex,this.value.start=Re.findPredecessorIndex(this.set,c(this.ranges,this.curIndex)),this.value.end=Re.findPredecessorIndex(this.set,u(this.ranges,this.curIndex))}move(){return this.hasNext&&(this.updateValue(),this.curIndex=g(this.ranges,this.set,this.curIndex+1),this.hasNext=this.curIndex!==-1),this.value}constructor(A,C){this.ranges=A,this.set=C,this.value={index:0,start:0,end:0},this.curIndex=0,this.hasNext=!1,this.curIndex=y(A,C),this.hasNext=this.curIndex!==-1}}e.Iterator=v})(Nt||(Nt={}));function Q5(e){return!!e.items}function J5(e){const{and:t}=ut.core.logic,{eq:n,gre:r,lte:i}=ut.core.rel,{macromolecular:o,ihm:s,core:a}=ut.struct.atomProperty,c={};cn(e.label_entity_id)&&(c["entity-test"]=n([o.label_entity_id(),e.label_entity_id]));const u=[];cn(e.operator_name)&&u.push(n([a.operatorName(),e.operator_name])),cn(e.label_asym_id)&&u.push(n([o.label_asym_id(),e.label_asym_id])),cn(e.auth_asym_id)&&u.push(n([o.auth_asym_id(),e.auth_asym_id])),u.length===1?c["chain-test"]=u[0]:u.length>1&&(c["chain-test"]=t(u));const l=[];cn(e.label_seq_id)&&l.push(s.hasSeqId({0:e.label_seq_id})),cn(e.auth_seq_id)&&l.push(n([o.auth_seq_id(),e.auth_seq_id])),cn(e.pdbx_PDB_ins_code)&&l.push(n([o.pdbx_PDB_ins_code(),e.pdbx_PDB_ins_code])),(cn(e.beg_label_seq_id)||cn(e.end_label_seq_id))&&l.push(s.overlapsSeqIdRange({beg:e.beg_label_seq_id,end:e.end_label_seq_id})),cn(e.beg_auth_seq_id)&&l.push(r([o.auth_seq_id(),e.beg_auth_seq_id])),cn(e.end_auth_seq_id)&&l.push(i([o.auth_seq_id(),e.end_auth_seq_id])),l.length===1?c["residue-test"]=l[0]:l.length>1&&(c["residue-test"]=t(l));const d=[];return cn(e.label_comp_id)&&d.push(n([o.label_comp_id(),e.label_comp_id])),cn(e.auth_comp_id)&&d.push(n([o.auth_comp_id(),e.auth_comp_id])),cn(e.atom_id)&&d.push(n([o.id(),e.atom_id])),cn(e.atom_index)&&d.push(n([ut.struct.atomProperty.core.sourceIndex(),e.atom_index])),cn(e.label_atom_id)&&d.push(n([o.label_atom_id(),e.label_atom_id])),cn(e.auth_atom_id)&&d.push(n([o.auth_atom_id(),e.auth_atom_id])),cn(e.type_symbol)&&d.push(n([ut.struct.atomProperty.core.elementSymbol(),e.type_symbol.toUpperCase()])),d.length===1?c["atom-test"]=d[0]:d.length>1&&(c["atom-test"]=t(d)),ut.struct.generator.atomGroups(c)}function F2(e){const t=[];return L2(e,n=>t.push(J5(n))),t.length===1?t[0]:eS(t)}function eS(e){return ut.struct.combinator.merge(e.map(t=>ut.struct.modifier.union([t])))}function cn(e){return e!=null}function L2(e,t){if(Q5(e))if(Array.isArray(e.items))if(e.prefix)for(const n of e.items)t(Object.assign({},e.prefix,n));else for(const n of e.items)t(n);else{const n={...e.prefix},r=Object.keys(e.items),i=e.items[r[0]].length;for(let o=0;o<i;o++){for(const s of r)n[s]=e.items[s][o];t(n)}}else t(e)}function G2(e,t,n){const r=F2(t);return Cn.fromExpression(e,r,n)}function tS(e,t,n){const r=G2(e,t,n);return Wl.fromLoci(r)}const H2={forEachItem:L2,toExpression:F2,toLoci:G2,toBundle:tS};var Wl;(function(e){e.Empty={hash:-1,elements:[]};function t(h,p){return s(wt.toLociWithSourceUnits(wt.Singletons(h,p)))}e.fromSubStructure=t;function n(h){return s(wt.toLociWithSourceUnits(h))}e.fromSelection=n;function r(h,p,m){return s(Cn.fromExpression(h,p,m))}e.fromExpression=r;function i(h,p,m){return s(Cn.fromQuery(h,p,m))}e.fromQuery=i;function o(h,p,m){return H2.toBundle(h,p,m)}e.fromSchema=o;function s(h){const p=[];for(const g of h.elements){const{unit:b,indices:v}=g;if(Re.size(v)===0)continue;const _=[],A=[];if(Re.isInterval(v))Re.size(v)===1?A.push(pe.min(v)):_.push(pe.min(v),pe.max(v));else{let C=0;const I=v.length;for(;C<I;){const S=C;for(C++;C<I&&v[C-1]+1===v[C];)C++;const w=C;if(w-S>2)_.push(v[S],v[w-1]);else for(let R=S;R<w;R++)A[A.length]=v[R]}}p.push({unit:b,set:ve.ofSortedArray(A),ranges:Nt.ofSortedRanges(_)})}const m=new Map;for(let g=0,b=p.length;g<b;++g){const v=p[g],_=ds(Oi(v.ranges),Oi(v.set));if(m.has(_)){const{groupedUnits:A}=m.get(_);A.has(v.unit.invariantId)?A.get(v.unit.invariantId).push(v.unit.id):A.set(v.unit.invariantId,[v.unit.id])}else{const A=new Map;A.set(v.unit.invariantId,[v.unit.id]),m.set(_,{groupedUnits:A,set:v.set,ranges:v.ranges})}}const y=[];return m.forEach(g=>{const b=[];g.groupedUnits.forEach(v=>b.push(ve.ofUnsortedArray(v))),b.sort((v,_)=>v[0]-_[0]),y.push({groupedUnits:b,set:g.set,ranges:g.ranges})}),{hash:h.structure.hashCode,elements:y}}e.fromLoci=s;function a(h,p){const m=[];for(let y=0,g=h.length;y<g;++y){const b=h[y];p.unitMap.has(b)&&m.push(p.unitMap.get(b))}return m}function c(h,p){h.hash!==-1&&(h.hash,p.hashCode);const m=[];for(const y of h.elements)for(const g of y.groupedUnits){const b=a(g,p);if(b.length===0)continue;let v;if(y.ranges.length===0)v=y.set;else if(y.set.length===0)if(y.ranges.length===2)v=pe.ofRange(y.ranges[0],y.ranges[1]);else{const _=new Int32Array(Nt.size(y.ranges));Nt.forEach(y.ranges,(A,C)=>_[C]=A),v=ve.ofSortedArray(_)}else{const _=Nt.size(y.ranges),A=new Int32Array(y.set.length+_);Nt.forEach(y.ranges,(C,I)=>A[I]=C),A.set(y.set,_),v=ve.ofUnsortedArray(A)}for(const _ of b)m.push({unit:_,indices:v})}return Cn(p,m)}e.toLoci=c;function u(h,p){h.hash!==-1&&(h.hash,p.hashCode);const m=[];for(const y of h.elements)for(const g of y.groupedUnits){const b=a(g,p);if(b.length===0)continue;const v=b[0].elements,_=Nt.size(y.ranges),A=y.set.length,C=new Int32Array(A+_);let I;if(_===0){for(let S=0,w=A;S<w;++S)C[S]=v[y.set[S]];I=ve.ofSortedArray(C)}else if(A===0)Nt.forEach(y.ranges,(S,w)=>C[w]=v[S]),I=ve.ofSortedArray(C);else if(ve.min(y.set)>Nt.max(y.ranges)){Nt.forEach(y.ranges,(S,w)=>C[w]=v[S]);for(let S=0,w=A;S<w;++S)C[S+_]=v[y.set[S]];I=ve.ofSortedArray(C)}else if(Nt.min(y.ranges)>ve.max(y.set)){for(let S=0,w=A;S<w;++S)C[S]=v[y.set[S]];Nt.forEach(y.ranges,(S,w)=>C[w+A]=v[S]),I=ve.ofSortedArray(C)}else{Nt.forEach(y.ranges,(S,w)=>C[w]=v[S]);for(let S=0,w=A;S<w;++S)C[S+_]=v[y.set[S]];I=ve.ofUnsortedArray(C)}for(const S of b)m.push(S.getChild(I))}return xt.create(m,{parent:p})}e.toStructure=u;function l(h){return ut.internal.generator.bundleElement({groupedUnits:ut.core.type.list(h.groupedUnits.map(p=>ut.core.type.list(p))),ranges:ut.core.type.list(h.ranges),set:ut.core.type.list(h.set)})}function d(h){return ut.internal.generator.bundle({elements:ut.core.type.list(h.elements.map(l))})}e.toExpression=d;function f(h,p){if(h.elements.length!==p.elements.length)return!1;for(let m=0,y=h.elements.length;m<y;++m){const g=h.elements[m],b=p.elements[m];if(g.groupedUnits.length!==b.groupedUnits.length)return!1;for(let v=0,_=b.groupedUnits.length;v<_;++v)if(!ve.areEqual(g.groupedUnits[v],b.groupedUnits[v]))return!1;if(!ve.areEqual(g.set,b.set)||!Nt.areEqual(g.ranges,b.ranges))return!1}return!0}e.areEqual=f})(Wl||(Wl={}));function j2(e){return $n.isCovalent(e.atomicBond.type)}class li{pushCurrentElement(){return this.currentElementStack[this.currentElementStack.length]=this.element,this.element=Ze.create(void 0),this.element}popCurrentElement(){this.element=this.currentElementStack.pop()}pushCurrentBond(){return this.atomicBond&&this.currentAtomicBondStack.push(this.atomicBond),this.atomicBond=new z2,this.atomicBond}popCurrentBond(){this.currentAtomicBondStack.length>0?this.atomicBond=this.currentAtomicBondStack.pop():this.atomicBond=void 0}pushCurrentStructure(){this.currentStructure&&this.currentStructureStack.push(this.currentStructure)}popCurrentStructure(){this.currentStructureStack.length?this.currentStructure=this.currentStructureStack.pop():this.currentStructure=void 0}pushInputStructure(t){this.inputStructureStack.push(this.inputStructure),this.inputStructure=t}popInputStructure(){if(this.inputStructureStack.length===0)throw new Error("Must push before pop.");this.inputStructure=this.inputStructureStack.pop()}throwIfTimedOut(){if(this.timeoutMs!==0&&Tn()-this.timeCreated>this.timeoutMs)throw new Error(`The query took too long to execute (> ${this.timeoutMs/1e3}s).`)}tryGetCurrentSelection(){if(!this.currentSelection)throw new Error("The current selection is not assigned.");return this.currentSelection}constructor(t,n){this.currentElementStack=[],this.currentAtomicBondStack=[],this.currentStructureStack=[],this.inputStructureStack=[],this.timeCreated=Tn(),this.element=Ze.create(void 0),this.currentStructure=void 0,this.atomicBond=new z2,this.currentSelection=void 0,this.inputStructure=t,this.timeoutMs=n&&n.timeoutMs||0,this.currentSelection=n&&n.currentSelection}}class z2{constructor(){this.a=Ze.create(void 0),this.aIndex=0,this.b=Ze.create(void 0),this.bIndex=0,this.type=0,this.order=0,this.key=-1,this.testFn=j2}setStructure(t){this.a.structure=t,this.b.structure=t}setTestFn(t){this.testFn=t||j2}test(t,n){return this.testFn(t)?!0:n?(this.swap(),this.testFn(t)):!1}swap(){const t=this.aIndex;this.aIndex=this.bIndex,this.bIndex=t;const n=this.a.unit;this.a.unit=this.b.unit,this.b.unit=n;const r=this.a.element;this.a.element=this.b.element,this.b.element=r}get length(){return Ze.distance(this.a,this.b)}}var V2;(function(e){function t(r,i,o){return r(new li(i,o))}e.run=t;function n(r,i,o){const s=r(new li(i,o));return wt.toLociWithSourceUnits(s)}e.loci=n})(V2||(V2={}));class nS{add(t,n,r){let i=this.builderMap.get(t);i||(i=this.source.subsetBuilder(!0),this.builders[this.builders.length]=i,this.builderMap.set(t,i)),i.addToUnit(n,r)}allSingletons(){for(let t=0,n=this.builders.length;t<n;t++)if(this.builders[t].elementCount>1)return!1;return!0}singletonSelection(){const t=this.source.subsetBuilder(!0),n=Ze.create(this.source);for(let r=0,i=this.builders.length;r<i;r++)this.builders[r].setSingletonLocation(n),t.addToUnit(n.unit.id,n.element);return wt.Singletons(this.source,t.getStructure())}fullSelection(){const t=new Array(this.builders.length);for(let n=0,r=this.builders.length;n<r;n++)t[n]=this.builders[n].getStructure();return wt.Sequence(this.source,t)}getSelection(){return this.builders.length===0?wt.Empty(this.source):this.allSingletons()?this.singletonSelection():this.fullSelection()}constructor(t){this.source=t,this.builders=[],this.builderMap=new Map}}const rS=e=>wt.Sequence(e.inputStructure,[]),K2=e=>wt.Singletons(e.inputStructure,e.inputStructure);function iS(e){return Zl({...e,groupBy:t=>vt.residue.key(t.element)})}function oS(e){return Zl({...e,groupBy:t=>vt.chain.key(t.element)})}function Lr(e){return!0}function sS(e){return 0}function Zl(e){if(!e||!e.atomTest&&!e.residueTest&&!e.chainTest&&!e.entityTest&&!e.unitTest&&!e.groupBy)return K2;if(e.atomTest&&!e.residueTest&&!e.chainTest&&!e.entityTest&&!e.unitTest&&!e.groupBy)return aS(e.atomTest);const t={unitTest:e.unitTest||Lr,entityTest:e.entityTest||Lr,chainTest:e.chainTest||Lr,residueTest:e.residueTest||Lr,atomTest:e.atomTest||Lr,groupBy:e.groupBy||sS};return e.groupBy?uS(t):cS(t)}function aS(e){return function(n){const{inputStructure:r}=n,{units:i}=r,o=n.pushCurrentElement(),s=r.subsetBuilder(!0);o.structure=r;for(const a of i){o.unit=a;const c=a.elements;s.beginUnit(a.id);for(let u=0,l=c.length;u<l;u++)o.element=c[u],e(n)&&s.addElement(o.element);s.commitUnit(),n.throwIfTimedOut()}return n.popCurrentElement(),wt.Singletons(r,s.getStructure())}}function cS({unitTest:e,entityTest:t,chainTest:n,residueTest:r,atomTest:i}){return function(s){const{inputStructure:a}=s,{units:c}=a,u=s.pushCurrentElement(),l=a.subsetBuilder(!0),d=r===Lr&&i===Lr,f=i===Lr;u.structure=a;for(const h of c){if(u.unit=h,!e(s))continue;const{elements:p,model:m}=h;if(l.beginUnit(h.id),h.kind===0){const y=mt.transientSegments(h.model.atomicHierarchy.chainAtomSegments,p),g=mt.transientSegments(h.model.atomicHierarchy.residueAtomSegments,p);for(;y.hasNext;){const b=y.move();if(u.element=p[b.start],!(!t(s)||!n(s))){if(d){l.addElementRange(p,b.start,b.end);continue}for(g.setSegment(b);g.hasNext;){const v=g.move();if(u.element=p[v.start],!!r(s)){if(f){l.addElementRange(p,v.start,v.end);continue}for(let _=v.start,A=v.end;_<A;_++)u.element=p[_],i(s)&&l.addElement(u.element)}}}}}else{const{chainElementSegments:y}=h.kind===1?m.coarseHierarchy.spheres:m.coarseHierarchy.gaussians,g=mt.transientSegments(y,p);for(;g.hasNext;){const b=g.move();if(u.element=p[b.start],!(!t(s)||!n(s))){if(d){l.addElementRange(p,b.start,b.end);continue}for(let v=b.start,_=b.end;v<_;v++)u.element=p[v],r(s)&&l.addElement(u.element)}}}l.commitUnit(),s.throwIfTimedOut()}return s.popCurrentElement(),wt.Singletons(a,l.getStructure())}}function uS({unitTest:e,entityTest:t,chainTest:n,residueTest:r,atomTest:i,groupBy:o}){return function(a){const{inputStructure:c}=a,{units:u}=c,l=a.pushCurrentElement(),d=new nS(c);l.structure=c;for(const f of u){if(l.unit=f,!e(a))continue;const{elements:h,model:p}=f;if(f.kind===0){const m=mt.transientSegments(p.atomicHierarchy.chainAtomSegments,h),y=mt.transientSegments(p.atomicHierarchy.residueAtomSegments,h);for(;m.hasNext;){const g=m.move();if(l.element=h[g.start],!(!t(a)||!n(a)))for(y.setSegment(g);y.hasNext;){const b=y.move();if(l.element=h[b.start],!!r(a))for(let v=b.start,_=b.end;v<_;v++)l.element=h[v],i(a)&&d.add(o(a),f.id,l.element)}}}else{const{chainElementSegments:m}=f.kind===1?p.coarseHierarchy.spheres:p.coarseHierarchy.gaussians,y=mt.transientSegments(m,h);for(;y.hasNext;){const g=y.move();if(l.element=h[g.start],!(!t(a)||!n(a)))for(let b=g.start,v=g.end;b<v;b++)l.element=h[b],r(a)&&d.add(o(a),f.id,l.element)}}a.throwIfTimedOut()}return a.popCurrentElement(),d.getSelection()}}function Xl(e,t,n){const r=new Int32Array(t.length);for(let i=0,o=t.length;i<o;i++)r[i]=e.elements[t[i]];return xt.create([e.getChild(ve.ofSortedArray(r))],{parent:n})}function lS(e,t){return function(r){const{units:i}=r.inputStructure,o=wt.LinearBuilder(r.inputStructure);if(!e||e.length===0){for(const s of i)if(Ne.isAtomic(s))if(t)for(const a of s.rings.aromaticRings)o.add(Xl(s,s.rings.all[a],r.inputStructure));else for(const a of s.rings.all)o.add(Xl(s,a,r.inputStructure))}else{const s=mn.create();for(let a=0;a<e.length;a++)mn.add(s,e[a],e[a]);for(const a of i){if(!Ne.isAtomic(a))continue;const c=a.rings;for(const u of s.array)if(c.byFingerprint.has(u))for(const l of c.byFingerprint.get(u))t&&!c.aromaticRings.includes(l)||o.add(Xl(a,c.all[l],r.inputStructure))}}return o.getSelection()}}function fS(e,t,n=!1){return function(i){const o=e(i);if(wt.structureCount(o)===0)return o;const s=n?X5(i.inputStructure,wt.unionStructure(o)):wt.unionStructure(o);if(s.elementCount===0)return wt.Empty(i.inputStructure);i.throwIfTimedOut(),i.pushInputStructure(s);const a=t(i);return i.popInputStructure(),wt.withInputStructure(a,i.inputStructure)}}function dS(e){return function(n){const r=n.inputStructure,i=r.interUnitBonds,o=wt.UniqueBuilder(n.inputStructure);n.pushCurrentBond();const s=n.atomicBond;s.setTestFn(e),s.setStructure(r);for(const a of r.units){if(a.kind!==0)continue;const{offset:c,b:u,edgeProps:{flags:l,order:d,key:f}}=a.bonds;s.a.unit=a,s.b.unit=a;for(let h=0,p=a.elements.length;h<p;h++){s.aIndex=h,s.a.element=a.elements[h];for(let m=c[h],y=c[h+1];m<y;m++)if(s.bIndex=u[m],s.b.element=a.elements[u[m]],s.type=l[m],s.order=d[m],s.key=f[m],s.test(n,!1)){const g=r.subsetBuilder(!1);g.beginUnit(a.id),g.addElement(s.a.element),g.addElement(s.b.element),g.commitUnit(),o.add(g.getStructure())}}}for(const a of i.edges)if(s.a.unit=r.unitMap.get(a.unitA),s.a.element=s.a.unit.elements[a.indexA],s.aIndex=a.indexA,s.b.unit=r.unitMap.get(a.unitB),s.b.element=s.b.unit.elements[a.indexB],s.bIndex=a.indexB,s.order=a.props.order,s.type=a.props.flag,s.key=a.props.key,s.test(n,!1)){const c=r.subsetBuilder(!1);c.addToUnit(s.a.unit.id,s.a.element),c.addToUnit(s.b.unit.id,s.b.element),o.add(c.getStructure())}return n.popCurrentBond(),o.getSelection()}}var hS=Object.freeze({__proto__:null,all:K2,atoms:Zl,bondedAtomicPairs:dS,chains:oS,none:rS,querySelection:fS,residues:iS,rings:lS});const mS=O.add,pS=O.squaredDistance,_S=O.distance;class Ds{reset(){O.set(this.center,0,0,0),this.radiusSq=0,this.count=0}includeStep(t){mS(this.center,this.center,t),this.count++}finishedIncludeStep(){this.count!==0&&O.scale(this.center,this.center,1/this.count)}radiusStep(t){const n=pS(t,this.center);n>this.radiusSq&&(this.radiusSq=n)}radiusSphereStep(t,n){const r=_S(t,this.center)+n,i=r*r;i>this.radiusSq&&(this.radiusSq=i)}getSphere(t){return t||(t=hn()),O.copy(t.center,this.center),t.radius=Math.sqrt(this.radiusSq),t}getCount(){return this.count}constructor(){this.count=0,this.center=O(),this.radiusSq=0}}(function(e){const t=new e,n=O(),r=O();function i({x:a,y:c,z:u},l){t.reset();const d=a.length;for(let f=0;f<d;f++)O.set(n,a[f],c[f],u[f]),t.includeStep(n);t.finishedIncludeStep();for(let f=0;f<d;f++)O.set(n,a[f],c[f],u[f]),t.radiusStep(n);return O.copy(l.center,t.center),l.radius=Math.sqrt(t.radiusSq),l}e.fromArrays=i;function o(a,c,u){t.reset();for(let l=0;l<a;l++)c(l,n),t.includeStep(n);t.finishedIncludeStep();for(let l=0;l<a;l++)c(l,n),t.radiusStep(n);return O.copy(u.center,t.center),u.radius=Math.sqrt(t.radiusSq),u}e.fromProvider=o;function s(a,c,u){t.reset();for(let l=0;l<a;l++)c(l,n,r),t.includeStep(n),t.includeStep(r);t.finishedIncludeStep();for(let l=0;l<a;l++)c(l,n,r),t.radiusStep(n),t.radiusStep(r);return O.copy(u.center,t.center),u.radius=Math.sqrt(t.radiusSq),u}e.fromPairProvider=s})(Ds||(Ds={}));class Fn{getConnectedUnits(t){return this.map.has(t)?this.map.get(t):$2}getEdgeIndex(t,n,r,i){const o=this.edgeKeyIndex.get(Fn.getEdgeUnitKey(n,i));if(o===void 0)return-1;const s=o.get(Fn.getEdgeIndexKey(t,r));return s!==void 0?s:-1}hasEdge(t,n,r,i){return this.getEdgeIndex(t,n,r,i)!==-1}getEdge(t,n,r,i){const o=this.getEdgeIndex(t,n,r,i);return o!==-1?this.edges[o]:void 0}getEdgeIndices(t,n){return this.vertexKeyIndex.get(Fn.getVertexKey(t,n))||[]}constructor(t){this.map=t;let n=0;const r=[],i=new Map,o=new Map;this.map.forEach(s=>{s.forEach(a=>{n+=a.edgeCount,a.connectedIndices.forEach(c=>{a.getEdges(c).forEach(u=>{const{unitA:l,unitB:d}=a,f=Fn.getEdgeIndexKey(l,d),h=Fn.getEdgeIndexKey(c,u.indexB),p=i.get(f);p===void 0?i.set(f,new Map([[h,r.length]])):p.set(h,r.length);const m=Fn.getVertexKey(c,l),y=o.get(m);y===void 0?o.set(m,[r.length]):y.push(r.length),r.push({...u,indexA:c,unitA:l,unitB:d})})})})}),this.edgeCount=n,this.edges=r,this.edgeKeyIndex=i,this.vertexKeyIndex=o}}(function(e){class t{hasEdges(c){return this.edgeMap.has(c)}getEdges(c){return this.edgeMap.has(c)?this.edgeMap.get(c):$2}get areUnitsOrdered(){return this.unitA<this.unitB}constructor(c,u,l,d,f){this.unitA=c,this.unitB=u,this.edgeCount=l,this.connectedIndices=d,this.edgeMap=f}}e.UnitPairEdges=t;function n(a,c){return Hn(a,c)}e.getEdgeUnitKey=n;function r(a,c){return Hn(a,c)}e.getEdgeIndexKey=r;function i(a,c){return Hn(a,c)}e.getVertexKey=i;function o(a,c,u){a.has(c)?a.get(c).push(u):a.set(c,[u])}class s{constructor(){this.map=new Map}startUnitPair(c,u){this.uA=c,this.uB=u,this.mapAB=new Map,this.mapBA=new Map,this.linkedA=mn.create(),this.linkedB=mn.create(),this.linkCount=0}finishUnitPair(){this.linkCount!==0&&(o(this.map,this.uA,new t(this.uA,this.uB,this.linkCount,this.linkedA.array,this.mapAB)),o(this.map,this.uB,new t(this.uB,this.uA,this.linkCount,this.linkedB.array,this.mapBA)))}add(c,u,l){o(this.mapAB,c,{indexB:u,props:l}),o(this.mapBA,u,{indexB:c,props:l}),mn.add(this.linkedA,c,c),mn.add(this.linkedB,u,u),this.linkCount+=1}getMap(){return this.map}}e.Builder=s})(Fn||(Fn={}));const $2=[];var Io;(function(e){e.Empty=or.create([],[],[],0,{flags:[],order:[],key:[]})})(Io||(Io={}));class ji extends Fn{getBondFromLocation(t){return Ne.isAtomic(t.aUnit)&&Ne.isAtomic(t.bUnit)?this.getEdge(t.aIndex,t.aUnit.id,t.bIndex,t.bUnit.id):void 0}getBondIndexFromLocation(t){return Ne.isAtomic(t.aUnit)&&Ne.isAtomic(t.bUnit)?this.getEdgeIndex(t.aIndex,t.aUnit.id,t.bIndex,t.bUnit.id):-1}}(function(e){class t extends Fn.UnitPairEdges{}e.UnitPairBonds=t})(ji||(ji={}));const Y2={forceCompute:!1,noCompute:!1,maxRadius:4},Ql={H:0,h:0,D:0,d:0,T:0,t:0,He:2,HE:2,he:2,Li:3,LI:3,li:3,Be:4,BE:4,be:4,B:5,b:5,C:6,c:6,N:7,n:7,O:8,o:8,F:9,f:9,Ne:10,NE:10,ne:10,Na:11,NA:11,na:11,Mg:12,MG:12,mg:12,Al:13,AL:13,al:13,Si:14,SI:14,si:14,P:15,p:15,S:16,s:16,Cl:17,CL:17,cl:17,Ar:18,AR:18,ar:18,K:19,k:19,Ca:20,CA:20,ca:20,Sc:21,SC:21,sc:21,Ti:22,TI:22,ti:22,V:23,v:23,Cr:24,CR:24,cr:24,Mn:25,MN:25,mn:25,Fe:26,FE:26,fe:26,Co:27,CO:27,co:27,Ni:28,NI:28,ni:28,Cu:29,CU:29,cu:29,Zn:30,ZN:30,zn:30,Ga:31,GA:31,ga:31,Ge:32,GE:32,ge:32,As:33,AS:33,as:33,Se:34,SE:34,se:34,Br:35,BR:35,br:35,Kr:36,KR:36,kr:36,Rb:37,RB:37,rb:37,Sr:38,SR:38,sr:38,Y:39,y:39,Zr:40,ZR:40,zr:40,Nb:41,NB:41,nb:41,Mo:42,MO:42,mo:42,Tc:43,TC:43,tc:43,Ru:44,RU:44,ru:44,Rh:45,RH:45,rh:45,Pd:46,PD:46,pd:46,Ag:47,AG:47,ag:47,Cd:48,CD:48,cd:48,In:49,IN:49,in:49,Sn:50,SN:50,sn:50,Sb:51,SB:51,sb:51,Te:52,TE:52,te:52,I:53,i:53,Xe:54,XE:54,xe:54,Cs:55,CS:55,cs:55,Ba:56,BA:56,ba:56,La:57,LA:57,la:57,Ce:58,CE:58,ce:58,Pr:59,PR:59,pr:59,Nd:60,ND:60,nd:60,Pm:61,PM:61,pm:61,Sm:62,SM:62,sm:62,Eu:63,EU:63,eu:63,Gd:64,GD:64,gd:64,Tb:65,TB:65,tb:65,Dy:66,DY:66,dy:66,Ho:67,HO:67,ho:67,Er:68,ER:68,er:68,Tm:69,TM:69,tm:69,Yb:70,YB:70,yb:70,Lu:71,LU:71,lu:71,Hf:72,HF:72,hf:72,Ta:73,TA:73,ta:73,W:74,w:74,Re:75,RE:75,re:75,Os:76,OS:76,os:76,Ir:77,IR:77,ir:77,Pt:78,PT:78,pt:78,Au:79,AU:79,au:79,Hg:80,HG:80,hg:80,Tl:81,TL:81,tl:81,Pb:82,PB:82,pb:82,Bi:83,BI:83,bi:83,Po:84,PO:84,po:84,At:85,AT:85,at:85,Rn:86,RN:86,rn:86,Fr:87,FR:87,fr:87,Ra:88,RA:88,ra:88,Ac:89,AC:89,ac:89,Th:90,TH:90,th:90,Pa:91,PA:91,pa:91,U:92,u:92,Np:93,NP:93,np:93,Pu:94,PU:94,pu:94,Am:95,AM:95,am:95,Cm:96,CM:96,cm:96,Bk:97,BK:97,bk:97,Cf:98,CF:98,cf:98,Es:99,ES:99,es:99,Fm:100,FM:100,fm:100,Md:101,MD:101,md:101,No:102,NO:102,no:102,Lr:103,LR:103,lr:103,Rf:104,RF:104,rf:104,Db:105,DB:105,db:105,Sg:106,SG:106,sg:106,Bh:107,BH:107,bh:107,Hs:108,HS:108,hs:108,Mt:109,MT:109,mt:109},yS={0:1.42,1:1.42,3:2.7,4:2.7,6:1.75,7:1.6,8:1.52,11:2.7,12:2.7,13:2.7,14:1.9,15:2,16:1.9,17:1.8,19:2.7,20:2.7,21:2.7,22:2.7,23:2.7,24:2.7,25:2.7,26:2.7,27:2.7,28:2.7,29:2.7,30:2.7,31:2.7,33:2.68,37:2.7,38:2.7,39:2.7,40:2.7,41:2.7,42:2.7,43:2.7,44:2.7,45:2.7,46:2.7,47:2.7,48:2.7,49:2.7,50:2.7,55:2.7,56:2.7,57:2.7,58:2.7,59:2.7,60:2.7,61:2.7,62:2.7,63:2.7,64:2.7,65:2.7,66:2.7,67:2.7,68:2.7,69:2.7,70:2.7,71:2.7,72:2.7,73:2.7,74:2.7,75:2.7,76:2.7,77:2.7,78:2.7,79:2.7,80:2.7,81:2.7,82:2.7,83:2.7,87:2.7,88:2.7,89:2.7,90:2.7,91:2.7,92:2.7,93:2.7,94:2.7,95:2.7,96:2.7,97:2.7,98:2.7,99:2.7,100:2.7,101:2.7,102:2.7,103:2.7,104:2.7,105:2.7,106:2.7,107:2.7,108:2.7,109:2.88},gS={0:.8,20:1.31,27:1.2,35:1.15,44:1.1,54:1,60:1.84,72:1.88,84:1.75,85:1.56,86:1.76,98:1.6,99:1.68,100:1.63,112:1.6,113:1.59,114:1.36,129:1.45,135:1.47,144:1.6,152:1.45,170:1.4,180:1.55,202:2.4,222:2.24,224:1.91,225:1.98,243:2.02,269:2,293:1.9,316:1.8,420:2.37,480:2.3,512:2.3,544:2.3,612:2.1,629:1.54,665:1,813:2.6,854:2.27,894:1.93,896:2.1,937:2.05,938:2.06,981:1.62,1258:2.68,1309:2.33,1484:1,1763:2.14,1823:2.48,1882:2.1,1944:1.72,2380:2.34,3367:2.44,3733:2.11,3819:2.6,3821:2.36,4736:2.75,5724:2.73,5959:2.63,6519:2.84,6750:2.87,8991:2.81},W2=2.001,Ns=function(){const e=["LI","NA","K","RB","CS","FR","BE","MG","CA","SR","BA","RA","AL","GA","IN","SN","TL","PB","BI","SC","TI","V","CR","MN","FE","CO","NI","CU","ZN","Y","ZR","NB","MO","TC","RU","RH","PD","AG","CD","LA","HF","TA","W","RE","OS","IR","PT","AU","HG","AC","RF","DB","SG","BH","HS","MT","CE","PR","ND","PM","SM","EU","GD","TB","DY","HO","ER","TM","YB","LU","TH","PA","U","NP","PU","AM","CM","BK","CF","ES","FM","MD","NO","LR"],t=new Set;for(const n of e)t.add(Ql[n]);return t}();function bS(e,t){return e<t?(e+t)*(e+t+1)/2+t:(e+t)*(e+t+1)/2+e}function Gr(e){const t=Ql[e];return t===void 0?-1:t}function vS(e,t){if(e<0||t<0)return-1;const n=gS[bS(e,t)];return n===void 0?-1:n}function Hr(e){if(e<0)return W2;const t=yS[e];return t===void 0?W2:t}function Ms(e,t,n,r){const i=vS(e,t);return i>0?i:t<0?n:(n+r)/1.95}const xS=Ql.H;function jr(e){return e===xS}const AS=new Map([["HIS|CD2|CG",2],["HIS|CE1|ND1",2],["ARG|CZ|NH2",2],["PHE|CE1|CZ",2],["PHE|CD2|CE2",2],["PHE|CD1|CG",2],["TRP|CD1|CG",2],["TRP|CD2|CE2",2],["TRP|CE3|CZ3",2],["TRP|CH2|CZ2",2],["ASN|CG|OD1",2],["GLN|CD|OE1",2],["TYR|CD1|CG",2],["TYR|CD2|CE2",2],["TYR|CE1|CZ",2],["ASP|CG|OD1",2],["GLU|CD|OE1",2],["G|C8|N7",2],["G|C4|C5",2],["G|C2|N3",2],["G|C6|O6",2],["C|C4|N3",2],["C|C5|C6",2],["C|C2|O2",2],["A|C2|N3",2],["A|C6|N1",2],["A|C4|C5",2],["A|C8|N7",2],["U|C5|C6",2],["U|C2|O2",2],["U|C4|O4",2],["DG|C8|N7",2],["DG|C4|C5",2],["DG|C2|N3",2],["DG|C6|O6",2],["DC|C4|N3",2],["DC|C5|C6",2],["DC|C2|O2",2],["DA|C2|N3",2],["DA|C6|N1",2],["DA|C4|C5",2],["DA|C8|N7",2],["DT|C5|C6",2],["DT|C2|O2",2],["DT|C4|O4",2]]);function SS(e,t,n){return[t,n]=t<n?[t,n]:[n,t],Es.has(e)&&t==="C"&&n==="O"||T2.has(e)&&t==="OP1"&&n==="P"?2:AS.get(`${e}|${t}|${n}`)||1}const CS=new Map([["LYS|NZ|RET|C15",2]]);function Z2(e,t,n,r){return e>n&&([e,n]=[n,e],[t,r]=[r,t]),CS.get(`${e}|${t}|${n}|${r}`)||1}var Jl;(function(e){function t(a,c,u){return{name:a,type:0,value:c,valueKind:u&&u.valueKind,defaultFormat:u&&u.encoder?{encoder:u.encoder}:void 0,shouldInclude:u&&u.shouldInclude}}e.str=t;function n(a,c,u){return{name:a,type:1,value:c,valueKind:u&&u.valueKind,defaultFormat:u?{encoder:u.encoder,typedArray:u.typedArray}:void 0,shouldInclude:u&&u.shouldInclude}}e.int=n;function r(a,c,u){return{name:a,type:2,value:c,valueKind:u&&u.valueKind,defaultFormat:u?{encoder:u.encoder,typedArray:u.typedArray,digitCount:typeof u.digitCount<"u"?u.digitCount:void 0}:void 0,shouldInclude:u&&u.shouldInclude}}e.float=r;function i(a){return n(a,(c,u,l)=>l+1,{typedArray:Int32Array,encoder:Qe.by(Qe.delta).and(Qe.runLength).and(Qe.integerPacking)})}e.index=i;class o{constructor(){this.fields=[]}index(c){return this.fields.push(e.index(c)),this}str(c,u,l){return this.fields.push(e.str(c,u,l)),this}int(c,u,l){return this.fields.push(e.int(c,u,l)),this}vec(c,u,l){for(let d=0;d<u.length;d++)this.fields.push(e.int(`${c}[${d+1}]`,u[d],l));return this}float(c,u,l){return this.fields.push(e.float(c,u,l)),this}many(c){for(let u=0;u<c.length;u++)this.fields.push(c[u]);return this}add(c){return this.fields.push(c),this}getFields(){return this.fields}}e.Builder=o;function s(){return new o}e.build=s})(Jl||(Jl={}));var Bn;(function(e){e.Empty={fields:[],source:[]};function t(r){const i=[],o=[],s=[],a=[];for(let u of r.split(/[\r\n]+/)){if(u=u.trim(),u.length===0)continue;const l=/^!/.test(u);l&&(u=u.substr(1));const d=u.split(/\./),f=d[1],h=l?f?a:o:f?s:i;h[h.length]=u,f&&!i.includes(d[0])&&(i[i.length]=d[0])}const c=s.map(u=>u.split(".")[0]);return{includeCategory(u){return o.includes(u)?!1:i.length<=0||i.indexOf(u)!==-1},includeField(u,l){const d=u+"."+l;return a.includes(d)?!1:!c.includes(u)||s.includes(d)}}}e.filterOf=t,e.DefaultFilter={includeCategory(r){return!0},includeField(r,i){return!0}},e.DefaultFormatter={getFormat(r,i){}};function n(r,i){return i?{fields:X2(r._schema),source:[{data:r,rowCount:i.length,keys:()=>Cs.Array(i)}]}:{fields:X2(r._schema),source:[{data:r,rowCount:r._rowCount}]}}e.ofTable=n})(Bn||(Bn={}));var ef;(function(e){function t(r,i,o){r.startDataBlock(i);for(const s of o._tableNames)r.writeCategory({name:s,instance:()=>Bn.ofTable(o[s])})}e.writeDatabase=t;function n(r,i){for(const o of Object.keys(i))t(r,o,i[o])}e.writeDatabaseCollection=n})(ef||(ef={}));function tf(e){return(t,n)=>n[e].value(t)}function IS(e){return(t,n)=>n[e].value(t).join(n[e].schema.separator)}function nf(e,...t){return(n,r)=>r[e].schema.space.get(r[e].value(n),...t)}function wo(e){return(t,n)=>n[e].valueKind(t)}function wS(e,t){const n=[],i=wo(e);if(t.rank===1){const o=t.dimensions[0];for(let s=0;s<o;s++){const a=`${e}[${s+1}]`;n.push({name:a,type:2,value:nf(e,s),valueKind:i})}}else if(t.rank===2){const o=t.dimensions[0],s=t.dimensions[1];for(let a=0;a<o;a++)for(let c=0;c<s;c++){const u=`${e}[${a+1}][${c+1}]`;n.push({name:u,type:2,value:nf(e,a,c),valueKind:i})}}else if(t.rank===3){const o=t.dimensions[0],s=t.dimensions[1],a=t.dimensions[2];for(let c=0;c<o;c++)for(let u=0;u<s;u++)for(let l=0;l<a;l++){const d=`${e}[${c+1}][${u+1}][${l+1}]`;n.push({name:d,type:2,value:nf(e,c,u,l),valueKind:i})}}else throw new Error("Tensors with rank > 3 or rank 0 are currently not supported.");return n}function X2(e){const t=[];for(const n of Object.keys(e)){const r=e[n];r.valueType==="int"?t.push({name:n,type:1,value:tf(n),valueKind:wo(n)}):r.valueType==="float"?t.push({name:n,type:2,value:tf(n),valueKind:wo(n)}):r.valueType==="str"?t.push({name:n,type:0,value:tf(n),valueKind:wo(n)}):r.valueType==="list"?t.push({name:n,type:0,value:IS(n),valueKind:wo(n)}):r.valueType==="tensor"?t.push(...wS(n,r.space)):Ri(r.valueType)}return t}function PS(e){return e.defaultFormat&&typeof e.defaultFormat.digitCount<"u"?Math.max(0,Math.min(e.defaultFormat.digitCount,16)):6}function rf(e){return e.fields.some(t=>!!t.shouldInclude)?e.fields.filter(t=>!t.shouldInclude||e.source.some(n=>t.shouldInclude(n.data))):e.fields}function Q2(e,t){const n=e.instance(t),r=n.source.filter(s=>s.rowCount>0);if(!r.length)return{instance:n,rowCount:0,source:[]};const i=r.reduce((s,a)=>s+a.rowCount,0),o=r.map(s=>({data:s.data,keys:()=>s.keys?s.keys():Cs.Range(0,s.rowCount-1),rowCount:s.rowCount}));return{instance:n,rowCount:i,source:o}}let ES=class{constructor(){this.builder=ft.create(),this.encoded=!1,this.dataBlockCreated=!1,this.filter=Bn.DefaultFilter,this.formatter=Bn.DefaultFormatter,this.isBinary=!1,this.binaryEncodingProvider=void 0}setFilter(t){this.filter=t||Bn.DefaultFilter}isCategoryIncluded(t){return this.filter.includeCategory(t)}setFormatter(t){this.formatter=t||Bn.DefaultFormatter}startDataBlock(t){this.dataBlockCreated=!0,ft.write(this.builder,`data_${(t||"").replace(/[ \n\t]/g,"").toUpperCase()}
#
`)}writeCategory(t,n,r){if(this.encoded)throw new Error("The writer contents have already been encoded, no more writing.");if(!this.dataBlockCreated)throw new Error("No data block created.");if(!(r!=null&&r.ignoreFilter)&&!this.filter.includeCategory(t.name))return;const{instance:i,rowCount:o,source:s}=Q2(t,n);o&&(o===1?BS(t,i,s,this.builder,this.filter,this.formatter):RS(t,i,s,this.builder,this.filter,this.formatter))}encode(){this.encoded=!0}writeTo(t){const n=ft.getChunks(this.builder);for(let r=0,i=n.length;r<i;r++)t.writeString(n[r])}getSize(){return ft.getSize(this.builder)}getData(){return ft.getString(this.builder)}};function J2(e,t,n,r,i,o){const s=r.valueKind,a=s?s(n,t):0;if(a!==0)a===1?TS(e):OS(e);else{const c=r.value(n,t,o),u=r.type;if(u===0)return DS(c)?(Ts(e,c),!0):kS(e,c);u===1?NS(e,c):MS(e,c,i)}return!1}function e_(e,t,n){const r=[];for(const i of t){const o=n.getFormat(e,i.name);o&&typeof o.digitCount<"u"?r[r.length]=i.type===2?Math.pow(10,Math.max(0,Math.min(o.digitCount,15))):0:r[r.length]=i.type===2?Math.pow(10,PS(i)):0}return r}function BS(e,t,n,r,i,o){const s=rf(t),a=n[0],c=a.data;let u=s.reduce((h,p)=>i.includeField(e.name,p.name)?Math.max(h,p.name.length):0,0);if(u===0)return;u+=e.name.length+6;const d=a.keys().move(),f=e_(e.name,t.fields,o);for(let h=0;h<s.length;h++){const p=s[h];if(!i.includeField(e.name,p.name))continue;ft.writePadRight(r,`_${e.name}.${p.name}`,u),J2(r,c,d,p,f[h],0)||ft.newline(r)}ft.write(r,`#
`)}function RS(e,t,n,r,i,o){const s=rf(t),a=i===Bn.DefaultFilter?s:s.filter(d=>i.includeField(e.name,d.name)),c=a.length;if(c===0)return;const u=e_(e.name,a,o);t_(r,"loop_");for(let d=0;d<c;d++)t_(r,`_${e.name}.${a[d].name}`);let l=0;for(let d=0;d<n.length;d++){const f=n[d],h=f.data;if(f.rowCount===0)continue;const p=f.keys();for(;p.hasNext;){const m=p.move();let y=!1;for(let g=0;g<c;g++)y=J2(r,h,m,a[g],u[g],l);y||ft.newline(r),l++}}ft.write(r,`#
`)}function DS(e){return typeof e=="string"&&e.indexOf(`
`)>=0}function t_(e,t){ft.write(e,t),ft.newline(e)}function NS(e,t){ft.writeInteger(e,t),ft.whitespace1(e)}function MS(e,t,n){ft.writeFloat(e,t,n),ft.whitespace1(e)}function TS(e){ft.writeSafe(e,". ")}function OS(e){ft.writeSafe(e,"? ")}function kS(e,t){if(!t)return ft.writeSafe(e,". "),!1;const n=t.charCodeAt(0);let r=!1,i=0,o=!1,s=!1;for(let a=0,c=t.length-1;a<=c;a++)switch(t.charCodeAt(a)){case 9:r=!0;break;case 10:return Ts(e,t),!0;case 32:r=!0;break;case 34:if(a&&a===c)break;if(o)return Ts(e,t),!0;s=!0,r=!0,i=0;break;case 39:if(a&&a===c)break;if(s)return Ts(e,t),!0;o=!0,r=!0,i=1;break}return!r&&(n===35||n===36||n===59||n===91||n===93||n===95)&&(r=!0),r?(ft.writeSafe(e,i?'"':"'"),ft.writeSafe(e,t),ft.writeSafe(e,i?'" ':"' ")):(ft.writeSafe(e,t),ft.writeSafe(e," ")),!1}function Ts(e,t){ft.writeSafe(e,`
;`+t),ft.writeSafe(e,`
;
`)}function qS(e){const t=new ArrayBuffer(Os(e)),n=new DataView(t),r=new Uint8Array(t);return ks(e,n,r,0),r}function Os(e){const t=typeof e;if(t==="string"){const n=Bp(e);if(n<32)return 1+n;if(n<256)return 2+n;if(n<65536)return 3+n;if(n<4294967296)return 5+n}if(e instanceof Uint8Array){const n=e.byteLength;if(n<256)return 2+n;if(n<65536)return 3+n;if(n<4294967296)return 5+n}if(t==="number"){if(Math.floor(e)!==e)return 9;if(e>=0){if(e<128)return 1;if(e<256)return 2;if(e<65536)return 3;if(e<4294967296)return 5;throw new Error("Number too big 0x"+e.toString(16))}if(e>=-32)return 1;if(e>=-128)return 2;if(e>=-32768)return 3;if(e>=-2147483648)return 5;throw new Error("Number too small -0x"+e.toString(16).substr(1))}if(t==="boolean"||e===null||e===void 0)return 1;if(t==="object"){let n,r=0;if(Array.isArray(e)){n=e.length;for(let i=0;i<n;i++)r+=Os(e[i])}else{const i=Object.keys(e);n=i.length;for(let o=0;o<n;o++){const s=i[o];r+=Os(s)+Os(e[s])}}if(n<16)return 1+r;if(n<65536)return 3+r;if(n<4294967296)return 5+r;throw new Error("Array or object too long 0x"+n.toString(16))}throw new Error("Unknown type "+t)}function ks(e,t,n,r){const i=typeof e;if(i==="string"){const o=Bp(e);if(o<32)return t.setUint8(r,o|160),ms(n,r+1,e),1+o;if(o<256)return t.setUint8(r,217),t.setUint8(r+1,o),ms(n,r+2,e),2+o;if(o<65536)return t.setUint8(r,218),t.setUint16(r+1,o),ms(n,r+3,e),3+o;if(o<4294967296)return t.setUint8(r,219),t.setUint32(r+1,o),ms(n,r+5,e),5+o}if(e instanceof Uint8Array){const o=e.byteLength,s=new Uint8Array(t.buffer);if(o<256)return t.setUint8(r,196),t.setUint8(r+1,o),s.set(e,r+2),2+o;if(o<65536)return t.setUint8(r,197),t.setUint16(r+1,o),s.set(e,r+3),3+o;if(o<4294967296)return t.setUint8(r,198),t.setUint32(r+1,o),s.set(e,r+5),5+o}if(i==="number"){if(!isFinite(e))throw new Error("Number not finite: "+e);if(Math.floor(e)!==e)return t.setUint8(r,203),t.setFloat64(r+1,e),9;if(e>=0){if(e<128)return t.setUint8(r,e),1;if(e<256)return t.setUint8(r,204),t.setUint8(r+1,e),2;if(e<65536)return t.setUint8(r,205),t.setUint16(r+1,e),3;if(e<4294967296)return t.setUint8(r,206),t.setUint32(r+1,e),5;throw new Error("Number too big 0x"+e.toString(16))}if(e>=-32)return t.setInt8(r,e),1;if(e>=-128)return t.setUint8(r,208),t.setInt8(r+1,e),2;if(e>=-32768)return t.setUint8(r,209),t.setInt16(r+1,e),3;if(e>=-2147483648)return t.setUint8(r,210),t.setInt32(r+1,e),5;throw new Error("Number too small -0x"+(-e).toString(16).substr(1))}if(e==null)return t.setUint8(r,192),1;if(i==="boolean")return t.setUint8(r,e?195:194),1;if(i==="object"){let o,s=0;const a=Array.isArray(e);let c;if(a?o=e.length:(c=Object.keys(e),o=c.length),o<16?(t.setUint8(r,o|(a?144:128)),s=1):o<65536?(t.setUint8(r,a?220:222),t.setUint16(r+1,o),s=3):o<4294967296&&(t.setUint8(r,a?221:223),t.setUint32(r+1,o),s=5),a)for(let u=0;u<o;u++)s+=ks(e[u],t,n,r+s);else for(let u=0,l=c.length;u<l;u++){const d=c[u];s+=ks(d,t,n,r+s),s+=ks(e[d],t,n,r+s)}return s}throw new Error("Unknown type "+i)}class US{setFilter(t){this.filter=t||Bn.DefaultFilter}isCategoryIncluded(t){return this.filter.includeCategory(t)}setFormatter(t){this.formatter=t||Bn.DefaultFormatter}startDataBlock(t){this.dataBlocks.push({header:(t||"").replace(/[ \n\t]/g,"").toUpperCase(),categories:[]})}writeCategory(t,n,r){if(!this.data)throw new Error("The writer contents have already been encoded, no more writing.");if(!this.dataBlocks.length)throw new Error("No data block created.");if(!(r!=null&&r.ignoreFilter)&&!this.filter.includeCategory(t.name))return;const{instance:i,rowCount:o,source:s}=Q2(t,n);if(!o)return;const a={name:"_"+t.name,columns:[],rowCount:o},c=rf(i);for(const u of c){if(!this.filter.includeField(t.name,u.name))continue;const l=this.formatter.getFormat(t.name,u.name);a.columns.push(jS(t.name,u,s,o,l,this.binaryEncodingProvider,this.autoClassify))}a.columns.length&&this.dataBlocks[this.dataBlocks.length-1].categories.push(a)}encode(){this.encodedData||(this.encodedData=qS(this.data),this.data=null,this.dataBlocks=null)}writeTo(t){t.writeBinary(this.encodedData)}getData(){return this.encode(),this.encodedData}getSize(){return this.encodedData.length}constructor(t,n,r){this.autoClassify=r,this.dataBlocks=[],this.filter=Bn.DefaultFilter,this.formatter=Bn.DefaultFormatter,this.isBinary=!0,this.binaryEncodingProvider=void 0,this.binaryEncodingProvider=n,this.data={encoder:t,version:Wv,dataBlocks:this.dataBlocks}}}function FS(e,t){return t&&t.typedArray?t.typedArray:e.defaultFormat&&e.defaultFormat.typedArray?e.defaultFormat.typedArray:e.type===0?Array:e.type===1?Int32Array:Float64Array}function LS(e){return e===0?pr.by(Qe.stringArray):pr.by(Qe.byteArray)}function GS(e,t,n,r){return n&&n.encoder?n.encoder:t.defaultFormat&&t.defaultFormat.encoder?t.defaultFormat.encoder:r?r.get(e,t.name):void 0}function HS(e,t){return e===0?pr.by(Qe.stringArray):e===1?vl(t):Bx(t)}function jS(e,t,n,r,i,o,s){const{array:a,allPresent:c,mask:u}=zS(t,FS(t,i),r,n);let l;t.type===0?l=pr.by(Qe.stringArray):l=GS(e,t,i,o),l||(s?l=HS(t.type,a):l=LS(t.type));const d=l.encode(a);let f;if(!c){const h=pr.by(Qe.runLength).and(Qe.byteArray).encode(u);h.data.length<u.length?f=h:f=pr.by(Qe.byteArray).encode(u)}return{name:t.name,data:d,mask:f}}function zS(e,t,n,r){const i=e.type===0,o=new t(n),s=new Uint8Array(n),a=e.valueKind,c=e.value;let u=!0,l=0;for(let d=0;d<r.length;d++){const f=r[d].data,h=r[d].keys();for(;h.hasNext;){const p=h.move(),m=a?a(p,f):0;if(m!==0)s[l]=m,i&&(o[l]=""),u=!1;else{const y=c(p,f,l);typeof y=="string"&&!y?(s[l]=1,u=!1):s[l]=0,o[l]=y}l++}}return{array:o,allPresent:u,mask:s}}var nn;(function(e){e.Encoder=ef,e.Category=Bn,e.Field=Jl,e.Encoding=Qe;function t(c){const{binary:u=!1,encoderName:l="mol*"}=c||{};return u?new US(l,c?c.binaryEncodingPovider:void 0,c?!!c.binaryAutoClassifyEncoding:!1):new ES}e.createEncoder=t;function n(){return e.Field.build()}e.fields=n;var r=e.Encoding;e.Encodings={deltaRLE:r.by(r.delta).and(r.runLength).and(r.integerPacking),fixedPoint2:r.by(r.fixedPoint(100)).and(r.delta).and(r.integerPacking),fixedPoint3:r.by(r.fixedPoint(1e3)).and(r.delta).and(r.integerPacking)};function i(c,u){return{fields:c,source:[u]}}e.categoryInstance=i;function o(c){return{get(u,l){const d=c.categories[u];if(!d)return;const f=d.getField(l);return f&&f.binaryEncoding?pr.fromEncoding(f.binaryEncoding):void 0}}}e.createEncodingProviderFromCifFrame=o;function s(c){return{get(u,l){for(let d=0;d<c.length;d++){const f=c[d];if(f.categoryName===u&&f.columnName===l)return a(f)}}}}e.createEncodingProviderFromJsonConfig=s;function a(c){const u=c.precision;if(u!==void 0){const l=Math.pow(10,u),d=r.by(r.fixedPoint(l));switch(c.encoding){case"pack":return d.and(r.integerPacking);case"rle":return d.and(r.runLength).and(r.integerPacking);case"delta":return d.and(r.delta).and(r.integerPacking);case"delta-rle":return d.and(r.delta).and(r.runLength).and(r.integerPacking)}}else switch(c.encoding){case"pack":return r.by(r.integerPacking);case"rle":return r.by(r.runLength).and(r.integerPacking);case"delta":return r.by(r.delta).and(r.integerPacking);case"delta-rle":return r.by(r.delta).and(r.runLength).and(r.integerPacking)}throw new Error("cannot be reached")}})(nn||(nn={}));var Po;(function(e){e.Descriptor={name:"chem_comp_bond",cifExport:{prefix:"",categories:[{name:"chem_comp_bond",instance(i){const o=e.Provider.get(i.firstModel);if(!o)return nn.Category.Empty;const s=o.data;if(!s)return nn.Category.Empty;const a=i.structures[0].uniqueResidueNames,{comp_id:c,_rowCount:u}=s,l=[];for(let d=0;d<u;d++)a.has(c.value(d))&&(l[l.length]=d);return nn.Category.ofTable(s,l)}}]}},e.Provider=sr.create(e.Descriptor);function t(i,o){return At.pick(o,et.chem_comp_bond,s=>i.properties.chemicalComponentMap.has(o.comp_id.value(s)))}e.chemCompBondFromTable=t;function n(i){const o=new Map;function s(m){if(o.has(m))return o.get(m);const y=new r(m);return o.set(m,y),y}const{comp_id:a,atom_id_1:c,atom_id_2:u,value_order:l,pdbx_aromatic_flag:d,_rowCount:f,pdbx_ordinal:h}=i;let p=s(a.value(0));for(let m=0;m<f;m++){const y=a.value(m),g=c.value(m),b=u.value(m),v=l.value(m),_=d.value(m)==="y",A=h.value(m);p.id!==y&&(p=s(y));let C=1,I=1;switch(_&&(C|=16),v.toLowerCase()){case"delo":C|=16;break;case"doub":I=2;break;case"trip":I=3;break;case"quad":I=4;break}p.add(g,b,I,C,A)}return o}e.getEntriesFromChemCompBond=n;class r{add(o,s,a,c,u,l=!0){const d=this.map.get(o);if(d!==void 0)d.get(s)===void 0&&d.set(s,{order:a,flags:c,key:u});else{const f=new Map;f.set(s,{order:a,flags:c,key:u}),this.map.set(o,f)}l&&this.add(s,o,a,c,u,!1)}constructor(o){this.id=o,this.map=new Map}}e.Entry=r})(Po||(Po={}));var Yn;(function(e){e.Descriptor={name:"struct_conn",cifExport:{prefix:"",categories:[{name:"struct_conn",instance(o){const s=e.Provider.get(o.firstModel);if(!s||s.entries.length===0)return nn.Category.Empty;const a=o.structures[0],c=[];for(const u of s.entries)n(a,u.partnerA.atomIndex)&&n(a,u.partnerB.atomIndex)&&(c[c.length]=u.rowIndex);return nn.Category.ofTable(s.data,c)}}]}},e.Provider=sr.create(e.Descriptor);function t(o){const s=e.Provider.get(o);return!!s&&s.entries.length/o.atomicConformation.atomId.rowCount>.95}e.isExhaustive=t;function n({units:o},s){for(let a=0,c=o.length;a<c;a++)if(ve.indexOf(o[a].elements,s)>=0)return!0;return!1}function r(o){const s=new Map;for(const a of o){const{partnerA:{atomIndex:c},partnerB:{atomIndex:u}}=a;s.has(c)?s.get(c).push(a):s.set(c,[a]),s.has(u)?s.get(u).push(a):s.set(u,[a])}return s}e.getAtomIndexFromEntries=r;function i(o,s){const{conn_type_id:a,pdbx_dist_value:c,pdbx_value_order:u}=o,l={label_asym_id:o.ptnr1_label_asym_id,label_seq_id:o.ptnr1_label_seq_id,auth_seq_id:o.ptnr1_auth_seq_id,label_atom_id:o.ptnr1_label_atom_id,label_alt_id:o.pdbx_ptnr1_label_alt_id,ins_code:o.pdbx_ptnr1_PDB_ins_code,symmetry:o.ptnr1_symmetry},d={label_asym_id:o.ptnr2_label_asym_id,label_seq_id:o.ptnr2_label_seq_id,auth_seq_id:o.ptnr2_auth_seq_id,label_atom_id:o.ptnr2_label_atom_id,label_alt_id:o.pdbx_ptnr2_label_alt_id,ins_code:o.pdbx_ptnr2_PDB_ins_code,symmetry:o.ptnr2_symmetry},f=Array.from(s.entities.data.id.toArray()),h=(m,y)=>{if(y.label_asym_id.valueKind(m)!==0)return;const g=y.label_asym_id.value(m),b=y.label_atom_id.value(m);if(!b)return;const v=y.auth_seq_id.valueKind(m)===Ce.ValueKind.Present?y.auth_seq_id.value(m):y.label_seq_id.value(m),_=y.ins_code.value(m),A=y.label_alt_id.value(m);for(const C of f){const I=s.atomicHierarchy.index.findResidue(C,g,v,_);if(I<0)continue;const S=s.atomicHierarchy.index.findAtomOnResidue(I,b,A);if(!(S<0))return{residueIndex:I,atomIndex:S,symmetry:y.symmetry.value(m)}}},p=[];for(let m=0;m<o._rowCount;m++){const y=h(m,l),g=h(m,d);if(y===void 0||g===void 0)continue;const b=a.value(m),v=u.value(m)||"";let _=0,A=1;switch(v){case"sing":A=1;break;case"doub":A=2;break;case"trip":A=3;break;case"quad":A=4;break;default:A=Z2(o.ptnr1_label_comp_id.value(m),o.ptnr1_label_atom_id.value(m),o.ptnr2_label_comp_id.value(m),o.ptnr2_label_atom_id.value(m))}switch(b){case"covale":_=1;break;case"disulf":_=9;break;case"hydrog":_=4;break;case"metalc":_=2;break}p.push({rowIndex:m,flags:_,order:A,distance:c.value(m),partnerA:y,partnerB:g})}return p}e.getEntriesFromStructConn=i})(Yn||(Yn={}));const VS=O.distance,KS=6,$S=5.5,YS=3.9;function of(e,t,n,r,i,o,s){const a=new or.EdgeBuilder(o,e,t),c=new Uint16Array(a.slotCount),u=new Int8Array(a.slotCount),l=new Uint32Array(a.slotCount);for(let d=0,f=a.edgeCount;d<f;d++)a.addNextEdge(),a.assignProperty(c,r[d]),a.assignProperty(u,n[d]),a.assignProperty(l,i[d]);return a.createGraph({flags:c,order:u,key:l},s)}const n_=O(),r_=O();function WS(e,t,n){return e.conformation.position(t,n_),e.conformation.position(n,r_),VS(n_,r_)}const ZS=new Set;function XS(e){const t=xn.Provider.get(e.model),{elements:n}=e,{type_symbol:r}=e.model.atomicHierarchy.atoms,i=e.elements.length,{maxDistance:o}=t,{offset:s,b:a,edgeProps:{order:c,distance:u,flag:l,key:d,operatorA:f,operatorB:h}}=t.bonds,{atomSourceIndex:p}=e.model.atomicHierarchy,{invertedIndex:m}=$t.getInvertedAtomSourceIndex(e.model),y=[],g=[],b=[],v=[],_=[],A=e.conformation.operator.key;for(let C=0;C<i;C++){const I=n[C],S=Gr(r.value(I)),w=jr(S),R=p.value(I);for(let M=s[R],P=s[R+1];M<P;++M){const E=m[a[M]];if(I>=E)continue;const N=ve.indexOf(e.elements,E);if(N<0)continue;const q=f[M],j=h[M];if(q>=0&&q!==A||j>=0&&j!==A)continue;const z=Gr(r.value(E)),W=u[M],se=WS(e,I,E);let ue=!1;if(W>=0)ue=sn(se,W,.3);else if(o>=0)ue=se<o;else{const $=Ms(S,z,Hr(S),Hr(z));ue=se<$,w&&jr(z)&&(ue=!1)}ue&&(y[y.length]=C,g[g.length]=N,v[v.length]=c[M],b[b.length]=l[M],_[_.length]=d[M])}}return of(y,g,v,b,_,i,{canRemap:!1,cacheable:t.cacheable})}function QS(e,t){const n=$t.isCoarseGrained(e.model),r=n?KS:t.maxRadius,{x:i,y:o,z:s}=e.model.atomicConformation,a=e.elements.length,{elements:c,residueIndex:u,chainIndex:l}=e,{type_symbol:d,label_atom_id:f,label_alt_id:h,label_comp_id:p}=e.model.atomicHierarchy.atoms,{label_seq_id:m}=e.model.atomicHierarchy.residues,{traceElementIndex:y}=e.model.atomicHierarchy.derived.residue,{index:g}=e.model.atomicHierarchy,{byEntityKey:b}=e.model.sequence,v=e.lookup3d,_=Yn.Provider.get(e.model),A=Po.Provider.get(e.model),C=Yn.isExhaustive(e.model),I=[],S=[],w=[],R=[],M=[];let P=-1,E,N=!0,q=!0,j=!0;const z=ZS,W=!!(_!=null&&_.residueCantorPairs.size);for(let se=0;se<a;se++){const ue=c[se],$=d.value(ue);N&&$!=="H"&&$!=="O"&&(N=!1);const ne=t.forceCompute?void 0:_&&_.byAtomIndex.get(ue);let de=!1;if(ne)for(const L of ne){const{partnerA:U,partnerB:Y}=L;if(U.symmetry!==Y.symmetry)continue;const fe=U.atomIndex===ue?Y:U,me=ve.indexOf(e.elements,fe.atomIndex);me<0||c[me]<ue||(I[I.length]=se,S[S.length]=me,w[w.length]=L.flags,R[R.length]=L.order,M[M.length]=L.rowIndex,de||z.clear(),de=!0,z.add(me))}if(C)continue;const _e=u[ue],X=m.value(_e),ce=p.value(ue);if(!t.forceCompute&&_e!==P)if(A&&A.entries.has(ce)){const L=b[g.getEntityFromChain(l[ue])];L&&L.sequence.microHet.has(X)?E=void 0:E=A.entries.get(ce).map}else E=void 0;P=_e;const k=Gr($),B=f.value(ue),F=E?E.get(B):void 0,{indices:re,count:G,squaredDistances:V}=v.find(i[ue],o[ue],s[ue],r),K=jr(k),Q=Hr(k),Z=h.value(ue),ie=Ns.has(k);for(let L=0;L<G;L++){const U=re[L];if(de&&z.has(U))continue;const Y=c[U];if(Y<=ue)continue;const fe=h.value(Y);if(Z&&fe&&Z!==fe)continue;if(W){const he=ho(u[ue],u[Y]);if(_.residueCantorPairs.has(he))continue}const me=Gr(d.value(Y)),Te=jr(me);if(K&&Te)continue;const x=(ie||Ns.has(me))&&!(K||Te),D=u[Y];if(_e===D&&F){const he=F.get(f.value(Y));if(he){I[I.length]=se,S[S.length]=U,R[R.length]=he.order;let ye=he.flags;x&&(ye|1&&(ye^=1),ye|=2),w[w.length]=ye,M[M.length]=he.key}continue}const J=Math.sqrt(V[L]);if(J===0)continue;let le=!1;if(n)_e===D?le=J<=$S:le=J<=YS&&y[_e]===ue&&y[D]===Y;else{const he=Ms(k,me,Q,Hr(me));le=J<=he}if(le){I[I.length]=se,S[S.length]=U,R[R.length]=SS(ce,B,f.value(Y)),w[w.length]=(x?2:1)|32,M[M.length]=-1;const he=m.value(D);X===he&&(q=!1),Math.abs(X-he)>1&&(j=!1)}}}return of(I,S,R,w,M,a,{canRemap:N||q&&j})}function JS(e){if(e.conformation.operator.key===-1)return!1;const t=xn.Provider.get(e.model);return!!(t!=null&&t.hasOperators)}function eC(e){const t=xn.Provider.get(e.model),n=t.bySameOperator.get(e.conformation.operator.key);if(!n)return Io.Empty;const{a:r,b:i,edgeProps:{key:o,flag:s,order:a}}=t.bonds,{invertedIndex:c}=$t.getInvertedAtomSourceIndex(e.model),{elements:u}=e,l=[],d=[],f=[],h=[],p=[];for(let m=0,y=n.length;m<y;++m){const g=n[m];if(r[g]>=i[g])continue;const b=c[r[g]],v=ve.indexOf(u,b);if(v<0)continue;const _=c[i[g]],A=ve.indexOf(u,_);A<0||(l[l.length]=v,d[d.length]=A,f[f.length]=s[g],h[h.length]=a[g],p[p.length]=o[g])}return of(l,d,h,f,p,u.length,{canRemap:!1,cacheable:t.cacheable})}function tC(e,t){const n={...Y2,...t};return n.noCompute||e.elements.length<=1?Io.Empty:!n.forceCompute&&xn.Provider.get(e.model)?JS(e)?eC(e):XS(e):QS(e,n)}const nC=O.distance,rC=O.set,iC=O.squaredDistance,oC=O.transformMat4,i_=O(),o_=O();function s_(e,t,n,r){return e.conformation.position(t,i_),n.conformation.position(r,o_),nC(i_,o_)}const sC=Oe(),fi=O();function aC(e,t,n,r){const{maxRadius:i}=n,{elements:o,residueIndex:s}=e,{x:a,y:c,z:u}=e.model.atomicConformation,{elements:l,residueIndex:d}=t,f=e.elements.length,{type_symbol:h,label_alt_id:p,label_atom_id:m,label_comp_id:y}=e.model.atomicHierarchy.atoms,{type_symbol:g,label_alt_id:b,label_atom_id:v,label_comp_id:_}=t.model.atomicHierarchy.atoms,{auth_seq_id:A}=e.model.atomicHierarchy.residues,{auth_seq_id:C}=t.model.atomicHierarchy.residues,{occupancy:I}=e.model.atomicConformation,{occupancy:S}=t.model.atomicConformation,w=I.isDefined&&S.isDefined,R=e.model===t.model&&Yn.Provider.get(e.model),M=!n.forceCompute&&e.model===t.model&&xn.Provider.get(e.model),{atomSourceIndex:P}=e.model.atomicHierarchy,{invertedIndex:E}=M?$t.getInvertedAtomSourceIndex(t.model):{invertedIndex:void 0},N=e.model===t.model&&Yn.isExhaustive(e.model),q=Oe.mul(sC,t.conformation.operator.inverse,e.conformation.operator.matrix),j=!Oe.isIdentity(q),{center:z,radius:W}=t.boundary.sphere,se=(W+i)*(W+i);r.startUnitPair(e.id,t.id);const ue=e.conformation.operator.key,$=t.conformation.operator.key;for(let ne=0;ne<f;ne++){const de=o[ne];if(rC(fi,a[de],c[de],u[de]),j&&oC(fi,fi,q),iC(fi,z)>se)continue;if(!n.forceCompute&&M){const{maxDistance:L}=M,{offset:U,b:Y,edgeProps:{order:fe,distance:me,flag:Te,key:x,operatorA:D,operatorB:J}}=M.bonds,le=P.value(de),he=Gr(h.value(de));for(let ye=U[le],Se=U[le+1];ye<Se;++ye){const Ie=E[Y[ye]],Ee=ve.indexOf(t.elements,Ie);if(Ee<0)continue;const Be=D[ye],we=J[ye];if(Be>=0&&we>=0&&(Be===we||Be!==ue||we!==$))continue;const Ue=Gr(h.value(Ie)),Fe=me[ye],qe=s_(e,de,t,Ie);let He=!1;if(Fe>=0)He=sn(qe,Fe,.3);else if(L>=0)He=qe<L;else{const Ve=Ms(he,Ue,Hr(he),Hr(Ue));He=qe<Ve,jr(he)&&jr(Ue)&&(He=!1)}He&&r.add(ne,Ee,{order:fe[ye],flag:Te[ye],key:x[ye]})}continue}const _e=n.forceCompute?void 0:R&&R.byAtomIndex.get(de);if(_e&&_e.length){let L=!1;for(const U of _e){const{partnerA:Y,partnerB:fe}=U,me=Y.atomIndex===de?fe:Y,Te=ve.indexOf(t.elements,me.atomIndex);Te<0||s_(e,de,t,me.atomIndex)>i||(r.add(ne,Te,{order:U.order,flag:U.flags,key:U.rowIndex}),L=!0)}if(L)continue}if(N)continue;const X=I.value(de),{lookup3d:ce}=t,{indices:k,count:B,squaredDistances:F}=ce.find(fi[0],fi[1],fi[2],i);if(B===0)continue;const re=Gr(h.value(de)),G=jr(re),V=Hr(re),K=p.value(de),Q=Ns.has(re),Z=m.value(de),ie=y.value(s[de]);for(let L=0;L<B;L++){const U=k[L],Y=l[U],fe=b.value(Y);if(K&&fe&&K!==fe||w&&S.value(Y)<1&&X<1&&A.value(s[de])===C.value(d[Y]))continue;if(R&&e.model===t.model){const le=ho(s[de],d[Y]);if(R.residueCantorPairs.has(le))continue}const me=Gr(g.value(Y)),Te=jr(me);if(G&&Te)continue;const x=(Q||Ns.has(me))&&!(G||Te),D=Math.sqrt(F[L]);if(D===0)continue;const J=Ms(re,me,V,Hr(me));if(D<=J){const le=v.value(Y),he=_.value(d[Y]);r.add(ne,U,{order:Z2(ie,he,Z,le),flag:(x?2:1)|32,key:-1})}}}r.finishUnitPair()}function cC(e){for(const t of e.models){const n=xn.Provider.get(t);if(!(n!=null&&n.hasOperators))return!1}for(const t of e.units)if(t.conformation.operator.key===-1)return!1;return!0}function uC(e,t){const n=new Map;for(const r of e.units){const{key:i}=r.conformation.operator;n.has(i)?n.get(i).add(r):n.set(i,new Set([r]))}for(const r of e.models){const i=xn.Provider.get(r),{a:o,b:s}=i.bonds,{order:a,flag:c,key:u,operatorA:l,operatorB:d}=i.bonds.edgeProps,{invertedIndex:f}=$t.getInvertedAtomSourceIndex(r),h=new Map;for(const y of e.units)if(y.model===r)for(let g=0,b=y.elements.length;g<b;++g){const v=y.elements[g];h.has(v)?h.get(v).add(y):h.set(v,new Set([y]))}const p=new Map;for(let y=0,g=l.length;y<g;++y){let b,v;if(l[y]===d[y]?(b=h.get(f[o[y]]),v=h.get(f[s[y]])):(b=n.get(l[y]),v=n.get(d[y])),!(!b||!v)){for(const _ of b)if(l[y]===_.conformation.operator.key)for(const A of v){if(d[y]!==A.conformation.operator.key||_===A||!Ne.isAtomic(_)||!Ne.isAtomic(A)||_.id>A.id)continue;const C=Hn(_.id,A.id);p.has(C)?p.get(C).add(y):p.set(C,new Set([y]))}}}const m=[-1,-1];p.forEach((y,g)=>{const[b,v]=Ax(m,g),_=e.unitMap.get(b),A=e.unitMap.get(v);t.startUnitPair(b,v),y.forEach(C=>{const I=f[o[C]],S=ve.indexOf(_.elements,I);if(S<0)return;const w=f[s[C]],R=ve.indexOf(A.elements,w);R<0||t.add(S,R,{order:a[C],flag:c[C],key:u[C]})}),t.finishUnitPair()})}}const lC={...Y2,ignoreWater:!0,ignoreIon:!0};function fC(e,t){const n=new Fn.Builder,r=e.models.some(o=>xn.Provider.get(o)),i=e.models.some(o=>Yn.isExhaustive(o));return t.noCompute||e.isCoarseGrained&&!r&&!i?new ji(n.getMap()):!t.forceCompute&&cC(e)?(uC(e,n),new ji(n.getMap())):(xt.eachUnitPair(e,(o,s)=>{aC(o,s,t,n)},{maxRadius:t.maxRadius,validUnit:o=>t.validUnit(o),validUnitPair:(o,s)=>t.validUnitPair(e,o,s)}),new ji(n.getMap()))}function dC(e,t){const n={...lC,...t};return fC(e,{...n,validUnit:t&&t.validUnit||(r=>Ne.isAtomic(r)),validUnitPair:t&&t.validUnitPair||((r,i,o)=>{if(!xt.validUnitPair(r,i,o))return!1;const a=i.model.atomicHierarchy.derived.residue.moleculeType,c=o.model.atomicHierarchy.derived.residue.moleculeType,u=(!Ne.isAtomic(i)||a[i.residueIndex[i.elements[0]]]!==2)&&(!Ne.isAtomic(o)||c[o.residueIndex[o.elements[0]]]!==2),l=!Ne.isAtomic(i)||a[i.residueIndex[i.elements[0]]]!==3,d=!Ne.isAtomic(o)||c[o.residueIndex[o.elements[0]]]!==3,f=l&&d;return(u||!n.ignoreWater)&&(f||!n.ignoreIon)?!0:hC(i,o)})})}function hC(e,t){if(e.model!==t.model||!Ne.isAtomic(e)||!Ne.isAtomic(t))return!1;const n=Yn.Provider.get(e.model);if(!n)return!1;const r=e.elements.length<t.elements.length?e:t,i=e.elements.length>=t.elements.length?e:t,{elements:o}=r,{elements:s}=i,{indexOf:a}=ve;for(let c=0,u=o.length;c<u;c++){const l=o[c],d=n.byAtomIndex.get(l);if(d!=null&&d.length)for(const f of d){const h=f.partnerA.atomIndex===l?f.partnerB.atomIndex:f.partnerA.atomIndex;if(a(s,h)>=0)return!0}}return!1}var sf;(function(e){function t(y,g,b,v,_,A){return{kind:"bond-location",aStructure:y,aUnit:g,aIndex:b,bStructure:v,bUnit:_,bIndex:A}}e.Location=t;function n(y){return!!y&&y.kind==="bond-location"}e.isLocation=n;function r(y,g){return y.aStructure.label===g.aStructure.label&&y.bStructure.label===g.bStructure.label&&y.aIndex===g.aIndex&&y.bIndex===g.bIndex&&y.aUnit.id===g.aUnit.id&&y.bUnit.id===g.bUnit.id}e.areLocationsEqual=r;function i(y,g){return{kind:"bond-loci",structure:y,bonds:g}}e.Loci=i;function o(y){return!!y&&y.kind==="bond-loci"}e.isLoci=o;function s(y,g){if(y.structure!==g.structure||y.bonds.length!==g.bonds.length)return!1;for(let b=0,v=y.bonds.length;b<v;++b)if(!r(y.bonds[b],g.bonds[b]))return!1;return!0}e.areLociEqual=s;function a(y){return y.bonds.length===0}e.isLociEmpty=a;function c(y,g){if(g===y.structure)return y;const b=[];return y.bonds.forEach(v=>{const _=g.unitMap.get(v.aUnit.id);if(!_)return;const A=g.unitMap.get(v.bUnit.id);if(!A)return;const C=v.aUnit.elements[v.aIndex],I=ve.indexOf(_.elements,C);if(I===-1)return;const S=v.bUnit.elements[v.bIndex],w=ve.indexOf(A.elements,S);w!==-1&&b.push(t(y.structure,_,I,y.structure,A,w))}),i(g,b)}e.remapLoci=c;function u(y){const g=[],b=new Map;for(const v of y.bonds){const{aIndex:_,aUnit:A,bIndex:C,bUnit:I}=v;A===I?b.has(A.id)?b.get(A.id).push(_,C):b.set(A.id,[_,C]):(b.has(A.id)?b.get(A.id).push(_):b.set(A.id,[_]),b.has(I.id)?b.get(I.id).push(C):b.set(I.id,[C]))}return b.forEach((v,_)=>{g.push({unit:y.structure.unitMap.get(_),indices:ve.deduplicate(ve.ofUnsortedArray(v))})}),Cn(y.structure,g)}e.toStructureElementLoci=u;function l(y){const{aUnit:g,aIndex:b}=y.bonds[0];return Cn(y.structure,[{unit:g,indices:Re.ofSingleton(b)}])}e.toFirstStructureElementLoci=l;function d(y,g){if(g.aUnit===g.bUnit){const b=g.aUnit.bonds,v=b.getEdgeIndex(g.aIndex,g.bIndex);return v<0?$n.create(0):$n.create(b.edgeProps.flags[v])}else{const b=y.interUnitBonds.getBondFromLocation(g);return b?$n.create(b.props.flag):$n.create(0)}}e.getType=d;function f(y,g){if(g.aUnit===g.bUnit){const b=g.aUnit.bonds,v=b.getEdgeIndex(g.aIndex,g.bIndex);return v<0?0:b.edgeProps.order[v]}else{const b=y.interUnitBonds.getBondFromLocation(g);return b?b.props.order:0}}e.getOrder=f;function h(y){let g=0;for(const b of y.unitSymmetryGroups){const v=b.units[0];Ne.isAtomic(v)&&(g+=v.bonds.edgeCount*b.units.length)}return g}e.getIntraUnitBondCount=h;class p{move(){return this.advance(),this.current}setElement(g,b,v){this.structure=g,this.unit=b,this.index=v,this.interBondIndices=g.interUnitBonds.getEdgeIndices(v,b.id),this.interBondCount=this.interBondIndices.length,this.interBondIndex=0,this.intraBondEnd=b.bonds.offset[v+1],this.intraBondIndex=b.bonds.offset[v],this.hasNext=this.interBondIndex<this.interBondCount||this.intraBondIndex<this.intraBondEnd}advance(){if(this.intraBondIndex<this.intraBondEnd)this.current.otherUnit=this.unit,this.current.otherIndex=this.unit.bonds.b[this.intraBondIndex],this.current.type=this.unit.bonds.edgeProps.flags[this.intraBondIndex],this.current.order=this.unit.bonds.edgeProps.order[this.intraBondIndex],this.intraBondIndex+=1;else if(this.interBondIndex<this.interBondCount){const g=this.structure.interUnitBonds.edges[this.interBondIndices[this.interBondIndex]];this.current.otherUnit=this.structure.unitMap.get(g.unitA!==this.unit.id?g.unitA:g.unitB),this.current.otherIndex=g.indexA!==this.index?g.indexA:g.indexB,this.current.type=g.props.flag,this.current.order=g.props.order,this.interBondIndex+=1}else{this.hasNext=!1;return}this.hasNext=this.interBondIndex<this.interBondCount||this.intraBondIndex<this.intraBondEnd}constructor(){this.current={},this.hasNext=!1}}e.ElementBondIterator=p;function m(y,g){return Ds.fromPairProvider(y.bonds.length,(b,v,_)=>{const{aUnit:A,aIndex:C,bUnit:I,bIndex:S}=y.bonds[b];A.conformation.position(A.elements[C],v),I.conformation.position(I.elements[S],_)},g)}e.getBoundingSphere=m})(sf||(sf={}));function mC(e){const t=_C(e),n=pC(e,t),r=mt.transientSegments(e.model.atomicHierarchy.residueAtomSegments,e.elements);for(;r.hasNext;){const i=r.move();yC(n,i.start,i.end)}return n.rings}function pC(e,t){return{startVertex:0,endVertex:0,count:0,isRingAtom:new Int32Array(t),marked:new Int32Array(t),queue:new Int32Array(t),pred:new Int32Array(t),depth:new Int32Array(t),left:new Int32Array(5),right:new Int32Array(5),color:new Int32Array(t),currentColor:0,currentAltLoc:"",hasAltLoc:!1,rings:[],currentRings:[],unit:e,bonds:e.bonds,altLoc:e.model.atomicHierarchy.atoms.label_alt_id}}function a_(e){e.count=e.endVertex-e.startVertex;const{isRingAtom:t,pred:n,color:r,depth:i,marked:o}=e;for(let s=0;s<e.count;s++)t[s]=0,n[s]=-1,o[s]=-1,r[s]=0,i[s]=0;e.currentColor=0,e.currentAltLoc="",e.hasAltLoc=!1}function c_(e){const{depth:t}=e;for(let n=0;n<e.count;n++)t[n]=e.count+1}function _C(e){const t=mt.transientSegments(e.model.atomicHierarchy.residueAtomSegments,e.elements);let n=0;for(;t.hasNext;){const r=t.move();n=Math.max(n,r.end-r.start)}return n}function u_(e,t){const n=e.bonds.offset,r=e.startVertex+t,i=n[r],s=n[r+1]-i;return!(s<=1||e.isRingAtom[t]&&s===2)}function yC(e,t,n){if(e.startVertex=t,e.endVertex=n,e.endVertex-e.startVertex<3)return;e.currentRings=[];const{elements:r}=e.unit,i=[];for(let s=e.startVertex;s<e.endVertex;s++){const a=e.altLoc.value(r[s]);qp(i,a)}sA(i,"");let o=1;if(i.length===0){a_(e);for(let s=0;s<e.count;s++)u_(e,s)&&(c_(e),o=l_(e,s,o))}else for(let s=0;s<i.length;s++){a_(e),e.hasAltLoc=!0,e.currentAltLoc=i[s];for(let a=0;a<e.count;a++){if(!u_(e,a))continue;const c=e.altLoc.value(r[e.startVertex+a]);c&&c!==e.currentAltLoc||(c_(e),o=l_(e,a,o))}}for(let s=0,a=e.currentRings.length;s<a;s++)e.rings.push(e.currentRings[s])}function gC(e,t,n,r){if(n<t)return!1;const{pred:i,color:o,left:s,right:a}=e,c=++e.currentColor;let u=t;for(let g=0;g<5&&(o[u]=c,u=i[u],!(u<0));g++);let l=0,d=0,f=!1,h=0;u=n;for(let g=0;g<5;g++){if(o[u]===c){h=u,f=!0;break}if(a[d++]=u,u=i[u],u<0)break}if(!f)return!1;u=t;for(let g=0;g<5&&(s[l++]=u,!(h===u||(u=i[u],u<0)));g++);const p=l+d;if(p<3)return!1;const m=new Int32Array(p);let y=0;for(let g=0;g<l;g++)m[y++]=e.startVertex+s[g],r[s[g]]=1;for(let g=d-1;g>=0;g--)m[y++]=e.startVertex+a[g],r[a[g]]=1;mr(m);for(let g=0,b=e.currentRings.length;g<b;g++){const v=e.currentRings[g];if(m.length===v.length){if(ve.areEqual(m,v))return!1}else if(m.length>v.length&&ve.isSubset(m,v))return!1}return e.currentRings.push(ve.ofSortedArray(m)),!0}function l_(e,t,n){const{bonds:r,startVertex:i,endVertex:o,isRingAtom:s,marked:a,queue:c,pred:u,depth:l}=e,{elements:d}=e.unit,{b:f,edgeProps:{flags:h},offset:p}=r;a[t]=n,l[t]=0,c[0]=t;let m=0,y=1;for(;m<y;){const g=c[m++],b=l[g],v=i+g,_=p[v],A=p[v+1];for(let C=_;C<A;C++){const I=f[C];if(I<i||I>=o||!$n.isCovalent(h[C]))continue;if(e.hasAltLoc){const R=e.altLoc.value(d[I]);if(R&&e.currentAltLoc!==R)continue}const S=I-i;if(a[S]===n){if(u[S]!==g&&u[g]!==S&&gC(e,g,S,s))return n+1;continue}const w=Math.min(l[S],b+1);w>5||(l[S]=w,a[S]=n,c[y++]=S,u[S]=g)}}return n+1}function bC(e){const t=e.length,n=new Array(t);for(let s=0;s<t;s++)n[s]=e[t-s-1];const r=f_(e),i=f_(n);let o=!1;for(let s=0;s<t;s++){const a=e[(s+r)%t],c=n[(s+i)%t];if(a!==c){o=a<c;break}}return o?d_(e,r):d_(n,i)}function f_(e){const t=e.length,n=new Int32Array(t*2);for(let s=0;s<n.length;s++)n[s]=-1;let r="",i="",o=0;for(let s=1;s<n.length;s++){let a=n[s-o-1];for(;a!==-1&&(r=e[s%t],i=e[(o+a+1)%t],r!==i);)r<i&&(o=s-a-1),a=n[a];a===-1?(r=e[s%t],i=e[(o+a+1)%t],r!==i?(r<i&&(o=s),n[s-o]=-1):n[s-o]=a+1):n[s-o]=a+1}return o}function d_(e,t){const n=e.length,r=[];let i;for(i=0;i<n-1;i++)r.push(e[(i+t)%n]),r.push("-");return r.push(e[(i+t)%n]),r.join("")}function vC(e,t){const n=new Map,r=new Map;for(let c=0,u=e.length;c<u;c++){const l=e[c];for(let d=0,f=l.length;d<f;d++){const h=l[d];n.has(h)?n.get(h).push(c):n.set(h,[c])}}for(let c=0,u=t.length;c<u;c++){const l=t[c],d=e[l];for(let f=0,h=d.length;f<h;f++){const p=d[f];r.has(p)?r.get(p).push(l):r.set(p,[l])}}const i=new or.UniqueEdgeBuilder(e.length);for(let c=0,u=e.length;c<u;c++){const l=e[c];for(let d=0,f=l.length;d<f;d++){const h=l[d],p=n.get(h);if(p.length!==1)for(let m=0,y=p.length;m<y;m++){const g=p[m];c>=g||i.addEdge(c,g)}}}const o=or.connectedComponents(i.getGraph()),s=o.componentIndex,a=[];for(let c=0;c<o.componentCount;c++)a[c]=[];for(let c=0,u=e.length;c<u;c++)a[s[c]].push(c);return{elementRingIndices:n,elementAromaticRingIndices:r,ringComponentIndex:s,ringComponents:a}}const xC=new Set;function zr(e,t){const n=q5[e];if(n!==void 0){const r=n[t];if(r!==void 0)return r}return xC}const h_=O.zero();function m_(e,t){const n=e.conformation,r=new Float32Array(t.length*3),{elements:i}=e;for(let o=0,s=t.length;o<s;++o)n.position(i[t[o]],h_),O.toArray(h_,r,o*3);return r}class qs{get index(){return this._index?this._index:(this._index=vC(this.all,this.aromaticRings),this._index)}get byFingerprint(){return this._byFingerprint?this._byFingerprint:(this._byFingerprint=AC(this.unit,this.all),this._byFingerprint)}get elementRingIndices(){return this.index.elementRingIndices}get elementAromaticRingIndices(){return this.index.elementAromaticRingIndices}get ringComponentIndex(){return this.index.ringComponentIndex}get ringComponents(){return this.index.ringComponents}get aromaticRings(){return this._aromaticRings?this._aromaticRings:(this._aromaticRings=IC(this.unit,this.all),this._aromaticRings)}constructor(t,n){this.unit=n,this.all=t}}var Wn;(function(e){function t(a,c){const{elements:u}=a,{type_symbol:l}=a.model.atomicHierarchy.atoms,d=[];for(let f=0,h=c.length;f<h;f++)d[d.length]=l.value(u[c[f]]);return n(d)}e.fingerprint=t;function n(a){return bC(a)}e.elementFingerprint=n;const r=new Set(["B","C","N","O","SI","P","S","GE","AS","SN","SB","BI"]),i=.05;function o(a,c){const{elements:u,bonds:{b:l,offset:d,edgeProps:{flags:f}}}=a,{type_symbol:h,label_comp_id:p}=a.model.atomicHierarchy.atoms;if(p.value(a.elements[c[0]])==="PRO")return!1;let m=0,y=!1;for(let b=0,v=c.length;b<v;++b){const _=c[b];!y&&r.has(h.value(u[_]))&&(y=!0);for(let A=d[_],C=d[_+1];A<C;++A)$n.is(16,f[A])&&ve.has(c,l[A])&&(m+=1)}if(m===2*c.length)return!0;if(!y||c.length<5||m>0)return!1;const g=xr.calculateMomentsAxes(m_(a,c));return O.magnitude(g.dirC)<i}e.isAromatic=o;function s(a,c){const{label_alt_id:u}=a.model.atomicHierarchy.atoms,{elements:l}=a;for(let d=0,f=c.length;d<f;++d){const h=l[c[d]],p=u.value(h);if(p)return p}return""}e.getAltId=s})(Wn||(Wn={})),function(e){function t(r){const i=mC(r);return new e(i,r)}e.create=t;function n(r,i){const o=new Map;for(let s=0,a=i.length;s<a;s++){const c=i[s];CC(r,c,o)}return o}e.byFingerprintAndResidue=n}(qs||(qs={}));function AC(e,t){const n=new Map;let r=0;for(let i=0,o=t.length;i<o;i++){const s=t[i],a=Wn.fingerprint(e,s);n.has(a)?n.get(a).push(r):n.set(a,[r]),r++}return n}function SC(e,t){const{elements:n}=e,r=e.model.atomicHierarchy.residueAtomSegments.index,i=r[n[t[0]]];for(let o=1,s=t.length;o<s;o++)if(i!==r[n[t[o]]])return-1;return i}function CC(e,t,n){const r=e.byFingerprint.get(t);if(r)for(let i=0,o=r.length;i<o;i++){const s=r[i],a=SC(e.unit,e.all[s]);a>=0&&(n.has(a)?n.get(a).push(s):n.set(a,[s]))}}function IC(e,t){const n=[];for(let r=0,i=t.length;r<i;++r)Wn.isAromatic(e,t[r])&&n.push(r);return n}function wC(e){const t=[],{elements:n,model:r}=e,{residueAtomSegments:i}=e.model.atomicHierarchy,{traceElementIndex:o}=r.atomicHierarchy.derived.residue,s=Nt.transientSegments(e.model.atomicRanges.polymerRanges,n),a=mt.transientSegments(i,n);for(;s.hasNext;){const c=s.move();for(a.setSegment(c);a.hasNext;){const u=a.move(),{start:l,end:d,index:f}=u;if(Re.areIntersecting(pe.ofRange(n[l],n[d-1]),n)){const h=o[f];t.push(h===-1?i.offsets[f]:h)}}}return ve.ofSortedArray(t)}function PC(e){const t=[],{elements:n,model:r}=e,{spheres:i,gaussians:o}=r.coarseHierarchy,s=Ne.isSpheres(e)?i.polymerRanges:o.polymerRanges,a=Nt.transientSegments(s,n);for(;a.hasNext;){const{start:c,end:u}=a.move();for(let l=c;l<u;++l)t.push(n[l])}return ve.ofSortedArray(t)}function EC(e){const t=[],{elements:n,model:r,residueIndex:i}=e,{residueAtomSegments:o}=e.model.atomicHierarchy,{traceElementIndex:s}=r.atomicHierarchy.derived.residue,a=Nt.transientSegments(e.model.atomicRanges.gapRanges,e.elements);for(;a.hasNext;){const c=a.move(),u=i[n[c.start]],l=i[n[c.end-1]],d=s[u],f=s[l];t.push(d===-1?o.offsets[u]:d),t.push(f===-1?o.offsets[l]:f)}return ve.ofSortedArray(t)}function BC(e){const t=[],{elements:n,model:r}=e,{spheres:i,gaussians:o}=r.coarseHierarchy,s=Ne.isSpheres(e)?i.gapRanges:o.gapRanges,a=Nt.transientSegments(s,n);for(;a.hasNext;){const{start:c,end:u}=a.move();t.push(n[c],n[u-1])}return ve.ofSortedArray(t)}function RC(e){const t=[],{elements:n,model:r}=e,{chainAtomSegments:i,residueAtomSegments:o}=r.atomicHierarchy,{moleculeType:s,traceElementIndex:a}=r.atomicHierarchy.derived.residue,c=mt.transientSegments(i,n),u=mt.transientSegments(o,n);for(;c.hasNext;)for(u.setSegment(c.move());u.hasNext;){const{index:l}=u.move();if(k2(s[l])){const d=a[l];t.push(d===-1?o.offsets[l]:d)}}return ve.ofSortedArray(t)}function DC(e){const t=[],{elements:n,model:r}=e,{chainAtomSegments:i,residueAtomSegments:o}=r.atomicHierarchy,{moleculeType:s,traceElementIndex:a}=r.atomicHierarchy.derived.residue,c=mt.transientSegments(i,n),u=mt.transientSegments(o,n);for(;c.hasNext;)for(u.setSegment(c.move());u.hasNext;){const{index:l}=u.move();if(Yl(s[l])){const d=a[l];t.push(d===-1?o.offsets[l]:d)}}return ve.ofSortedArray(t)}const p_=O();function NC(e){const{elements:t,conformation:n}=e,r=new Float32Array(t.length*3);for(let i=0,o=t.length;i<o;i++)n.invariantPosition(t[i],p_),O.toArray(p_,r,i*3);return r}function __(e){const t=NC(e);return xr.ofPositions(t)}const y_=O.dot,g_=O.copy,MC=O.scaleAndSub,TC=O.scaleAndAdd;class Eo{computeExtrema(t,n){const r=y_(this.dir[t],n);r<this.minDist[t]&&(this.minDist[t]=r,g_(this.extrema[t*2],n)),r>this.maxDist[t]&&(this.maxDist[t]=r,g_(this.extrema[t*2+1],n))}computeSphereExtrema(t,n,r){const i=this.dir[t],o=y_(i,n);o-r<this.minDist[t]&&(this.minDist[t]=o-r,MC(this.extrema[t*2],n,i,r)),o+r>this.maxDist[t]&&(this.maxDist[t]=o+r,TC(this.extrema[t*2+1],n,i,r))}includeSphere(t){if(hn.hasExtrema(t)&&t.extrema.length>1)for(const n of t.extrema)this.includePosition(n);else this.includePositionRadius(t.center,t.radius)}includePosition(t){for(let n=0;n<this.dirLength;++n)this.computeExtrema(n,t)}includePositionRadius(t,n){for(let r=0;r<this.dirLength;++r)this.computeSphereExtrema(r,t,n)}finishedIncludeStep(){for(let t=0;t<this.extrema.length;t++)this.centroidHelper.includeStep(this.extrema[t]);this.centroidHelper.finishedIncludeStep()}radiusSphere(t){if(hn.hasExtrema(t)&&t.extrema.length>1)for(const n of t.extrema)this.radiusPosition(n);else this.radiusPositionRadius(t.center,t.radius)}radiusPosition(t){this.centroidHelper.radiusStep(t)}radiusPositionRadius(t,n){this.centroidHelper.radiusSphereStep(t,n)}getSphere(t){return hn.setExtrema(this.centroidHelper.getSphere(t),this.extrema.slice())}getBox(t){return Kn.fromVec3Array(t||Kn(),this.extrema)}reset(){for(let t=0;t<this.dirLength;++t)this.minDist[t]=1/0,this.maxDist[t]=-1/0,this.extrema[t*2]=O(),this.extrema[t*2+1]=O();this.centroidHelper.reset()}constructor(t){this.minDist=[],this.maxDist=[],this.extrema=[],this.centroidHelper=new Ds,this.dir=OC(t),this.dirLength=this.dir.length,this.reset()}}function OC(e){let t;switch(e){case"6":t=[...Us];break;case"14":t=[...Us,...af];break;case"26":t=[...Us,...af,...b_];break;case"98":t=[...Us,...af,...b_,...kC,...qC,...UC];break}return t.map(n=>{const r=O.create(n[0],n[1],n[2]);return O.normalize(r,r)})}const Us=[[1,0,0],[0,1,0],[0,0,1]],af=[[1,1,1],[-1,1,1],[-1,-1,1],[1,-1,1]],b_=[[1,1,0],[1,-1,0],[1,0,1],[1,0,-1],[0,1,1],[0,1,-1]],kC=[[0,1,2],[0,2,1],[1,0,2],[2,0,1],[1,2,0],[2,1,0],[0,1,-2],[0,2,-1],[1,0,-2],[2,0,-1],[1,-2,0],[2,-1,0]],qC=[[1,1,2],[2,1,1],[1,2,1],[1,-1,2],[1,1,-2],[1,-1,-2],[2,-1,1],[2,1,-1],[2,-1,-1],[1,-2,1],[1,2,-1],[1,-2,-1]],UC=[[2,2,1],[1,2,2],[2,1,2],[2,-2,1],[2,2,-1],[2,-2,-1],[1,-2,2],[1,2,-2],[1,-2,-2],[2,-1,2],[2,1,-2],[2,-1,-2]],v_=O.set,FC=new Eo("14"),LC=new Eo("98");function GC(e){return e>1e4?FC:LC}function cf(e){const t=Kn.computeBounding(e);return{box:t,sphere:hn.fromBox3D(hn(),t)}}const Fs=O();function uf(e){const{x:t,y:n,z:r,radius:i,indices:o}=e,s=Re.size(o);if(s>25e4)return cf(e);const a=GC(s);a.reset();for(let u=0;u<s;u++){const l=Re.getAt(o,u);v_(Fs,t[l],n[l],r[l]),a.includePositionRadius(Fs,i&&i[l]||0)}a.finishedIncludeStep();for(let u=0;u<s;u++){const l=Re.getAt(o,u);v_(Fs,t[l],n[l],r[l]),a.radiusPositionRadius(Fs,i&&i[l]||0)}const c=a.getSphere();if(!i&&hn.hasExtrema(c)&&s<=c.extrema.length){const u=[];for(let l=0;l<s;l++){const d=Re.getAt(o,l);u.push(O.create(t[d],n[d],r[d]))}hn.setExtrema(c,u)}return{box:a.getBox(),sphere:c}}class lf{constructor(){this.data=new Map}get(t){const n=ve.hashCode(t);if(this.data.has(n)){for(const[r,i]of this.data.get(n))if(ve.areEqual(t,r))return i}}set(t,n){const r=ve.hashCode(t);if(this.data.has(r)){const i=this.data.get(r);for(const o of i)if(ve.areEqual(t,o[0])){o[1]=n;return}i.push([t,n])}else this.data.set(r,[[t,n]])}static get(t){return t._dynamicPropertyData.ElementSetIntraBondCache||(t._dynamicPropertyData.ElementSetIntraBondCache=new lf),t._dynamicPropertyData.ElementSetIntraBondCache}}function HC(e){return{delocalizedTriplets:jC(e)}}function jC(e){const t=e.bonds,{b:n,edgeProps:r,offset:i}=t,{order:o,flags:s}=r,{elementAromaticRingIndices:a}=e.rings,c=[],u=new Map,l=new Map,d=(f,h,p)=>{const m=c.length;c.push(ve.ofUnsortedArray([f,h,p])),u.set(ho(f,h),p),l.has(f)?l.get(f).push(m):l.set(f,[m])};for(let f=0;f<e.elements.length;f++){if(a.has(f)||i[f+1]-i[f]+1<2)continue;const p=[];for(let m=i[f],y=i[f+1];m<y;m++){const g=s[m];$n.is(g,16)&&p.push(n[m])}if(p.length>=2){d(f,p[0],p[1]);for(let m=1,y=p.length;m<y;m++)d(f,p[m],p[0])}}return{getThirdElement:(f,h)=>u.get(ho(f,h)),getTripletIndices:f=>l.get(f),triplets:c}}var Ne;(function(e){(function(z){z[z.Atomic=0]="Atomic",z[z.Spheres=1]="Spheres",z[z.Gaussians=2]="Gaussians"})(e.Kinds||(e.Kinds={}));function t(z){return z.kind===0}e.isAtomic=t;function n(z){return z.kind===1||z.kind===2}e.isCoarse=n;function r(z){return z.kind===1}e.isSpheres=r;function i(z){return z.kind===2}e.isGaussians=i;function o(z,W,se,ue,$,ne,de,_e,X){switch($){case 0:return new y(z,W,se,ue,ne,_e,St.createMapping(de,ne.atomicConformation),X??g());case 1:return I(z,W,se,ue,ne,1,_e,St.createMapping(de,ne.coarseConformation.spheres,p(ne)),X??_());case 2:return I(z,W,se,ue,ne,2,_e,St.createMapping(de,ne.coarseConformation.gaussians,m()),X??_())}}e.create=o;function s(z){const W=ci.Mutable();for(let se=0,ue=z.length;se<ue;se++)W.set(z[se].id,se);return W}function a(z){const W=[];for(let se=0,ue=z.length;se<ue;se++)W.push(z[se].id);return Oi(W)}function c(z){const W={};return{elements:z[0].elements,units:z,get unitIndexMap(){return W.unitIndexMap||(W.unitIndexMap=s(z)),W.unitIndexMap},hashCode:l(z[0]),transformHash:a(z)}}e.SymmetryGroup=c,function(z){function W(ue,$){return ue.hashCode!==$.hashCode?!1:ve.areEqual(ue.elements,$.elements)}z.areInvariantElementsEqual=W;function se(ue){const $=ci.Mutable();for(let ne=0,de=ue.length;ne<de;++ne){const _e=ue[ne];for(let X=0,ce=_e.units.length;X<ce;++X)$.set(_e.units[X].id,ne)}return $}z.getUnitSymmetryGroupsIndexMap=se}(c=e.SymmetryGroup||(e.SymmetryGroup={}));function u(z){return e.isAtomic(z)?z.model.atomicConformation.id:z.model.coarseConformation.id}e.conformationId=u;function l(z){return ds(z.invariantId,ve.hashCode(z.elements))}e.hashUnit=l;let d;(function(z){z[z.None=0]="None",z[z.MultiChain=1]="MultiChain",z[z.Partitioned=2]="Partitioned",z[z.FastBoundary=4]="FastBoundary",z[z.Water=8]="Water"})(d=e.Trait||(e.Trait={}));let f;(function(z){z.is=tr.has,z.create=tr.create})(f=e.Traits||(e.Traits={}));function h(){return{}}function p(z){const W=z.coarseConformation.spheres.radius;return se=>W[se]}function m(z){return W=>0}class y{get transientCache(){return this._transientCache===void 0&&(this._transientCache=new Map),this._transientCache}getChild(W){return W.length===this.elements.length?this:new y(this.id,this.invariantId,this.chainGroupId,this.traits,this.model,W,this.conformation,g())}getCopy(W,se,ue,$){const ne=new y(W,se,ue,this.traits,this.model,this.elements,this.conformation,this.props);return $!=null&&$.propagateTransientCache&&(ne._transientCache=this._transientCache),ne}applyOperator(W,se,ue=!1){const $=ue?se:St.compose(this.conformation.operator,se);return new y(W,this.invariantId,this.chainGroupId,this.traits,this.model,this.elements,St.createMapping($,this.model.atomicConformation,this.conformation.r),this.props)}remapModel(W,se,ue){var $,ne;ue||(ue={...this.props,bonds:se&&!(!((ne=($=this.props.bonds)===null||$===void 0?void 0:$.props)===null||ne===void 0)&&ne.canRemap)?void 0:M(this,this.props.bonds,W,se)},e.isSameConformation(this,W)||(ue.boundary=void 0,ue.lookup3d=void 0,ue.principalAxes=void 0));let de=this.conformation.operator;const _e=Sn.Provider.get(W);if(de.spgrOp!==-1&&_e&&_e!==Sn.Provider.get(this.model)){const[ce,k,B]=de.hkl,{toFractional:F}=_e.spacegroup.cell,re=O.transformMat4(O(),$t.getCenter(W),F);de=zn.getSymmetryOperatorRef(_e.spacegroup,de.spgrOp,ce,k,B,re)}const X=this.model.atomicConformation!==W.atomicConformation||de!==this.conformation.operator?St.createMapping(de,W.atomicConformation):this.conformation;return new y(this.id,this.invariantId,this.chainGroupId,this.traits,W,this.elements,X,ue)}get boundary(){if(this.props.boundary)return this.props.boundary;const{x:W,y:se,z:ue}=this.model.atomicConformation;return this.props.boundary=f.is(this.traits,d.FastBoundary)?cf({x:W,y:se,z:ue,indices:this.elements}):uf({x:W,y:se,z:ue,indices:this.elements}),this.props.boundary}get lookup3d(){if(this.props.lookup3d)return this.props.lookup3d;const{x:W,y:se,z:ue}=this.model.atomicConformation;return this.props.lookup3d=ws({x:W,y:se,z:ue,indices:this.elements},this.boundary),this.props.lookup3d}get principalAxes(){return this.props.principalAxes?this.props.principalAxes:(this.props.principalAxes=__(this),this.props.principalAxes)}get bonds(){var W;if(this.props.bonds)return this.props.bonds;const se=lf.get(this.model);let ue=se.get(this.elements);return ue||(ue=tC(this),!((W=ue.props)===null||W===void 0)&&W.cacheable&&se.set(this.elements,ue)),this.props.bonds=ue,this.props.bonds}get rings(){return this.props.rings?this.props.rings:(this.props.rings=qs.create(this),this.props.rings)}get resonance(){return this.props.resonance?this.props.resonance:(this.props.resonance=HC(this),this.props.resonance)}get polymerElements(){return this.props.polymerElements?this.props.polymerElements:(this.props.polymerElements=wC(this),this.props.polymerElements)}get gapElements(){return this.props.gapElements?this.props.gapElements:(this.props.gapElements=EC(this),this.props.gapElements)}get nucleotideElements(){return this.props.nucleotideElements?this.props.nucleotideElements:(this.props.nucleotideElements=RC(this),this.props.nucleotideElements)}get proteinElements(){return this.props.proteinElements?this.props.proteinElements:(this.props.proteinElements=DC(this),this.props.proteinElements)}get residueCount(){if(this.props.residueCount!==void 0)return this.props.residueCount;let W=0;const se=mt.transientSegments(this.model.atomicHierarchy.residueAtomSegments,this.elements);for(;se.hasNext;)se.move(),W+=1;return this.props.residueCount=W,this.props.residueCount}getResidueIndex(W){return this.residueIndex[this.elements[W]]}constructor(W,se,ue,$,ne,de,_e,X){this.kind=0,this.objectPrimitive="atomistic",this._transientCache=void 0,this.id=W,this.invariantId=se,this.chainGroupId=ue,this.traits=$,this.model=ne,this.elements=de,this.conformation=_e,this.residueIndex=ne.atomicHierarchy.residueAtomSegments.index,this.chainIndex=ne.atomicHierarchy.chainAtomSegments.index,this.props=X}}e.Atomic=y;function g(){return h()}class b{get transientCache(){return this._transientCache===void 0&&(this._transientCache=new Map),this._transientCache}getChild(W){return W.length===this.elements.length?this:I(this.id,this.invariantId,this.chainGroupId,this.traits,this.model,this.kind,W,this.conformation,_())}getCopy(W,se,ue,$){const ne=I(W,se,ue,this.traits,this.model,this.kind,this.elements,this.conformation,this.props);return $!=null&&$.propagateTransientCache&&(ne._transientCache=this._transientCache),ne}applyOperator(W,se,ue=!1){const $=ue?se:St.compose(this.conformation.operator,se);return I(W,this.invariantId,this.chainGroupId,this.traits,this.model,this.kind,this.elements,St.createMapping($,this.getCoarseConformation(),this.conformation.r),this.props)}remapModel(W,se,ue){const $=this.getCoarseConformation(),ne=v(this.kind,W);ue||(ue={...this.props},e.isSameConformation(this,W)||(ue.boundary=void 0,ue.lookup3d=void 0,ue.principalAxes=void 0));const de=$!==ne?St.createMapping(this.conformation.operator,ne,this.kind===1?p(W):m()):this.conformation;return new b(this.id,this.invariantId,this.chainGroupId,this.traits,W,this.kind,this.elements,de,ue)}get boundary(){if(this.props.boundary)return this.props.boundary;const{x:W,y:se,z:ue}=this.getCoarseConformation();return this.props.boundary=f.is(this.traits,d.FastBoundary)?cf({x:W,y:se,z:ue,indices:this.elements}):uf({x:W,y:se,z:ue,indices:this.elements}),this.props.boundary}get lookup3d(){if(this.props.lookup3d)return this.props.lookup3d;const{x:W,y:se,z:ue}=this.getCoarseConformation();return this.props.lookup3d=ws({x:W,y:se,z:ue,indices:this.elements},this.boundary),this.props.lookup3d}get principalAxes(){return this.props.principalAxes?this.props.principalAxes:(this.props.principalAxes=__(this),this.props.principalAxes)}get polymerElements(){return this.props.polymerElements?this.props.polymerElements:(this.props.polymerElements=PC(this),this.props.polymerElements)}get gapElements(){return this.props.gapElements?this.props.gapElements:(this.props.gapElements=BC(this),this.props.gapElements)}getCoarseConformation(){return v(this.kind,this.model)}constructor(W,se,ue,$,ne,de,_e,X,ce){this._transientCache=void 0,this.kind=de,this.objectPrimitive=de===1?"sphere":"gaussian",this.id=W,this.invariantId=se,this.chainGroupId=ue,this.traits=$,this.model=ne,this.elements=_e,this.conformation=X,this.coarseElements=de===1?ne.coarseHierarchy.spheres:ne.coarseHierarchy.gaussians,this.coarseConformation=de===1?ne.coarseConformation.spheres:ne.coarseConformation.gaussians,this.props=ce}}function v(z,W){return z===1?W.coarseConformation.spheres:W.coarseConformation.gaussians}function _(){return h()}class A extends b{}e.Spheres=A;class C extends b{}e.Gaussians=C;function I(z,W,se,ue,$,ne,de,_e,X){return new b(z,W,se,ue,$,ne,de,_e,X)}function S(z,W){return z.chainGroupId===W.chainGroupId&&z.conformation.operator.name===W.conformation.operator.name}e.areSameChainOperatorGroup=S;function w(z,W){return Oe.areEqual(z.conformation.operator.matrix,W.conformation.operator.matrix,1e-6)}e.areOperatorsEqual=w;function R(z,W){return z===W?!0:ve.areEqual(z.elements,W.elements)?P(z,W.model):!1}e.areConformationsEqual=R;function M(z,W,se,ue){var $;if(!W)return;if(z.model.atomicConformation.id===se.atomicConformation.id)return W;const ne=xn.Provider.get(z.model);if(ne){const de=xn.Provider.get(se);return!de||ne===de?W:void 0}return!(($=W.props)===null||$===void 0)&&$.canRemap||!ue||P(z,se)?W:void 0}function P(z,W){const se=$t.CoordinatesHistory.get($t.getRoot(W));if(se)return se.areEqual(z.elements,z.kind,W);const ue=z.elements,{x:$,y:ne,z:de}=z.conformation.coordinates,{x:_e,y:X,z:ce}=E(z.kind,W);for(let k=0,B=ue.length;k<B;k++){const F=ue[k];if($[F]!==_e[F]||ne[F]!==X[F]||de[F]!==ce[F])return!1}return!0}e.isSameConformation=P;function E(z,W){return z===0?W.atomicConformation:z===1?W.coarseConformation.spheres:W.coarseConformation.gaussians}e.getModelConformationOfKind=E;function N(z){return E(z.kind,z.model)}e.getConformation=N;function q(z,W){return z===0?W.atomicHierarchy:z===1?W.coarseHierarchy.spheres:W.coarseHierarchy.gaussians}e.getModelHierarchyOfKind=q;function j(z){return q(z.kind,z.model)}e.getHierarchy=j})(Ne||(Ne={}));const zC={type_symbol:Ce.Schema.Aliased(et.atom_site.type_symbol),label_atom_id:et.atom_site.label_atom_id,auth_atom_id:et.atom_site.auth_atom_id,label_alt_id:et.atom_site.label_alt_id,label_comp_id:et.atom_site.label_comp_id,auth_comp_id:et.atom_site.auth_comp_id,pdbx_formal_charge:et.atom_site.pdbx_formal_charge},VC={group_PDB:et.atom_site.group_PDB,label_seq_id:et.atom_site.label_seq_id,auth_seq_id:et.atom_site.auth_seq_id,pdbx_PDB_ins_code:et.atom_site.pdbx_PDB_ins_code},KC={label_asym_id:et.atom_site.label_asym_id,auth_asym_id:et.atom_site.auth_asym_id,label_entity_id:et.atom_site.label_entity_id};var ff;(function(e){function t(){return{label_entity_id:"",label_asym_id:"",auth_seq_id:0,pdbx_PDB_ins_code:void 0}}e.EmptyResidueKey=t})(ff||(ff={}));var zi;(function(e){function t(a,c){return a.residueAtomSegments.index[a.chainAtomSegments.offsets[c]]}e.chainStartResidueIndex=t;function n(a,c){return a.residueAtomSegments.index[a.chainAtomSegments.offsets[c+1]-1]+1}e.chainEndResidueIndexExcl=n;function r(a,c){return n(a,c)-t(a,c)}e.chainResidueCount=r;function i(a,c){return a.residueAtomSegments.offsets[c]}e.residueFirstAtomIndex=i;function o(a,c){return a.chainAtomSegments.index[c]}e.atomChainIndex=o;function s(a,c){return a.chainAtomSegments.index[a.residueAtomSegments.offsets[c]]}e.residueChainIndex=s})(zi||(zi={}));const x_={H:1,D:1,T:1,HE:2,LI:3,BE:4,B:5,C:6,N:7,O:8,F:9,NE:10,NA:11,MG:12,AL:13,SI:14,P:15,S:16,CL:17,AR:18,K:19,CA:20,SC:21,TI:22,V:23,CR:24,MN:25,FE:26,CO:27,NI:28,CU:29,ZN:30,GA:31,GE:32,AS:33,SE:34,BR:35,KR:36,RB:37,SR:38,Y:39,ZR:40,NB:41,MO:42,TC:43,RU:44,RH:45,PD:46,AG:47,CD:48,IN:49,SN:50,SB:51,TE:52,I:53,XE:54,CS:55,BA:56,LA:57,CE:58,PR:59,ND:60,PM:61,SM:62,EU:63,GD:64,TB:65,DY:66,HO:67,ER:68,TM:69,YB:70,LU:71,HF:72,TA:73,W:74,RE:75,OS:76,IR:77,PT:78,AU:79,HG:80,TL:81,PB:82,BI:83,PO:84,AT:85,RN:86,FR:87,RA:88,AC:89,TH:90,PA:91,U:92,NP:93,PU:94,AM:95,CM:96,BK:97,CF:98,ES:99,FM:100,MD:101,NO:102,LR:103,RF:104,DB:105,SG:106,BH:107,HS:108,MT:109},$C={1:1.1,2:1.4,3:1.81,4:1.53,5:1.92,6:1.7,7:1.55,8:1.52,9:1.47,10:1.54,11:2.27,12:1.73,13:1.84,14:2.1,15:1.8,16:1.8,17:1.75,18:1.88,19:2.75,20:2.31,21:2.3,22:2.15,23:2.05,24:2.05,25:2.05,26:2.05,27:2,28:2,29:2,30:2.1,31:1.87,32:2.11,33:1.85,34:1.9,35:1.83,36:2.02,37:3.03,38:2.49,39:2.4,40:2.3,41:2.15,42:2.1,43:2.05,44:2.05,45:2,46:2.05,47:2.1,48:2.2,49:2.2,50:1.93,51:2.17,52:2.06,53:1.98,54:2.16,55:3.43,56:2.68,57:2.5,58:2.48,59:2.47,60:2.45,61:2.43,62:2.42,63:2.4,64:2.38,65:2.37,66:2.35,67:2.33,68:2.32,69:2.3,70:2.28,71:2.27,72:2.25,73:2.2,74:2.1,75:2.05,76:2,77:2,78:2.05,79:2.1,80:2.05,81:1.96,82:2.02,83:2.07,84:1.97,85:2.02,86:2.2,87:3.48,88:2.83,89:2,90:2.4,91:2,92:2.3,93:2,94:2,95:2,96:2,97:2,98:2,99:2,100:2,101:2,102:2,103:2,104:2,105:2,106:2,107:2,108:2,109:2},YC=1.7,WC=0;function ZC(e){const t=x_[e];return t===void 0?YC:$C[t]}function XC(e){const t=x_[e];return t===void 0?WC:t}function df(e,t,n,r){return{type:e,key:t,elements:n,getIndex:r}}const QC=typeof process<"u"&&process.versions!=null&&process.versions.node!=null;JC();function JC(){return typeof XMLHttpRequest>"u"||QC?require("xhr2"):XMLHttpRequest}(function(){const e=new Uint32Array(256);for(let t=0;t<256;t++){let n=t;for(let r=0;r<8;r++)n&1?n=3988292384^n>>>1:n=n>>>1;e[t]=n}return e})();const Pt=function(){const e=Uint16Array,t=Uint32Array;return{next_code:new e(16),bl_count:new e(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new e(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new t(32),flmap:new e(512),fltree:[],fdmap:new e(32),fdtree:[],lmap:new e(32768),ltree:[],ttree:[],dmap:new e(32768),dtree:[],imap:new e(512),itree:[],rev15:new e(32768),lhst:new t(286),dhst:new t(30),ihst:new t(19),lits:new t(15e3),strt:new e(65536),prev:new e(32768)}}();(function(){for(let n=0;n<32768;n++){let r=n;r=(r&2863311530)>>>1|(r&1431655765)<<1,r=(r&3435973836)>>>2|(r&858993459)<<2,r=(r&4042322160)>>>4|(r&252645135)<<4,r=(r&4278255360)>>>8|(r&16711935)<<8,Pt.rev15[n]=(r>>>16|r<<16)>>>17}function t(n,r,i){for(;r--!==0;)n.push(0,i)}for(let n=0;n<32;n++)Pt.ldef[n]=Pt.of0[n]<<3|Pt.exb[n],Pt.ddef[n]=Pt.df0[n]<<4|Pt.dxb[n];t(Pt.fltree,144,8),t(Pt.fltree,112,9),t(Pt.fltree,24,7),t(Pt.fltree,8,8),S_(Pt.fltree,9),A_(Pt.fltree,9,Pt.flmap),C_(Pt.fltree,9),t(Pt.fdtree,32,5),S_(Pt.fdtree,5),A_(Pt.fdtree,5,Pt.fdmap),C_(Pt.fdtree,5),t(Pt.itree,19,0),t(Pt.ltree,286,0),t(Pt.dtree,30,0),t(Pt.ttree,320,0)})();function A_(e,t,n){const r=e.length,i=Pt.rev15;for(let o=0;o<r;o+=2)if(e[o+1]!==0){const s=o>>1,a=e[o+1],c=s<<4|a,u=t-a;let l=e[o]<<u;const d=l+(1<<u);for(;l!==d;){const f=i[l]>>>15-t;n[f]=c,l++}}}function S_(e,t){const n=e.length,r=Pt.bl_count;for(let s=0;s<=t;s++)r[s]=0;for(let s=1;s<n;s+=2)r[e[s]]++;const i=Pt.next_code;let o=0;r[0]=0;for(let s=1;s<=t;s++)o=o+r[s-1]<<1,i[s]=o;for(let s=0;s<n;s+=2){const a=e[s+1];a!==0&&(e[s]=i[a],i[a]++)}}function C_(e,t){const n=Pt.rev15,r=15-t;for(let i=0;i<e.length;i+=2){const o=e[i]<<t-e[i+1];e[i]=n[o]>>>r}}var I_;(function(e){e[e.None=0]="None",e[e.Gzip=1]="Gzip",e[e.Zip=2]="Zip"})(I_||(I_={}));var Ls;(function(e){function t(c,u){return{kind:"url",id:ln.create22(),url:c,...u}}e.Url=t;function n(c){return{kind:"file",id:ln.create22(),name:c.name,file:c}}e.File=n;function r(c){return(c==null?void 0:c.kind)==="url"}e.isUrl=r;function i(c){return(c==null?void 0:c.kind)==="file"}e.isFile=i;function o(c,u,l){return{data:c,dispose:()=>{l.release(u)}}}e.Wrapper=o;function s(c){return typeof c=="string"?c:c.url}e.getUrl=s;function a(c,u,l){return typeof u=="string"?c.tryFindUrl(u,l)||t(u,{body:l}):u}e.getUrlAsset=a})(Ls||(Ls={}));var bt;(function(e){e.Essential={isEssential:!0};function t(L,U){return U&&(U.label&&(L.label=U.label),U.description&&(L.description=U.description),U.legend&&(L.legend=U.legend),U.fieldLabels&&(L.fieldLabels=U.fieldLabels),U.isHidden&&(L.isHidden=U.isHidden),U.shortLabel&&(L.shortLabel=U.shortLabel),U.twoColumns&&(L.twoColumns=U.twoColumns),U.isEssential&&(L.isEssential=U.isEssential),U.category&&(L.category=U.category),U.hideIf&&(L.hideIf=U.hideIf),U.help&&(L.help=U.help)),L}function n(L){const U={...L};return U.isOptional=!0,U}e.Optional=n;function r(L,U){return t({type:"value",defaultValue:L},U)}e.Value=r;function i(L,U,Y){return t({type:"select",defaultValue:Z(L,U),options:U,cycle:Y==null?void 0:Y.cycle},Y)}e.Select=i;function o(L,U,Y){const fe=t({type:"multi-select",defaultValue:L,options:U},Y);return Y!=null&&Y.emptyValue&&(fe.emptyValue=Y.emptyValue),fe}e.MultiSelect=o;function s(L,U){return t({type:"boolean",defaultValue:L},U)}e.Boolean=s;function a(L="",U){return t({type:"text",defaultValue:L,multiline:U==null?void 0:U.multiline,placeholder:U==null?void 0:U.placeholder,disableInteractiveUpdates:U==null?void 0:U.disableInteractiveUpdates},U)}e.Text=a;function c(L,U){const Y=t({type:"color",defaultValue:L},U);return U!=null&&U.isExpanded&&(Y.isExpanded=U.isExpanded),Y}e.Color=c;function u(L,U){let Y;if(typeof L=="string"){const fe=g2(L);Y={kind:fe.type!=="qualitative"?"interpolate":"set",colors:fe.list}}else Y=L;return t({type:"color-list",presetKind:(U==null?void 0:U.presetKind)||"all",defaultValue:Y,offsets:!!(U!=null&&U.offsets)},U)}e.ColorList=u;function l(L,U,Y){return t(m({type:"vec3",defaultValue:L},U),Y)}e.Vec3=l;function d(L,U){return t({type:"mat4",defaultValue:L},U)}e.Mat4=d;function f(L,U){const Y=typeof L=="string"?Ls.Url(L):Ls.Url(L.url,{body:L.body});return t({type:"url",defaultValue:Y},U)}e.Url=f;function h(L){const U=t({type:"file",defaultValue:null},L);return L!=null&&L.accept&&(U.accept=L.accept),U}e.File=h;function p(L){const U=t({type:"file-list",defaultValue:null},L);return L!=null&&L.accept&&(U.accept=L.accept),U}e.FileList=p;function m(L,U){return U&&(typeof U.min<"u"&&(L.min=U.min),typeof U.max<"u"&&(L.max=U.max),typeof U.step<"u"&&(L.step=U.step)),L}function y(L,U,Y){const fe=t(m({type:"number",defaultValue:L},U),Y);return Y!=null&&Y.immediateUpdate&&(fe.immediateUpdate=!0),fe}e.Numeric=y;function g(L,U,Y){return t(m({type:"interval",defaultValue:L},U),Y)}e.Interval=g;function b(L,U){const Y=t({type:"line-graph",defaultValue:L},U);return U!=null&&U.getVolume&&(Y.getVolume=U.getVolume),Y}e.LineGraph=b;function v(L,U){const Y=t({type:"group",defaultValue:(U==null?void 0:U.customDefault)||j(L),params:L},U);return U!=null&&U.presets&&(Y.presets=U.presets),U!=null&&U.isExpanded&&(Y.isExpanded=U.isExpanded),U!=null&&U.isFlat&&(Y.isFlat=U.isFlat),U!=null&&U.pivot&&(Y.pivot=U.pivot),Y}e.Group=v;function _(L){return v({},L)}e.EmptyGroup=_;function A(L,U,Y,fe){const me=Z(L,U);return t({type:"mapped",defaultValue:{name:me,params:Y(me).defaultValue},select:i(me,U,fe),map:Y},fe)}e.Mapped=A;function C(L,U,Y){const fe=Y!=null&&Y.options?Y.options:Object.keys(U).map(Te=>[Te,U[Te].label||So(Te)]),me=Z(L,fe);return t({type:"mapped",defaultValue:{name:me,params:U[me].defaultValue},select:i(me,fe,Y),map:Te=>U[Te]},Y)}e.MappedStatic=C;function I(L,U,Y){return t({type:"object-list",element:L,getLabel:U,ctor:S,defaultValue:(Y==null?void 0:Y.defaultValue)||[]},Y)}e.ObjectList=I;function S(){return j(this.element)}function w(){throw new Error("getValue not set. Fix runtime.")}function R(L,U,Y){var fe;return t({type:"value-ref",defaultValue:{ref:(fe=Y==null?void 0:Y.defaultRef)!==null&&fe!==void 0?fe:"",getValue:w},getOptions:L,resolveRef:U},Y)}e.ValueRef=R;function M(L){var U;return t({type:"data-ref",defaultValue:{ref:(U=L==null?void 0:L.defaultRef)!==null&&U!==void 0?U:"",getValue:w}},L)}e.DataRef=M;function P(L,U,Y){return t({type:"converted",defaultValue:U(Y.defaultValue),converted:Y,fromValue:L,toValue:U},Y)}e.Converted=P;function E(L,U,Y,fe,me){const Te=Object.keys(U).map(x=>[x,x]);return t({type:"conditioned",select:i(Y(L),Te,me),defaultValue:L,conditionParams:U,conditionForValue:Y,conditionedValue:fe},me)}e.Conditioned=E;function N(L,U){return t({type:"script",defaultValue:L},U)}e.Script=N;function q(L){return 0}e.For=q;function j(L){const U={};for(const Y of Object.keys(L))L[Y].isOptional||(U[Y]=L[Y].defaultValue);return U}e.getDefaultValues=j;function z(L,U,Y){return()=>L(U,Y)}function W(L,U,Y){if(U){if(L.type==="value-ref"){const fe=U;fe.ref?fe.getValue=z(L.resolveRef,fe.ref,Y):fe.getValue=()=>{throw new Error("Unset ref in ValueRef value.")}}else if(L.type==="data-ref"){const fe=U;fe.ref?fe.getValue=z(Y,fe.ref,Y):fe.getValue=()=>{throw new Error("Unset ref in ValueRef value.")}}else if(L.type==="group")$(L.params,U,Y);else if(L.type==="mapped"){const fe=U,me=L.map(fe.name);W(me,fe.params,Y)}else if(L.type==="object-list"){if(!ue(L.element))return;for(const fe of U)$(L.element,fe,Y)}}}function se(L){if(L.type==="value-ref"||L.type==="data-ref")return!0;if(L.type==="group"){if(ue(L.params))return!0}else if(L.type==="mapped"){for(const[U]of L.select.options)if(se(L.map(U)))return!0}else if(L.type==="object-list")return ue(L.element);return!1}function ue(L){for(const U of Object.keys(L))if(se(L[U]))return!0;return!1}function $(L,U,Y){for(const fe of Object.keys(L))W(L[fe],U==null?void 0:U[fe],Y)}e.resolveRefs=$;function ne(L,U){for(const Y of Object.keys(L))L[Y].isOptional||(L[Y].defaultValue=U[Y])}e.setDefaultValues=ne;function de(L){return Bl(L)}e.clone=de;function _e(L,U){}e.validate=_e;function X(L,U,Y){if(U===Y)return!0;if(typeof U!="object"||typeof Y!="object")return!1;for(const fe of Object.keys(L))if(!ce(L[fe],U[fe],Y[fe]))return!1;return!0}e.areEqual=X;function ce(L,U,Y){if(U===Y)return!0;if(L.type==="group")return X(L.params,U,Y);if(L.type==="mapped"){const fe=U,me=Y;if(fe.name!==me.name)return!1;const Te=L.map(fe.name);return ce(Te,fe.params,me.params)}else if(L.type==="multi-select"){const fe=U,me=Y;if(fe.length!==me.length)return!1;if(fe.length<10){for(let Te=0,x=fe.length;Te<x;Te++)if(fe[Te]!==me[Te]&&me.indexOf(fe[Te])<0)return!1}else{const Te=new Set(me);for(let x=0,D=fe.length;x<D;x++)if(fe[x]!==me[x]&&!Te.has(fe[x]))return!1}return!0}else{if(L.type==="interval")return U[0]===Y[0]&&U[1]===Y[1];if(L.type==="line-graph"){const fe=U,me=Y;if(fe.length!==me.length)return!1;for(let Te=0,x=fe.length;Te<x;Te++)if(!os.areEqual(fe[Te],me[Te]))return!1;return!0}else{if(L.type==="vec3")return O.equals(U,Y);if(L.type==="mat4")return Oe.areEqual(U,Y,Tt);if(L.type==="script"){const fe=U,me=Y;return fe.language===me.language&&fe.expression===me.expression}else if(L.type==="object-list"){const fe=U,me=Y,Te=fe.length;if(Te!==me.length)return!1;for(let x=0;x<Te;x++)if(!X(L.element,fe[x],me[x]))return!1;return!0}else if(typeof U=="object"&&typeof Y=="object")return lv(U,Y)}}return!1}e.isParamEqual=ce;function k(L,U,Y){if(U===void 0)return{...Y};if(Y===void 0)return{...U};const fe=Object.create(null);for(const me of Object.keys(L))fe[me]=B(L[me],U[me],Y[me]);return fe}e.merge=k;function B(L,U,Y){if(U===void 0)return typeof Y=="object"&&!Array.isArray(Y)?{...Y}:Y;if(Y===void 0)return typeof U=="object"&&!Array.isArray(U)?{...U}:U;if(L.type==="group")return k(L.params,U,Y);if(L.type==="mapped"){const fe=U,me=Y;if(fe.name!==me.name)return{...me};const Te=L.map(me.name);return{name:me.name,params:B(Te,fe.params,me.params)}}else return L.type==="value"?Y:typeof U=="object"&&typeof Y=="object"?Array.isArray(Y)?Y:{...U,...Y}:Y}e.mergeParam=B;function F(L,U){for(const Y of L.options)if(Y[0]===U)return!0;return!1}function re(L,U,Y){if(U==null)return Y?L.defaultValue:void 0;if(L.type==="value")return U;if(L.type==="group"){const fe=Object.create(null);for(const me of Object.keys(L.params)){const Te=L.params[me];U[me]===void 0?Y&&(fe[me]=Te.defaultValue):fe[me]=re(Te,U[me],Y)}return fe}else if(L.type==="mapped"){const fe=U;if(typeof fe.name!="string")return L.defaultValue;if(typeof fe.params>"u")return Y?L.defaultValue:void 0;if(!F(L.select,fe.name))return L.defaultValue;const me=L.map(fe.name);return{name:fe.name,params:re(me,fe.params,Y)}}else{if(L.type==="select")return F(L,U)?U:L.defaultValue;if(L.type==="multi-select"){if(!Array.isArray(U))return L.defaultValue;const fe=U.filter(function(me){return F(this,me)},L);return U.length>0&&fe.length===0?L.defaultValue:fe}else if(L.type==="object-list")return Array.isArray(U)?U.map(fe=>G(L.element,fe,Y?"all":"skip")):L.defaultValue}return U}function G(L,U,Y){if(typeof U!="object"||U===null)return Y?j(L):U;const fe=Object.create(null);for(const me of Object.keys(L)){const Te=L[me];U[me]===void 0?Y==="all"&&(fe[me]=Te.defaultValue):fe[me]=re(Te,U[me],Y!=="skip")}return fe}e.normalizeParams=G;function V(L,U){const Y=[];for(const fe of Object.keys(L))if(!U)typeof L[fe]=="string"?Y.push([fe,L[fe]]):Y.push([fe,U===null?fe:So(fe)]);else{const me=U(fe,L[fe]);Y.push(typeof me=="string"?[fe,me]:[fe,me[0],me[1]])}return Y}e.objectToOptions=V;function K(L,U){const Y=[];for(const fe of L)U?Y.push([fe,U(fe)]):Y.push([fe,U===null?fe:So(fe)]);return Y}e.arrayToOptions=K;function Q(L,U){for(const Y of L.options)if(Y[0]===U)return Y[1];return""}e.optionLabel=Q;function Z(L,U){for(const Y of U)if(Y[0]===L)return L;return U.length>0?U[0][0]:void 0}function ie(L,U){const Y={};for(const fe of Object.keys(U)){const me=U[fe];!L[fe]||me===null||me===void 0||L[fe].defaultValue===me||(Y[fe]={...L[fe],defaultValue:me})}return{...L,...Y}}e.withDefaults=ie})(bt||(bt={}));function eI(e){const{unit:t,flags:n,proteinInfo:r}=e,i=t.conformation,{traceElementIndex:o}=t.model.atomicHierarchy.derived.residue,{residueIndices:s,nIndices:a}=r,c=s.length,u=(g,b)=>g===-1?O.setNaN(b):i.position(g,b),l=O(),d=O(),f=O(),h=O(),p=O(),m=O(),y=O();e:for(let g=2;g<c-2;g++){for(let w=0;w<4;w++){const R=g+w-2;if(u(o[R],h),u(a[R+1],p),O.squaredDistance(h,p)>6.25)continue e}const b=s[g-2],v=s[g],_=s[g+2],A=o[b],C=o[v],I=o[_];u(A,l),u(C,d),u(I,f),O.sub(m,l,d),O.sub(y,d,f);const S=Qr(O.angle(m,y));S&&S>70&&(n[g]|=32)}}const tI=9,Gs=-27.888,nI=-.5,w_=-9.9;function rI(e,t,n,r){const i=O.distance(e,r),o=O.distance(t,r),s=O.distance(t,n),a=O.distance(e,n),c=Gs/i-Gs/o,u=Gs/s-Gs/a,l=c+u;return l<w_?w_:l}function iI(e,t,n){const{residueIndices:r,cIndices:i,hIndices:o,nIndices:s,oIndices:a}=t,{index:c}=e.model.atomicHierarchy,u=e.conformation,{traceElementIndex:l}=e.model.atomicHierarchy.derived.residue,d=r.length,f=[],h=[],p=[],m=O(),y=O(),g=O(),b=O(),v=O(),_=O(),A=O();for(let C=0,I=r.length;C<I;++C){const S=C,w=r[C],R=a[S],M=i[S],P=l[w];if(R===-1||M===-1||c.findAtomOnResidue(w,"OXT")!==-1)continue;u.invariantPosition(R,m),u.invariantPosition(M,y),u.invariantPosition(P,g);const{indices:E,count:N}=n.find(g[0],g[1],g[2],tI);for(let q=0;q<N;++q){const j=E[q];if(j===S||j-1===S||j+1===S)continue;const z=s[j];if(z===-1)continue;u.invariantPosition(z,b);const W=o[j];if(W===-1){if(j===0)continue;const ue=j-1,$=a[ue],ne=i[ue];if($===-1||ne===-1)continue;u.invariantPosition($,A),u.invariantPosition(ne,_),O.sub(v,_,A);const de=O.distance(A,_);O.scaleAndAdd(v,b,v,1/de)}else u.invariantPosition(W,v);const se=rI(m,y,b,v);se>nI||(f[f.length]=S,h[h.length]=j,p[p.length]=se)}}return oI(d,f,h,p)}function oI(e,t,n,r){const i=new or.DirectedEdgeBuilder(e,t,n),o=new Float32Array(i.slotCount);for(let s=0,a=i.edgeCount;s<a;s++)i.addNextEdge(),i.assignProperty(o,r[s]);return i.createGraph({energies:r})}var We;(function(e){e.is=tr.has,e.create=tr.create})(We||(We={}));class Hs{constructor(t,n,r){this.partner1=Math.min(t,n),this.partner2=Math.max(t,n),this.type=r}}function sI(e){const{proteinInfo:t,hbonds:n,flags:r}=e,i=[1024,2048,4096,128,256,512];for(let o=0;o<3;o++)for(let s=0,a=t.residueIndices.length-1;s<a;++s)if(n.getDirectedEdgeIndex(s,s+o+3)!==-1)if(r[s]|=i[o+3]|i[o],e.params.oldDefinition)for(let c=1;c<o+3;++c)r[s+c]|=i[o+3]|64;else for(let c=0;c<=o+3;++c)r[s+c]|=i[o+3]|64}function aI(e){const{proteinInfo:t,flags:n}=e,r=t.residueIndices.length,i=[1024,2048,4096,128,256,512],o=[0,0,0,8,1,16],s=e.params.oldOrdering?[4,3,5]:[3,4,5];for(let a=0;a<s.length;a++){const c=s[a];for(let u=1,l=r-c;u<l;u++){const d=We.create(n[u]),f=We.create(n[u-1]),h=We.create(n[u+1]);if(e.params.oldOrdering){if(c===3&&(We.is(d,1)||We.is(h,1))||c===5&&(We.is(d,1)||We.is(d,8)||We.is(h,1)||We.is(h,8)))continue}else if(c===4&&(We.is(d,8)||We.is(h,8))||c===5&&(We.is(d,1)||We.is(d,8)||We.is(h,1)||We.is(h,8)))continue;if(We.is(d,i[c])&&We.is(d,i[c-3])&&We.is(f,i[c])&&We.is(f,i[c-3]))if(e.params.oldDefinition)for(let p=0;p<c;p++)n[u+p]|=o[c];else for(let p=-1;p<=c;p++)n[u+p]|=o[c]}}}function cI(e,t){if(t.type!==e.type||t.partner1!==e.firstEnd+1)return!1;if(t.type===0){if(t.partner2===e.secondEnd+1)return!0}else if(t.partner2===e.secondStart-1)return!0;return!1}function uI(e,t){return e.type===t.type&&t.firstStart-e.firstEnd<6&&e.firstStart<t.firstStart&&t.nextLadder===0?e.type===0?P_(e,t):P_(t,e):!1}function P_(e,t){return t.secondStart-e.secondEnd>0&&(t.secondStart-e.secondEnd<6&&t.firstStart-e.firstEnd<3||t.secondStart-e.secondEnd<3)}function lI(e){const{bridges:t,ladders:n}=e;for(let r=0;r<t.length;r++){const i=t[r];let o=!1;for(let s=0;s<n.length;s++){const a=n[s];cI(a,i)&&(o=!0,a.firstEnd++,i.type===0?a.secondEnd++:a.secondStart--)}o||(n[n.length]={previousLadder:0,nextLadder:0,firstStart:i.partner1,firstEnd:i.partner1,secondStart:i.partner2,secondEnd:i.partner2,type:i.type})}for(let r=0;r<n.length;r++){const i=n[r];for(let o=r;o<n.length;o++){const s=n[o];uI(i,s)&&(i.nextLadder=o,s.previousLadder=r)}}}function fI(e){const{proteinInfo:t,hbonds:n,flags:r,bridges:i}=e,{offset:o,b:s}=n;let a,c;for(let u=0,l=t.residueIndices.length;u<l;++u)for(let d=o[u],f=o[u+1];d<f;d++){const h=s[d];u>h||(a=u+1,c=h,a!==c&&n.getDirectedEdgeIndex(c,a+1)!==-1&&(r[a]|=2,r[c]|=2,i[i.length]=new Hs(a,c,0)),a=u,c=h-1,a!==c&&n.getDirectedEdgeIndex(c-1,a)!==-1&&(r[a]|=2,r[c]|=2,i[i.length]=new Hs(c,a,0)),a=u,c=h,a!==c&&n.getDirectedEdgeIndex(c,a)!==-1&&(r[a]|=2,r[c]|=2,i[i.length]=new Hs(c,a,1)),a=u+1,c=h-1,a!==c&&n.getDirectedEdgeIndex(c-1,a+1)!==-1&&(r[a]|=2,r[c]|=2,i[i.length]=new Hs(c,a,1)))}i.sort((u,l)=>u.partner1>l.partner1?1:u.partner1<l.partner1?-1:0)}function E_(e){return We.is(e,8)||We.is(e,1)||We.is(e,16)}function dI(e){const{ladders:t,flags:n}=e;for(let r=0;r<t.length;r++){const i=t[r];for(let s=i.firstStart;s<=i.firstEnd;s++){const a=i.firstStart-s,c=i.secondStart-a;i.firstStart!==i.firstEnd?(n[s]|=4,n[c]|=4):(!E_(n[s])&&We.is(n[s],4)&&(n[s]|=2),!E_(n[c])&&We.is(n[c],4)&&(n[c]|=2))}if(i.nextLadder===0)continue;const o=t[i.nextLadder];for(let s=i.firstStart;s<=o.firstEnd;s++)n[s]|=4;if(i.type===0)for(let s=i.secondStart;s<=o.secondEnd;s++)n[s]|=4;else for(let s=o.secondEnd;s<=i.secondStart;s++)n[s]|=4}}function hI(e,t){const{cIndices:n,nIndices:r,residueIndices:i}=t,o=e.conformation,{index:s}=e.model.atomicHierarchy,{traceElementIndex:a}=e.model.atomicHierarchy.derived.residue,c=i.length,u=(A,C)=>A===-1?O.setNaN(C):o.position(A,C);let l=O(),d=O(),f=O(),h=O(),p=O(),m=O();const y=O(),g=O(),b=O();if(c===0)return{phi:new Float32Array(0),psi:new Float32Array(0)};const v=new Float32Array(c-1),_=new Float32Array(c-1);u(-1,l),u(-1,d),u(-1,f),u(n[0],h),u(a[i[0]],p),u(r[0],m),u(n[1],y),u(a[i[1]],g),u(r[1],b);for(let A=0;A<c-1;++A)s.findAtomOnResidue(i[A],"OXT")===-1&&(v[A]=Qr(O.dihedralAngle(l,m,p,h)),_[A]=Qr(O.dihedralAngle(m,p,h,b)),l=h,d=p,f=m,h=y,p=g,m=b,u(n[A+1],y),u(a[i[A+1]],g),u(r[A+1],b));return{phi:v,psi:_}}function mI(e,t){const{x:n,y:r,z:i}=e.model.atomicConformation,{traceElementIndex:o}=e.model.atomicHierarchy.derived.residue,s=new Uint32Array(t.length);for(let c=0,u=t.length;c<u;++c)s[c]=o[t[c]];const a={x:n,y:r,z:i,indices:ve.ofSortedArray(s)};return ws(a,uf(a))}function pI(e){const{index:t}=e.model.atomicHierarchy,{proteinElements:n,residueIndex:r}=e,i=n.length,o=new Uint32Array(i),s=new Int32Array(i),a=new Int32Array(i),c=new Int32Array(i),u=new Int32Array(i);for(let l=0;l<i;++l){const d=r[n[l]];o[l]=d,s[l]=t.findAtomOnResidue(d,"C"),a[l]=t.findAtomOnResidue(d,"H"),c[l]=t.findAtomOnResidue(d,"O"),u[l]=t.findAtomOnResidue(d,"N")}return{residueIndices:ve.ofSortedArray(o),cIndices:s,hIndices:a,oIndices:c,nIndices:u}}const B_={oldDefinition:bt.Boolean(!0,{description:"Whether to use the old DSSP convention for the annotation of turns and helices, causes them to be two residues shorter"}),oldOrdering:bt.Boolean(!0,{description:"Alpha-helices are preferred over 3-10 helices"})},_I=bt.getDefaultValues(B_);async function R_(e,t){const n=pI(e),{residueIndices:r}=n,i=mI(e,r),o=iI(e,n,i),s=r.length,a=new Uint32Array(s);hI(e,n);const c=[],u=[],l=t.oldDefinition?bI:xI;t.oldOrdering;const d={params:t,unit:e,proteinInfo:n,flags:a,hbonds:o,ladders:c,bridges:u};sI(d),aI(d),eI(d),fI(d),lI(d),dI(d);const f=SI(a,l),h=new Uint32Array(s),p=[],m=[],y=g=>ve.indexOf(r,g);for(let g=0,b=r.length;g<b;++g){const v=f[g];h[g]=v;const _=l(a[g]);(m.length===0||_!==m[m.length-1].flags)&&(m[m.length]=yI(gI(v),a[g],l)),p[g]=m.length-1}return df(h,p,m,y)}function yI(e,t,n){return e==="helix"?{kind:"helix",flags:n(t)}:e==="sheet"?{kind:"sheet",flags:n(t)}:e==="turn"||e==="bend"?{kind:"turn",flags:n(t)}:{kind:"none"}}function gI(e){return e===Dt.SecondaryStructureDssp.H||e===Dt.SecondaryStructureDssp.G||e===Dt.SecondaryStructureDssp.I?"helix":e===Dt.SecondaryStructureDssp.B||e===Dt.SecondaryStructureDssp.E?"sheet":e===Dt.SecondaryStructureDssp.T?"turn":e===Dt.SecondaryStructureDssp.S?"bend":"none"}function bI(e){return We.is(e,1)?Dt.SecondaryStructureDssp.H:We.is(e,4)?Dt.SecondaryStructureDssp.E:We.is(e,2)?Dt.SecondaryStructureDssp.B:We.is(e,8)?Dt.SecondaryStructureDssp.G:We.is(e,16)?Dt.SecondaryStructureDssp.I:We.is(e,64)?Dt.SecondaryStructureDssp.T:We.is(e,32)?Dt.SecondaryStructureDssp.S:0}function vI(e){return We.is(e,1)?"H":We.is(e,4)?"E":We.is(e,2)?"B":We.is(e,8)?"G":We.is(e,16)?"I":We.is(e,64)?"T":We.is(e,32)?"S":"-"}function xI(e){return We.is(e,16)?Dt.SecondaryStructureDssp.I:We.is(e,1)?Dt.SecondaryStructureDssp.H:We.is(e,4)?Dt.SecondaryStructureDssp.E:We.is(e,2)?Dt.SecondaryStructureDssp.B:We.is(e,8)?Dt.SecondaryStructureDssp.G:We.is(e,64)?Dt.SecondaryStructureDssp.T:We.is(e,32)?Dt.SecondaryStructureDssp.S:0}function AI(e){return We.is(e,16)?"I":We.is(e,1)?"H":We.is(e,4)?"E":We.is(e,2)?"B":We.is(e,8)?"G":We.is(e,64)?"T":We.is(e,32)?"S":"-"}function SI(e,t){const n=new Uint32Array(e.length);for(let r=0,i=e.length;r<i;++r){const o=We.create(e[r]);n[r]=t(o)}return n}var Bo;(function(e){function t(r){const i=r.descriptor.name,o=r.type==="root"?"inheritedPropertyData":"currentPropertyData",s=c=>(i in c[o]||(c[o][i]={props:{...bt.getDefaultValues(r.getParams(c))},data:Br.create(void 0)}),c[o][i]),a=(c,u,l)=>{const d=s(c);c[o][i]={props:u,data:Br.withValue(d.data,l)}};return{label:r.label,descriptor:r.descriptor,isHidden:r.isHidden,getParams:c=>{const u=bt.clone(r.getParams(c));return bt.setDefaultValues(u,s(c).props),u},defaultParams:r.defaultParams,isApplicable:r.isApplicable,attach:async(c,u,l={},d)=>{d&&u.customPropertyDescriptors.reference(r.descriptor,!0),r.type==="root"&&(u=u.root);const f=s(u.root).props,h=s(u),p=bt.merge(r.defaultParams,f,l);if(h.data.value&&bt.areEqual(r.defaultParams,h.props,p))return;const{value:m,assets:y}=await r.obtain(c,u,p);u.customPropertyDescriptors.add(r.descriptor),u.customPropertyDescriptors.assets(r.descriptor,y),a(u,p,m)},ref:(c,u)=>c.customPropertyDescriptors.reference(r.descriptor,u),get:c=>s(c).data,set:(c,u={},l)=>{r.type==="root"&&(c=c.root);const d=s(c),f=bt.merge(r.defaultParams,d.props,u);bt.areEqual(r.defaultParams,d.props,f)||(a(c,f,l),c.customPropertyDescriptors.assets(r.descriptor))},props:c=>s(c).props}}e.createProvider=t;function n(r,i,o){const s={value:bt.Value(o,{isHidden:!0})};return t({label:So(r),descriptor:ri({name:r}),isHidden:!0,type:i,defaultParams:s,getParams:()=>({value:bt.Value(o,{isHidden:!0})}),isApplicable:()=>!0,obtain:async(a,c,u)=>({...bt.getDefaultValues(s),...u})})}e.createSimple=n})(Bo||(Bo={}));var di;(function(e){e.Descriptor={name:"model_secondary_structure"},e.Provider=sr.create(e.Descriptor);function t(n,r,i){const o=new Map,s=[{kind:"none"}],a=CI(n,r);II(n,a,o,s),wI(r,a,o,n._rowCount,s);const c=i.residues._rowCount,u=d=>d,l={type:new Int32Array(c),key:new Int32Array(c),elements:s};return o.size>0&&EI(i,a,o,l),df(l.type,l.key,l.elements,u)}e.fromStruct=t})(di||(di={}));function CI(e,t){if(e._rowCount>0){if(e.beg_label_seq_id.valueKind(0)!==0||e.end_label_seq_id.valueKind(0)!==0)return"auth"}else if(t&&(t.beg_label_seq_id.valueKind(0)!==0||t.end_label_seq_id.valueKind(0)!==0))return"auth";return"label"}function II(e,t,n,r){if(!e._rowCount)return;const{beg_label_asym_id:i,beg_label_seq_id:o,beg_auth_seq_id:s,pdbx_beg_PDB_ins_code:a}=e,{end_label_seq_id:c,end_auth_seq_id:u,pdbx_end_PDB_ins_code:l}=e,{pdbx_PDB_helix_class:d,conf_type_id:f,details:h}=e,p=t==="label"?o:s,m=t==="label"?c:u;for(let y=0,g=e._rowCount;y<g;y++){const b=Dt.create(d.valueKind(y)===0?Dt.SecondaryStructurePdb[d.value(y)]:f.valueKind(y)===0?Dt.SecondaryStructureMmcif[f.value(y)]:536870912),v={kind:"helix",flags:b,type_id:f.valueKind(y)===0?f.value(y):"helx_p",helix_class:d.value(y),details:h.valueKind(y)===0?h.value(y):void 0},_={startSeqId:p.value(y),startInsCode:a.value(y),endSeqId:m.value(y),endInsCode:l.value(y),type:b,key:r.length};r[r.length]=v;const A=i.value(y);if(n.has(A)){const C=n.get(A);C.has(_.startSeqId)?C.get(_.startSeqId).push(_):C.set(_.startSeqId,[_])}else n.set(A,new Map([[_.startSeqId,[_]]]))}}function wI(e,t,n,r,i){if(!e._rowCount)return;const{beg_label_asym_id:o,beg_label_seq_id:s,beg_auth_seq_id:a,pdbx_beg_PDB_ins_code:c}=e,{end_label_seq_id:u,end_auth_seq_id:l,pdbx_end_PDB_ins_code:d}=e,{sheet_id:f}=e,h=t==="label"?s:a,p=t==="label"?u:l,m=new Map;let y=r+1;for(let g=0,b=e._rowCount;g<b;g++){const v=f.value(g);let _;m.has(v)?_=m.get(v):(_=y++,m.set(v,_));const A=Dt.create(8388612),C={kind:"sheet",flags:A,sheet_id:v,symmetry:void 0},I={startSeqId:h.value(g),startInsCode:c.value(g),endSeqId:p.value(g),endInsCode:d.value(g),type:A,key:i.length};i[i.length]=C;const S=o.value(g);if(n.has(S)){const w=n.get(S);w.has(I.startSeqId)?w.get(I.startSeqId).push(I):w.set(I.startSeqId,[I])}else n.set(S,new Map([[I.startSeqId,[I]]]))}}function PI(e,t,n,r,i,o){const{auth_seq_id:s,label_seq_id:a,pdbx_PDB_ins_code:c}=e.residues,{endSeqId:u,endInsCode:l,key:d,type:f}=n,h=t==="label"?a:s;let p=r;for(;p<i;){const m=h.value(p);if(o.type[p]=f,o.key[p]=d,m>u||m===u&&c.value(p)===l)break;p++}}function EI(e,t,n,r){const{count:i}=e.chainAtomSegments,{label_asym_id:o}=e.chains,{auth_seq_id:s,label_seq_id:a,pdbx_PDB_ins_code:c}=e.residues,u=t==="label"?a:s;for(let l=0;l<i;l++){const d=zi.chainStartResidueIndex(e,l),f=zi.chainEndResidueIndexExcl(e,l),h=o.value(l);if(n.has(h)){const p=n.get(h);for(let m=d;m<f;m++){const y=u.value(m);if(p.has(y)){const g=p.get(y);for(const b of g){const v=c.value(m);b.startInsCode===v&&PI(e,t,b,m,f,r)}}}}}}const BI=[5.45,5.18,6.37],RI=2.1,DI=[6.1,10.4,13],NI=1.42,D_=O(),N_=O();function M_(e,t,n,r,i){const o=e.conformation,{traceElementIndex:s}=e.model.atomicHierarchy.derived.residue;for(let a=Math.max(0,n-2);a<=n;++a)for(let c=2;c<5;++c){if(a+c>=t.length)return!1;const u=t[a],l=t[a+c],d=s[u],f=s[l];if(d===-1||f===-1)return!1;o.invariantPosition(d,D_),o.invariantPosition(f,N_);const h=O.distance(D_,N_);if(Math.abs(h-r[c-2])>=i)return!1}return!0}async function T_(e){const t=e.proteinElements.length,n=new Uint32Array(t),r=[],i=[],{proteinElements:o,residueIndex:s}=e,a=o.length,c=new Uint32Array(a);for(let d=0;d<a;++d){const f=s[o[d]];c[d]=f}const u=ve.ofSortedArray(c),l=d=>ve.indexOf(u,d);for(let d=0,f=u.length;d<f;++d){let h=0;M_(e,u,d,BI,RI)?h=2:M_(e,u,d,DI,NI)&&(h=4),n[d]=h,(i.length===0||h!==OI(i[i.length-1]))&&(i[i.length]=MI(TI(h),h)),r[d]=i.length-1}return df(n,r,i,l)}function MI(e,t){return e==="helix"?{kind:"helix",flags:t}:e==="sheet"?{kind:"sheet",flags:t}:{kind:"none"}}function TI(e){return e===2?"helix":e===4?"sheet":"none"}function OI(e){return e.kind==="helix"||e.kind==="sheet"?e.flags:0}function O_(e){return{type:bt.MappedStatic("auto",{auto:bt.EmptyGroup({label:"Automatic"}),model:bt.EmptyGroup({label:"Model"}),dssp:bt.Group(B_,{label:"DSSP",isFlat:!0}),"zhang-skolnick":bt.EmptyGroup({label:"Zhang-Skolnick"})},{options:[["auto","Automatic"],["model","Model"],["dssp","DSSP"],["zhang-skolnick","Zhang-Skolnick"]]})}}const k_=O_(),q_=Bo.createProvider({label:"Secondary Structure",descriptor:ri({name:"molstar_computed_secondary_structure"}),type:"root",defaultParams:k_,getParams:O_,isApplicable:e=>!0,obtain:async(e,t,n)=>{const r={...bt.getDefaultValues(k_),...n};switch(r.type.name){case"auto":return{value:await kI(t)};case"dssp":return{value:await qI(t,r.type.params)};case"model":return{value:await FI(t)};case"zhang-skolnick":return{value:await UI(t)}}}});async function kI(e){const t=new Map;for(let n=0,r=e.unitSymmetryGroups.length;n<r;++n){const i=e.unitSymmetryGroups[n].units[0],o=i.model;if($t.isFromPdbArchive(o)&&$t.isExperimental(o)&&!$t.isCoarseGrained(o)||$t.hasSecondaryStructure(o)){const s=di.Provider.get(o);s&&t.set(i.invariantId,s)}else if(Ne.isAtomic(i)&&!$t.isCoarseGrained(o)){const s=await R_(i,_I);t.set(i.invariantId,s)}else if(Ne.isAtomic(i)){const s=await T_(i);t.set(i.invariantId,s)}}return t}async function qI(e,t){const n=new Map;for(let r=0,i=e.unitSymmetryGroups.length;r<i;++r){const o=e.unitSymmetryGroups[r].units[0];if(Ne.isAtomic(o)&&!$t.isCoarseGrained(o.model)){const s=await R_(o,t);n.set(o.invariantId,s)}}return n}async function UI(e){const t=new Map;for(let n=0,r=e.unitSymmetryGroups.length;n<r;++n){const i=e.unitSymmetryGroups[n].units[0];if(Ne.isAtomic(i)){const o=await T_(i);t.set(i.invariantId,o)}}return t}async function FI(e){const t=new Map;for(let n=0,r=e.unitSymmetryGroups.length;n<r;++n){const i=e.unitSymmetryGroups[n].units[0];if(Ne.isAtomic(i)){const o=di.Provider.get(i.model);o&&t.set(i.invariantId,o)}}return t}function E8(e){return e}function Ft(){throw new Error("Property only available for atomic models.")}function LI(e){throw new Error("Property only available for coarse models.")}const Ro={key:e=>e.element,x:e=>e.unit.conformation.x(e.element),y:e=>e.unit.conformation.y(e.element),z:e=>e.unit.conformation.z(e.element),id:e=>Ne.isAtomic(e.unit)?e.unit.model.atomicConformation.atomId.value(e.element):Ft(),occupancy:e=>Ne.isAtomic(e.unit)?e.unit.model.atomicConformation.occupancy.value(e.element):Ft(),B_iso_or_equiv:e=>Ne.isAtomic(e.unit)?e.unit.model.atomicConformation.B_iso_or_equiv.value(e.element):Ft(),sourceIndex:e=>Ne.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atomSourceIndex.value(e.element):e.element,type_symbol:e=>Ne.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atoms.type_symbol.value(e.element):Ft(),label_atom_id:e=>Ne.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atoms.label_atom_id.value(e.element):Ft(),auth_atom_id:e=>Ne.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atoms.auth_atom_id.value(e.element):Ft(),label_alt_id:e=>Ne.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atoms.label_alt_id.value(e.element):Ft(),label_comp_id:js,auth_comp_id:e=>Ne.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atoms.auth_comp_id.value(e.element):Ft(),pdbx_formal_charge:e=>Ne.isAtomic(e.unit)?e.unit.model.atomicHierarchy.atoms.pdbx_formal_charge.value(e.element):Ft(),vdw_radius:e=>Ne.isAtomic(e.unit)?ZC(e.unit.model.atomicHierarchy.atoms.type_symbol.value(e.element)):Ft()};function js(e){return Ne.isAtomic(e.unit)||Ft(),e.unit.model.atomicHierarchy.atoms.label_comp_id.value(e.element)}function hf(e){return Ne.isAtomic(e.unit)?e.unit.model.atomicHierarchy.residues.label_seq_id.value(e.unit.residueIndex[e.element]):Ft()}function GI(e){Ne.isAtomic(e.unit)||Ft();const t=e.unit.model.sequence.byEntityKey[pn(e)];return t&&t.sequence.microHet.has(hf(e))}function U_(e){Ne.isAtomic(e.unit)||Ft();const t=e.unit.model.sequence.byEntityKey[pn(e)];return t?t.sequence.microHet.get(hf(e))||[js(e)]:[js(e)]}const HI={key:e=>Ne.isAtomic(e.unit)?e.unit.residueIndex[e.element]:Ft(),group_PDB:e=>Ne.isAtomic(e.unit)?e.unit.model.atomicHierarchy.residues.group_PDB.value(e.unit.residueIndex[e.element]):Ft(),label_seq_id:hf,auth_seq_id:e=>Ne.isAtomic(e.unit)?e.unit.model.atomicHierarchy.residues.auth_seq_id.value(e.unit.residueIndex[e.element]):Ft(),pdbx_PDB_ins_code:e=>Ne.isAtomic(e.unit)?e.unit.model.atomicHierarchy.residues.pdbx_PDB_ins_code.value(e.unit.residueIndex[e.element]):Ft(),isNonStandard:e=>Ne.isAtomic(e.unit)?U_(e).some(t=>e.unit.model.properties.chemicalComponentMap.get(t).mon_nstd_flag[0]==="n"):Ft(),hasMicroheterogeneity:GI,microheterogeneityCompIds:U_,secondary_structure_type:e=>{var t;Ne.isAtomic(e.unit)||Ft();const n=(t=q_.get(e.structure).value)===null||t===void 0?void 0:t.get(e.unit.invariantId);return n?n.type[n.getIndex(e.unit.residueIndex[e.element])]:536870912},secondary_structure_key:e=>{var t;Ne.isAtomic(e.unit)||Ft();const n=(t=q_.get(e.structure).value)===null||t===void 0?void 0:t.get(e.unit.invariantId);return n?n.key[n.getIndex(e.unit.residueIndex[e.element])]:-1},chem_comp_type:e=>Ne.isAtomic(e.unit)?e.unit.model.properties.chemicalComponentMap.get(js(e)).type:Ft()},jI={key:e=>Ne.isAtomic(e.unit)?e.unit.chainIndex[e.element]:Ft(),label_asym_id:e=>Ne.isAtomic(e.unit)?e.unit.model.atomicHierarchy.chains.label_asym_id.value(e.unit.chainIndex[e.element]):e.unit.coarseElements.asym_id.value(e.element),auth_asym_id:e=>Ne.isAtomic(e.unit)?e.unit.model.atomicHierarchy.chains.auth_asym_id.value(e.unit.chainIndex[e.element]):Ft(),label_entity_id:e=>Ne.isAtomic(e.unit)?e.unit.model.atomicHierarchy.chains.label_entity_id.value(e.unit.chainIndex[e.element]):e.unit.coarseElements.entity_id.value(e.element)},zI={key:Ro.key,entityKey:e=>Ne.isCoarse(e.unit)?e.unit.coarseElements.entityKey[e.element]:LI(),x:Ro.x,y:Ro.y,z:Ro.z};function pn(e){switch(e.unit.kind){case 0:return e.unit.model.atomicHierarchy.index.getEntityFromChain(e.unit.chainIndex[e.element]);case 1:return e.unit.model.coarseHierarchy.spheres.entityKey[e.element];case 2:return e.unit.model.coarseHierarchy.gaussians.entityKey[e.element]}}const VI={key:pn,id:e=>e.unit.model.entities.data.id.value(pn(e)),type:e=>e.unit.model.entities.data.type.value(pn(e)),src_method:e=>e.unit.model.entities.data.src_method.value(pn(e)),pdbx_description:e=>e.unit.model.entities.data.pdbx_description.value(pn(e)),formula_weight:e=>e.unit.model.entities.data.formula_weight.value(pn(e)),pdbx_number_of_molecules:e=>e.unit.model.entities.data.pdbx_number_of_molecules.value(pn(e)),details:e=>e.unit.model.entities.data.details.value(pn(e)),pdbx_mutation:e=>e.unit.model.entities.data.pdbx_mutation.value(pn(e)),pdbx_fragment:e=>e.unit.model.entities.data.pdbx_fragment.value(pn(e)),pdbx_ec:e=>e.unit.model.entities.data.pdbx_ec.value(pn(e)),pdbx_parent_entity_id:e=>e.unit.model.entities.data.pdbx_parent_entity_id.value(pn(e)),subtype:e=>e.unit.model.entities.subtype.value(pn(e)),prd_id:e=>{var t,n;return(n=(t=e.unit.model.entities.prd_id)===null||t===void 0?void 0:t.value(pn(e)))!==null&&n!==void 0?n:""}},KI=[],$I={id:e=>e.unit.id,chainGroupId:e=>e.unit.chainGroupId,multiChain:e=>Ne.Traits.is(e.unit.traits,Ne.Trait.MultiChain),object_primitive:e=>e.unit.objectPrimitive,operator_name:e=>e.unit.conformation.operator.name,operator_key:e=>e.unit.conformation.operator.key,model_index:e=>e.unit.model.modelNum,model_label:e=>e.unit.model.label,model_entry_id:e=>e.unit.model.entryId,hkl:e=>e.unit.conformation.operator.hkl,spgrOp:e=>e.unit.conformation.operator.spgrOp,model_num:e=>e.unit.model.modelNum,pdbx_struct_assembly_id:e=>{var t;return((t=e.unit.conformation.operator.assembly)===null||t===void 0?void 0:t.id)||St.DefaultName},pdbx_struct_oper_list_ids:e=>{var t;return((t=e.unit.conformation.operator.assembly)===null||t===void 0?void 0:t.operList)||KI},struct_ncs_oper_id:e=>e.unit.conformation.operator.ncsId},vt={atom:Ro,residue:HI,chain:jI,entity:VI,unit:$I,coarse:zI};var Vi;(function(e){function t(l,d){return Zt.create("Build Assembly",async f=>{const h=l.models;if(h.length!==1)throw new Error("Can only build assemblies from structures based on 1 model.");const p=yf.findAssembly(h[0],d);if(!p)throw new Error(`Assembly '${d}' is not defined.`);const m=St.create(p.id,Oe.identity(),{assembly:{id:p.id,operId:0,operList:[]}}),y=xt.Builder({coordinateSystem:m,label:l.label,dynamicBonds:l.dynamicBonds}),g=new li(l);for(const b of p.operatorGroups){const v=b.selector(g);if(wt.structureCount(v)===0)continue;const{units:_}=wt.unionStructure(v);for(const A of b.operators)for(const C of _)y.addWithOperator(C,A)}return y.getStructure()})}e.buildAssembly=t;function n(l,d,f){return Zt.create("Build Symmetry Assembly",async h=>{const p=l.models;if(p.length!==1)throw new Error("Can only build symmetry assemblies from structures based on 1 model.");const m=O(),y=xt.Builder({label:l.label,representativeModel:p[0],dynamicBonds:l.dynamicBonds}),g=new li(l);for(const b of d){const _=YI(b.asymIds)(g);if(wt.structureCount(_)===0)continue;const{units:A}=wt.unionStructure(_);for(const{index:C,shift:[I,S,w]}of b.operators){const R=F_(f,C,I,S,w,m);for(const M of A)for(const P of R)y.addWithOperator(M,P)}}return y.getStructure()})}e.buildSymmetryAssembly=n;function r(l,d){return Zt.create("Find Symmetry Mates",f=>QI(f,l,d))}e.builderSymmetryMates=r;function i(l,d,f){return Zt.create("Build Symmetry",h=>XI(h,l,d,f))}e.buildSymmetryRange=i;function o(l){return Zt.create("Build NCS",d=>ZI(d,l))}e.buildNcs=o;function s(l,d){return l.invariantId===d.invariantId&&l.model.id===d.model.id&&ve.areEqual(l.elements,d.elements)}e.areUnitsEquivalent=s;function a(){return yx(Ne.hashUnit,s)}e.UnitEquivalenceBuilder=a;function c(l){const d=a();for(const h of l.units)d.add(h.id,h);const f=[];for(const h of d.groups)f.push(Ne.SymmetryGroup(h.map(p=>l.unitMap.get(p))));return f}e.computeTransformGroups=c;function u(l,d){if(l.length!==d.length)return!1;for(let f=0,h=l.length;f<h;++f){const p=l[f].units,m=d[f].units;if(p.length!==m.length||l[f].hashCode!==d[f].hashCode)return!1;for(let y=0,g=p.length;y<g;y++)if(p[y].conformation!==m[y].conformation)return!1}return!0}e.areTransformGroupsEquivalent=u})(Vi||(Vi={}));function YI(e){return Vr.generators.atoms({chainTest:Vr.pred.and(Vr.pred.eq(t=>vt.unit.operator_name(t.element),St.DefaultName),Vr.pred.inSet(t=>vt.chain.label_asym_id(t.element),e))})}function F_(e,t,n,r,i,o){const{spacegroup:s,ncsOperators:a}=e,c=[],{toFractional:u}=s.cell,l=O.transformMat4(O(),o,u),d=zn.getSymmetryOperatorRef(s,t,n,r,i,l);if(a&&a.length)for(let f=0,h=a.length;f<h;++f){const p=a[f],m=Oe.mul(Oe(),d.matrix,p.matrix),y=St.create(`${d.name} ${p.name}`,m,{assembly:d.assembly,ncsId:p.ncsId,hkl:d.hkl,spgrOp:d.spgrOp});c.push(y)}else c.push(d);return c}function L_(e,t,n,r){const{spacegroup:i,ncsOperators:o}=e,s=o&&o.length||0,a=[];!s&&t[0]<=0&&n[0]>=0&&t[1]<=0&&n[1]>=0&&t[2]<=0&&n[2]>=0&&(a[0]=zn.getSymmetryOperator(i,0,0,0,0));for(let c=0;c<i.operators.length;c++)for(let u=t[0];u<=n[0];u++)for(let l=t[1];l<=n[1];l++)for(let d=t[2];d<=n[2];d++)!s&&c===0&&u===0&&l===0&&d===0||a.push(...F_(e,c,u,l,d,r));return a}function WI(e,t){return e._operators_333&&O.equals(t,e._operators_333.ref)||(e._operators_333={ref:O.clone(t),operators:L_(e,O.create(-3,-3,-3),O.create(3,3,3),t)}),e._operators_333.operators}function G_(e,t){const n=xt.Builder({label:e.label,dynamicBonds:e.dynamicBonds}),{units:r}=e;for(const i of t)for(const o of r)n.addWithOperator(o,i);return n.getStructure()}async function ZI(e,t){const n=t.models;if(n.length!==1)throw new Error("Can only build NCS from structures based on 1 model.");const r=Sn.Provider.get(n[0]);if(!r)return t;const i=r.ncsOperators;return!i||!i.length?t:G_(t,i)}async function XI(e,t,n,r){const i=t.models;if(i.length!==1)throw new Error("Can only build symmetries from structures based on 1 model.");const o=Sn.Provider.get(i[0]);if(!o)return t;const{spacegroup:s}=o;if(ui.isZero(s.cell))return t;const a=$t.getCenter(i[0]),c=L_(o,n,r,a);return G_(t,c)}async function QI(e,t,n){const r=t.models;if(r.length!==1)throw new Error("Can only build symmetries from structures based on 1 model.");const i=Sn.Provider.get(r[0]);if(!i)return t;const{spacegroup:o}=i;if(ui.isZero(o.cell))return t;e.shouldUpdate&&await e.update("Initialing...");const s=$t.getCenter(r[0]),a=WI(i,s),c=t.lookup3d,u=new Set;function l(p,m){return`${p.invariantId}|${m.name}`}const d=xt.Builder({label:t.label,dynamicBonds:t.dynamicBonds}),{units:f}=t,h=O.zero();for(const p of a){for(const m of f){const y=m.lookup3d.boundary.sphere;O.transformMat4(h,y.center,p.matrix);const g=c.findUnitIndices(h[0],h[1],h[2],y.radius+n);for(let b=0,v=g.count;b<v;b++){if(!f[g.indices[b]].lookup3d.check(h[0],h[1],h[2],y.radius+n))continue;const A=l(m,p);u.has(A)||(d.addWithOperator(m,p),u.add(A))}}e.shouldUpdate&&await e.update("Building symmetry...")}return d.getStructure()}vt.chain.label_asym_id,vt.residue.label_seq_id,vt.atom.label_comp_id,vt.atom.label_alt_id,vt.residue.pdbx_PDB_ins_code,vt.unit.operator_name,vt.entity.type;var H_;(function(e){const t=O();function n(s,a,c,u,l,d,f){const{elements:h,conformation:p}=a,m=t;s.element.unit=a;let y=!1;for(let g=0,b=h.length;g<b;g++){const v=h[g];s.element.element=v;const _=Math.max(0,O.distance(c,p.position(v,m))-u-f(s));if(_<l)return 0;_<d&&(y=!0)}return y?1:2}function r(s,a,c,u,l,d,f){const{units:h}=a;let p=!1;for(let m=0,y=h.length;m<y;m++){const g=n(s,h[m],c,u,l,d,f);if(g===0)return 0;g===1&&(p=!0)}return p?1:2}const i=O();function o(s,a,c,u,l,d){if(a.elementCount===0||c.elementCount===0)return 0;const{units:f}=a;let h=!1;s.element.structure=a;for(let p=0,m=f.length;p<m;p++){const y=f[p],{elements:g,conformation:b}=y;s.element.unit=y;for(let v=0,_=g.length;v<_;v++){const A=g[v];s.element.element=A;const C=r(s,c,b.position(A,i),d(s),u,l,d);if(C===0)return!1;C===1&&(h=!0)}}return h}e.check=o})(H_||(H_={}));var j_;(function(e){const t=O();function n(s,a,c,u,l,d){const{elements:f,conformation:h}=a,p=t;s.element.unit=a;for(let m=0,y=f.length;m<y;m++){const g=f[m];if(s.element.element=g,Math.max(0,O.distance(c,h.position(g,p))-u-d(s))<=l)return!0}return!1}function r(s,a,c,u,l,d){const{units:f}=a;for(let h=0,p=f.length;h<p;h++)if(n(s,f[h],c,u,l,d))return!0;return!1}const i=O();function o(s,a,c,u,l){if(a.elementCount===0||c.elementCount===0)return 0;const{units:d}=a;s.element.structure=a;for(let f=0,h=d.length;f<h;f++){const p=d[f];s.element.unit=p;const{elements:m,conformation:y}=p;for(let g=0,b=m.length;g<b;g++){const v=m[g];if(s.element.element=v,r(s,c,y.position(v,i),l(s),u,l))return!0}}return!1}e.check=o})(j_||(j_={}));var mf;(function(e){function t(f){return!!f&&!!f.has}function n(f,h){return p=>f(p)===h}e.eq=n;function r(f,h){return p=>f(p)<h}e.lt=r;function i(f,h){return p=>f(p)<=h}e.lte=i;function o(f,h){return p=>f(p)>h}e.gt=o;function s(f,h){return p=>f(p)>=h}e.gte=s;function a(f){return!0}function c(f){return!1}function u(f,h){if(t(h))return p=>h.has(f(p));{if(h.length===0)return c;const p=new Set;for(let m=0;m<h.length;m++)p.add(h[m]);return m=>p.has(f(m))}}e.inSet=u;function l(...f){switch(f.length){case 0:return a;case 1:return f[0];case 2:{const h=f[0],p=f[1];return m=>h(m)&&p(m)}case 3:{const h=f[0],p=f[1],m=f[2];return y=>h(y)&&p(y)&&m(y)}case 4:{const h=f[0],p=f[1],m=f[2],y=f[3];return g=>h(g)&&p(g)&&m(g)&&y(g)}case 5:{const h=f[0],p=f[1],m=f[2],y=f[3],g=f[4];return b=>h(b)&&p(b)&&m(b)&&y(b)&&g(b)}case 6:{const h=f[0],p=f[1],m=f[2],y=f[3],g=f[4],b=f[5];return v=>h(v)&&p(v)&&m(v)&&y(v)&&g(v)&&b(v)}default:{const h=f.length;return p=>{for(let m=0;m<h;m++)if(!f[m])return!1;return!0}}}}e.and=l;function d(...f){switch(f.length){case 0:return c;case 1:return f[0];case 2:{const h=f[0],p=f[1];return m=>h(m)||p(m)}case 3:{const h=f[0],p=f[1],m=f[2];return y=>h(y)||p(y)||m(y)}case 4:{const h=f[0],p=f[1],m=f[2],y=f[3];return g=>h(g)||p(g)||m(g)||y(g)}case 5:{const h=f[0],p=f[1],m=f[2],y=f[3],g=f[4];return b=>h(b)||p(b)||m(b)||y(b)||g(b)}case 6:{const h=f[0],p=f[1],m=f[2],y=f[3],g=f[4],b=f[5];return v=>h(v)||p(v)||m(v)||y(v)||g(v)||b(v)}default:{const h=f.length;return p=>{for(let m=0;m<h;m++)if(f[m])return!0;return!1}}}}e.or=d})(mf||(mf={}));const Vr={generators:hS,pred:mf};class pf{getFrameAtIndex(t){return this.frames[t]}constructor(t){this.frames=t,this.frameCount=t.length,this.representative=t[0],this.duration=t.length}}function JI(e,t,n){if(!e._rowCount)return[];const r=n6(n),i=[];for(let o=0;o<e._rowCount;o++)i[i.length]=e6(e,t,o,r);return i}function e6(e,t,n,r){const i=e.id.value(n),o=e.details.value(n),s=[],{assembly_id:a,oper_expression:c,asym_id_list:u}=t;for(let l=0,d=t._rowCount;l<d;l++)a.value(l)===i&&(s[s.length]={assemblyId:i,expression:c.value(l),asymIds:u.value(l)});return _f.create(i,o,t6(s,r))}function t6(e,t){return()=>{const n=[];let r=0;for(let i=0;i<e.length;i++){const o=e[i],s=o6(o.expression),a=r6(s),c=i6(t,a,r,o.assemblyId),u=Vr.generators.atoms({chainTest:Vr.pred.and(Vr.pred.eq(l=>vt.unit.operator_name(l.element),St.DefaultName),Vr.pred.inSet(l=>vt.chain.label_asym_id(l.element),o.asymIds))});n[n.length]={selector:u,operators:c,asymIds:o.asymIds},r+=c.length}return n}}function n6(e){const{id:t,matrix:n,vector:r,_schema:i}=e,o=new Map,s=O();for(let a=0,c=e._rowCount;a<c;a++){const u=er.toMat4(Oe(),i.matrix.space,n.value(a));er.toVec3(s,i.vector.space,r.value(a)),Oe.setTranslation(u,s),Oe.setValue(u,3,3,1),o.set(t.value(a),u)}return o}function r6(e){const t=[],n=[];for(let r=0;r<e.length;r++)n[r]="";return z_(e,t,e.length-1,n),t}function z_(e,t,n,r){if(n<0){t[t.length]=r.slice(0);return}const i=e[n],o=i.length;for(let s=0;s<o;s++)r[n]=i[s],z_(e,t,n-1,r)}function i6(e,t,n,r){const i=[];let o=n;for(const s of t){const a=Oe.identity();for(let c=0;c<s.length;c++)Oe.mul(a,a,e.get(s[c]));o++,i[i.length]=St.create(`ASM_${o}`,a,{assembly:{id:r,operId:o,operList:s}})}return i}function o6(e){const t=/\(?([^\(\)]+)\)?]*/g,n=[],r=[];let i;for(;i=t.exec(e);)n[n.length]=i[1];return n.forEach(o=>{const s=[];o.split(",").forEach(a=>{const c=a.indexOf("-");if(c>0){const u=parseInt(a.substring(0,c)),l=parseInt(a.substr(c+1));for(let d=u;d<=l;d++)s[s.length]=d.toString()}else s[s.length]=a.trim()}),r[r.length]=s}),r}var Sn;(function(e){e.Descriptor={name:"model_symmetry"},e.Provider=sr.create(e.Descriptor);function t(r){const i=JI(r.pdbx_struct_assembly,r.pdbx_struct_assembly_gen,r.pdbx_struct_oper_list),o=c6(r.symmetry,r.cell),s=s6(r.atom_sites);return{assemblies:i,spacegroup:o,isNonStandardCrystalFrame:s,ncsOperators:u6(r.struct_ncs_oper)}}e.fromData=t;function n(r,i){const o=ui.create("P 1",r,i),s=zn.create(o);return{assemblies:[],spacegroup:s,isNonStandardCrystalFrame:!1}}e.fromCell=n})(Sn||(Sn={}));function s6(e,t){return e._rowCount===0,!1}function a6(e){const t=e.Int_Tables_number.value(0),n=e["space_group_name_H-M"].value(0);return e.Int_Tables_number.isDefined?e["space_group_name_H-M"].isDefined?n:t:n}function c6(e,t){if(e._rowCount===0||t._rowCount===0)return zn.ZeroP1;const n=t.length_a.value(0),r=t.length_b.value(0),i=t.length_c.value(0);if(n===0||r===0||i===0)return zn.ZeroP1;const o=t.angle_alpha.value(0),s=t.angle_beta.value(0),a=t.angle_gamma.value(0);if(o===0||s===0||a===0)return zn.ZeroP1;const c=a6(e),u=ui.create(c,O.create(n,r,i),O.scale(O(),O.create(o,s,a),Math.PI/180));return zn.create(u)}function u6(e){if(e._rowCount===0)return;const{id:t,matrix:n,vector:r}=e,i=et.struct_ncs_oper.matrix.space,o=et.struct_ncs_oper.vector.space,s=[];for(let a=0;a<e._rowCount;a++){const c=er.toMat3(Mn(),i,n.value(a)),u=er.toVec3(O(),o,r.value(a));if(!St.checkIfRotationAndTranslation(c,u)||e.code.value(a)==="given"&&!Mn.isIdentity(c)&&!O.isZero(u))continue;const l=t.value(a);s[s.length]=St.ofRotationAndOffset(`ncs_${l}`,c,u,l)}return s}class _f{get operatorGroups(){return this._operators?this._operators:(this._operators=this.operatorsProvider(),this._operators)}constructor(t,n,r){this.operatorsProvider=r,this.id=t,this.details=n}}(function(e){function t(n,r,i){return new e(n,r,i)}e.create=t})(_f||(_f={}));var yf;(function(e){e.Default={assemblies:[],spacegroup:zn.ZeroP1,isNonStandardCrystalFrame:!1};function t(r,i){const o=i.toLocaleLowerCase(),s=Sn.Provider.get(r);return s?Sx(s.assemblies,a=>a.id.toLowerCase()===o):void 0}e.findAssembly=t;function n(r){const{cell:i,name:o,num:s}=r.spacegroup,{size:a,anglesInRadians:c}=i,u=a[0].toFixed(2),l=a[1].toFixed(2),d=a[2].toFixed(2),f=Qr(c[0]).toFixed(2),h=Qr(c[1]).toFixed(2),p=Qr(c[2]).toFixed(2),m=[];return m.push(`Unit Cell <b>${o}</b> #${s}`),m.push(`${u}Ã${l}Ã${d} â«`),m.push(`Î±=${f}Â° Î²=${h}Â° Î³=${p}Â°`),m.join(" | ")}e.getUnitcellLabel=n})(yf||(yf={}));var Do;(function(e){let t;(function(u){u.Protein="protein",u.RNA="RNA",u.DNA="DNA",u.Generic="generic"})(t=e.Kind||(e.Kind={}));function n(u){const l=u.code.toArray();return(l instanceof Array?l:Array.from(l)).join("")}e.getSequenceString=n;function r(u){for(let l=0,d=Math.min(u.rowCount,10);l<d;l++){const f=u.value(l)||"";if(Ju(f)!=="X")return t.Protein;if(Jm(f)!=="X")return t.RNA;if(ep(f)!=="X")return t.DNA}return t.Generic}function i(u,l){let d;switch(u){case t.Protein:d=Ju;break;case t.DNA:d=ep;break;case t.RNA:d=Jm;break;case t.Generic:d=()=>"X";break;default:Ri()}return d}function o(u,l){if(l.rowCount===0)throw new Error("cannot be empty");const d=r(u);return new s(d,u,l)}e.ofResidueNames=o;class s{index(l){return this.indexMap.get(l)}constructor(l,d,f){this.kind=l,this.microHet=new Map;const h=i(l),p=[],m=[],y=[],g=new Map;let b=0;const v=new Map;for(let A=0,C=f.rowCount;A<C;++A){const I=f.value(A);if(v.has(I))g.has(I)?g.get(I).push(d.value(A)):g.set(I,[m[v.get(I)],d.value(A)]);else{v.set(I,b);const S=d.value(A);m[b]=S,y[b]=I,p[b]=h(S),b+=1}}const _=[];for(let A=0,C=b;A<C;++A){const I=g.get(y[A]);if(I){const S=I.map(w=>{const R=h(w);return R==="X"?w:R});_[A]=`(${S.join("|")})`}else _[A]=p[A]==="X"?m[A]:p[A]}this.length=b,this.code=Ce.ofStringArray(p),this.compId=Ce.ofStringArray(m),this.seqId=Ce.ofIntArray(y),this.label=Ce.ofStringArray(_),this.microHet=g,this.indexMap=v}}function a(u,l){const d=t.Generic;return new c(d,u,l)}e.ofSequenceRanges=a;class c{index(l){return l-this.minSeqId}constructor(l,d,f){this.kind=l,this.seqIdStart=d,this.seqIdEnd=f,this.microHet=new Map;let h=0,p=Number.MAX_SAFE_INTEGER;for(let y=0,g=this.seqIdStart.rowCount;y<g;y++){const b=this.seqIdStart.value(y),v=this.seqIdEnd.value(y);b<p&&(p=b),h<v&&(h=v)}const m=h-p+1;this.code=Ce.ofConst("X",m,Ce.Schema.str),this.label=Ce.ofConst("",m,Ce.Schema.str),this.seqId=Ce.ofLambda({value:y=>y+p+1,rowCount:m,schema:Ce.Schema.int}),this.compId=Ce.ofConst("",m,Ce.Schema.str),this.length=m,this.minSeqId=p}}})(Do||(Do={}));var gf;(function(e){const t={byEntityKey:{},sequences:[]};function n(...a){const c=[],u={};for(let l=0,d=a.length;l<d;++l)c.push(...a[l].sequences),Object.assign(u,a[l].byEntityKey);return{sequences:c,byEntityKey:u}}function r(a,c,u){const l=i(a,c),d=u.isDefined?o(a,u):t;return n(l,d)}e.fromHierarchy=r;function i(a,c){const{label_comp_id:u}=c.atoms,{label_seq_id:l}=c.residues,{chainAtomSegments:d,residueAtomSegments:f}=c,{count:h,offsets:p}=d,m={},y=[];if(h===1&&p[0]===0&&p[1]===0)return{byEntityKey:m,sequences:y};for(let g=0,b=c.chains._rowCount;g<b;g++){const v=c.index.getEntityFromChain(g);if(m[v]!==void 0||a.data.type.value(v)!=="polymer")continue;const _=g;for(g++;g<b&&v===c.index.getEntityFromChain(g)&&a.data.type.value(v)!=="polymer";)g++;g--;const A=f.index[p[_]],C=f.index[p[g+1]-1]+1,I=Ce.window(l,A,C),S=[];for(let R=A;R<C;++R)S.push(u.value(f.offsets[R]));const w=Ce.ofStringArray(S);m[v]={entityId:a.data.id.value(v),sequence:Do.ofResidueNames(w,I)},y.push(m[v])}return{byEntityKey:m,sequences:y}}e.fromAtomicHierarchy=i;function o(a,c){const u=s(a,c.spheres),l=s(a,c.gaussians);return n(u,l)}e.fromCoarseHierarchy=o;function s(a,c){const{chainElementSegments:u,seq_id_begin:l,seq_id_end:d}=c,{count:f,offsets:h}=u,p={},m=[];if(f===1&&h[0]===0&&h[1]===0)return{byEntityKey:p,sequences:m};for(let y=0,g=f;y<g;y++){const b=c.getEntityFromChain(y);if(p[b]!==void 0)continue;const v=y;for(y++;y<g&&b===c.getEntityFromChain(y);)y++;y--;const _=h[v],A=h[y+1]-1,C=Ce.window(l,_,A),I=Ce.window(d,_,A);p[b]={entityId:a.data.id.value(b),sequence:Do.ofSequenceRanges(C,I)},m.push(p[b])}return{byEntityKey:p,sequences:m}}e.fromCoarseElements=s})(gf||(gf={}));var V_;(function(e){function t(d,f,h){if(!f)return{rowCount:0};if(h&&h[f.id])return h[f.id];const p=f.getElements(d),m={data:p,rowCount:p.elements.length};return h&&(h[f.id]=m),m}e.getCifDataSource=t;function n(d){return new K_(d)}e.fromAtomMap=n;function r(d){return new K_(bf(d))}e.fromAtomArray=r;const i=d=>d.atomicHierarchy.residueAtomSegments;function o(d){return new zs("residue",d,i,0)}e.fromResidueMap=o;function s(d){return new zs("residue",bf(d),i,0)}e.fromResidueArray=s;const a=d=>d.atomicHierarchy.chainAtomSegments;function c(d){return new zs("chain",d,a,0)}e.fromChainMap=c;function u(d){return new zs("chain",bf(d),a,0)}e.fromChainArray=u;function l(d){return new l6(d)}e.fromEntityMap=l})(V_||(V_={}));function bf(e){const t=new Map;for(let n=0,r=e.length;n<r;n++)t.set(n,e[n]);return t}class zs{has(t){return this.map.has(t)}get(t){return this.map.get(t)}getStructureElements(t){const n=t.models;if(n.length!==1)throw new Error("Only works on structures with a single model.");const r=new Set,i=t.unitSymmetryGroups,o=[],s=this.segmentGetter(n[0]);for(const a of i){const c=a.units[0];if(c.kind!==this.kind)continue;const u=mt.transientSegments(s,c.elements);for(;u.hasNext;){const l=u.move();!this.has(l.index)||r.has(l.index)||(r.add(l.index),o[o.length]=Ze.create(t,c,c.elements[l.start]))}}return o.sort((a,c)=>a.element-c.element),o}getElements(t){const n=this.segmentGetter(t.model).index,r=this.getStructureElements(t);return{elements:r,property:i=>this.get(n[r[i].element])}}constructor(t,n,r,i){this.level=t,this.map=n,this.segmentGetter=r,this.id=ln.create22(),this.kind=i}}class K_{has(t){return this.map.has(t)}get(t){return this.map.get(t)}getStructureElements(t){if(t.models.length!==1)throw new Error("Only works on structures with a single model.");const r=new Set,i=t.unitSymmetryGroups,o=[];for(const s of i){const a=s.units[0];if(a.kind!==this.kind)continue;const c=a.elements;for(let u=0,l=c.length;u<l;u++){const d=c[u];!this.has(d)||r.has(d)||(r.add(c[u]),o[o.length]=Ze.create(t,a,d))}}return o.sort((s,a)=>s.element-a.element),o}getElements(t){const n=this.getStructureElements(t);return{elements:n,property:r=>this.get(n[r].element)}}constructor(t){this.map=t,this.id=ln.create22(),this.level="atom",this.kind=0}}class l6{has(t){return this.map.has(t)}get(t){return this.map.get(t)}getStructureElements(t){const n=t.models;if(n.length!==1)throw new Error("Only works on structures with a single model.");const r=n[0].atomicHierarchy.index,i=new Set,o=t.unitSymmetryGroups,s=[],a=n[0].atomicHierarchy.chainAtomSegments;for(const c of o){const u=c.units[0];if(u.kind!==this.kind)continue;const l=mt.transientSegments(a,u.elements);for(;l.hasNext;){const d=l.move(),f=r.getEntityFromChain(d.index);!this.has(f)||i.has(f)||(i.add(f),s[s.length]=Ze.create(t,u,u.elements[d.start]))}}return s.sort((c,u)=>c.element-u.element),s}getElements(t){const n=this.getStructureElements(t),r=t.model.atomicHierarchy.chainAtomSegments.index,i=t.model.atomicHierarchy.index;return{elements:n,property:o=>this.get(i.getEntityFromChain(r[n[o].element]))}}constructor(t){this.map=t,this.id=ln.create22(),this.level="entity",this.kind=0}}var hi;(function(e){function t(i,o,s,a){i.indices[i.count]=s,i.units[i.count]=o,i.squaredDistances[i.count]=a,i.count++}e.add=t;function n(){return{count:0,indices:[],units:[],squaredDistances:[]}}e.create=n;function r(i,o){for(let s=0;s<o.count;++s)i.indices[s]=o.indices[s],i.units[s]=o.units[s],i.squaredDistances[s]=o.squaredDistances[s];return i.count=o.count,i}e.copy=r})(hi||(hi={}));function f6(){return{result:hi.create(),closeUnitsResult:gn.create(),unitGroupResult:gn.create()}}class d6{findUnitIndices(t,n,r,i){return this.unitLookup.find(t,n,r,i)}find(t,n,r,i,o){return this._find(t,n,r,i,o??this.findContext)}_find(t,n,r,i,o){gn.reset(o.result);const{units:s}=this.structure,a=this.unitLookup.find(t,n,r,i,o.closeUnitsResult);if(a.count===0)return o.result;for(let c=0,u=a.count;c<u;c++){const l=s[a.indices[c]];O.set(this.pivot,t,n,r),l.conformation.operator.isIdentity||O.transformMat4(this.pivot,this.pivot,l.conformation.operator.inverse);const f=l.lookup3d.find(this.pivot[0],this.pivot[1],this.pivot[2],i,o.unitGroupResult);for(let h=0,p=f.count;h<p;h++)hi.add(o.result,l,f.indices[h],f.squaredDistances[h])}return o.result}nearest(t,n,r,i=1,o){return this._nearest(t,n,r,i,o??this.findContext)}_nearest(t,n,r,i,o){const s=o.result,a=this.heap;gn.reset(s),a.clear();const{units:c}=this.structure;let u=0;const l=this.unitLookup.nearest(t,n,r,c.length,h=>(u+=c[h].elements.length)>=i,o.closeUnitsResult);if(l.count===0)return s;let d=0,f=-Number.MAX_VALUE;for(let h=0,p=l.count;h<p;h++){const m=l.squaredDistances[h];if(d>=i&&f<m)break;O.set(this.pivot,t,n,r);const y=c[l.indices[h]];y.conformation.operator.isIdentity||O.transformMat4(this.pivot,this.pivot,y.conformation.operator.inverse);const b=y.lookup3d.nearest(this.pivot[0],this.pivot[1],this.pivot[2],i,void 0,o.unitGroupResult);if(b.count!==0){d+=b.count,f=Math.max(f,b.squaredDistances[b.count-1]);for(let v=0,_=b.count;v<_;v++)a.insert(b.squaredDistances[v],{index:b.indices[v],unit:y})}}if(i===1){const h=a.findMinimum();if(h){const{key:p}=h,{unit:m,index:y}=h.value;hi.add(s,m,y,p)}}else for(;!a.isEmpty()&&s.count<i;){const h=a.extractMinimum(),{key:p}=h,{unit:m,index:y}=h.value;hi.add(s,m,y,p)}return s}findIntoBuilder(t,n,r,i,o){const{units:s}=this.structure,a=this.unitLookup.find(t,n,r,i);if(a.count!==0)for(let c=0,u=a.count;c<u;c++){const l=s[a.indices[c]];O.set(this.pivot,t,n,r),l.conformation.operator.isIdentity||O.transformMat4(this.pivot,this.pivot,l.conformation.operator.inverse);const f=l.lookup3d.find(this.pivot[0],this.pivot[1],this.pivot[2],i);if(f.count===0)continue;const h=l.elements;o.beginUnit(l.id);for(let p=0,m=f.count;p<m;p++)o.addElement(h[f.indices[p]]);o.commitUnit()}}findIntoBuilderIf(t,n,r,i,o,s){const{units:a}=this.structure,c=this.unitLookup.find(t,n,r,i);if(c.count===0)return;const u=Ze.create(this.structure);for(let l=0,d=c.count;l<d;l++){const f=a[c.indices[l]];O.set(this.pivot,t,n,r),f.conformation.operator.isIdentity||O.transformMat4(this.pivot,this.pivot,f.conformation.operator.inverse);const p=f.lookup3d.find(this.pivot[0],this.pivot[1],this.pivot[2],i);if(p.count===0)continue;const m=f.elements;u.unit=f,o.beginUnit(f.id);for(let y=0,g=p.count;y<g;y++)u.element=m[p.indices[y]],s(u)&&o.addElement(u.element);o.commitUnit()}}findIntoBuilderWithRadius(t,n,r,i,o,s,a,c){const{units:u}=this.structure,l=this.unitLookup.find(t,n,r,s);if(l.count===0)return;const d=Ze.create(this.structure),f=i+o+s;for(let h=0,p=l.count;h<p;h++){const m=u[l.indices[h]];O.set(this.pivot,t,n,r),m.conformation.operator.isIdentity||O.transformMat4(this.pivot,this.pivot,m.conformation.operator.inverse);const g=m.lookup3d.find(this.pivot[0],this.pivot[1],this.pivot[2],f);if(g.count===0)continue;const b=m.elements;d.unit=m,c.beginUnit(m.id);for(let v=0,_=g.count;v<_;v++){d.element=b[g.indices[v]];const A=a(d);Math.sqrt(g.squaredDistances[v])-i-A>s||c.addElement(b[g.indices[v]])}c.commitUnit()}}check(t,n,r,i){const{units:o}=this.structure,s=this.unitLookup.find(t,n,r,i);if(s.count===0)return!1;for(let a=0,c=s.count;a<c;a++){const u=o[s.indices[a]];if(O.set(this.pivot,t,n,r),u.conformation.operator.isIdentity||O.transformMat4(this.pivot,this.pivot,u.conformation.operator.inverse),u.lookup3d.check(this.pivot[0],this.pivot[1],this.pivot[2],i))return!0}return!1}approxNearest(t,n,r,i,o){return this._approxNearest(t,n,r,i,o??this.findContext)}_approxNearest(t,n,r,i,o){gn.reset(o.result);const{units:s}=this.structure,a=this.unitLookup.find(t,n,r,i,o.closeUnitsResult);if(a.count===0)return o.result;let c=Number.MAX_VALUE;for(let u=0,l=a.count;u<l;u++){const d=s[a.indices[u]];O.set(this.pivot,t,n,r),d.conformation.operator.isIdentity||O.transformMat4(this.pivot,this.pivot,d.conformation.operator.inverse);const h=d.lookup3d.approxNearest(this.pivot[0],this.pivot[1],this.pivot[2],i,o.unitGroupResult);for(let p=0,m=h.count;p<m;p++)h.squaredDistances[p]<c&&(hi.add(o.result,d,h.indices[p],h.squaredDistances[p]),c=h.squaredDistances[p])}return o.result}get boundary(){return this.structure.boundary}constructor(t){this.structure=t,this.pivot=O(),this.heap=new s2,this.findContext=f6();const{units:n,boundary:r}=t,i=n.length,o=new Float32Array(i),s=new Float32Array(i),a=new Float32Array(i),c=new Float32Array(i),u=O();for(let d=0;d<i;d++){const f=n[d],h=f.boundary.sphere;O.transformMat4(u,h.center,f.conformation.operator.matrix),o[d]=u[0],s[d]=u[1],a[d]=u[2],c[d]=h.radius}const l={x:o,y:s,z:a,radius:c,indices:Re.ofBounds(0,i)};this.unitLookup=ws(l,r)}}class h6{addToUnit(t,n){const r=this.unitMap.get(t);r?r[r.length]=n:(this.unitMap.set(t,[n]),this.ids[this.ids.length]=t),this.elementCount++}beginUnit(t){this.parentId=t,this.currentUnit=this.currentUnit.length>0?[]:this.currentUnit}addElement(t){this.currentUnit[this.currentUnit.length]=t,this.elementCount++}addElementRange(t,n,r){for(let i=n;i<r;i++)this.currentUnit[this.currentUnit.length]=t[i],this.elementCount++}commitUnit(){this.currentUnit.length!==0&&(this.ids[this.ids.length]=this.parentId,this.unitMap.set(this.parentId,this.currentUnit),this.parentId=-1)}setUnit(t,n){this.ids[this.ids.length]=t,this.unitMap.set(t,n),this.elementCount+=n.length}_getStructure(t){if(this.isEmpty)return xt.Empty;const n=[];mr(this.ids);const r=Vi.UnitEquivalenceBuilder();for(let i=0,o=this.ids.length;i<o;i++){const s=this.ids[i],a=this.parent.unitMap.get(s);let c=this.unitMap.get(s),u=!1;t&&(this.isSorted||mr(c),c=ve.deduplicate(ve.ofSortedArray(this.currentUnit)),u=!0);const l=c.length;if(c.length===a.elements.length){n[n.length]=a,r.add(a.id,a);continue}!this.isSorted&&!u&&l>1&&mr(c);let d=a.getChild(ve.ofSortedArray(c));const f=r.add(d.id,d);d!==f&&(d=f.applyOperator(d.id,d.conformation.operator,!0)),n[n.length]=d}return xt.create(n,{parent:this.parent})}getStructure(){return this._getStructure(!1)}getStructureDeduplicate(){return this._getStructure(!0)}setSingletonLocation(t){const n=this.ids[0];t.unit=this.parent.unitMap.get(n),t.element=this.unitMap.get(n)[0]}get isEmpty(){return this.elementCount===0}constructor(t,n){this.parent=t,this.isSorted=n,this.ids=[],this.unitMap=ci.Mutable(),this.parentId=-1,this.currentUnit=[],this.elementCount=0}}function $_(e,t){let n=1;for(;t--;)n*=e--;return n}function m6(e,t){return t>e?0:$_(e,t)/$_(t,t)}function p6(e){const t=e&-e,n=e+t,i=((n&-n)/t>>1)-1;return n|i}class _6{move(){if(this.hasNext){let t=0,n=0,r=this.index;for(;r;r>>>=1,t++)r&1&&(this.value[n++]=this.array[t]);this.index=p6(this.index),this.hasNext=this.index<this.maxIndex}return this.value}constructor(t,n){this.array=t,this.hasNext=!1,this.index=(1<<n)-1,this.size=m6(t.length,n),this.maxIndex=1<<t.length,this.value=new Array(n),this.hasNext=n>0&&n<=t.length}}function Y_(e,t){const n=[],r=new _6(e,t);for(;r.hasNext;)n.push(r.move().slice());return n}const mi=[],y6={links:mi,terminalLinks:mi,elements:mi,partialElements:mi,getElementIndices:()=>mi,getLinkIndices:()=>mi,getTerminalLinkIndices:()=>mi},rn=Co("C"),No=Co("O"),g6=[Wn.elementFingerprint([rn,rn,rn,No]),Wn.elementFingerprint([rn,rn,rn,rn,No]),Wn.elementFingerprint([rn,rn,rn,rn,rn,No]),Wn.elementFingerprint([rn,rn,rn,rn,rn,rn,No])];function b6(e,t){let n=-1,r=-1,i=-1,o=-1;const{elements:s}=e,{type_symbol:a,label_atom_id:c}=e.model.atomicHierarchy.atoms,{b:u,offset:l}=e.bonds;for(let d=0,f=t.length;d<f;++d){const h=s[t[d]];if(a.value(h)!==rn)continue;let p=0,m=0;for(let y=l[t[d]],g=l[t[d]+1];y<g;++y){const b=s[u[y]],v=a.value(b);v===No?++p:v===rn&&++m}if(p===2){n=h;break}else p===1&&m===1?r=h:c.value(h).startsWith("C1")?i=h:o=h}return n!==-1?n:r!==-1?r:i!==-1?i:o!==-1?o:s[t[0]]}function v6(e,t){const{elements:n}=e,{label_alt_id:r}=e.model.atomicHierarchy.atoms;return r.value(n[t])}function x6(e,t,n,r){const i=t.conformation;return O.normalize(e,O.sub(e,r,i.position(n,e))),e}function W_(e,t){const{elements:n}=e,{label_atom_id:r}=e.model.atomicHierarchy.atoms;return r.value(n[t])}function A6(e,t){if(!t||!t.length)return;const{unit:n,all:r}=e,i=new Set,o=Y_(kp(new Array(t.length)),2);for(let s=0,a=o.length;s<a;++s){const c=o[s],u=r[t[c[0]]],l=r[t[c[1]]];ve.areIntersecting(u,l)&&Wn.getAltId(n,u)===Wn.getAltId(n,l)&&(i.add(t[c[0]]),i.add(t[c[1]]))}if(i.size){const s=[];for(let a=0,c=t.length;a<c;++a)i.has(t[a])||s.push(t[a]);return s}else return t}function S6(e,t){return t.properties.saccharideComponentMap.get(e)}function C6(e){if(e.models.reduce((f,h)=>f+h.properties.saccharideComponentMap.size,0)===0)return y6;const t=[],n=[],r=[],i=[],o=new Map;function s(f,h,p){return`${f}|${h}|${p}`}function a(f,h){o.has(f)?o.get(f).push(h):o.set(f,[h])}function c(f,h){O.sub(r[f].geometry.direction,r[h].geometry.center,r[f].geometry.center),O.normalize(r[f].geometry.direction,r[f].geometry.direction)}const u=O();function l(f,h,p){const m=p.conformation,y=r[f].geometry;O.sub(y.direction,m.position(p.elements[h],u),y.center),O.normalize(y.direction,y.direction)}for(let f=0,h=e.units.length;f<h;++f){const p=e.units[f];if(!Ne.isAtomic(p))continue;const{model:m,rings:y}=p,{chainAtomSegments:g,residueAtomSegments:b,atoms:v}=m.atomicHierarchy,{label_comp_id:_}=v,A=mt.transientSegments(g,p.elements),C=mt.transientSegments(b,p.elements);let I;for(;A.hasNext;)for(C.setSegment(A.move());C.hasNext;){const{index:S}=C.move(),w=S6(_.value(b.offsets[S]),m);if(!w)continue;I||(I=qs.byFingerprintAndResidue(y,g6));const R=A6(y,I.get(S));if(!R||!R.length){i.push({unit:p,residueIndex:S,component:w});continue}const M=[];for(let E=0,N=R.length;E<N;++E){const q=y.all[R[E]],j=b6(p,q),z=xr.calculateMomentsAxes(m_(p,q)),W=xr.calculateNormalizedAxes(z),se=O.copy(O(),W.origin),ue=O.copy(O(),W.dirC),$=x6(O(),p,j,se);O.orthogonalize($,ue,$);const ne=Wn.getAltId(p,q),de=r.length;M.push(de),a(s(S,p.id,ne),de),ne&&a(s(S,p.id,""),de),r.push({geometry:{center:se,normal:ue,direction:$},component:w,ringIndex:R[E],altId:ne,unit:p,residueIndex:S})}const P=Y_(kp(new Array(R.length)),2);for(let E=0,N=P.length;E<N;++E){const q=P[E],j=y.all[R[q[0]]],z=y.all[R[q[1]]];if(or.areVertexSetsConnected(p.bonds,j,z,3)){const W=M[q[0]],se=M[q[1]];r[W].altId===r[se].altId&&(c(W,se),c(se,W),t.push({carbohydrateIndexA:W,carbohydrateIndexB:se}),t.push({carbohydrateIndexA:se,carbohydrateIndexB:W}))}}}}function d(f,h){return o.get(s(f.getResidueIndex(h),f.id,v6(f,h)))||[]}for(let f=0,h=r.length;f<h;++f){const p=r[f],{unit:m}=p;for(let y=f+1;y<h;++y){const g=r[y];if(m!==g.unit||p.residueIndex===g.residueIndex)continue;const b=m.rings.all[p.ringIndex],v=m.rings.all[g.ringIndex];or.areVertexSetsConnected(m.bonds,b,v,3)&&(c(f,y),c(y,f),t.push({carbohydrateIndexA:f,carbohydrateIndexB:y}),t.push({carbohydrateIndexA:y,carbohydrateIndexB:f}))}}for(let f=0,h=e.units.length;f<h;++f){const p=e.units[f];Ne.isAtomic(p)&&e.interUnitBonds.getConnectedUnits(p.id).forEach(m=>{m.connectedIndices.forEach(y=>{m.getEdges(y).forEach(({props:g,indexB:b})=>{if(!$n.isCovalent(g.flag))return;const v=e.unitMap.get(m.unitA),_=e.unitMap.get(m.unitB),A=d(v,y),C=d(_,b);if(A.length>0&&C.length>0){const I=A.length,S=C.length;for(let w=0,R=Math.max(I,S);w<R;++w){const M=A[Math.min(w,I-1)],P=C[Math.min(w,S-1)],E=W_(v,y);(E.startsWith("O1")||E.startsWith("C1"))&&c(M,P),t.push({carbohydrateIndexA:M,carbohydrateIndexB:P})}}else if(C.length===0)for(const I of A){const S=W_(v,y);(S.startsWith("O1")||S.startsWith("C1"))&&l(I,b,_),n.push({carbohydrateIndex:I,elementIndex:b,elementUnit:_,fromCarbohydrate:!0})}else if(A.length===0)for(const I of C)n.push({carbohydrateIndex:I,elementIndex:y,elementUnit:v,fromCarbohydrate:!1})})})})}return{links:t,terminalLinks:n,elements:r,partialElements:i,...I6(r,t,n)}}function I6(e,t,n){function r(d,f){return Hn(d.id,f)}function i(d,f,h){const p=[],m=d.get(r(f,h));if(m!==void 0)for(const y of m)qp(p,y);return p}const o=new Map;for(let d=0,f=e.length;d<f;++d){const{unit:h,ringIndex:p}=e[d],m=h.rings.all[p];for(let y=0,g=m.length;y<g;++y){const b=r(h,h.elements[m[y]]),v=o.get(b);v===void 0?o.set(b,[d]):v.push(d)}}function s(d,f){return i(o,d,f)}const a=new Map;for(let d=0,f=t.length;d<f;++d){const h=t[d],{unit:p,ringIndex:m}=e[h.carbohydrateIndexA],y=p.rings.all[m];for(let g=0,b=y.length;g<b;++g){const v=r(p,p.elements[y[g]]),_=a.get(v);_===void 0?a.set(v,[d]):_.push(d)}}function c(d,f){return i(a,d,f)}const u=new Map;for(let d=0,f=n.length;d<f;++d){const{fromCarbohydrate:h,carbohydrateIndex:p,elementUnit:m,elementIndex:y}=n[d];if(h){const{unit:g,ringIndex:b}=e[p],v=g.rings.all[b];for(let _=0,A=v.length;_<A;++_){const C=r(g,g.elements[v[_]]),I=u.get(C);I===void 0?u.set(C,[d]):I.push(d)}}else{const g=r(m,m.elements[y]),b=u.get(g);b===void 0?u.set(g,[d]):b.push(d)}}function l(d,f){return i(u,d,f)}return{getElementIndices:s,getLinkIndices:c,getTerminalLinkIndices:l}}const Vs=hn(),w6=new Eo("14"),P6=new Eo("98");function E6(e){return e>500?w6:P6}function B6(e){const{units:t}=e,n=E6(t.length);n.reset();for(let r=0,i=t.length;r<i;r++){const o=t[r],s=o.boundary,a=o.conformation.operator;a.isIdentity?n.includeSphere(s.sphere):(hn.transform(Vs,s.sphere,a.matrix),n.includeSphere(Vs))}n.finishedIncludeStep();for(let r=0,i=t.length;r<i;r++){const o=t[r],s=o.boundary,a=o.conformation.operator;a.isIdentity?n.radiusSphere(s.sphere):(hn.transform(Vs,s.sphere,a.matrix),n.radiusSphere(Vs))}return{box:n.getBox(),sphere:n.getSphere()}}function R6(e){const{units:t,elementCount:n,unitIndexMap:r}=e,i=new Uint32Array(t.length),o=new Uint32Array(n),s=new Uint32Array(n);for(let a=0,c=0,u=t.length;a<u;++a){i[a]=c;const{elements:l}=t[a];for(let d=0,f=l.length;d<f;++d){const h=c+d;o[h]=a,s[h]=l[d]}c+=l.length}return{cumulativeUnitElementCount:i,unitIndices:o,elementIndices:s,getSerialIndex:(a,c)=>i[r.get(a.id)]+Re.indexOf(a.elements,c)}}function D6(e){let t=0;const n=[];for(const c of e.unitSymmetryGroups){n.push(t);const u=c.units[0];Ne.isAtomic(u)&&(t+=u.bonds.edgeCount*2*c.units.length)}const r=new Uint32Array(t),i=new Uint32Array(t),o=new Uint32Array(t);let s=0,a=0;for(const c of e.unitSymmetryGroups){const u=c.units[0];if(Ne.isAtomic(u)){const l=u.bonds.edgeCount*2;for(let d=0,f=c.units.length;d<f;++d)for(let h=0,p=l;h<p;++h)r[s]=a,i[s]=h,o[s]=d,s+=1}a+=1}return{bondCount:t,unitIndex:r,unitEdgeIndex:i,unitGroupIndex:o,unitGroupOffset:n}}class xt{subsetBuilder(t){return new h6(this,t)}get elementCount(){return this.state.elementCount}get bondCount(){return this.state.bondCount===-1&&(this.state.bondCount=this.interUnitBonds.edgeCount/2+sf.getIntraUnitBondCount(this)),this.state.bondCount}get hasCustomProperties(){return!!this.state.customProps&&this.state.customProps.all.length>0}get customPropertyDescriptors(){return this.state.customProps||(this.state.customProps=new xs),this.state.customProps}get currentPropertyData(){return this.state.propertyData||(this.state.propertyData=Object.create(null)),this.state.propertyData}get inheritedPropertyData(){return this.parent?this.parent.currentPropertyData:this.currentPropertyData}get polymerResidueCount(){return this.state.polymerResidueCount===-1&&(this.state.polymerResidueCount=F6(this)),this.state.polymerResidueCount}get polymerGapCount(){return this.state.polymerGapCount===-1&&(this.state.polymerGapCount=L6(this)),this.state.polymerGapCount}get polymerUnitCount(){return this.state.polymerUnitCount===-1&&(this.state.polymerUnitCount=G6(this)),this.state.polymerUnitCount}get uniqueElementCount(){return this.state.uniqueElementCount===-1&&(this.state.uniqueElementCount=U6(this)),this.state.uniqueElementCount}get atomicResidueCount(){return this.state.atomicResidueCount===-1&&(this.state.atomicResidueCount=H6(this)),this.state.atomicResidueCount}get isCoarseGrained(){return this.models.some(t=>$t.isCoarseGrained(t))}get isEmpty(){return this.units.length===0}get hashCode(){return this.state.hashCode!==-1?this.state.hashCode:this.computeHash()}get transformHash(){return this.state.transformHash!==-1?this.state.transformHash:(this.state.transformHash=Oi(this.units.map(t=>t.id)),this.state.transformHash)}computeHash(){let t=23;for(let n=0,r=this.units.length;n<r;n++){const i=this.units[n];t=31*t+i.id|0,t=31*t+ve.hashCode(i.elements)|0}return t=31*t+this.elementCount|0,t=gx(t),t===-1&&(t=0),this.state.hashCode=t,t}elementLocations(){return new xt.ElementLocationIterator(this)}get root(){var t;return(t=this.state.parent)!==null&&t!==void 0?t:this}get parent(){return this.state.parent}get coordinateSystem(){return this.state.coordinateSystem}get label(){return this.state.label}get boundary(){return this.state.boundary?this.state.boundary:(this.state.boundary=B6(this),this.state.boundary)}get lookup3d(){return this.state.lookup3d?this.state.lookup3d:(this.state.lookup3d=new d6(this),this.state.lookup3d)}get interUnitBonds(){return this.state.interUnitBonds?this.state.interUnitBonds:(this.parent&&this.state.dynamicBonds===this.parent.state.dynamicBonds&&this.parent.state.interUnitBonds&&this.parent.state.interUnitBonds.edgeCount===0?this.state.interUnitBonds=new ji(new Map):this.state.interUnitBonds=dC(this,{ignoreWater:!this.dynamicBonds,ignoreIon:!this.dynamicBonds,validUnit:this.state.interBondsValidUnit,validUnitPair:this.state.interBondsValidUnitPair}),this.state.interUnitBonds)}get dynamicBonds(){return this.state.dynamicBonds}get interBondsValidUnit(){return this.state.interBondsValidUnit}get interBondsValidUnitPair(){return this.state.interBondsValidUnitPair}get unitSymmetryGroups(){return this.state.unitSymmetryGroups?this.state.unitSymmetryGroups:(this.state.unitSymmetryGroups=Vi.computeTransformGroups(this),this.state.unitSymmetryGroups)}get unitSymmetryGroupsIndexMap(){return this.state.unitSymmetryGroupsIndexMap?this.state.unitSymmetryGroupsIndexMap:(this.state.unitSymmetryGroupsIndexMap=Ne.SymmetryGroup.getUnitSymmetryGroupsIndexMap(this.unitSymmetryGroups),this.state.unitSymmetryGroupsIndexMap)}get carbohydrates(){return this.state.carbohydrates?this.state.carbohydrates:(this.state.carbohydrates=C6(this),this.state.carbohydrates)}get models(){return this.state.models?this.state.models:(this.state.models=M6(this),this.state.models)}get uniqueResidueNames(){return this.state.uniqueResidueNames||(this.state.uniqueResidueNames=T6(this))}get uniqueElementSymbols(){return this.state.uniqueElementSymbols||(this.state.uniqueElementSymbols=O6(this))}get entityIndices(){return this.state.entityIndices||(this.state.entityIndices=k6(this))}get uniqueAtomicResidueIndices(){return this.state.uniqueAtomicResidueIndices||(this.state.uniqueAtomicResidueIndices=q6(this))}get isAtomic(){for(const t of this.units)if(!Ne.isAtomic(t))return!1;return!0}get hasAtomic(){for(const t of this.units)if(Ne.isAtomic(t))return!0;return!1}get isCoarse(){for(const t of this.units)if(!Ne.isCoarse(t))return!1;return!0}get hasCoarse(){for(const t of this.units)if(Ne.isCoarse(t))return!0;return!1}get serialMapping(){return this.state.serialMapping||(this.state.serialMapping=R6(this))}get intraUnitBondMapping(){return this.state.intraUnitBondMapping||(this.state.intraUnitBondMapping=D6(this))}get model(){if(this.state.model)return this.state.model;if(this.state.representativeModel)return this.state.representativeModel;if(this.state.masterModel)return this.state.masterModel;const t=this.models;if(t.length>1)throw new Error("The structure is based on multiple models and has neither a master- nor a representative-model.");return this.state.model=t[0],this.state.model}get masterModel(){return this.state.masterModel}get representativeModel(){return this.state.representativeModel}hasElement(t){return this.unitMap.has(t.unit.id)?ve.has(this.unitMap.get(t.unit.id).elements,t.element):!1}getModelIndex(t){return this.models.indexOf(t)}remapModel(t){const{dynamicBonds:n,interUnitBonds:r,parent:i}=this.state,o=[];for(const s of this.unitSymmetryGroups){const a=s.units[0].remapModel(t,n);o.push(a);for(let c=1,u=s.units.length;c<u;++c){const l=s.units[c];o.push(l.remapModel(t,n,a.props))}}return xt.create(o,{parent:i==null?void 0:i.remapModel(t),label:this.label,interUnitBonds:n?void 0:r,dynamicBonds:n,interBondsValidUnit:this.state.interBondsValidUnit,interBondsValidUnitPair:this.state.interBondsValidUnitPair,coordinateSystem:this.state.coordinateSystem,masterModel:this.state.masterModel,representativeModel:this.state.representativeModel})}asParent(){if(this._proxy)return this._proxy;if(this.parent){const t=this.parent.coordinateSystem.isIdentity?this.parent:xt.transform(this.parent,this.parent.coordinateSystem.inverse),n=this.coordinateSystem.isIdentity?t:xt.transform(t,this.coordinateSystem.matrix);this._proxy=new xt(n.units,n.unitMap,n.unitIndexMap,{...n.state,dynamicBonds:this.dynamicBonds},{child:this,target:this.parent})}else this._proxy=this;return this._proxy}get child(){return this._child}get target(){var t;return(t=this._target)!==null&&t!==void 0?t:this}constructor(t,n,r,i,o){this.units=t,this.unitMap=n,this.unitIndexMap=r,this.state=i,this._child=o==null?void 0:o.child,this._target=o==null?void 0:o.target,this._proxy=void 0}}function N6(e,t,n){return e[t].id-e[n].id}function M6(e){const{units:t}=e,n=mn.create();for(const r of t)mn.add(n,r.model.id,r.model);return n.array}function T6(e){const{microheterogeneityCompIds:t}=vt.residue,n=new Set,r=Ze.create(e);for(const i of e.unitSymmetryGroups){const o=i.units[0];if(!Ne.isAtomic(o))continue;const s=mt.transientSegments(o.model.atomicHierarchy.residueAtomSegments,o.elements);for(r.unit=o;s.hasNext;){const a=s.move();r.element=o.elements[a.start];const c=t(r);for(const u of c)n.add(u)}}return n}function O6(e){const t=vt.atom.type_symbol,n=new Set,r=Ze.create(e);for(const i of e.unitSymmetryGroups){const o=i.units[0];if(Ne.isAtomic(o)){r.unit=o;for(let s=0,a=o.elements.length;s<a;++s)r.element=o.elements[s],n.add(t(r))}}return n}function k6(e){const{units:t}=e,n=Ze.create(e),r=mn.create();for(const i of t){const o=i.kind===0?vt.entity.key:vt.coarse.entityKey;n.unit=i;const s=i.elements,a=mt.transientSegments(i.model.atomicHierarchy.chainAtomSegments,s);for(;a.hasNext;){const c=a.move();n.element=s[c.start];const u=o(n);mn.add(r,u,u)}}return mr(r.array),r.array}function q6(e){const t=new Map,n=[],r=e.unitSymmetryGroups;for(const o of r){const s=o.units[0];if(!Ne.isAtomic(s))continue;let a;t.has(s.model.id)?a=t.get(s.model.id):(a=mn.create(),n.push(s.model.id),t.set(s.model.id,a));const c=mt.transientSegments(s.model.atomicHierarchy.residueAtomSegments,s.elements);for(;c.hasNext;){const u=c.move();mn.add(a,u.index,u.index)}}const i=new Map;for(const o of n){const s=t.get(o).array;mr(s),i.set(o,s)}return i}function U6(e){const{unitSymmetryGroups:t}=e;let n=0;for(let r=0,i=t.length;r<i;r++)n+=t[r].elements.length;return n}function F6(e){const{units:t}=e;let n=0;for(let r=0,i=t.length;r<i;r++)n+=t[r].polymerElements.length;return n}function L6(e){const{units:t}=e;let n=0;for(let r=0,i=t.length;r<i;r++)n+=t[r].gapElements.length/2;return n}function G6(e){const{units:t}=e;let n=0;for(let r=0,i=t.length;r<i;r++)t[r].polymerElements.length>0&&(n+=1);return n}function H6(e){const{units:t}=e;let n=0;for(let r=0,i=t.length;r<i;r++){const o=t[r];if(!Ne.isAtomic(o))continue;const{elements:s,residueIndex:a}=o;let c=-1,u=-1;for(let l=0,d=s.length;l<d;++l)c=a[s[l]],c!==u&&(n+=1,u=c)}return n}(function(e){e.Empty=c([]);function t(X){return{kind:"structure-loci",structure:X}}e.Loci=t;function n(X){const ce=[];for(const k of X.units)ce.push({unit:k,indices:pe.ofBounds(0,k.elements.length)});return Cn(X,ce)}e.toStructureElementLoci=n;function r(X,ce){return wt.toLociWithSourceUnits(wt.Singletons(X,ce))}e.toSubStructureElementLoci=r;function i(X){return!!X&&X.kind==="structure-loci"}e.isLoci=i;function o(X,ce){return X.structure===ce.structure}e.areLociEqual=o;function s(X){return X.structure.isEmpty}e.isLociEmpty=s;function a(X,ce){return ce===X.structure?X:t(ce)}e.remapLoci=a;function c(X,ce={}){const k=ci.Mutable(),B=ci.Mutable();let F=0,re=!0,G=X.length>0?X[0].id:0;for(let K=0,Q=X.length;K<Q;K++){const Z=X[K];k.set(Z.id,Z),F+=Z.elements.length,Z.id<G&&(re=!1),G=Z.id}re||op(X,0,X.length,N6,ei);for(let K=0,Q=X.length;K<Q;K++)B.set(X[K].id,K);const V={hashCode:-1,transformHash:-1,elementCount:F,bondCount:-1,uniqueElementCount:-1,atomicResidueCount:-1,polymerResidueCount:-1,polymerGapCount:-1,polymerUnitCount:-1,dynamicBonds:!1,coordinateSystem:St.Default,label:""};return ce.parent&&(V.parent=ce.parent.parent||ce.parent),ce.interUnitBonds&&(V.interUnitBonds=ce.interUnitBonds),ce.interBondsValidUnit?V.interBondsValidUnit=ce.interBondsValidUnit:ce.parent&&(V.interBondsValidUnit=ce.parent.interBondsValidUnit),ce.interBondsValidUnitPair?V.interBondsValidUnitPair=ce.interBondsValidUnitPair:ce.parent&&(V.interBondsValidUnitPair=ce.parent.interBondsValidUnitPair),ce.dynamicBonds?V.dynamicBonds=ce.dynamicBonds:ce.parent&&(V.dynamicBonds=ce.parent.dynamicBonds),ce.coordinateSystem?V.coordinateSystem=ce.coordinateSystem:ce.parent&&(V.coordinateSystem=ce.parent.coordinateSystem),ce.label?V.label=ce.label:ce.parent&&(V.label=ce.parent.label),ce.masterModel?V.masterModel=ce.masterModel:ce.parent&&(V.masterModel=ce.parent.masterModel),ce.representativeModel?V.representativeModel=ce.representativeModel:ce.parent&&(V.representativeModel=ce.parent.representativeModel),new e(X,k,B,V)}e.create=c;async function u(X,ce){if(X.frameCount===0)return e.Empty;const k=[];let B,F=0;for(let re=0,G=X.frameCount;re<G;++re){const V=await Zt.resolveInContext(X.getFrameAtIndex(re),ce);B||(B=V);const K=l(V);for(let Q=0,Z=K.units.length;Q<Z;++Q){const ie=K.units[Q],L=ie.invariantId+F,U=ie.chainGroupId+F,Y=Ne.create(k.length,L,U,ie.traits,ie.kind,ie.model,ie.conformation.operator,ie.elements);k.push(Y)}F=k.length}return c(k,{representativeModel:B,label:B.label})}e.ofTrajectory=u;function l(X,ce={}){const k=X.atomicHierarchy.chainAtomSegments,{index:B}=X.atomicHierarchy,{auth_asym_id:F}=X.atomicHierarchy.chains,{atomicChainOperatorMappinng:re}=X,G=new p({label:X.label,...ce});for(let K=0;K<k.count;K++){const Q=re.get(K)||St.Default,Z=k.offsets[K];let ie=!1,L=!1;if(d(X,K))for(L=!0;K+1<k.count&&d(X,K+1);){const fe=re.get(K),me=re.get(K+1);if(fe!==me)break;ie=!0,K++}else for(;K+1<k.count&&k.offsets[K+1]-k.offsets[K]===1&&k.offsets[K+2]-k.offsets[K+1]===1;){const fe=B.getEntityFromChain(K),me=B.getEntityFromChain(K+1);if(fe!==me)break;const Te=F.value(K),x=F.value(K+1);if(Te!==x)break;const D=re.get(K),J=re.get(K+1);if(D!==J)break;ie=!0,K++}const U=ve.ofBounds(Z,k.offsets[K+1]);let Y=Ne.Trait.None;ie&&(Y|=Ne.Trait.MultiChain),L&&(Y|=Ne.Trait.Water),G.addUnit(0,X,Q,U,Y)}const V=X.coarseHierarchy;return V.isDefined&&(V.spheres.count>0&&f(G,X,X.coarseHierarchy.spheres,1),V.gaussians.count>0&&f(G,X,X.coarseHierarchy.gaussians,2)),G.getStructure()}e.ofModel=l;function d(X,ce){const k=X.atomicHierarchy.index.getEntityFromChain(ce);return X.entities.data.type.value(k)==="water"}function f(X,ce,k,B){const{chainElementSegments:F}=k;for(let re=0;re<F.count;re++){const G=ve.ofBounds(F.offsets[re],F.offsets[re+1]);X.addUnit(B,ce,St.Default,G,Ne.Trait.None)}}function h(X,ce){if(Oe.isIdentity(ce))return X;if(!Oe.isRotationAndTranslation(ce,St.RotationTranslationEpsilon))throw new Error("Only rotation/translation combination can be applied.");const k=[];for(const re of X.units){const G=re.conformation.operator,V=St.create(G.name,ce,G);k.push(re.applyOperator(re.id,V))}const B=X.coordinateSystem,F=St.compose(St.create(B.name,ce,B),B);return c(k,{parent:X,coordinateSystem:F})}e.transform=h;class p{beginChainGroup(){this.chainGroupId++,this.inChainGroup=!0}endChainGroup(){this.inChainGroup=!1}addUnit(ce,k,B,F,re,G){G===void 0&&(G=this.invariantId());const V=this.inChainGroup?this.chainGroupId:++this.chainGroupId,K=Ne.create(this.units.length,G,V,re,ce,k,B,F);return this.add(K)}copyUnit(ce,k){let B=k==null?void 0:k.invariantId;B===void 0&&(B=this.invariantId());const F=this.inChainGroup?this.chainGroupId:++this.chainGroupId,re=ce.getCopy(this.units.length,B,F,k);return this.add(re)}add(ce){if(ce.elements.length===1){ce.conformation.position(ce.elements[0],this.p);const k=[ce.invariantId,this.p[0],this.p[1],this.p[2]].join("|");if(this.singleElementUnits.has(k))return this.singleElementUnits.get(k);this.singleElementUnits.set(k,ce)}return this.units.push(ce),ce}addWithOperator(ce,k,B=!1){return this.add(ce.applyOperator(this.units.length,k,B))}getStructure(){return c(this.units,this.props)}get isEmpty(){return this.units.length===0}constructor(ce={}){this.props=ce,this.units=[],this.invariantId=al(),this.chainGroupId=-1,this.inChainGroup=!1,this.p=O(),this.singleElementUnits=new Map}}e.StructureBuilder=p;function m(X={}){return new p(X)}e.Builder=m;function y(X){return X.hashCode}e.hashCode=y;function g(X){return xx(X.units.map(ce=>Ne.conformationId(ce)).join("|"))}e.conformationHash=g;function b(X,ce){if(X===ce)return!0;if(X.elementCount!==ce.elementCount)return!1;const k=X.units.length;if(k!==ce.units.length)return!1;for(let B=0;B<k;B++)if(X.units[B].id!==ce.units[B].id)return!1;return!0}e.areUnitIdsEqual=b;function v(X,ce){if(X===ce)return!0;if(!b(X,ce))return!1;for(let k=0,B=X.units.length;k<B;k++)if(!ve.areEqual(X.units[k].elements,ce.units[k].elements))return!1;return!0}e.areUnitIdsAndIndicesEqual=v;function _(X,ce){if(X.hashCode!==ce.hashCode)return!1;const k=X.models.length;if(k!==ce.models.length)return!1;for(let B=0;B<k;B++)if(!$t.areHierarchiesEqual(X.models[B],ce.models[B]))return!1;return!0}e.areHierarchiesEqual=_;function A(X,ce){return X===ce||X.hashCode===ce.hashCode&&Vi.areTransformGroupsEquivalent(X.unitSymmetryGroups,ce.unitSymmetryGroups)}e.areEquivalent=A;function C(X,ce){return A(X.root,ce.root)}e.areRootsEquivalent=C;function I(X,ce){return X.root===ce.root}e.areRootsEqual=I;class S{move(){return this.advance(),this.current.element=this.elements[this.idx],this.current}advance(){if(this.idx<this.maxIdx){this.idx++,this.idx===this.maxIdx&&(this.hasNext=this.unitIndex+1<this.structure.units.length);return}if(this.idx=0,this.unitIndex++,this.unitIndex>=this.structure.units.length){this.hasNext=!1;return}this.current.unit=this.structure.units[this.unitIndex],this.elements=this.current.unit.elements,this.maxIdx=this.elements.length-1,this.maxIdx===0&&(this.hasNext=this.unitIndex+1<this.structure.units.length)}constructor(ce){this.structure=ce,this.unitIndex=0,this.maxIdx=0,this.idx=-1,this.current=Ze.create(ce),this.hasNext=ce.elementCount>0,this.hasNext&&(this.elements=ce.units[0].elements,this.maxIdx=this.elements.length-1,this.current.unit=ce.units[0])}}e.ElementLocationIterator=S;const w=O();function R(X,ce,k){const{elements:B,conformation:F}=X,re=w;let G=Number.MAX_VALUE;for(let V=0,K=B.length;V<K;V++){const Q=B[V],Z=O.distance(ce,F.position(Q,re))-k-F.r(Q);Z<G&&(G=Z)}return G}function M(X,ce,k){const{units:B}=X;let F=Number.MAX_VALUE;for(let re=0,G=B.length;re<G;re++){const V=B[re],K=R(V,ce,k);K<F&&(F=K)}return F}e.minDistanceToPoint=M;const P=O();function E(X,ce){if(X.elementCount===0||ce.elementCount===0)return 0;const{units:k}=X;let B=Number.MAX_VALUE;for(let F=0,re=k.length;F<re;F++){const G=k[F],{elements:V,conformation:K}=G;for(let Q=0,Z=V.length;Q<Z;Q++){const ie=V[Q],L=M(ce,K.position(ie,P),K.r(ie));L<B&&(B=L)}}return B}e.distance=E;function N(X){return X.elementCount===1?"1 element":`${X.elementCount} elements`}e.elementDescription=N;function q(X,ce,k){return X.masterModel?ce.model===k.model||ce.model===X.masterModel||k.model===X.masterModel:ce.model===k.model}e.validUnitPair=q;function j(X,ce,k){const{maxRadius:B,validUnit:F,validUnitPair:re}=k;if(!X.units.some(K=>F(K)))return;const G=X.lookup3d,V=O();for(const K of X.units){if(!F(K))continue;const Q=K.boundary.sphere;O.transformMat4(V,Q.center,K.conformation.operator.matrix);const Z=G.findUnitIndices(V[0],V[1],V[2],Q.radius+B);for(let ie=0;ie<Z.count;ie++){const L=X.units[Z.indices[ie]];K.id>=L.id||!F(L)||!re(K,L)||(L.elements.length>=K.elements.length?ce(K,L):ce(L,K))}}}e.eachUnitPair=j;function z(X,{chain:ce,residue:k,atom:B}){const F=Ze.create(X);for(const re of X.units){if(re.kind!==0)continue;F.unit=re;const{elements:G}=re,V=mt.transientSegments(re.model.atomicHierarchy.chainAtomSegments,G),K=mt.transientSegments(re.model.atomicHierarchy.residueAtomSegments,G);for(;V.hasNext;){const Q=V.move();if(ce&&(F.element=G[Q.start],ce(F)),!(!k&&!B))for(K.setSegment(Q);K.hasNext;){const Z=K.move();if(k&&(F.element=G[Z.start],k(F)),!!B)for(let ie=Z.start,L=Z.end;ie<L;ie++)F.element=G[ie],B(F)}}}}e.eachAtomicHierarchyElement=z,e.DefaultSizeThresholds={smallResidueCount:10,mediumResidueCount:5e3,largeResidueCount:3e4,highSymmetryUnitCount:10,fiberResidueCount:15};function W(X){return X.unitSymmetryGroups.filter(ce=>ce.units[0].polymerElements.length>0)}function se(X,ce){const k=W(X);return k.length===1&&k[0].units.length>2&&k[0].units[0].polymerElements.length<ce.fiberResidueCount}function ue(X,ce){const k=W(X);return k.length>=1&&k[0].units.length>ce.highSymmetryUnitCount}let $;(function(X){X[X.Small=0]="Small",X[X.Medium=1]="Medium",X[X.Large=2]="Large",X[X.Huge=3]="Huge",X[X.Gigantic=4]="Gigantic"})($=e.Size||(e.Size={}));function ne(X,ce={},k=1){const B={...e.DefaultSizeThresholds,...ce};return X.polymerResidueCount>=B.largeResidueCount*k?ue(X,B)?$.Huge:$.Gigantic:se(X,B)||X.polymerResidueCount<B.smallResidueCount*k?$.Small:X.polymerResidueCount<B.mediumResidueCount*k?$.Medium:$.Large}e.getSize=ne,e.Index=Bo.createSimple("index","root"),e.MaxIndex=Bo.createSimple("max_index","root");const de="__PrincipalAxes__";function _e(X){if(X.currentPropertyData[de])return X.currentPropertyData[de];const ce=Cn.getPrincipalAxes(e.toStructureElementLoci(X));return X.currentPropertyData[de]=ce,ce}e.getPrincipalAxes=_e})(xt||(xt={}));class j6{constructor(){this.map=new Map}removeSymbol(t){this.map.delete(t.symbol.id)}addSymbol(t){this.map.has(t.symbol.id)&&console.warn(`Symbol '${t.symbol.id}' already added. Call removeSymbol/removeCustomProps re-adding the symbol.`),this.map.set(t.symbol.id,t)}addCustomProp(t){if(t.symbols)for(const n of Object.keys(t.symbols))this.addSymbol(t.symbols[n])}removeCustomProp(t){if(t.symbols)for(const n of Object.keys(t.symbols))this.removeSymbol(t.symbols[n])}getRuntime(t){return this.map.get(t)}}const z6=new j6;class V6{constructor(t){this.table=t,this.constQueryContext=new li(xt.Empty)}}var Z_;(function(e){function t(r){return{kind:"const",value:r}}e.Const=t;function n(r){return{kind:"dynamic",runtime:r}}e.Dynamic=n})(Z_||(Z_={}));var pi;(function(e){function t(r){return{isConst:!0,fn:function(o){return r}}}e.Const=t;function n(r){return{isConst:!1,fn:r}}e.Dynamic=n})(pi||(pi={}));var X_;(function(e){function t(n,r,i,o){if(typeof n.length=="number")for(let s=0,a=n.length;s<a;s++)i(n[s](r),s,o);else{let s=0;for(const a of Object.keys(n))i(n[a](r),s++,o)}return o}e.forEachEval=t})(X_||(X_={}));var Q_;(function(e){function t(r,i){return new J_(r,i,!0)}e.Const=t;function n(r,i){return new J_(r,i,!1)}e.Dynamic=n})(Q_||(Q_={}));class J_{compile(t,n){let r,i=!1;if(!n)r=void 0,i=!0;else if(kr.isArgumentsArray(n)){r=[],i=!0;for(const o of n){const s=vf(t,o);i=i&&s.isConst,r.push(s.fn)}}else{r=Object.create(null),i=!0;for(const o of Object.keys(n)){const s=vf(t,n[o]);i=i&&s.isConst,r[o]=s.fn}}return this.isConst?this.isConst&&i?pi.Const(this.fn(t.constQueryContext,r)):pi.Dynamic(ey(this.fn,r)):pi.Dynamic(ey(this.fn,r))}constructor(t,n,r){this.symbol=t,this.fn=n,this.isConst=r}}function ey(e,t){return function(r){return e(r,t)}}function vf(e,t){if(kr.isLiteral(t))return pi.Const(t);if(kr.isSymbol(t)){const r=e.table.getRuntime(t.name);return r?r.compile(e):pi.Const(t.name)}if(!kr.isSymbol(t.head))throw new Error("Can only apply symbols.");const n=e.table.getRuntime(t.head.name);if(!n)throw new Error(`Symbol '${t.head.name}' is not implemented.`);return n.compile(e,t.args)}function K6(e){const t=new V6(z6);return vf(t,e).fn}const $6=Kt.diff;function Cn(e,t){return{kind:"element-loci",structure:e,elements:t}}(function(e){function t(G){return!!G&&G.kind==="element-loci"}e.is=t;function n(G,V){if(G.structure!==V.structure||G.elements.length!==V.elements.length)return!1;for(let K=0,Q=G.elements.length;K<Q;++K){const Z=G.elements[K],ie=V.elements[K];if(Z.unit.id!==ie.unit.id||!Re.areEqual(Z.indices,ie.indices))return!1}return!0}e.areEqual=n;function r(G){for(const V of G.elements)if(Re.size(V.indices)>0)return!1;return!0}e.isEmpty=r;function i(G){return o(G)===G.structure.elementCount}e.isWholeStructure=i;function o(G){let V=0;for(const{indices:K}of G.elements)typeof K=="number"?V+=$6(K):V+=K.length;return V}e.size=o;function s(G){return e(G,G.units.map(V=>({unit:V,indices:Re.ofBounds(0,V.elements.length)})))}e.all=s;function a(G){return e(G,[])}e.none=a;function c(G,V,K){let Q;typeof V=="function"?Q=V(ut):Q=V;const Z=K6(Q)(K??new li(G));return wt.toLociWithSourceUnits(Z)}e.fromExpression=c;function u(G,V,K){const Q=V(K??new li(G));return wt.toLociWithSourceUnits(Q)}e.fromQuery=u;function l(G,V,K){return H2.toLoci(G,V,K)}e.fromSchema=l;function d(G,V){if(r(G))return;const K=G.elements[0].unit,Q=K.elements[Re.getAt(G.elements[0].indices,0)];return V?(V.structure=G.structure,V.unit=G.elements[0].unit,V.element=Q,V):Ze.create(G.structure,K,Q)}e.getFirstLocation=d;function f(G){return r(G)?G:e(G.structure,[{unit:G.elements[0].unit,indices:Re.ofSingleton(Re.start(G.elements[0].indices))}])}e.firstElement=f;function h(G){return r(G)?G:S(f(G))}e.firstResidue=h;function p(G){return r(G)?G:E(f(G))}e.firstChain=p;function m(G){const V=[];for(const K of G.elements){const{unit:Q,indices:Z}=K,ie=new Int32Array(Re.size(Z));Re.forEach(Z,(L,U)=>ie[U]=Q.elements[L]),V.push(Q.getChild(ve.ofSortedArray(ie)))}return xt.create(V,{parent:G.structure.parent})}e.toStructure=m;function y(G,V,K){if(e.isEmpty(G))return;const Q=K||Ze.create(G.structure);Q.structure=G.structure;for(const Z of G.elements){const{unit:ie,indices:L}=Z;Q.unit=ie;const{elements:U}=Z.unit;for(let Y=0,fe=Re.size(L);Y<fe;Y++)Q.element=U[Re.getAt(L,Y)],V(Q)}}e.forEachLocation=y;function g(G,V){if(V===G.structure)return G;const K=[];return G.elements.forEach(Q=>{if(!V.unitMap.has(Q.unit.id))return;const Z=V.unitMap.get(Q.unit.id),ie=Re.indexedIntersect(Q.indices,Q.unit.elements,Z.elements);Re.size(ie)>0&&K.push({unit:Z,indices:ie})}),e(V,K)}e.remap=g;function b(G,V){if(G.elements.length>V.elements.length)return b(V,G);if(e.isEmpty(G))return V;const K=new Map;for(const Z of G.elements)K.set(Z.unit.id,Z.indices);const Q=[];for(const Z of V.elements)K.has(Z.unit.id)?(Q[Q.length]={unit:Z.unit,indices:Re.union(K.get(Z.unit.id),Z.indices)},K.delete(Z.unit.id)):Q[Q.length]=Z;return K.forEach((Z,ie)=>{Q[Q.length]={unit:G.structure.unitMap.get(ie),indices:Z}}),e(G.structure,Q)}e.union=b;function v(G,V){const K=new Map;for(const Z of V.elements)K.set(Z.unit.id,Z.indices);const Q=[];for(const Z of G.elements)if(K.has(Z.unit.id)){const ie=Re.subtract(Z.indices,K.get(Z.unit.id));if(Re.size(ie)===0)continue;Q[Q.length]={unit:Z.unit,indices:ie}}else Q[Q.length]=Z;return e(G.structure,Q)}e.subtract=v;function _(G,V){const K=new Map;for(const Z of G.elements)K.set(Z.unit.id,Z.indices);const Q=[];for(const Z of V.elements){if(!K.has(Z.unit.id))continue;const ie=Re.intersect(K.get(Z.unit.id),Z.indices);Re.size(ie)!==0&&(Q[Q.length]={unit:Z.unit,indices:ie})}return e(G.structure,Q)}e.intersect=_;function A(G,V){if(G.elements.length>V.elements.length)return A(V,G);if(e.isEmpty(G))return e.isEmpty(V);const K=new Map;for(const Q of G.elements)K.set(Q.unit.id,Q.indices);for(const Q of V.elements)if(K.has(Q.unit.id)&&Re.areIntersecting(K.get(Q.unit.id),Q.indices))return!0;return!1}e.areIntersecting=A;function C(G,V){if(e.isEmpty(G))return e.isEmpty(V);const K=new Map;for(const Z of G.elements)K.set(Z.unit.id,Z.indices);let Q=!1;for(const Z of V.elements){if(!K.has(Z.unit.id))return!1;if(Re.isSubset(K.get(Z.unit.id),Z.indices))Q=!0;else return!1}return Q}e.isSubset=C;function I(G){return G.length>3&&ve.isRange(G)?pe.ofRange(G[0],G[G.length-1]):ve.ofSortedArray(G)}function S(G,V){const K=[],Q=new Set;for(const Z of G.elements){if(R(Z)){K[K.length]=Z;continue}if(Z.unit.kind===0){const ie=Z.unit.elements,L=Z.unit.model.atomicHierarchy,{label_alt_id:U}=Z.unit.model.atomicHierarchy.atoms,{index:Y,offsets:fe}=L.residueAtomSegments,me=[],Te=Z.indices,x=Re.size(Te);let D=0;for(;D<x;){Q.clear();const J=ie[Re.getAt(Te,D)],le=Y[J];for(Q.add(U.value(J)),D++;D<x;){const ye=ie[Re.getAt(Te,D)];if(Y[ye]!==le)break;Q.add(U.value(ye)),D++}const he=Q.has("");for(let ye=fe[le],Se=fe[le+1];ye<Se;ye++){const Ie=Re.indexOf(ie,ye);if(Ie>=0){const Ee=U.value(ye);(!V||he||!Ee||Q.has(Ee))&&(me[me.length]=Ie)}}}K[K.length]={unit:Z.unit,indices:I(me)}}else K[K.length]=Z}return e(G.structure,K)}e.extendToWholeResidues=S;function w(G){switch(G.kind){case 0:return G.model.atomicHierarchy.chainAtomSegments;case 1:return G.model.coarseHierarchy.spheres.chainElementSegments;case 2:return G.model.coarseHierarchy.gaussians.chainElementSegments}}function R(G){return G.unit.elements.length===Re.size(G.indices)}function M(G,V,K){const{index:Q}=w(G),Z=G.elements;let ie=0;for(let U=0,Y=Z.length;U<Y;U++){const fe=Z[U],me=Q[fe];V.has(me)&&ie++}if(ie===G.elements.length){K[K.length]={unit:G,indices:pe.ofBounds(0,ie)};return}const L=new Int32Array(ie);ie=0;for(let U=0,Y=Z.length;U<Y;U++){const fe=Z[U],me=Q[fe];V.has(me)&&(L[ie++]=U)}L.length>0&&(K[K.length]={unit:G,indices:I(L)})}function P(G,V,K,Q,Z){const{index:ie}=w(G.elements[0].unit),L=new Set;for(let U=V;U<K;U++){const Y=G.elements[U],fe=Y.indices,me=Y.unit.elements;for(let Te=0,x=Re.size(fe);Te<x;Te++)L.add(ie[me[Re.getAt(fe,Te)]])}if(Q){const U=G.elements[0].unit;for(const Y of G.structure.units)Ne.areSameChainOperatorGroup(Y,U)&&M(Y,L,Z)}else for(let U=V;U<K;U++)M(G.elements[U].unit,L,Z)}function E(G){const V=[];for(let K=0,Q=G.elements.length;K<Q;K++){const Z=G.elements[K];if(Ne.Traits.is(Z.unit.traits,Ne.Trait.Partitioned)){const ie=K;for(;K<Q&&Ne.areSameChainOperatorGroup(G.elements[K].unit,Z.unit);)K++;const L=K;K--,P(G,ie,L,!0,V)}else R(Z)?V[V.length]=Z:P(G,K,K+1,!1,V)}return e(G.structure,V)}e.extendToWholeChains=E;function N(G){return`${G.unit.model.id}|${vt.entity.id(G)}`}function q(G){const V=[],K=Ze.create(G.structure),Q=new Set,{units:Z}=G.structure;for(let ie=0,L=G.elements.length;ie<L;ie++){const U=G.elements[ie];K.unit=U.unit,K.element=U.unit.elements[0],Q.add(N(K))}for(let ie=0,L=Z.length;ie<L;++ie){const U=Z[ie];if(K.unit=U,K.element=U.elements[0],Q.has(N(K))){const Y=Re.ofBounds(0,U.elements.length);V[V.length]={unit:U,indices:Y}}}return e(G.structure,V)}e.extendToWholeEntities=q;function j(G){const V=[],K=new Set,{units:Q}=G.structure;for(let Z=0,ie=G.elements.length;Z<ie;Z++){const L=G.elements[Z];K.add(L.unit.model.id)}for(let Z=0,ie=Q.length;Z<ie;++Z){const L=Q[Z];if(K.has(L.model.id)){const U=Re.ofBounds(0,L.elements.length);V[V.length]={unit:L,indices:U}}}return e(G.structure,V)}e.extendToWholeModels=j;function z(G,V){const K=[];for(let Q=0,Z=Re.size(V);Q<Z;++Q)K.push(G[Re.getAt(V,Q)]);return ve.ofSortedArray(K)}function W(G,V){return ve.isRange(G)&&ve.areEqual(G,V)?pe.ofLength(G.length):I(ve.indicesOf(G,V))}function se(G){const V=[],K=new Map;for(let Q=0,Z=G.elements.length;Q<Z;Q++){const ie=G.elements[Q],{model:L}=ie.unit,U=z(ie.unit.elements,ie.indices);K.has(L)?K.set(L,ve.union(U,K.get(L))):K.set(L,U)}for(let Q=0,Z=G.structure.units.length;Q<Z;++Q){const ie=G.structure.units[Q],L=K.get(ie.model);if(!L)continue;const U=W(ie.elements,L);Re.size(U)&&(V[V.length]={unit:ie,indices:U})}return e(G.structure,V)}e.extendToAllInstances=se;function ue(G){const V=[],K=new Set,{units:Q}=G.structure;for(let Z=0,ie=G.elements.length;Z<ie;Z++){const L=G.elements[Z];K.add(L.unit.conformation.operator.name)}for(let Z=0,ie=Q.length;Z<ie;++Z){const L=Q[Z];if(K.has(L.conformation.operator.name)){const U=Re.ofBounds(0,L.elements.length);V[V.length]={unit:L,indices:U}}}return e(G.structure,V)}e.extendToWholeOperators=ue;const $=new Eo("98"),ne=O();function de(G,V,K){$.reset();for(const Q of G.elements){const{indices:Z}=Q,{elements:ie,conformation:L}=Q.unit;for(let U=0,Y=Re.size(Z);U<Y;U++){const fe=ie[Re.getAt(Z,U)];L.position(fe,ne),V&&O.transformMat4(ne,ne,V),$.includePositionRadius(ne,L.r(fe))}}$.finishedIncludeStep();for(const Q of G.elements){const{indices:Z}=Q,{elements:ie,conformation:L}=Q.unit;for(let U=0,Y=Re.size(Z);U<Y;U++){const fe=ie[Re.getAt(Z,U)];L.position(fe,ne),V&&O.transformMat4(ne,ne,V),$.radiusPositionRadius(ne,L.r(fe))}}return K?(K.box&&$.getBox(K.box),K.sphere&&$.getSphere(K.sphere),K):{box:$.getBox(),sphere:$.getSphere()}}e.getBoundary=de;const _e=O();function X(G,V,K=0){let Q=K;for(const Z of G.elements){const{indices:ie}=Z,{elements:L,conformation:U}=Z.unit,Y=Re.size(ie);for(let fe=0;fe<Y;fe++){const me=L[Re.getAt(ie,fe)];U.position(me,_e),O.toArray(_e,V,Q+fe*3)}Q+=Y*3}return V}e.toPositionsArray=X;function ce(G){const V=o(G),K=X(G,new Float32Array(3*V));return xr.ofPositions(K)}e.getPrincipalAxes=ce;function k(G){let V=0;G.forEach(Z=>{V+=o(Z)});const K=new Float32Array(3*V);let Q=0;return G.forEach(Z=>{X(Z,K,Q),Q+=o(Z)*3}),xr.ofPositions(K)}e.getPrincipalAxesMany=k;function B(G,V){return Ne.isAtomic(G)?G.model.atomicHierarchy.atomSourceIndex.value(V):V}function F(G){if(e.isEmpty(G))return ut.struct.generator.empty();const V=G.structure.models,K=new Map;for(const U of G.elements){const{indices:Y}=U,{elements:fe}=U.unit,me=U.unit.conformation.operator.name;let Te;K.has(me)?Te=K.get(me).xs:(Te=mn.create(),K.set(me,{modelLabel:U.unit.model.label,modelIndex:U.unit.model.modelNum,xs:Te}));for(let x=0,D=Re.size(Y);x<D;x++){const J=B(U.unit,fe[Re.getAt(Y,x)]);mn.add(Te,J,J)}}const Q=[],Z=K.keys();for(;;){const U=Z.next();if(U.done)break;const Y=K.get(U.value);Q.push(re(U.value,Y.xs.array,V.length>1,Y.modelLabel,Y.modelIndex))}const ie=new Map;for(let U=0,Y=Q.length;U<Y;++U){const fe=Q[U],Te=`${ds(Oi(fe.atom.ranges),Oi(fe.atom.set))}|${fe.entity?fe.entity.modelLabel+fe.entity.modelIndex:""}`;ie.has(Te)?ie.get(Te).chain.opName.push(...fe.chain.opName):ie.set(Te,fe)}const L=[];return ie.forEach(U=>{const{ranges:Y,set:fe}=U.atom,{opName:me}=U.chain,Te=ut.struct.atomProperty.core.operatorName(),x=ut.struct.atomProperty.core.sourceIndex(),D=[];fe.length>0&&(D[D.length]=ut.core.set.has([ut.core.type.set(fe),x]));for(let J=0,le=Y.length/2;J<le;J++)D[D.length]=ut.core.rel.inRange([x,Y[2*J],Y[2*J+1]]);if(U.entity){const{modelLabel:J,modelIndex:le}=U.entity;L.push(ut.struct.generator.atomGroups({"atom-test":D.length>1?ut.core.logic.or(D):D[0],"chain-test":me.length>1?ut.core.set.has([ut.core.type.set(me),Te]):ut.core.rel.eq([Te,me[0]]),"entity-test":ut.core.logic.and([ut.core.rel.eq([ut.struct.atomProperty.core.modelLabel(),J]),ut.core.rel.eq([ut.struct.atomProperty.core.modelIndex(),le])])}))}else L.push(ut.struct.generator.atomGroups({"atom-test":D.length>1?ut.core.logic.or(D):D[0],"chain-test":me.length>1?ut.core.set.has([ut.core.type.set(me),Te]):ut.core.rel.eq([Te,me[0]])}))}),ut.struct.modifier.union([L.length===1?L[0]:ut.struct.combinator.merge(L.map(U=>ut.struct.modifier.union([U])))])}e.toExpression=F;function re(G,V,K,Q,Z){mr(V);const ie=[],L=[];let U=0;const Y=V.length;for(;U<Y;){const fe=U;for(U++;U<Y&&V[U-1]+1===V[U];)U++;const me=U;if(me-fe>12)ie[ie.length]=V[fe],ie[ie.length]=V[me-1];else for(let Te=fe;Te<me;Te++)L[L.length]=V[Te]}return K?{atom:{set:L,ranges:ie},chain:{opName:[G]},entity:{modelLabel:Q,modelIndex:Z}}:{atom:{set:L,ranges:ie},chain:{opName:[G]}}}})(Cn||(Cn={}));var ty;(function(e){function t(){return{elementCount:0,conformationCount:0,residueCount:0,chainCount:0,unitCount:0,structureCount:0,firstElementLoc:Ze.create(void 0),firstConformationLoc:Ze.create(void 0),firstResidueLoc:Ze.create(void 0),firstChainLoc:Ze.create(void 0),firstUnitLoc:Ze.create(void 0),firstStructureLoc:Ze.create(void 0)}}e.create=t;function n(c,u,l){const d=c.get(u)||0;c.set(u,d+l)}function r(c,u,l){const{indices:d,unit:f}=l,{elements:h}=f,p=Re.size(d),m=new Map,y=new Map;if(p>0&&Ze.set(c.firstElementLoc,u,f,h[Re.start(d)]),p===h.length)c.unitCount+=1,c.unitCount===1&&Ze.set(c.firstUnitLoc,u,f,h[Re.start(d)]);else if(p===1){if(Ne.Traits.is(f.traits,Ne.Trait.MultiChain))return;c.elementCount+=1,c.elementCount===1&&Ze.set(c.firstElementLoc,u,f,h[Re.start(d)])}else if(Ne.isAtomic(f)){const{index:g,offsets:b}=f.model.atomicHierarchy.residueAtomSegments,{label_alt_id:v}=f.model.atomicHierarchy.atoms;let _=0;for(;_<p;){m.clear();let A=0;const C=h[Re.getAt(d,_)],I=g[C];for(n(m,v.value(C),1),++_,++A;_<p;){const S=h[Re.getAt(d,_)];if(g[S]!==I)break;n(m,v.value(S),1),++_,++A}if(b[I+1]-b[I]===A)c.residueCount+=1,c.residueCount===1&&Ze.set(c.firstResidueLoc,u,f,b[I]);else{y.clear();for(let S=b[I],w=b[I+1];S<w;++S)n(y,v.value(S),1);y.get("")===m.get("")&&m.forEach((S,w)=>{if(y.get(w)===S){if(w!==""&&(c.conformationCount+=1,c.conformationCount===1)){for(let R=b[I],M=b[I+1];R<M;++R)if(w===v.value(R)){Ze.set(c.firstConformationLoc,u,f,R);break}}A-=S}}),c.elementCount+=A}}}else c.elementCount+=p,c.elementCount===1&&Ze.set(c.firstElementLoc,u,f,h[Re.start(d)])}function i(c,u,l){const{indices:d,unit:f}=l,h=Re.size(d);if(h===0)return;const{elements:p}=f;if(!Ne.Traits.is(f.traits,Ne.Trait.MultiChain)){h===p.length&&(c.chainCount+=1,c.chainCount===1&&Ze.set(c.firstChainLoc,u,f,p[Re.start(d)]));return}const m=Ne.isAtomic(f)?f.model.atomicHierarchy.chainAtomSegments:Ne.isSpheres(f)?f.model.coarseHierarchy.spheres.chainElementSegments:Ne.isGaussians(f)?f.model.coarseHierarchy.gaussians.chainElementSegments:void 0;if(!m){console.warn("StructureElement loci stats: unknown unit type");return}const{index:y,offsets:g}=m;let b=0;for(;b<h;){let v=0;const _=p[Re.getAt(d,b)],A=y[_];for(++b,++v;b<h;){const C=p[Re.getAt(d,b)];if(y[C]!==A)break;++b,++v}g[A+1]-g[A]===v?(c.chainCount+=1,c.chainCount===1&&Ze.set(c.firstChainLoc,u,f,g[A])):h===1&&(c.elementCount+=1,c.elementCount===1&&Ze.set(c.firstElementLoc,u,f,_))}}function o(c,u,l,d,f){let h=l[d];const p=Ne.isAtomic(h.unit)?h.unit.model.atomicHierarchy.chainAtomSegments:Ne.isSpheres(h.unit)?h.unit.model.coarseHierarchy.spheres.chainElementSegments:Ne.isGaussians(h.unit)?h.unit.model.coarseHierarchy.gaussians.chainElementSegments:void 0;if(!p){console.warn("StructureElement loci stats: unknown unit type");return}const{index:m,offsets:y}=p,g=new Map;for(let v=d;v<f;v++){h=l[v];const{indices:_,unit:A}=h,C=Re.size(_);if(C===0)continue;const{elements:I}=A;if(!Ne.Traits.is(A.traits,Ne.Trait.MultiChain)){const w=I[Re.start(_)];n(g,m[w],I.length);continue}let S=0;for(;S<C;){let w=0;const R=I[Re.getAt(_,S)],M=m[R];for(++S,++w;S<C;){const P=I[Re.getAt(_,S)];if(m[P]!==M)break;++S,++w}n(g,M,w)}}let b=-1;if(g.forEach((v,_)=>{y[_+1]-y[_]===v&&(c.chainCount+=1,c.chainCount===1&&(b=_))}),!(b<0))for(let v=d;v<f;v++){h=l[v];const{indices:_,unit:A}=h,C=Re.size(_);if(C===0)continue;const{elements:I}=A,S=0;for(;S<C;){const w=I[Re.getAt(_,S)];if(m[w]===b){Ze.set(c.firstChainLoc,u,A,w);return}}}}function s(c){const u=t();if(Cn.isEmpty(c))return u;let l=!1;if(Cn.isWholeStructure(c)){if(u.structureCount+=1,u.structureCount===1){const{unit:d,indices:f}=c.elements[0];Ze.set(u.firstStructureLoc,c.structure,d,d.elements[Re.min(f)])}}else for(const d of c.elements)r(u,c.structure,d),Ne.Traits.is(d.unit.traits,Ne.Trait.Partitioned)?l=!0:i(u,c.structure,d);if(l)for(let d=0,f=c.elements.length;d<f;d++){const h=c.elements[d];if(!Ne.Traits.is(h.unit.traits,Ne.Trait.Partitioned))continue;const p=d;for(;d<f&&Ne.areSameChainOperatorGroup(c.elements[d].unit,h.unit);)d++;const m=d;d--,m-p===1?i(u,c.structure,h):o(u,c.structure,c.elements,p,m)}return u}e.ofLoci=s;function a(c,u,l){return u.elementCount===1&&l.elementCount===0?Ze.copy(c.firstElementLoc,u.firstElementLoc):u.elementCount===0&&l.elementCount===1&&Ze.copy(c.firstElementLoc,l.firstElementLoc),u.conformationCount===1&&l.conformationCount===0?Ze.copy(c.firstConformationLoc,u.firstConformationLoc):u.conformationCount===0&&l.conformationCount===1&&Ze.copy(c.firstConformationLoc,l.firstConformationLoc),u.residueCount===1&&l.residueCount===0?Ze.copy(c.firstResidueLoc,u.firstResidueLoc):u.residueCount===0&&l.residueCount===1&&Ze.copy(c.firstResidueLoc,l.firstResidueLoc),u.chainCount===1&&l.chainCount===0?Ze.copy(c.firstChainLoc,u.firstChainLoc):u.chainCount===0&&l.chainCount===1&&Ze.copy(c.firstChainLoc,l.firstChainLoc),u.unitCount===1&&l.unitCount===0?Ze.copy(c.firstUnitLoc,u.firstUnitLoc):u.unitCount===0&&l.unitCount===1&&Ze.copy(c.firstUnitLoc,l.firstUnitLoc),u.structureCount===1&&l.structureCount===0?Ze.copy(c.firstStructureLoc,u.firstStructureLoc):u.structureCount===0&&l.structureCount===1&&Ze.copy(c.firstStructureLoc,l.firstStructureLoc),c.elementCount=u.elementCount+l.elementCount,c.conformationCount=u.conformationCount+l.conformationCount,c.residueCount=u.residueCount+l.residueCount,c.chainCount=u.chainCount+l.chainCount,c.unitCount=u.unitCount+l.unitCount,c.structureCount=u.structureCount+l.structureCount,c}e.add=a})(ty||(ty={}));var Ki;(function(e){function t(r){const i=r.descriptor.name,o=r.type==="static"?"_staticPropertyData":"_dynamicPropertyData",s=c=>(i in c[o]||(c[o][i]={props:{...bt.getDefaultValues(r.getParams(c))},data:Br.create(void 0)}),c[o][i]),a=(c,u,l)=>{const d=s(c);c[o][i]={props:u,data:Br.withValue(d.data,l)}};return{label:r.label,descriptor:r.descriptor,isHidden:r.isHidden,getParams:c=>{const u=bt.clone(r.getParams(c));return bt.setDefaultValues(u,s(c).props),u},defaultParams:r.defaultParams,isApplicable:r.isApplicable,attach:async(c,u,l={},d)=>{d&&u.customProperties.reference(r.descriptor,!0);const f=s(u),h=bt.merge(r.defaultParams,f.props,l);if(f.data.value&&bt.areEqual(r.defaultParams,f.props,h))return;const{value:p,assets:m}=await r.obtain(c,u,h);u.customProperties.add(r.descriptor),u.customProperties.assets(r.descriptor,m),a(u,h,p)},ref:(c,u)=>c.customProperties.reference(r.descriptor,u),get:c=>{var u;return(u=s(c))===null||u===void 0?void 0:u.data},set:(c,u={},l)=>{const d=s(c),f=bt.merge(r.defaultParams,d.props,u);bt.areEqual(r.defaultParams,d.props,f)||(a(c,f,l),c.customProperties.assets(r.descriptor))},props:c=>s(c).props}}e.createProvider=t;function n(r,i,o){const s={value:bt.Value(o,{isHidden:!0})};return t({label:So(r),descriptor:ri({name:r}),isHidden:!0,type:i,defaultParams:s,getParams:()=>({value:bt.Value(o,{isHidden:!0})}),isApplicable:()=>!0,obtain:async(a,c,u)=>({...bt.getDefaultValues(s),...u})})}e.createSimple=n})(Ki||(Ki={}));var ny;(function(e){e.Provider=Ki.createProvider({label:"SIFTS Mapping",descriptor:ri({name:"sifts_sequence_mapping"}),type:"static",defaultParams:{},getParams:()=>({}),isApplicable:o=>t(o),obtain:async(o,s)=>({value:i(s)})});function t(o){if(!Ct.is(o.sourceData))return!1;const{pdbx_sifts_xref_db_name:s,pdbx_sifts_xref_db_acc:a,pdbx_sifts_xref_db_num:c,pdbx_sifts_xref_db_res:u}=o.sourceData.data.db.atom_site;return s.isDefined&&a.isDefined&&c.isDefined&&u.isDefined}e.isAvailable=t;function n(o){const s=o.unit.model,a=e.Provider.get(s).value;if(!a)return"";const c=s.atomicHierarchy.residueAtomSegments.index[o.element];return a.accession[c]}e.getKey=n;function r(o){const s=o.unit.model,a=e.Provider.get(s).value;if(!a)return;const c=s.atomicHierarchy.residueAtomSegments.index[o.element],u=a.dbName[c];if(u)return`${u} ${a.accession[c]} ${a.num[c]} ${a.residue[c]}`}e.getLabel=r;function i(o){if(!Ct.is(o.sourceData))return;const{pdbx_sifts_xref_db_name:s,pdbx_sifts_xref_db_acc:a,pdbx_sifts_xref_db_num:c,pdbx_sifts_xref_db_res:u}=o.sourceData.data.db.atom_site;if(!s.isDefined||!a.isDefined||!c.isDefined||!u.isDefined)return;const{atomSourceIndex:l}=o.atomicHierarchy,{count:d,offsets:f}=o.atomicHierarchy.residueAtomSegments,h=new Array(d),p=new Array(d),m=new Array(d),y=new Array(d);for(let g=0;g<d;g++){const b=l.value(f[g]);if(s.valueKind(b)!==0){h[g]="",p[g]="",m[g]="",y[g]="";continue}h[g]=s.value(b),p[g]=a.value(b),m[g]=c.value(b),y[g]=u.value(b)}return{dbName:h,accession:p,num:m,residue:y}}})(ny||(ny={})),nn.Field,nn.Encodings,nn.Field,nn.Category,nn.Category,nn.Category;var ry;(function(e){function t(n){const r=Array.isArray(n)?n:[n];return{structures:r,firstModel:r[0].model,cache:Object.create(null)}}e.create=t})(ry||(ry={}));var iy;(function(e){e.AtomSitePositionsFieldNames=new Set(["id","Cartn_x","Cartn_y","Cartn_z"])})(iy||(iy={}));const Y6={molstar_atom_site_operator_mapping:{label_asym_id:Ce.Schema.Str(),auth_asym_id:Ce.Schema.Str(),operator_name:Ce.Schema.Str(),suffix:Ce.Schema.Str(),assembly_id:Ce.Schema.Str(),assembly_operator_id:Ce.Schema.Int(),symmetry_operator_index:Ce.Schema.Int(),symmetry_hkl:Ce.Schema.Vector(3),ncs_id:Ce.Schema.Int()}},oy=(e,t)=>typeof t[e].operator.assembly>"u"?1:0,xf=(e,t)=>t[e].operator.spgrOp===-1?1:0;nn.fields().str("label_asym_id",(e,t)=>t[e].label_asym_id).str("auth_asym_id",(e,t)=>t[e].auth_asym_id).str("operator_name",(e,t)=>t[e].operator.name).str("suffix",(e,t)=>t[e].operator.suffix).str("assembly_id",(e,t)=>{var n;return((n=t[e].operator.assembly)===null||n===void 0?void 0:n.id)||""},{valueKind:oy}).int("assembly_operator_id",(e,t)=>{var n;return((n=t[e].operator.assembly)===null||n===void 0?void 0:n.operId)||0},{valueKind:oy}).int("symmetry_operator_index",(e,t)=>t[e].operator.spgrOp,{valueKind:xf}).vec("symmetry_hkl",[(e,t)=>t[e].operator.hkl[0],(e,t)=>t[e].operator.hkl[1],(e,t)=>t[e].operator.hkl[2]],{valueKind:xf}).int("ncs_id",(e,t)=>t[e].operator.ncsId,{valueKind:xf}).getFields();function W6(e,t,n,r){const{label_comp_id:i,type_symbol:o,_rowCount:s}=e.atoms,{_rowCount:a}=e.residues,{offsets:c}=t.residueAtomSegments,u=new Uint8Array(s);for(let g=0;g<s;++g)u[g]=XC(o.value(g));const l=new Int32Array(a),d=new Int32Array(a),f=new Int32Array(a),h=new Uint8Array(a),p=new Uint8Array(a),m=new Map,y=new Map;for(let g=0;g<a;++g){const b=i.value(c[g]),v=r;let _,A;if(m.has(b))_=m.get(b),A=y.get(b);else{let R;v.has(b)?R=v.get(b).type:(vv||console.info("chemComp not found",b),R=O2(b)),_=Kl(R,b),A=V5(R,_),m.set(b,_),y.set(b,A)}h[g]=_,p[g]=A;const C=zr(A,"trace");let I=n.findAtomsOnResidue(g,C);if(I===-1){const R=zr(A,"coarseBackbone");I=n.findAtomsOnResidue(g,R),I===-1&&$l(_)&&(I=n.findElementOnResidue(g,Co("C")))}l[g]=I;const S=zr(A,"directionFrom");d[g]=n.findAtomsOnResidue(g,S);const w=zr(A,"directionTo");f[g]=n.findAtomsOnResidue(g,w)}return{atom:{atomicNumber:u},residue:{traceElementIndex:l,directionFromElementIndex:d,directionToElementIndex:f,moleculeType:h,polymerType:p}}}function $i(e,t){return t?t.length===1?Hn(t.charCodeAt(0),e):t.length===2?Hn(t.charCodeAt(0),Hn(t.charCodeAt(1),e)):`${e} ${t}`:e}function Z6(e,t,n,r){if(e.has(t)){const i=e.get(t);i.has(n)||i.set(n,r)}else{const i=new Map;e.set(t,i),i.set(n,r)}}function X6(e){throw new Error(`Missing entity entry for entity id '${e}'.`)}function Q6(e,t,n){return{entities:e,segments:n,label_seq_id:ve.ofSortedArray(t.residues.label_seq_id.toArray({array:Int32Array})),label_atom_id:t.atoms.label_atom_id,auth_atom_id:t.atoms.auth_atom_id,label_alt_id:t.atoms.label_alt_id,type_symbol:t.atoms.type_symbol,chain_index_entity_index:new Int32Array(t.chains._rowCount),entity_index_label_asym_id:new Map,chain_index_label_seq_id:new Map,auth_asym_id_auth_seq_id:new Map,chain_index_auth_seq_id:new Map,label_asym_id:new Map}}const Mo=ff.EmptyResidueKey();let J6=class{getEntityFromChain(t){return this.map.chain_index_entity_index[t]}findEntity(t){const n=this.map.label_asym_id.get(t);return n!==void 0?n:-1}findChainLabel(t){const n=this.entityIndex(t.label_entity_id);if(n<0||!this.map.entity_index_label_asym_id.has(n))return-1;const r=this.map.entity_index_label_asym_id.get(n);return r&&r.has(t.label_asym_id)?r.get(t.label_asym_id):-1}findChainAuth(t){if(!this.map.auth_asym_id_auth_seq_id.has(t.auth_asym_id))return-1;const n=this.map.auth_asym_id_auth_seq_id.get(t.auth_asym_id);return n.has(t.auth_seq_id)?n.get(t.auth_seq_id):-1}findResidue(t,n,r,i){let o;arguments.length===1?o=t:(Mo.label_entity_id=t,Mo.label_asym_id=n,Mo.auth_seq_id=r,Mo.pdbx_PDB_ins_code=i,o=Mo);const s=this.findChainLabel(o);if(s<0)return-1;const a=this.map.chain_index_auth_seq_id.get(s),c=$i(o.auth_seq_id,o.pdbx_PDB_ins_code||"");return a.has(c)?a.get(c):-1}findResidueLabel(t){const n=this.findChainLabel(t);if(n<0)return-1;const r=this.map.chain_index_label_seq_id.get(n),i=$i(t.label_seq_id,t.pdbx_PDB_ins_code||"");return r.has(i)?r.get(i):-1}findResidueAuth(t){const n=this.findChainAuth(t);if(n<0)return-1;const r=this.map.chain_index_auth_seq_id.get(n),i=$i(t.auth_seq_id,t.pdbx_PDB_ins_code||"");return r.has(i)?r.get(i):-1}findResidueInsertion(t){const n=this.findChainLabel(t);if(n<0)return-1;const r=this.map.chain_index_label_seq_id.get(n),i=$i(t.label_seq_id,t.pdbx_PDB_ins_code||"");if(r.has(i))return r.get(i);const o=ve.findPredecessorIndex(this.map.label_seq_id,t.label_seq_id),s=zi.chainStartResidueIndex(this.map.segments,n);if(o<s)return s;const a=zi.chainEndResidueIndexExcl(this.map.segments,n)-1;return o>=a?a:o}findAtom(t){const n=this.findResidue(t);return n<0?-1:typeof t.label_alt_id>"u"?Af(this.residueOffsets[n],this.residueOffsets[n+1],this.map.label_atom_id,t.label_atom_id):Sf(this.residueOffsets[n],this.residueOffsets[n+1],this.map.label_atom_id,this.map.label_alt_id,t.label_atom_id,t.label_alt_id)}findAtomAuth(t){const n=this.findResidueAuth(t);return n<0?-1:typeof t.label_alt_id>"u"?Af(this.residueOffsets[n],this.residueOffsets[n+1],this.map.auth_atom_id,t.auth_atom_id):Sf(this.residueOffsets[n],this.residueOffsets[n+1],this.map.auth_atom_id,this.map.label_alt_id,t.auth_atom_id,t.label_alt_id)}findAtomOnResidue(t,n,r){return typeof r>"u"?Af(this.residueOffsets[t],this.residueOffsets[t+1],this.map.label_atom_id,n):Sf(this.residueOffsets[t],this.residueOffsets[t+1],this.map.label_atom_id,this.map.label_alt_id,n,r)}findAtomsOnResidue(t,n){return ew(this.residueOffsets[t],this.residueOffsets[t+1],this.map.label_atom_id,n)}findElementOnResidue(t,n){return tw(this.residueOffsets[t],this.residueOffsets[t+1],this.map.type_symbol,n)}constructor(t){this.map=t,this.entityIndex=t.entities.getEntityIndex,this.residueOffsets=this.map.segments.residueAtomSegments.offsets}};function Af(e,t,n,r){for(let i=e;i<t;i++)if(n.value(i)===r)return i;return-1}function ew(e,t,n,r){for(let i=e;i<t;i++)if(r.has(n.value(i)))return i;return-1}function Sf(e,t,n,r,i,o){for(let s=e;s<t;s++)if(n.value(s)===i&&r.value(s)===o)return s;return-1}function tw(e,t,n,r){for(let i=e;i<t;i++)if(n.value(i)===r)return i;return-1}function nw(e,t,n){const r=Q6(t,e,n),{label_seq_id:i,auth_seq_id:o,pdbx_PDB_ins_code:s}=e.residues,{label_entity_id:a,label_asym_id:c,auth_asym_id:u}=e.chains,l=pe.ofBounds(0,e.atoms._rowCount),d=mt.transientSegments(n.chainAtomSegments,l);for(;d.hasNext;){const f=d.move(),h=f.index,p=t.getEntityIndex(a.value(h));p<0&&X6(a.value(h)),r.chain_index_entity_index[h]=p;const m=u.value(h);let y=r.auth_asym_id_auth_seq_id.get(m);y||(y=new Map,r.auth_asym_id_auth_seq_id.set(m,y));const g=c.value(h);r.label_asym_id.has(g)||r.label_asym_id.set(g,p),Z6(r.entity_index_label_asym_id,p,g,h);const b=new Map,v=new Map;r.chain_index_label_seq_id.set(h,b),r.chain_index_auth_seq_id.set(h,v);const _=mt.transientSegments(n.residueAtomSegments,l,f);for(;_.hasNext;){const C=_.move().index,I=o.value(C),S=s.value(C);b.set($i(i.value(C),S),C),v.set($i(I,S),C),y.set(I,h)}}return new J6(r)}function rw(e){if(e._rowCount===0)return{residues:[],chains:[]};const t=0,n=e._rowCount,r=[t],i=[t],{label_entity_id:o,label_asym_id:s,label_seq_id:a,auth_seq_id:c,pdbx_PDB_ins_code:u}=e;for(let l=t+1;l<n;l++){const d=!o.areValuesEqual(l-1,l)||!s.areValuesEqual(l-1,l);(d||!a.areValuesEqual(l-1,l)||!c.areValuesEqual(l-1,l)||!u.areValuesEqual(l-1,l))&&(r[r.length]=l),d&&(i[i.length]=l)}return{residues:r,chains:i}}function iw(e,t,n){const r=At.ofColumns(zC,{type_symbol:Ce.ofArray({array:Ce.mapToArray(e.type_symbol,Co),schema:Ce.Schema.Aliased(Ce.Schema.str)}),label_atom_id:e.label_atom_id,auth_atom_id:e.auth_atom_id,label_alt_id:e.label_alt_id,label_comp_id:e.label_comp_id,auth_comp_id:e.auth_comp_id,pdbx_formal_charge:e.pdbx_formal_charge}),i=At.view(e,VC,n.residues),o=At.view(e,KC,n.chains);if(!i.label_seq_id.isDefined){const s=new Int32Array(i.label_seq_id.rowCount),{residues:a,chains:c}=n;let u=0,l=0;for(let d=0,f=s.length;d<f;++d)a[d]>=c[u+1]&&(u+=1,l=0),s[d]=++l;i.label_seq_id=Ce.ofIntArray(s)}return At.columnToArray(i,"label_seq_id",Int32Array),At.columnToArray(i,"auth_seq_id",Int32Array),{atoms:r,residues:i,chains:o,atomSourceIndex:t}}function ow(e){return{id:ln.create22(),atomId:e.id,occupancy:e.occupancy.isDefined?e.occupancy:Ce.ofConst(1,e._rowCount,Ce.Schema.float),B_iso_or_equiv:e.B_iso_or_equiv,xyzDefined:e.Cartn_x.isDefined&&e.Cartn_y.isDefined&&e.Cartn_z.isDefined,x:e.Cartn_x.toArray({array:Float32Array}),y:e.Cartn_y.toArray({array:Float32Array}),z:e.Cartn_z.toArray({array:Float32Array})}}function sw(e,t){return At.areEqual(e.chains,t.chains)&&At.areEqual(e.residues,t.residues)&&At.areEqual(e.atoms,t.atoms)}function aw(e,t){const n=new Map;if(!Ct.is(t))return n;const{molstar_atom_site_operator_mapping:r}=nr(Y6,t.data.frame);if(r._rowCount===0)return n;const i=new Map,o=new Map;for(let l=0;l<r._rowCount;l++){const d=r.assembly_operator_id.valueKind(l)===0?{id:r.assembly_id.value(l),operList:[],operId:r.assembly_operator_id.value(l)}:void 0,f=St.create(r.operator_name.value(l),Oe.identity(),{assembly:d,spgrOp:r.symmetry_operator_index.valueKind(l)===0?r.symmetry_operator_index.value(l):void 0,hkl:O.ofArray(r.symmetry_hkl.value(l)),ncsId:r.ncs_id.value(l)}),h=r.suffix.value(l),p=r.label_asym_id.value(l);i.set(`${p}${h}`,{name:p,operator:f});const m=r.auth_asym_id.value(l);o.set(`${m}${h}`,m)}const{label_asym_id:s,auth_asym_id:a}=e.chains,c=new Array(s.rowCount),u=new Array(s.rowCount);for(let l=0;l<s.rowCount;l++){const d=s.value(l),f=a.value(l);if(!i.has(d)){c[l]=d,u[l]=f;continue}const{name:h,operator:p}=i.get(d);n.set(l,p),c[l]=h,u[l]=o.get(f)||f}return e.chains.label_asym_id=Ce.ofArray({array:c,valueKind:e.chains.label_asym_id.valueKind,schema:e.chains.label_asym_id.schema}),e.chains.auth_asym_id=Ce.ofArray({array:u,valueKind:e.chains.auth_asym_id.valueKind,schema:e.chains.auth_asym_id.schema}),n}function cw(e,t,n,r,i,o){const s=rw(e),a=iw(e,t,s),c=aw(a,i);if(o&&sw(o.atomicHierarchy,a))return{sameAsPrevious:!0,hierarchy:o.atomicHierarchy,chainOperatorMapping:c};const u={residueAtomSegments:mt.ofOffsets(s.residues,pe.ofBounds(0,e._rowCount)),chainAtomSegments:mt.ofOffsets(s.chains,pe.ofBounds(0,e._rowCount))},l=nw(a,n,u),d=W6(a,u,l,r);return{sameAsPrevious:!1,hierarchy:{...a,...u,index:l,derived:d},chainOperatorMapping:c}}function sy(e,t,n,r,i,o){const{sameAsPrevious:s,hierarchy:a,chainOperatorMapping:c}=cw(e,t,n,r,i,o),u=ow(e);return{sameAsPrevious:s,hierarchy:a,conformation:u,chainOperatorMapping:c}}function uw(e){return new dw(e)}class lw{findElement(t,n){return n.kind=void 0,n.index=-1,!1}findSphereElement(t){return-1}findGaussianElement(t){return-1}}const fw=new lw;class dw{get sphereMapping(){return this._sphereMapping||(this._sphereMapping=ay(this.data.spheres)),this._sphereMapping}get gaussianMapping(){return this._gaussianMapping||(this._gaussianMapping=ay(this.data.gaussians)),this._gaussianMapping}findSphereElement(t){var n;let i=this.sphereMapping[t.label_entity_id];return!i||(i=i[t.label_asym_id],!i)?-1:(n=i[t.label_seq_id])!==null&&n!==void 0?n:-1}findGaussianElement(t){var n;let i=this.gaussianMapping[t.label_entity_id];return!i||(i=i[t.label_asym_id],!i)?-1:(n=i[t.label_seq_id])!==null&&n!==void 0?n:-1}findElement(t,n){const r=this.findSphereElement(t);if(r>=0)return n.kind="spheres",n.index=r,!0;const i=this.findGaussianElement(t);return i>=0?(n.kind="gaussians",n.index=i,!0):!1}constructor(t){this.data=t,this._sphereMapping=void 0,this._gaussianMapping=void 0}}function ay({count:e,entity_id:t,asym_id:n,seq_id_begin:r,seq_id_end:i}){const o={};for(let s=0;s<e;s++){const a=t.value(s),c=n.value(s);o[a]||(o[a]={}),o[a][c]||(o[a][c]={});const u=o[a][c],l=r.value(s),d=i.value(s);for(let f=l;f<=d;f++)u[f]=s}return o}const cy={chainKey:[],entityKey:[],findSequenceKey:()=>-1,findChainKey:()=>-1,getEntityFromChain:()=>-1,count:0,entity_id:Ce.Undefined(0,Ce.Schema.str),asym_id:Ce.Undefined(0,Ce.Schema.str),seq_id_begin:Ce.Undefined(0,Ce.Schema.int),seq_id_end:Ce.Undefined(0,Ce.Schema.int),chainElementSegments:mt.create([]),polymerRanges:Nt.ofSortedRanges([]),gapRanges:Nt.ofSortedRanges([])};var Cf;(function(e){e.Empty={isDefined:!1,spheres:cy,gaussians:cy,index:fw}})(Cf||(Cf={}));function hw(e,t,n){if(e.has(t))return e.get(t);const r=n.index++;return e.set(t,r),r}function mw(e,t){if(e.has(t))return e.get(t);const n=new Map;return e.set(t,n),n}function pw(e,t,n){const r=e.getEntityIndex;return{findChainKey:(s,a)=>{const c=r(s);if(c<0)return-1;const u=t.get(c);return u.has(a)?u.get(a):-1},findSequenceKey:(s,a,c)=>{const u=r(s);if(u<0)return-1;const l=t.get(u);if(l===void 0)return-1;const d=l.get(a);if(d===void 0)return-1;const f=n.get(d),{elementIndices:h,seqRanges:p}=f,m=Nt.firstIntersectionIndex(p,Re.ofSingleton(c));return m!==-1?h[m]:-1}}}function _w(e){throw new Error(`Missing entity entry for entity id '${e}'.`)}function uy(e,t){const{entity_id:n,asym_id:r,seq_id_begin:i,seq_id_end:o,count:s,chainElementSegments:a}=e,c=new Map,u=new Map,l={index:0},d=new Int32Array(s),f=new Int32Array(s),h=new Int32Array(a.count);for(let g=0;g<s;g++)f[g]=t.getEntityIndex(n.value(g)),f[g]<0&&_w(n.value(g));for(let g=0;g<a.count;g++){const b=a.offsets[g],v=a.offsets[g+1],_=f[b];h[g]=_;const A=mw(u,_),C=hw(A,r.value(b),l);for(let R=b;R<v;R++)d[R]=C;const I=[],S=[];for(let R=b;R<v;R++){const M=i.value(R),P=o.value(R);I.push(R),S.push(M,P)}const w={elementIndices:I,seqRanges:Nt.ofSortedRanges(S)};c.set(C,w)}const{findChainKey:p,findSequenceKey:m}=pw(t,u,c);return{chainKey:d,entityKey:f,findSequenceKey:m,findChainKey:p,getEntityFromChain:g=>h[g]}}function ly(e,t){const n=[],r=[],i=mt.transientSegments(e.chainElementSegments,pe.ofBounds(0,e.count)),{seq_id_begin:o,seq_id_end:s}=e;for(;i.hasNext;){const{start:a,end:c}=i.move();let u=-1,l=-1;for(let d=a;d<c;++d){const f=s.value(d);d===a?(u=d,l=s.value(d)):o.value(d)-l>1&&(n.push(u,d-1),r.push(d-1,d),u=d),d===c-1&&n.push(u,d),l=f}}return{polymerRanges:Nt.ofSortedRanges(n),gapRanges:Nt.ofSortedRanges(r)}}et.atom_site.label_comp_id,et.atom_site.label_seq_id,et.atom_site.pdbx_PDB_ins_code,et.atom_site.label_asym_id,et.atom_site.label_entity_id,et.atom_site.auth_atom_id,et.atom_site.auth_seq_id,et.atom_site.auth_asym_id,{...et.chem_comp_bond,molstar_protonation_variant:Ce.Schema.Str()};const yw={...et.chem_comp,type:Ce.Schema.Aliased(Ce.Schema.str)};function gw(e,t){const{ihm_model_group:n,ihm_model_group_link:r}=t,i=At.pickRow(r,o=>r.model_id.value(o)===e);if(i){const o=At.pickRow(n,s=>n.id.value(s)===i.group_id);if(o)return o.name}return""}function fy(e){for(let t=0,n=e.rowCount;t<n;t++)if(e.valueKind(t)===0)return!0;return!1}function To(e,t,n){(!e[t].isDefined||!fy(e[t]))&&(e[t]=e[n]),(!e[n].isDefined||!fy(e[n]))&&(e[n]=e[t])}function bw(e){const t=At.ofColumns(e._schema,e);return To(t,"label_atom_id","auth_atom_id"),To(t,"label_comp_id","auth_comp_id"),To(t,"label_seq_id","auth_seq_id"),To(t,"label_asym_id","auth_asym_id"),To(t,"label_entity_id","label_asym_id"),t}const Kr={entry:et.entry,struct:et.struct,struct_asym:et.struct_asym,ihm_model_list:et.ihm_model_list,ihm_model_group:et.ihm_model_group,ihm_model_group_link:et.ihm_model_group_link,entity:et.entity,entity_poly:et.entity_poly,entity_poly_seq:et.entity_poly_seq,pdbx_entity_branch:et.pdbx_entity_branch,chem_comp:yw,pdbx_chem_comp_identifier:et.pdbx_chem_comp_identifier,atom_site:et.atom_site,ihm_sphere_obj_site:et.ihm_sphere_obj_site,ihm_gaussian_obj_site:et.ihm_gaussian_obj_site,pdbx_unobs_or_zero_occ_residues:et.pdbx_unobs_or_zero_occ_residues,pdbx_molecule:et.pdbx_molecule};function dy(e,t=!1){const n=Object.create(null);for(const r of Object.keys(Kr))r in e?n[r]=e[r]:n[r]=At.ofUndefinedColumns(Kr[r],0);return t&&(n.atom_site=bw(n.atom_site)),n}const hy={hierarchy:Cf.Empty,conformation:void 0};function vw(e,t){const{ihm_sphere_obj_site:n,ihm_gaussian_obj_site:r}=e;if(n._rowCount===0&&r._rowCount===0)return hy;const i=my(n),o=xw(n),s=uy(i,e.entities),a=ly(i),c=my(r),u=Aw(r),l=uy(c,e.entities),d=ly(c);return{hierarchy:{isDefined:!0,spheres:{...i,...s,...a},gaussians:{...c,...l,...d},index:uw({spheres:i,gaussians:c})},conformation:{id:ln.create22(),spheres:o,gaussians:u}}}function xw(e){return{x:e.Cartn_x.toArray({array:Float32Array}),y:e.Cartn_y.toArray({array:Float32Array}),z:e.Cartn_z.toArray({array:Float32Array}),radius:e.object_radius.toArray({array:Float32Array}),rmsf:e.rmsf.toArray({array:Float32Array})}}function Aw(e){const t=Kr.ihm_gaussian_obj_site.covariance_matrix.space,n=[],{covariance_matrix:r}=e;for(let i=0,o=r.rowCount;i<o;i++)n[i]=er.toMat3(Mn(),t,r.value(i));return{x:e.mean_Cartn_x.toArray({array:Float32Array}),y:e.mean_Cartn_y.toArray({array:Float32Array}),z:e.mean_Cartn_z.toArray({array:Float32Array}),weight:e.weight.toArray({array:Float32Array}),covariance_matrix:n}}function Sw(e,t,n){const r=[0];for(let i=1,o=e.rowCount;i<o;i++)!e.areValuesEqual(i-1,i)&&(r[r.length]=i);return{chainElementSegments:mt.ofOffsets(r,pe.ofBounds(0,e.rowCount))}}function my(e){const{entity_id:t,seq_id_begin:n,seq_id_end:r,asym_id:i}=e;return{count:t.rowCount,entity_id:t,asym_id:i,seq_id_begin:n,seq_id_end:r,...Sw(i)}}function py(e,t,n,r){if(!e.entity_poly_seq||!e.entity_poly_seq._rowCount)return gf.fromHierarchy(t,n,r);const{entity_id:i,num:o,mon_id:s}=e.entity_poly_seq,a={},c=[],u=i.rowCount;let l=0;for(;l<u;){const d=l;for(;l<u-1&&i.areValuesEqual(l,l+1);)l++;l++;const f=i.value(d),h=Ce.window(s,d,l),p=Ce.window(o,d,l),m=t.getEntityIndex(f);a[m]={entityId:f,sequence:Do.ofResidueNames(h,p)},c.push(a[m])}return{byEntityKey:a,sequences:c}}async function _y(e,t,n,r){const i=bl(n,r-1),{label_entity_id:o,label_asym_id:s,label_seq_id:a}=t,c=gl(i,o.value);e.shouldUpdate&&await e.update();for(let u=0,l=c.length-1;u<l;u++){const d=gl(i,s.value,{start:c[u],end:c[u+1]});for(let f=0,h=d.length-1;f<h;f++){const p=d[f];a.valueKind(p)===0&&(gl(i,a.value,{sort:!0,start:p,end:d[f+1]}),e.shouldUpdate&&await e.update())}e.shouldUpdate&&await e.update()}return aA(i)&&i.length===t._rowCount?{atom_site:t,sourceIndex:Ce.ofIntArray(i)}:{atom_site:At.view(t,t._schema,i),sourceIndex:Ce.ofIntArray(i)}}function yy(e,t,n,r,i){const{polymerType:o,traceElementIndex:s,directionFromElementIndex:a,directionToElementIndex:c}=i.residue,u=o[e],l=o[t];if(u===0||l===0||s[e]===-1||s[t]===-1)return!1;let d=r.findAtomsOnResidue(e,zr(u,"backboneStart")),f=r.findAtomsOnResidue(t,zr(l,"backboneEnd"));(d===-1||f===-1)&&(d=r.findAtomsOnResidue(e,zr(u,"coarseBackbone")),f=r.findAtomsOnResidue(t,zr(l,"coarseBackbone")));const{x:h,y:p,z:m}=n,y=O.create(h[d],p[d],m[d]),g=O.create(h[f],p[f],m[f]),b=a[e]===-1||c[e]===-1||a[t]===-1||c[t]===-1;return O.distance(y,g)<(b?10:3)}function gy(e,t,n,r){const i=[],o=[],s=new Map,a=mt.transientSegments(e.chainAtomSegments,pe.ofBounds(0,e.atoms._rowCount)),c=mt.transientSegments(e.residueAtomSegments,pe.ofBounds(0,e.atoms._rowCount)),{index:u,derived:l}=e,{label_seq_id:d}=e.residues,{label_entity_id:f}=e.chains,{moleculeType:h,traceElementIndex:p}=l.residue;let m,y,g,b;for(;a.hasNext;){const v=a.move();c.setSegment(v),m=-1,y=-1,g=-1,b=-1;const _=t.getEntityIndex(f.value(v.index)),A=r.byEntityKey[_],C=A?A.sequence.seqId.value(A.sequence.seqId.rowCount-1):-1,I=e.residueAtomSegments.index[v.start],S=e.residueAtomSegments.index[v.end-1],w=d.value(I),R=d.value(S);for(w===1&&R===C&&n.xyzDefined&&yy(I,S,n,u,l)&&(s.set(I,S),s.set(S,I));c.hasNext;){const M=c.move(),P=M.index,E=d.value(P);if($l(h[P])&&p[P]!==-1)if(b!==-1)if(E!==m+1)i.push(b,g-1),o.push(y,M.end-1),b=M.start;else if(!c.hasNext)i.push(b,M.end-1);else{const N=e.residueAtomSegments.index[M.start],q=e.residueAtomSegments.index[g-1];n.xyzDefined&&!yy(N,q,n,e.index,l)&&(i.push(b,g-1),o.push(y,M.end-1),b=M.start)}else b=M.start;else b!==-1&&(i.push(b,g-1),b=-1);y=M.start,g=M.end,m=E}}return{polymerRanges:Nt.ofSortedRanges(i),gapRanges:Nt.ofSortedRanges(o),cyclicPolymerMap:s}}function Cw(e){const t=new Map,n=(i,o,s)=>`${i}|${o}|${s}`,r=e.pdbx_unobs_or_zero_occ_residues;for(let i=0,o=r._rowCount;i<o;++i){const s=n(r.PDB_model_num.value(i),r.label_asym_id.value(i),r.label_seq_id.value(i));t.set(s,{polymer_flag:r.polymer_flag.value(i),occupancy_flag:r.occupancy_flag.value(i)})}return{has:(i,o,s)=>t.has(n(i,o,s)),get:(i,o,s)=>t.get(n(i,o,s)),size:t.size}}function Iw(e){const t=new Map;if(e.chem_comp._rowCount>0){const{id:n}=e.chem_comp;for(let r=0,i=n.rowCount;r<i;++r)t.set(n.value(r),At.getRow(e.chem_comp,r))}else by(e).forEach(r=>{t.set(r,K5(r))});return t}function ww(e){const t=new Map;if(e.pdbx_chem_comp_identifier._rowCount>0){const{comp_id:n,type:r,identifier:i}=e.pdbx_chem_comp_identifier;for(let o=0,s=n.rowCount;o<s;++o)if(r.value(o)==="SNFG CARBOHYDRATE SYMBOL"||r.value(o)==="SNFG CARB SYMBOL"){const a=i.value(o),c=M5.get(a);c?t.set(n.value(o),c):console.warn(`Unknown SNFG name '${a}'`)}}if(e.chem_comp._rowCount>0){const{id:n,type:r}=e.chem_comp;for(let i=0,o=n.rowCount;i<o;++i){const s=n.value(i);if(t.has(s))continue;const a=r.value(i);Ur.has(s)?t.set(s,Ur.get(s)):Kl(a,s)===9&&t.set(s,Hl)}}else{const n=by(e);Ur.forEach((r,i)=>{!t.has(i)&&n.has(i)&&t.set(i,r)})}return t}const by=a2(e=>{const t=new Set,{label_comp_id:n,auth_comp_id:r}=e.atom_site,i=n.isDefined?n:r;for(let o=0,s=i.rowCount;o<s;++o)t.add(i.value(o));return t});function vy(e,t){const n=new Map,{auth_asym_id:r,label_asym_id:i,label_entity_id:o}=e.chains;for(let s=0,a=e.chains._rowCount;s<a;s++){const c=i.value(s);n.set(c,{id:c,auth_id:r.value(s),entity_id:o.value(s)})}if(t!=null&&t.struct_asym._rowCount){const{id:s,entity_id:a}=t.struct_asym;for(let c=0,u=s.rowCount;c<u;++c){const l=s.value(c);n.has(l)||n.set(l,{id:l,auth_id:"",entity_id:a.value(c)})}}return n}const Pw=Ce.Schema.Aliased(Ce.Schema.Str());function xy(e){let t;if(e.entity.id.isDefined)t=e.entity;else{const a=new Set,c=[],u=[],{label_entity_id:l,label_comp_id:d}=e.atom_site;for(let p=0,m=e.atom_site._rowCount;p<m;p++){const y=l.value(p);a.has(y)||(c.push(y),u.push($5(d.value(p))),a.add(y))}const{entity_id:f}=e.ihm_sphere_obj_site;for(let p=0,m=e.ihm_sphere_obj_site._rowCount;p<m;p++){const y=f.value(p);a.has(y)||(c.push(y),u.push("polymer"),a.add(y))}const{entity_id:h}=e.ihm_gaussian_obj_site;for(let p=0,m=e.ihm_gaussian_obj_site._rowCount;p<m;p++){const y=h.value(p);a.has(y)||(c.push(y),u.push("polymer"),a.add(y))}t=At.ofPartialColumns(Kr.entity,{id:Ce.ofArray({array:c,schema:Kr.entity.id}),type:Ce.ofArray({array:u,schema:Kr.entity.type})},c.length)}const n=Ce.createIndexer(t.id),r=new Array(t._rowCount);r.fill("other");const i=new Set;let o=!1;if(e.entity_poly&&e.entity_poly.type.isDefined){const{entity_id:a,type:c,_rowCount:u}=e.entity_poly;for(let l=0;l<u;++l){const d=a.value(l);r[n(d)]=c.value(l),i.add(d)}}else o=!0;if(e.pdbx_entity_branch&&e.pdbx_entity_branch.entity_id.isDefined){const{entity_id:a,type:c,_rowCount:u}=e.pdbx_entity_branch;for(let l=0;l<u;++l){const d=a.value(l);r[n(d)]=c.value(l),i.add(d)}}else o=!0;if(i.size<r.length&&(o=!0),o){const a=new Map;if(e.chem_comp){const{id:c,type:u}=e.chem_comp;for(let l=0,d=e.chem_comp._rowCount;l<d;l++)a.set(c.value(l),u.value(l))}if(e.atom_site){const{label_entity_id:c,label_comp_id:u}=e.atom_site;for(let l=0,d=e.atom_site._rowCount;l<d;l++){const f=c.value(l);if(!i.has(f)){const h=u.value(l),p=a.get(h)||"other";r[n(f)]=Y5(h,p),i.add(f)}}}}const s=Ce.ofArray({array:r,schema:Pw});return{data:t,subtype:s,getEntityIndex:n}}function Ay(e,t,n){var r;if(!e.pdbx_molecule||!e.pdbx_molecule.prd_id.isDefined)return t;const i=new Array(t.data._rowCount);i.fill("");const{asym_id:o,prd_id:s,_rowCount:a}=e.pdbx_molecule;for(let u=0;u<a;++u){const l=o.value(u),d=(r=n.get(l))===null||r===void 0?void 0:r.entity_id;d!==void 0&&(i[t.getEntityIndex(d)]=s.value(u))}const c=Ce.ofArray({array:i,schema:Ce.Schema.str});return{...t,prd_id:c}}async function If(e,t,n){const r=Ew(e),i=e.ihm_model_list._rowCount>0?await Nw(n,e,r,t):await Dw(n,e,r,t);for(let o=0;o<i.length;o++)$t.TrajectoryInfo.set(i[o],{index:o,size:i.length});return new pf(i)}function Ew(e,t){return{missingResidues:Cw(e),chemicalComponentMap:Iw(e),saccharideComponentMap:ww(e)}}function Bw(e,t,n,r,i,o,s){const a=sy(t,n,r,i.chemicalComponentMap,o,s),c=t.pdbx_PDB_model_num.value(0);if(s&&a.sameAsPrevious)return{...s,id:ln.create22(),modelNum:c,atomicConformation:a.conformation,_dynamicPropertyData:Object.create(null)};const u=hy,l=py(e,r,a.hierarchy,u.hierarchy),d=gy(a.hierarchy,r,a.conformation,l),f=vy(a.hierarchy),h=e.entry.id.valueKind(0)===0?e.entry.id.value(0):o.name,p=[];return h&&p.push(h),e.struct.title.valueKind(0)===0&&p.push(e.struct.title.value(0)),{id:ln.create22(),entryId:h,label:p.join(" | "),entry:h,sourceData:o,modelNum:c,parent:void 0,entities:Ay(e,r,f),sequence:l,atomicHierarchy:a.hierarchy,atomicConformation:a.conformation,atomicRanges:d,atomicChainOperatorMappinng:a.chainOperatorMapping,coarseHierarchy:u.hierarchy,coarseConformation:u.conformation,properties:{...i,structAsymMap:f},customProperties:new xs,_staticPropertyData:Object.create(null),_dynamicPropertyData:Object.create(null)}}function Rw(e,t,n,r){const i=sy(t.atom_site,t.atom_site_sourceIndex,t.entities,n.chemicalComponentMap,r),o=vw(t,n.chemicalComponentMap),s=py(e,t.entities,i.hierarchy,o.hierarchy),a=gy(i.hierarchy,t.entities,i.conformation,s),c=e.entry.id.valueKind(0)===0?e.entry.id.value(0):r.name,u=[];c&&u.push(c),e.struct.title.valueKind(0)===0&&u.push(e.struct.title.value(0)),t.model_name&&u.push(t.model_name),t.model_group_name&&u.push(t.model_group_name);const l=vy(i.hierarchy,e);return{id:ln.create22(),entryId:c,label:u.join(" | "),entry:c,sourceData:r,modelNum:t.model_id,parent:void 0,entities:Ay(e,t.entities,l),sequence:s,atomicHierarchy:i.hierarchy,atomicConformation:i.conformation,atomicRanges:a,atomicChainOperatorMappinng:i.chainOperatorMapping,coarseHierarchy:o.hierarchy,coarseConformation:o.conformation,properties:{...n,structAsymMap:l},customProperties:new xs,_staticPropertyData:Object.create(null),_dynamicPropertyData:Object.create(null)}}function Sy(e,t){const n=e.rowCount;if(!e.isDefined)return n;let r=t+1;for(;r<n&&e.areValuesEqual(t,r);)r++;return r}async function Dw(e,t,n,r){const i=[];if(t.atom_site){const o=t.atom_site.id.rowCount,s=xy(t);let a=0;for(;a<o;){const c=Sy(t.atom_site.pdbx_PDB_model_num,a),{atom_site:u,sourceIndex:l}=await _y(e,t.atom_site,a,c),d=Bw(t,u,l,s,n,r,i.length>0?i[i.length-1]:void 0);i.push(d),a=c}}return i}function wf(e,t){const n=new Map,r=e._rowCount;let i=0;for(;i<r;){const o=Sy(t,i),s=t.value(i);n.set(s,{table:At.window(e,e._schema,i,o),start:i,end:o}),i=o}return n}async function Nw(e,t,n,r){const i=xy(t),o=t.atom_site.ihm_model_id.isDefined?t.atom_site.ihm_model_id:t.atom_site.pdbx_PDB_model_num,s=wf(t.atom_site,o),a=wf(t.ihm_sphere_obj_site,t.ihm_sphere_obj_site.model_id),c=wf(t.ihm_gaussian_obj_site,t.ihm_gaussian_obj_site.model_id),u=[];if(t.ihm_model_list){const{model_id:l,model_name:d}=t.ihm_model_list;for(let f=0;f<t.ihm_model_list._rowCount;f++){const h=l.value(f);let p,m;if(s.has(h)){const b=s.get(h),{atom_site:v,sourceIndex:_}=await _y(e,t.atom_site,b.start,b.end);p=v,m=_}else p=At.window(t.atom_site,t.atom_site._schema,0,0),m=Ce.ofIntArray([]);const y={model_id:h,model_name:d.value(f),model_group_name:gw(h,t),entities:i,atom_site:p,atom_site_sourceIndex:m,ihm_sphere_obj_site:a.has(h)?a.get(h).table:At.window(t.ihm_sphere_obj_site,t.ihm_sphere_obj_site._schema,0,0),ihm_gaussian_obj_site:c.has(h)?c.get(h).table:At.window(t.ihm_gaussian_obj_site,t.ihm_gaussian_obj_site._schema,0,0)},g=Rw(t,y,n,r);u.push(g)}}return u}var $t;(function(e){function t($,ne){const de=[],{frames:_e}=ne,X=n($),ce=g($),k=$.atomicHierarchy.atoms._rowCount;for(let B=0,F=_e.length;B<F;++B){const re=_e[B];if(re.elementCount!==k)throw new Error(`Frame element count mismatch, got ${re.elementCount} but expected ${k}.`);const G={...$,id:ln.create22(),modelNum:B,atomicConformation:o($,re),customProperties:new xs,_staticPropertyData:Object.create(null),_dynamicPropertyData:Object.create(null)};if(re.cell){const V=Sn.fromCell(re.cell.size,re.cell.anglesInRadians);Sn.Provider.set(G,V)}e.TrajectoryInfo.set(G,{index:B,size:_e.length}),e.CoarseGrained.set(G,ce),de.push(G)}return{trajectory:de,srcIndexArray:X}}function n($){const ne=$.atomicHierarchy.atomSourceIndex;let de;return"__srcIndexArray__"in $._staticPropertyData?de=$._dynamicPropertyData.__srcIndexArray__:(de=Ce.isIdentity(ne)?void 0:ne.toArray({array:Int32Array}),$._dynamicPropertyData.__srcIndexArray__=de),de}function r($,ne){return new pf(t($,ne).trajectory)}e.trajectoryFromModelAndCoordinates=r;function i($,ne){return Zt.create("Create Trajectory",async de=>{const _e=await If($.basic,$.sourceData,de);if(_e.frameCount===0)throw new Error("found no model");const X=_e.representative,{trajectory:ce}=t(X,ne),k={pairs:$.bonds,count:X.atomicHierarchy.atoms._rowCount},B=xn.fromData(k),F=g(X);let re=0;for(const G of ce)xn.Provider.set(G,B),e.TrajectoryInfo.set(G,{index:re++,size:ce.length}),e.CoarseGrained.set(G,F);return new pf(ce)})}e.trajectoryFromTopologyAndCoordinates=i;function o($,ne){return Rl.getAtomicConformation(ne,{atomId:$.atomicConformation.atomId,occupancy:$.atomicConformation.occupancy,B_iso_or_equiv:$.atomicConformation.B_iso_or_equiv},n($))}e.getAtomicConformationFromFrame=o;const s="__Center__";function a($){if($._dynamicPropertyData[s])return $._dynamicPropertyData[s];const ne=cA($.atomicConformation,$.coarseConformation);return $._dynamicPropertyData[s]=ne,ne}e.getCenter=a;function c($){const ne=new Int32Array($.rowCount);let de=!1;for(let _e=0,X=$.rowCount;_e<X;_e++){const ce=$.value(_e);ce!==_e&&(de=!1),ne[ce]=_e}return{isIdentity:de,invertedIndex:ne}}const u="__InvertedAtomSrcIndex__";function l($){if($._staticPropertyData[u])return $._staticPropertyData[u];const ne=c($.atomicHierarchy.atomSourceIndex);return $._staticPropertyData[u]=ne,ne}e.getInvertedAtomSourceIndex=l;const d="__TrajectoryInfo__";e.TrajectoryInfo={get($){return $._dynamicPropertyData[d]||{index:0,size:1}},set($,ne){return $._dynamicPropertyData[d]=ne}};const f="__AsymIdCount__";e.AsymIdCount={get($){if($._dynamicPropertyData[f])return $._dynamicPropertyData[f];const ne=uA($);return $._dynamicPropertyData[f]=ne,ne}},e.AsymIdOffset=Ki.createSimple("asym_id_offset","static"),e.Index=Ki.createSimple("index","static"),e.MaxIndex=Ki.createSimple("max_index","static");function h($){return $.parent||$}e.getRoot=h;function p($,ne){return $.atomicHierarchy===ne.atomicHierarchy&&$.coarseHierarchy===ne.coarseHierarchy}e.areHierarchiesEqual=p;const m="__CoordinatesHistory__";e.CoordinatesHistory={get($){return $._staticPropertyData[m]},set($,ne){return $._staticPropertyData[m]=ne}};const y="__CoarseGrained__";e.CoarseGrained={get($){return $._staticPropertyData[y]},set($,ne){return $._staticPropertyData[y]=ne}};function g($){let ne=e.CoarseGrained.get($);if(ne===void 0){let de=0,_e=0;const{polymerType:X,directionToElementIndex:ce}=$.atomicHierarchy.derived.residue;for(let G=0;G<X.length;++G)X[G]!==0&&(de+=1,ce[G]!==-1&&(_e+=1));let k=!1,B=!1;const{label_atom_id:F,_rowCount:re}=$.atomicHierarchy.atoms;for(let G=0;G<re;++G){const V=F.value(G);if(!k&&V==="BB"&&(k=!0),!B&&V==="SC1"&&(B=!0),k&&B)break}ne=!1,re>0&&de>0&&(k&&B||re/de<3||_e===0)&&(ne=!0),e.CoarseGrained.set($,ne)}return ne}e.isCoarseGrained=g;function b($){return $.properties.saccharideComponentMap.size>0}e.hasCarbohydrate=b;function v($){const{subtype:ne}=$.entities;for(let de=0,_e=ne.rowCount;de<_e;++de)if(ne.value(de).startsWith("polypeptide"))return!0;return!1}e.hasProtein=v;function _($){const{subtype:ne}=$.entities;for(let de=0,_e=ne.rowCount;de<_e;++de){const X=ne.value(de);if(X.endsWith("ribonucleotide hybrid")||X.endsWith("ribonucleotide"))return!0}return!1}e.hasNucleic=_;function A($){if(!Ct.is($.sourceData))return!1;const{db:ne}=$.sourceData.data;for(let de=0,_e=ne.database_2.database_id.rowCount;de<_e;++de)if(ne.database_2.database_id.value(de)==="pdb")return!0;return!1}e.isFromPdbArchive=A;function C($){return Ct.is($.sourceData)?$.entryId.match(/^[1-9][a-z0-9]{3,3}$/i)!==null||$.entryId.match(/^pdb_[0-9]{4,4}[1-9][a-z0-9]{3,3}$/i)!==null:!1}e.hasPdbId=C;function I($){if(Ct.is($.sourceData)){const{db:ne}=$.sourceData.data;return ne.struct_conf.id.isDefined||ne.struct_sheet_range.id.isDefined}else return di.Provider.isApplicable($)}e.hasSecondaryStructure=I;const S=O.create(1.5707963,1.5707963,1.5707963),w=O.create(1,1,1);function R($){var ne;const de=(ne=Sn.Provider.get($))===null||ne===void 0?void 0:ne.spacegroup;return!!de&&!(de.num===1&&O.equals(de.cell.anglesInRadians,S)&&O.equals(de.cell.size,w))}e.hasCrystalSymmetry=R;function M($){if(!Ct.is($.sourceData))return!1;const{db:ne}=$.sourceData.data;for(let de=0;de<ne.exptl.method.rowCount;de++)if(ne.exptl.method.value(de).toUpperCase().indexOf("DIFFRACTION")>=0)return!0;return!1}e.isFromXray=M;function P($){if(!Ct.is($.sourceData))return!1;const{db:ne}=$.sourceData.data;for(let de=0;de<ne.exptl.method.rowCount;de++)if(ne.exptl.method.value(de).toUpperCase().indexOf("MICROSCOPY")>=0)return!0;return!1}e.isFromEm=P;function E($){if(!Ct.is($.sourceData))return!1;const{db:ne}=$.sourceData.data;for(let de=0;de<ne.exptl.method.rowCount;de++)if(ne.exptl.method.value(de).toUpperCase().indexOf("NMR")>=0)return!0;return!1}e.isFromNmr=E;function N($){if(!Ct.is($.sourceData))return!1;const{db:ne}=$.sourceData.data;for(let de=0;de<ne.struct.pdbx_structure_determination_methodology.rowCount;de++)if(ne.struct.pdbx_structure_determination_methodology.value(de).toLowerCase()==="experimental")return!0;return!1}e.isExperimental=N;function q($){if(!Ct.is($.sourceData))return!1;const{db:ne}=$.sourceData.data;for(let de=0;de<ne.struct.pdbx_structure_determination_methodology.rowCount;de++)if(ne.struct.pdbx_structure_determination_methodology.value(de).toLowerCase()==="integrative")return!0;return!1}e.isIntegrative=q;function j($){if(!Ct.is($.sourceData))return!1;const{db:ne}=$.sourceData.data;for(let de=0;de<ne.struct.pdbx_structure_determination_methodology.rowCount;de++)if(ne.struct.pdbx_structure_determination_methodology.value(de).toLowerCase()==="computational")return!0;return!1}e.isComputational=j;function z($){if(!Ct.is($.sourceData)||!M($))return!1;const{db:ne}=$.sourceData.data,{status_code_sf:de}=ne.pdbx_database_status;return de.isDefined&&de.value(0)==="REL"}e.hasXrayMap=z;function W($){if(!Ct.is($.sourceData))return!1;const{db:ne}=$.sourceData.data,{db_name:de,content_type:_e}=ne.pdbx_database_related;for(let X=0,ce=ne.pdbx_database_related._rowCount;X<ce;++X)if(de.value(X).toUpperCase()==="EMDB"&&_e.value(X)==="associated EM volume")return!0;return!1}e.hasEmMap=W;function se($){return Ct.is($.sourceData)?z($)||W($):!1}e.hasDensityMap=se;function ue($){if(!Ct.is($.sourceData))return!1;const{db:ne}=$.sourceData.data;return se($)||C($)&&(!ne.exptl.method.isDefined||M($)&&(!ne.pdbx_database_status.status_code_sf.isDefined||ne.pdbx_database_status.status_code_sf.valueKind(0)===2)||P($)&&!ne.pdbx_database_related.db_name.isDefined)}e.probablyHasDensityMap=ue})($t||($t={}));const Mw={U:et.atom_site_anisotrop.U,U_esd:et.atom_site_anisotrop.U_esd};var Oo;(function(e){e.Schema=Mw,e.Descriptor={name:"atom_site_anisotrop",cifExport:{prefix:"",categories:[{name:"atom_site_anisotrop",instance(r){return!e.Provider.get(r.firstModel)||!Ct.is(r.firstModel.sourceData)?nn.Category.Empty:nn.Category.ofTable(r.firstModel.sourceData.data.db.atom_site_anisotrop)}}]}},e.Provider=sr.create(e.Descriptor);function t(r,i){const o=new Int32Array(r.rowCount);o.fill(-1);for(let a=0,c=r.rowCount;a<c;a++)o[r.value(a)]=a;const s=new Int32Array(r.rowCount);s.fill(-1);for(let a=0,c=i.rowCount;a<c;++a){const u=o[i.value(a)];u!==-1&&(s[u]=a)}return s}e.getElementToAnsiotrop=t;function n(r,i){const o={};for(let a=0,c=r.rowCount;a<c;a++)o[r.value(a)]=a;const s=new Int32Array(r.rowCount);s.fill(-1);for(let a=0,c=i.rowCount;a<c;++a){const u=o[i.value(a)];u!==void 0&&(s[u]=a)}return s}e.getElementToAnsiotropFromLabel=n})(Oo||(Oo={}));var ko;(function(e){const t="molstar_global_model_transform_info";e.Schema={[t]:{matrix:Ce.Schema.Matrix(4,4,Ce.Schema.float)}},e.Descriptor=ri({name:t,cifExport:{categories:[{name:t,instance(a){const c=r(a.firstModel);if(!c)return nn.Category.Empty;const u=At.ofRows(e.Schema.molstar_global_model_transform_info,[{matrix:c}]);return nn.Category.ofTable(u)}}],prefix:"molstar"}}),e.Provider=sr.create(e.Descriptor);function n(a,c){a.customProperties.has(e.Descriptor)||a.customProperties.add(e.Descriptor),e.Provider.set(a,c)}e.attach=n;function r(a){return e.Provider.get(a)}e.get=r;function i(a){if(!Ct.is(a.sourceData))return;const c=a.sourceData.data.frame.categories[t];if(!c)return;const u=Ux(e.Schema[t],c);if(u._rowCount!==0)return u.matrix.value(0)}e.fromMmCif=i;function o(a){if(!Ct.is(a.sourceData))return!1;const c=a.sourceData.data.frame.categories[t];return!!c&&c.rowCount>0}e.hasData=o;function s(a,c){a.writeCategory({name:t,instance(){const u=At.ofRows(e.Schema.molstar_global_model_transform_info,[{matrix:c}]);return nn.Category.ofTable(u)}})}e.writeMmCif=s})(ko||(ko={}));class Tw{constructor(){this.count=0,this.ids=[],this.types=[],this.descriptions=[],this.compoundsMap=new Map,this.namesMap=new Map,this.heteroMap=new Map,this.chainMap=new Map}set(t,n){this.count+=1,this.ids.push(`${this.count}`),this.types.push(t),this.descriptions.push([n])}getEntityId(t,n,r,i){return n===2?(this.waterId===void 0&&(this.set("water",(i==null?void 0:i.customName)||"Water"),this.waterId=`${this.count}`),this.waterId):$l(n)?this.compoundsMap.has(r)?this.compoundsMap.get(r):(this.chainMap.has(r)||(this.set("polymer",(i==null?void 0:i.customName)||`Polymer ${this.chainMap.size+1}`),this.chainMap.set(r,`${this.count}`)),this.chainMap.get(r)):(this.heteroMap.has(t)||(this.set("non-polymer",(i==null?void 0:i.customName)||this.namesMap.get(t)||t),this.heteroMap.set(t,`${this.count}`)),this.heteroMap.get(t))}getEntityTable(){return At.ofPartialColumns(Kr.entity,{id:Ce.ofStringArray(this.ids),type:Ce.ofStringAliasArray(this.types),pdbx_description:Ce.ofStringListArray(this.descriptions)},this.count)}setCompounds(t){for(let n=0,r=t.length;n<r;++n){const{chains:i,description:o}=t[n];this.set("polymer",o);for(let s=0,a=i.length;s<a;++s)this.compoundsMap.set(i[s],`${this.count}`)}}setNames(t){t.forEach(n=>this.namesMap.set(n[0],n[1]))}}const Ow=[new Set(["CA"]),new Set(["C"]),new Set(["N"])],kw=[new Set(["P","O3'","O3*"]),new Set(["C4'","C4*"]),new Set(["O2'","O2*","F2'","F2*"])],qw=[new Set(["P","O3'","O3*"]),new Set(["C3'","C3*"]),new Set(["O2'","O2*","F2'","F2*"])],Uw=new Set(["FMN","NCN","FNS","FMA","ATP","ADP","AMP","GTP","GDP","GMP","LIG"]),Cy=function(){const e=new Map;return[{id:"HIS",name:"HISTIDINE",type:"l-peptide linking"},{id:"ARG",name:"ARGININE",type:"l-peptide linking"},{id:"LYS",name:"LYSINE",type:"l-peptide linking"},{id:"ILE",name:"ISOLEUCINE",type:"l-peptide linking"},{id:"PHE",name:"PHENYLALANINE",type:"l-peptide linking"},{id:"LEU",name:"LEUCINE",type:"l-peptide linking"},{id:"TRP",name:"TRYPTOPHAN",type:"l-peptide linking"},{id:"ALA",name:"ALANINE",type:"l-peptide linking"},{id:"MET",name:"METHIONINE",type:"l-peptide linking"},{id:"CYS",name:"CYSTEINE",type:"l-peptide linking"},{id:"ASN",name:"ASPARAGINE",type:"l-peptide linking"},{id:"VAL",name:"VALINE",type:"l-peptide linking"},{id:"GLY",name:"GLYCINE",type:"peptide linking"},{id:"SER",name:"SERINE",type:"l-peptide linking"},{id:"GLN",name:"GLUTAMINE",type:"l-peptide linking"},{id:"TYR",name:"TYROSINE",type:"l-peptide linking"},{id:"ASP",name:"ASPARTIC ACID",type:"l-peptide linking"},{id:"GLU",name:"GLUTAMIC ACID",type:"l-peptide linking"},{id:"THR",name:"THREONINE",type:"l-peptide linking"},{id:"PRO",name:"PROLINE",type:"l-peptide linking"},{id:"SEC",name:"SELENOCYSTEINE",type:"l-peptide linking"},{id:"PYL",name:"PYRROLYSINE",type:"l-peptide linking"},{id:"MSE",name:"SELENOMETHIONINE",type:"l-peptide linking"},{id:"SEP",name:"PHOSPHOSERINE",type:"l-peptide linking"},{id:"TPO",name:"PHOSPHOTHREONINE",type:"l-peptide linking"},{id:"PTR",name:"O-PHOSPHOTYROSINE",type:"l-peptide linking"},{id:"PCA",name:"PYROGLUTAMIC ACID",type:"l-peptide linking"},{id:"A",name:"ADENOSINE-5'-MONOPHOSPHATE",type:"rna linking"},{id:"C",name:"CYTIDINE-5'-MONOPHOSPHATE",type:"rna linking"},{id:"T",name:"THYMIDINE-5'-MONOPHOSPHATE",type:"rna linking"},{id:"G",name:"GUANOSINE-5'-MONOPHOSPHATE",type:"rna linking"},{id:"I",name:"INOSINIC ACID",type:"rna linking"},{id:"U",name:"URIDINE-5'-MONOPHOSPHATE",type:"rna linking"},{id:"DA",name:"2'-DEOXYADENOSINE-5'-MONOPHOSPHATE",type:"dna linking"},{id:"DC",name:"2'-DEOXYCYTIDINE-5'-MONOPHOSPHATE",type:"dna linking"},{id:"DT",name:"THYMIDINE-5'-MONOPHOSPHATE",type:"dna linking"},{id:"DG",name:"2'-DEOXYGUANOSINE-5'-MONOPHOSPHATE",type:"dna linking"},{id:"DI",name:"2'-DEOXYINOSINE-5'-MONOPHOSPHATE",type:"dna linking"},{id:"DU",name:"2'-DEOXYURIDINE-5'-MONOPHOSPHATE",type:"dna linking"}].forEach(n=>e.set(n.id,n)),e}(),Iy=function(){const e=new Map;return[{id:"ZN2",name:"ZINC ION",type:"ion"},{id:"SOD",name:"SODIUM ION",type:"ion"},{id:"CES",name:"CESIUM ION",type:"ion"},{id:"CLA",name:"CHLORIDE ION",type:"ion"},{id:"CAL",name:"CALCIUM ION",type:"ion"},{id:"POT",name:"POTASSIUM ION",type:"ion"}].forEach(n=>e.set(n.id,n)),e}();class Fw{set(t){this.comps.set(t.id,t),this.ids.push(t.id),this.names.push(t.name),this.types.push(t.type),this.mon_nstd_flags.push(Vl.has(t.id)?"y":"n")}getAtomIds(t){const n=new Set,r=this.seqId.value(t);for(;t<this.seqId.rowCount&&this.seqId.value(t)===r;)n.add(this.atomId.value(t)),t+=1;return n}hasAtomIds(t,n){for(let r=0,i=n.length;r<i;++r)if(!Fr.areIntersecting(t,n[r]))return!1;return!0}getType(t){return this.hasAtomIds(t,Ow)?"peptide linking":this.hasAtomIds(t,kw)?"rna linking":this.hasAtomIds(t,qw)?"dna linking":"other"}has(t){return this.comps.has(t)}get(t){return this.comps.get(t)}add(t,n){if(!this.has(t))if(Cy.has(t))this.set(Cy.get(t));else if(jl.has(t))this.set({id:t,name:"WATER",type:"non-polymer"});else if(Uw.has(t.toUpperCase()))this.set({id:t,name:this.namesMap.get(t)||t,type:"non-polymer"});else if(Ur.has(t.toUpperCase()))this.set({id:t,name:this.namesMap.get(t)||t,type:"saccharide"});else{const r=this.getAtomIds(n);if(r.size===1&&Iy.has(t))this.set(Iy.get(t));else{const i=this.getType(r);this.set({id:t,name:this.namesMap.get(t)||t,type:i})}}return this.get(t)}getChemCompTable(){return At.ofPartialColumns(Kr.chem_comp,{id:Ce.ofStringArray(this.ids),name:Ce.ofStringArray(this.names),type:Ce.ofStringAliasArray(this.types),mon_nstd_flag:Ce.ofStringAliasArray(this.mon_nstd_flags)},this.ids.length)}setNames(t){t.forEach(n=>this.namesMap.set(n[0],n[1]))}constructor(t,n){this.seqId=t,this.atomId=n,this.namesMap=new Map,this.comps=new Map,this.ids=[],this.names=[],this.types=[],this.mon_nstd_flags=[]}}function Lw(e){if(Ct.is(e.sourceData))return Sn.fromData(e.sourceData.data.db)}Sn.Provider.formatRegistry.add("mmCIF",Lw);function Gw(e){if(!Ct.is(e.sourceData))return;const{struct_conf:t,struct_sheet_range:n}=e.sourceData.data.db;return di.fromStruct(t,n,e.atomicHierarchy)}di.Provider.formatRegistry.add("mmCIF",Gw);function Hw(e){if(!Ct.is(e.sourceData))return;const{atom_site_anisotrop:t}=e.sourceData.data.db,n=At.ofColumns(Oo.Schema,t),r=Oo.getElementToAnsiotrop(e.atomicConformation.atomId,t.id);return{data:n,elementToAnsiotrop:r}}function jw(e){return Ct.is(e.sourceData)?e.sourceData.data.db.atom_site_anisotrop.U.isDefined:!1}Oo.Provider.formatRegistry.add("mmCIF",Hw,jw);function zw(e){if(!Ct.is(e.sourceData))return;const{chem_comp_bond:t}=e.sourceData.data.db;if(t._rowCount!==0)return{data:t,entries:Po.getEntriesFromChemCompBond(t)}}Po.Provider.formatRegistry.add("mmCIF",zw);function Vw(e){if(!Ct.is(e.sourceData))return;const{struct_conn:t}=e.sourceData.data.db;if(t._rowCount===0)return;const n=Yn.getEntriesFromStructConn(t,e),r=new Set;for(const i of n)r.add(ho(i.partnerA.residueIndex,i.partnerB.residueIndex));return{data:t,byAtomIndex:Yn.getAtomIndexFromEntries(n),residueCantorPairs:r,entries:n}}Yn.Provider.formatRegistry.add("mmCIF",Vw),ko.Provider.formatRegistry.add("mmCIF",ko.fromMmCif,ko.hasData);var Ct;(function(e){function t(r){return(r==null?void 0:r.kind)==="mmCIF"}e.is=t;function n(r,i,o,s){return i||(i=El.schema.mmCIF(r)),{kind:"mmCIF",name:i._name,data:{db:i,file:s,frame:r,source:o}}}e.fromFrame=n})(Ct||(Ct={}));function Kw(e,t){const n=Ct.fromFrame(e,void 0,void 0,t),r=dy(n.data.db,!0);return Zt.create("Create mmCIF Model",i=>If(r,n,i))}var wy;(function(e){const t="__CcdCoordinateType__";e.CoordinateType={get(i){return i._staticPropertyData[t]},set(i,o){return i._staticPropertyData[t]=o}};function n(i){return(i==null?void 0:i.kind)==="CCD"}e.is=n;function r(i,o){return o||(o=El.schema.CCD(i)),{kind:"CCD",name:o._name,data:{db:o,frame:i}}}e.fromFrame=r})(wy||(wy={}));function $w(e,t){const n=(o,s)=>(t.substr(o,s)||"").trim(),r={entry_id:Ae.ofString(e),length_a:Ae.ofString(n(6,9)),length_b:Ae.ofString(n(15,9)),length_c:Ae.ofString(n(24,9)),angle_alpha:Ae.ofString(n(33,7)),angle_beta:Ae.ofString(n(40,7)),angle_gamma:Ae.ofString(n(47,7)),Z_PDB:Ae.ofString(n(66,4)),pdbx_unique_axis:Ae.ofString("?")},i={entry_id:Ae.ofString(e),"space_group_name_H-M":Ae.ofString(n(55,11)),Int_Tables_number:Ae.ofString("?"),cell_setting:Ae.ofString("?"),space_group_name_Hall:Ae.ofString("?")};return[tn.ofFields("cell",r),tn.ofFields("symmetry",i)]}function Py(e,t){return{id:e,details:t,groups:[]}}function Yw(e,t,n){const r=[];let i,o,s,a=1,c=1;const u=m=>e.data.substring(e.indices[2*m],e.indices[2*m+1]);for(let m=t;m<n;m++){let y=u(m);if(y.substr(11,12)==="BIOMOLECULE:"){const g=y.substr(23).trim();let b=`Biomolecule ${g}`;y=u(m+1),y.substr(11,30)!=="APPLY THE FOLLOWING TO CHAINS:"&&(m++,b=y.substr(11).trim()),i=Py(g,b),r.push(i)}else if(y.substr(13,5)==="BIOMT"){const g=y.split(/\s+/),b=parseInt(y[18])-1;b===0&&(s=Oe.identity(),o.operators.push({id:a++,matrix:s})),Oe.setValue(s,b,0,parseFloat(g[4])),Oe.setValue(s,b,1,parseFloat(g[5])),Oe.setValue(s,b,2,parseFloat(g[6])),Oe.setValue(s,b,3,parseFloat(g[7]))}else if(y.substr(11,30)==="APPLY THE FOLLOWING TO CHAINS:"||y.substr(11,30)==="                   AND CHAINS:"){y.substr(11,5)==="APPLY"&&(o={chains:[],operators:[]},i.groups.push(o));const g=y.substr(41,30).split(",");for(let b=0,v=g.length;b<v;++b){const _=g[b].trim();_&&o.chains.push(_)}}else if(y.substr(11,33)==="APPLYING THE FOLLOWING TO CHAINS:"){i=Py(`${c}`,`Biomolecule ${c}`),r.push(i),c+=1,o={chains:[],operators:[]},i.groups.push(o),m++,y=u(m);const g=y.substr(11,69).split(",");for(let b=0,v=g.length;b<v;++b){const _=g[b].trim();_&&o.chains.push(_)}}}if(r.length===0)return[];const l={id:Ae.ofStrings(r.map(m=>m.id)),details:Ae.ofStrings(r.map(m=>m.details))},d=[];for(const m of r)for(const y of m.groups)d.push({assembly_id:m.id,oper_expression:y.operators.map(g=>g.id).join(","),asym_id_list:y.chains.join(",")});const f={assembly_id:Ae.ofStrings(d.map(m=>m.assembly_id)),oper_expression:Ae.ofStrings(d.map(m=>m.oper_expression)),asym_id_list:Ae.ofStrings(d.map(m=>m.asym_id_list))},h=[];for(const m of r)for(const y of m.groups)for(const g of y.operators){const b={id:""+g.id,type:"?",name:"?",symmetry_operation:"?"};for(let v=0;v<3;v++){for(let _=0;_<3;_++)b[`matrix[${v+1}][${_+1}]`]=""+Oe.getValue(g.matrix,v,_);b[`vector[${v+1}]`]=""+Oe.getValue(g.matrix,v,3)}h.push(b)}const p={id:Ae.ofStrings(h.map(m=>m.id)),type:Ae.ofStrings(h.map(m=>m.type)),name:Ae.ofStrings(h.map(m=>m.name)),symmetry_operation:Ae.ofStrings(h.map(m=>m.symmetry_operation))};for(let m=0;m<3;m++){for(let g=0;g<3;g++){const b=`matrix[${m+1}][${g+1}]`;p[b]=Ae.ofStrings(h.map(v=>v[b]))}const y=`vector[${m+1}]`;p[y]=Ae.ofStrings(h.map(g=>g[y]))}return[tn.ofFields("pdbx_struct_assembly",l),tn.ofFields("pdbx_struct_assembly_gen",f),tn.ofFields("pdbx_struct_oper_list",p)]}function Ww(e,t,n){const r=[];let i;const o=u=>e.data.substring(e.indices[2*u],e.indices[2*u+1]);for(let u=t;u<n;u++){const l=o(u),d=l.split(/\s+/),f=parseInt(l[5])-1;f===0&&(i=Oe.identity(),r.push(i)),Oe.setValue(i,f,0,parseFloat(d[2])),Oe.setValue(i,f,1,parseFloat(d[3])),Oe.setValue(i,f,2,parseFloat(d[4])),Oe.setValue(i,f,3,parseFloat(d[5]))}if(r.length===0)return[];const s=[];let a=1;for(const u of r){const l={id:"ncsop"+a++,code:".",details:"."};for(let d=0;d<3;d++){for(let f=0;f<3;f++)l[`matrix[${d+1}][${f+1}]`]=""+Oe.getValue(u,d,f);l[`vector[${d+1}]`]=""+Oe.getValue(u,d,3)}s.push(l)}const c={id:Ae.ofStrings(s.map(u=>u.id)),code:Ae.ofStrings(s.map(u=>u.code)),details:Ae.ofStrings(s.map(u=>u.details))};for(let u=0;u<3;u++){for(let d=0;d<3;d++){const f=`matrix[${u+1}][${d+1}]`;c[f]=Ae.ofStrings(s.map(h=>h[f]))}const l=`vector[${u+1}]`;c[l]=Ae.ofStrings(s.map(d=>d[l]))}return[tn.ofFields("struct_ncs_oper",c)]}const Zw={1:"helx_rh_al_p",2:"helx_rh_om_p",3:"helx_rh_pi_p",4:"helx_rh_ga_p",5:"helx_rh_3t_p",6:"helx_lh_al_p",7:"helx_lh_om_p",8:"helx_lh_ga_p",9:"helx_rh_27_p",10:"helx_rh_pp_p"};function Xw(e){return Zw[e]||"helx_p"}function Qw(e,t,n){const r=[],i=l=>e.data.substring(e.indices[2*l],e.indices[2*l+1]);for(let l=t;l<n;l++){const d=i(l);r.push({serNum:d.substr(7,3).trim(),helixID:d.substr(11,3).trim(),initResName:d.substr(15,3).trim(),initChainID:d.substr(19,1).trim(),initSeqNum:d.substr(21,4).trim(),initICode:d.substr(25,1).trim(),endResName:d.substr(27,3).trim(),endChainID:d.substr(31,3).trim(),endSeqNum:d.substr(33,4).trim(),endICode:d.substr(37,1).trim(),helixClass:d.substr(38,2).trim(),comment:d.substr(40,30).trim(),length:d.substr(71,5).trim()})}const o=Ae.ofStrings(r.map(l=>l.initChainID)),s=Ae.ofStrings(r.map(l=>l.initResName)),a=Ae.ofStrings(r.map(l=>l.endChainID)),c=Ae.ofStrings(r.map(l=>l.endResName)),u={beg_label_asym_id:o,beg_label_comp_id:s,beg_label_seq_id:Ae.ofUndefined(r.length,Ce.Schema.int),beg_auth_asym_id:o,beg_auth_comp_id:s,beg_auth_seq_id:Ae.ofStrings(r.map(l=>l.initSeqNum)),conf_type_id:Ae.ofStrings(r.map(l=>Xw(l.helixClass))),details:Ae.ofStrings(r.map(l=>l.comment)),end_label_asym_id:a,end_label_comp_id:c,end_label_seq_id:Ae.ofUndefined(r.length,Ce.Schema.int),end_auth_asym_id:a,end_auth_comp_id:c,end_auth_seq_id:Ae.ofStrings(r.map(l=>l.endSeqNum)),id:Ae.ofStrings(r.map(l=>l.serNum)),pdbx_beg_PDB_ins_code:Ae.ofStrings(r.map(l=>l.initICode)),pdbx_end_PDB_ins_code:Ae.ofStrings(r.map(l=>l.endICode)),pdbx_PDB_helix_class:Ae.ofStrings(r.map(l=>l.helixClass)),pdbx_PDB_helix_length:Ae.ofStrings(r.map(l=>l.length)),pdbx_PDB_helix_id:Ae.ofStrings(r.map(l=>l.helixID))};return tn.ofFields("struct_conf",u)}function Jw(e,t,n){const r=[],i=f=>e.data.substring(e.indices[2*f],e.indices[2*f+1]);for(let f=t;f<n;f++){const h=i(f);r.push({strand:h.substr(7,3).trim(),sheetID:h.substr(11,3).trim(),numStrands:h.substr(14,2).trim(),initResName:h.substr(17,3).trim(),initChainID:h.substr(21,1).trim(),initSeqNum:h.substr(22,4).trim(),initICode:h.substr(26,1).trim(),endResName:h.substr(28,3).trim(),endChainID:h.substr(32,1).trim(),endSeqNum:h.substr(33,4).trim(),endICode:h.substr(37,1).trim(),sense:h.substr(38,2).trim(),curAtom:h.substr(41,4).trim(),curResName:h.substr(45,3).trim(),curChainId:h.substr(49,1).trim(),curResSeq:h.substr(50,4).trim(),curICode:h.substr(54,1).trim(),prevAtom:h.substr(56,4).trim(),prevResName:h.substr(60,3).trim(),prevChainId:h.substr(64,1).trim(),prevResSeq:h.substr(65,4).trim(),prevICode:h.substr(69,1).trim()})}const o=Ae.ofStrings(r.map(f=>f.initChainID)),s=Ae.ofStrings(r.map(f=>f.initResName)),a=Ae.ofStrings(r.map(f=>f.initSeqNum)),c=Ae.ofStrings(r.map(f=>f.endChainID)),u=Ae.ofStrings(r.map(f=>f.endResName)),l=Ae.ofStrings(r.map(f=>f.endSeqNum)),d={beg_label_asym_id:o,beg_label_comp_id:s,beg_label_seq_id:a,beg_auth_asym_id:o,beg_auth_comp_id:s,beg_auth_seq_id:a,end_label_asym_id:c,end_label_comp_id:c,end_label_seq_id:l,end_auth_asym_id:c,end_auth_comp_id:u,end_auth_seq_id:l,id:Ae.ofStrings(r.map(f=>f.strand)),sheet_id:Ae.ofStrings(r.map(f=>f.sheetID)),pdbx_beg_PDB_ins_code:Ae.ofStrings(r.map(f=>f.initICode)),pdbx_end_PDB_ins_code:Ae.ofStrings(r.map(f=>f.endICode))};return tn.ofFields("struct_sheet_range",d)}const eP={MOL_ID:"",MOLECULE:"",CHAIN:"",FRAGMENT:"",SYNONYM:"",EC:"",ENGINEERED:"",MUTATION:"",OTHER_DETAILS:""};function tP(e,t,n){const r=c=>e.data.substring(e.indices[2*c],e.indices[2*c+1]);let i,o={chains:[],description:""};const s=[];for(let c=t;c<n;c++){const l=r(c).substr(10,70).trim(),d=l.indexOf(":"),f=l.substring(0,d);let h;f in eP?(i=f,h=l.substring(d+2)):h=l,h=h.replace(/;$/,""),i==="MOL_ID"?(o={chains:[],description:""},s.push(o)):i==="MOLECULE"?(o.description&&(o.description+=" "),o.description+=h):i==="CHAIN"&&Array.prototype.push.apply(o.chains,h.split(/\s*,\s*/))}const a=[];for(const c of s)for(const u of c.chains)a.push({description:c.description,chains:[u]});return a}function nP(e,t,n){const r=o=>e.data.substring(e.indices[2*o],e.indices[2*o+1]),i=new Map;for(let o=t;o<n;o++){const s=r(o),a=s.substr(11,3).trim(),c=s.substr(15).trim();i.has(a)?i.set(a,`${i.get(a)} ${c}`):i.set(a,c)}return i}function Ks(e,t,n,r){let i=n,o=r-1,s=t.charCodeAt(i);for(;(s===32||s>=48&&s<=57)&&i<=o;)s=t.charCodeAt(++i);for(s=t.charCodeAt(o);(s===32||s>=48&&s<=57)&&o>=i;)s=t.charCodeAt(--o);if(++o,i===o||i+1===o)return at.add(e,i,o);if(s=t.charCodeAt(i),i+2===o){const a=t.charCodeAt(i+1);if((s===78||s===110)&&(a===65||a===97)||(s===67||s===99)&&(a===76||a===108)||(s===70||s===102)&&(a===69||a===101)||(s===83||s===115)&&(a===73||a===105)||(s===66||s===98)&&(a===82||a===114)||(s===65||s===97)&&(a===83||a===115))return at.add(e,i,i+2)}if(s===67||s===99||s===72||s===104||s===78||s===110||s===79||s===111||s===80||s===112||s===83||s===115)return at.add(e,i,i+1);at.add(e,i,i)}function rP(e,t){const n=()=>[],r=()=>at.create(e,2*t);return{index:0,group_PDB:r(),id:n(),auth_atom_id:r(),label_alt_id:r(),auth_comp_id:r(),auth_asym_id:r(),auth_seq_id:r(),pdbx_PDB_ins_code:r(),Cartn_x:r(),Cartn_y:r(),Cartn_z:r(),occupancy:r(),B_iso_or_equiv:r(),type_symbol:r(),pdbx_PDB_model_num:n(),label_entity_id:n(),partial_charge:r()}}class iP{constructor(t,n,r,i){this.asymIds=t,this.modelNums=n,this.terIndices=r,this.hasAssemblies=i,this.asymIdCounts=new Map,this.currModelNum=void 0,this.currAsymId="",this.currLabelAsymId=""}clear(){this.asymIdCounts.clear(),this.currModelNum=void 0}get(t){const n=this.asymIds.value(t);if(this.hasAssemblies)return n;const r=this.modelNums[t];if(r!==this.currModelNum?(this.asymIdCounts.clear(),this.currModelNum=r,this.currLabelAsymId=n):this.currAsymId!==n&&(this.currAsymId=n,this.currLabelAsymId=n),this.asymIdCounts.has(n)){if(this.terIndices.has(t)){const i=this.asymIdCounts.get(n)+1;this.asymIdCounts.set(n,i),this.currLabelAsymId=`${n}_${i}`}}else this.asymIdCounts.set(n,0);return this.currLabelAsymId}}function oP(e,t,n){t.clear();const r=Ae.ofStrings(e.pdbx_PDB_model_num),i=Ae.ofTokens(e.auth_asym_id),o=Ae.ofTokens(e.auth_seq_id),s=Ae.ofTokens(e.pdbx_PDB_ins_code),a=Ae.ofTokens(e.auth_atom_id),c=Ae.ofTokens(e.auth_comp_id),u=Ae.ofStrings(e.id);let l=r.str(0),d=i.str(0),f=o.int(0),h=s.str(0),p=f;const m=new Map,y=new Map,g=[],b=[],v=[];let _=!1;for(let S=0,w=u.rowCount;S<w;++S)if(s.str(S)!==""){_=!0;break}for(let S=0,w=u.rowCount;S<w;++S){const R=r.str(S),M=i.str(S),P=o.int(S),E=s.str(S);let N=a.str(S);if(R!==l?(m.clear(),y.clear(),l=R,d=M,f=P,h=E,p=P):d!==M?(y.clear(),d=M,f=P,h=E,p=P):f!==P?(y.clear(),f===p?p=P:p+=1,f=P,h=E):h!==E&&(y.clear(),h=E,p+=1),g[S]=t.get(S),y.has(N)){const q=y.get(N)+1;y.set(N,q),N=`${N}_${q}`}else y.set(N,0);b[S]=N,_&&(v[S]=p)}const A=Ce.ofStringArray(g),C=Ce.ofStringArray(b),I=_?Ae.ofColumn(Ce.ofIntArray(v)):Ae.ofUndefined(e.index,Ce.Schema.int);return{auth_asym_id:i,auth_atom_id:a,auth_comp_id:c,auth_seq_id:o,B_iso_or_equiv:Ae.ofTokens(e.B_iso_or_equiv),Cartn_x:Ae.ofTokens(e.Cartn_x),Cartn_y:Ae.ofTokens(e.Cartn_y),Cartn_z:Ae.ofTokens(e.Cartn_z),group_PDB:Ae.ofTokens(e.group_PDB),id:u,label_alt_id:Ae.ofTokens(e.label_alt_id),label_asym_id:Ae.ofColumn(A),label_atom_id:Ae.ofColumn(C),label_comp_id:c,label_seq_id:I,label_entity_id:Ae.ofStrings(e.label_entity_id),occupancy:dv(e.occupancy)?Ae.ofUndefined(e.index,Ce.Schema.float):Ae.ofTokens(e.occupancy),type_symbol:Ae.ofTokens(e.type_symbol),pdbx_PDB_ins_code:Ae.ofTokens(e.pdbx_PDB_ins_code),pdbx_PDB_model_num:r,partial_charge:Ae.ofTokens(e.partial_charge)}}function Ey(e,t,n,r,i,o){const{data:s}=n,a=i-r;at.addToken(e.group_PDB,zt.trim(n,r,r+6)),zt.trim(n,r+6,r+11),e.id[e.index]=n.data.substring(n.tokenStart,n.tokenEnd),at.addToken(e.auth_atom_id,zt.trim(n,r+12,r+16)),s.charCodeAt(r+16)===32?at.add(e.label_alt_id,0,0):at.add(e.label_alt_id,r+16,r+17),at.addToken(e.auth_comp_id,zt.trim(n,r+17,r+20)),at.add(e.auth_asym_id,r+21,r+22),at.addToken(e.auth_seq_id,zt.trim(n,r+22,r+26)),s.charCodeAt(r+26)===32?at.add(e.pdbx_PDB_ins_code,0,0):at.add(e.pdbx_PDB_ins_code,r+26,r+27),at.addToken(e.Cartn_x,zt.trim(n,r+30,r+38)),at.addToken(e.Cartn_y,zt.trim(n,r+38,r+46)),at.addToken(e.Cartn_z,zt.trim(n,r+46,r+54)),at.addToken(e.occupancy,zt.trim(n,r+54,r+60)),a>=66?at.addToken(e.B_iso_or_equiv,zt.trim(n,r+60,r+66)):at.add(e.B_iso_or_equiv,0,0),o&&at.addToken(e.partial_charge,zt.trim(n,r+70,r+76)),a>=78&&!o?(zt.trim(n,r+76,r+78),n.tokenStart<n.tokenEnd?at.addToken(e.type_symbol,n):Ks(e.type_symbol,s,r+12,r+16)):Ks(e.type_symbol,s,r+12,r+16),e.pdbx_PDB_model_num[e.index]=t,e.index++}function sP(e,t){const n=()=>[],r=()=>new Float32Array(t),i=()=>at.create(e,2*t);return{index:0,count:t,id:n(),type_symbol:i(),pdbx_label_atom_id:i(),pdbx_label_alt_id:i(),pdbx_label_comp_id:i(),pdbx_label_asym_id:i(),pdbx_label_seq_id:i(),pdbx_PDB_ins_code:i(),"U[1][1]":r(),"U[2][2]":r(),"U[3][3]":r(),"U[1][2]":r(),"U[1][3]":r(),"U[2][3]":r(),pdbx_auth_seq_id:i(),pdbx_auth_comp_id:i(),pdbx_auth_asym_id:i(),pdbx_auth_atom_id:i()}}function aP(e){const t=Ae.ofTokens(e.pdbx_auth_seq_id),n=Ae.ofTokens(e.pdbx_auth_comp_id),r=Ae.ofTokens(e.pdbx_auth_asym_id),i=Ae.ofTokens(e.pdbx_auth_atom_id),o={id:Ae.ofStrings(e.id),type_symbol:Ae.ofTokens(e.type_symbol),pdbx_label_atom_id:i,pdbx_label_alt_id:Ae.ofTokens(e.pdbx_label_alt_id),pdbx_label_comp_id:n,pdbx_label_asym_id:r,pdbx_label_seq_id:t,pdbx_PDB_ins_code:Ae.ofTokens(e.pdbx_PDB_ins_code),pdbx_auth_seq_id:t,pdbx_auth_comp_id:n,pdbx_auth_asym_id:r,pdbx_auth_atom_id:i};return o["U[1][1]"]=Ae.ofNumbers(e["U[1][1]"]),o["U[2][2]"]=Ae.ofNumbers(e["U[2][2]"]),o["U[3][3]"]=Ae.ofNumbers(e["U[3][3]"]),o["U[1][2]"]=Ae.ofNumbers(e["U[1][2]"]),o["U[1][3]"]=Ae.ofNumbers(e["U[1][3]"]),o["U[2][3]"]=Ae.ofNumbers(e["U[2][3]"]),o}function cP(e,t,n,r,i){const{data:o}=n,s=i-r;zt.trim(n,r+6,r+11),e.id[e.index]=o.substring(n.tokenStart,n.tokenEnd),at.addToken(e.pdbx_auth_atom_id,zt.trim(n,r+12,r+16)),o.charCodeAt(r+16)===32?at.add(e.pdbx_label_alt_id,0,0):at.add(e.pdbx_label_alt_id,r+16,r+17),at.addToken(e.pdbx_auth_comp_id,zt.trim(n,r+17,r+20)),at.add(e.pdbx_auth_asym_id,r+21,r+22),at.addToken(e.pdbx_auth_seq_id,zt.trim(n,r+22,r+26)),o.charCodeAt(r+26)===32?at.add(e.pdbx_PDB_ins_code,0,0):at.add(e.pdbx_PDB_ins_code,r+26,r+27),e["U[1][1]"][e.index]=Di(o,r+28,r+35)/1e4,e["U[2][2]"][e.index]=Di(o,r+35,r+42)/1e4,e["U[3][3]"][e.index]=Di(o,r+42,r+49)/1e4,e["U[1][2]"][e.index]=Di(o,r+49,r+56)/1e4,e["U[1][3]"][e.index]=Di(o,r+56,r+63)/1e4,e["U[2][3]"][e.index]=Di(o,r+63,r+70)/1e4,s>=78?(zt.trim(n,r+76,r+78),n.tokenStart<n.tokenEnd?at.addToken(e.type_symbol,n):Ks(e.type_symbol,o,r+12,r+16)):Ks(e.type_symbol,o,r+12,r+16),e.index++}function uP(e,t,n,r){const i={};for(let I=0,S=r.id.rowCount;I<S;++I)i[r.id.str(I)]=I;const o=I=>e.data.substring(e.indices[2*I],e.indices[2*I+1]),s=[],a=[],c=[],u=[],l=[],d=[],f=[],h=[],p=[],m=[],y=[],g=[],b=[],v=[],_=[11,16,21,26];let A=1;for(let I=t;I<n;I++){const S=o(I),w=i[parseInt(S.substr(6,5))],R={};if(w!==void 0)for(let M=0;M<4;++M){const P=parseInt(S.substr(_[M],5));if(Number.isNaN(P))continue;const E=i[P];E!==void 0&&(w>E||R[E]===void 0&&(s.push(`covale${A}`),a.push("covale"),c.push(r.label_asym_id.str(w)),u.push(r.label_seq_id.int(w)),l.push(r.auth_seq_id.int(w)),d.push(r.label_atom_id.str(w)),f.push(r.label_alt_id.str(w)),h.push(r.pdbx_PDB_ins_code.str(w)),p.push(r.label_asym_id.str(E)),m.push(r.label_seq_id.int(E)),y.push(r.auth_seq_id.int(E)),g.push(r.label_atom_id.str(E)),b.push(r.label_alt_id.str(E)),v.push(r.pdbx_PDB_ins_code.str(E)),A+=1))}}const C={id:Ae.ofStrings(s),conn_type_id:Ae.ofStrings(a),ptnr1_label_asym_id:Ae.ofStrings(c),ptnr1_label_seq_id:Ae.ofNumbers(u),ptnr1_auth_seq_id:Ae.ofNumbers(l),ptnr1_label_atom_id:Ae.ofStrings(d),pdbx_ptnr1_label_alt_id:Ae.ofStrings(f),pdbx_ptnr1_PDB_ins_code:Ae.ofStrings(h),ptnr2_label_asym_id:Ae.ofStrings(p),ptnr2_label_seq_id:Ae.ofNumbers(m),ptnr2_auth_seq_id:Ae.ofNumbers(y),ptnr2_label_atom_id:Ae.ofStrings(g),pdbx_ptnr2_label_alt_id:Ae.ofStrings(b),pdbx_ptnr2_PDB_ins_code:Ae.ofStrings(v)};return tn.ofFields("struct_conn",C)}function lP(e,t,n,r){const i=e.substring(t,n);r.id_code=i.substring(62,66).trim()||void 0,r.dep_date=i.substring(50,59).trim()||void 0,r.classification=i.substring(10,50).trim()||void 0}async function fP(e){const{lines:t}=e,{data:n,indices:r}=t,i=zt(n),o=!!e.isPdbqt;let s=0,a=0;for(let M=0,P=t.count;M<P;M++){const E=r[2*M],N=r[2*M+1];switch(n[E]){case"A":Ut(n,E,N,"ATOM  ")?s++:Ut(n,E,N,"ANISOU")&&a++;break;case"H":Ut(n,E,N,"HETATM")&&s++;break}}const c={},u=rP(n,s),l=sP(n,a),d=new Tw,f=[],h=[];let p=0,m="",y,g=!1;const b=new Set;for(let M=0,P=t.count;M<P;M++){let E=r[2*M],N=r[2*M+1];switch(n[E]){case"A":Ut(n,E,N,"ATOM  ")?(p||(p++,m=""+p),Ey(u,m,i,E,N,o)):Ut(n,E,N,"ANISOU")&&cP(l,m,i,E,N);break;case"C":if(Ut(n,E,N,"CRYST1"))f.push(...$w(e.id||"?",n.substring(E,N)));else if(Ut(n,E,N,"CONECT")){let q=M+1;for(;E=r[2*q],N=r[2*q+1],!!Ut(n,E,N,"CONECT");)q++;y?xv&&console.log("only single CONECT block allowed, ignoring others"):y=[M,q],M=q-1}else if(Ut(n,E,N,"COMPND")){let q=M+1;for(;E=r[2*q],N=r[2*q+1],!!Ut(n,E,N,"COMPND");)q++;d.setCompounds(tP(t,M,q)),M=q-1}break;case"H":if(Ut(n,E,N,"HEADER"))lP(n,E,N,c);else if(Ut(n,E,N,"HETATM"))p||(p++,m=""+p),Ey(u,m,i,E,N,o);else if(Ut(n,E,N,"HELIX")){let q=M+1;for(;E=r[2*q],N=r[2*q+1],!!Ut(n,E,N,"HELIX");)q++;f.push(Qw(t,M,q)),M=q-1}else if(Ut(n,E,N,"HETNAM")){let q=M+1;for(;E=r[2*q],N=r[2*q+1],!!Ut(n,E,N,"HETNAM");)q++;h.push(...Array.from(nP(t,M,q).entries())),M=q-1}break;case"M":if(Ut(n,E,N,"MODEL ")&&(p++,m=""+p),Ut(n,E,N,"MTRIX")){let q=M+1;for(;E=r[2*q],N=r[2*q+1],!!Ut(n,E,N,"MTRIX");)q++;f.push(...Ww(t,M,q)),M=q-1}break;case"O":break;case"R":if(Ut(n,E,N,"REMARK 350")){let q=M+1;for(;E=r[2*q],N=r[2*q+1],!!Ut(n,E,N,"REMARK 350");)q++;f.push(...Yw(t,M,q)),M=q-1,g=!0}break;case"S":if(Ut(n,E,N,"SHEET")){let q=M+1;for(;E=r[2*q],N=r[2*q+1],!!Ut(n,E,N,"SHEET");)q++;f.push(Jw(t,M,q)),M=q-1}break;case"T":Ut(n,E,N,"TER")&&b.add(u.index)}}if(c.id_code){const M={id:Ae.ofString(c.id_code)};f.push(tn.ofFields("entry",M))}if(c.classification){const M={pdbx_keywords:Ae.ofString(c.classification)};f.push(tn.ofFields("struct_keywords",M))}if(c.dep_date){const M={recvd_initial_deposition_date:Ae.ofString(c.dep_date)};f.push(tn.ofFields("pdbx_database_status",M))}const v=Ce.ofIntTokens(u.auth_seq_id),_=Ce.ofStringTokens(u.auth_atom_id),A=Ce.ofStringTokens(u.auth_comp_id),C=Ce.ofStringTokens(u.auth_asym_id),I=new iP(C,u.pdbx_PDB_model_num,b,g),S=new Fw(v,_);S.setNames(h),d.setNames(h);for(let M=0,P=A.rowCount;M<P;++M){const E=A.value(M),N=Kl(S.add(E,M).type,E),q=I.get(M);u.label_entity_id[M]=d.getEntityId(E,N,q)}const w=oP(u,I);o||delete w.partial_charge,y&&f.push(uP(t,y[0],y[1],w));const R={entity:tn.ofTable("entity",d.getEntityTable()),chem_comp:tn.ofTable("chem_comp",S.getChemCompTable()),atom_site:tn.ofFields("atom_site",w),atom_site_anisotrop:tn.ofFields("atom_site_anisotrop",aP(l))};for(const M of f)R[M.name]=M;return{header:e.id||"PDB",categoryNames:Object.keys(R),categories:R}}var Pf;(function(e){e.Descriptor={name:"atom_partial_charge"},e.Provider=sr.create(e.Descriptor)})(Pf||(Pf={}));var Ef;(function(e){function t(r){return(r==null?void 0:r.kind)==="pdb"}e.is=t;function n(r){return{kind:"pdb",name:r.id||"",data:r}}e.create=n})(Ef||(Ef={}));function dP(e){return Zt.create("Parse PDB",async t=>{var n;await t.update("Converting to mmCIF");const r=await fP(e),i=Ct.fromFrame(r,void 0,Ef.create(e)),o=dy(i.data.db,!0),s=await If(o,i,t),a=(n=r.categories.atom_site)===null||n===void 0?void 0:n.getField("partial_charge");if(a&&s.frameCount===1){const c=s.representative,u=c.atomicHierarchy.atomSourceIndex,d=Ce.isIdentity(u)?void 0:u.toArray({array:Int32Array}),f=a.toFloatArray(),h=d?Ce.ofFloatArray(Ce.mapToArray(u,p=>f[p],Float32Array)):Ce.ofFloatArray(f);Pf.Provider.set(c,{data:h,type:"GASTEIGER"})}return s})}var By={},hP=function(e,t,n,r,i){var o=new Worker(By[t]||(By[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return o.onmessage=function(s){var a=s.data,c=a.$e$;if(c){var u=new Error(c[0]);u.code=c[1],u.stack=c[2],i(u,null)}else i(null,a)},o.postMessage(n,r),o},bn=Uint8Array,_i=Uint16Array,Ry=Int32Array,Bf=new bn([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Rf=new bn([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Dy=new bn([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Ny=function(e,t){for(var n=new _i(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var i=new Ry(n[30]),r=1;r<30;++r)for(var o=n[r];o<n[r+1];++o)i[o]=o-n[r]<<5|r;return{b:n,r:i}},My=Ny(Bf,2),Df=My.b,mP=My.r;Df[28]=258,mP[258]=28;for(var pP=Ny(Rf,0),Ty=pP.b,$s=new _i(32768),Ot=0;Ot<32768;++Ot){var $r=(Ot&43690)>>1|(Ot&21845)<<1;$r=($r&52428)>>2|($r&13107)<<2,$r=($r&61680)>>4|($r&3855)<<4,$s[Ot]=(($r&65280)>>8|($r&255)<<8)>>1}for(var Yi=function(e,t,n){for(var r=e.length,i=0,o=new _i(t);i<r;++i)e[i]&&++o[e[i]-1];var s=new _i(t);for(i=1;i<t;++i)s[i]=s[i-1]+o[i-1]<<1;var a;if(n){a=new _i(1<<t);var c=15-t;for(i=0;i<r;++i)if(e[i])for(var u=i<<4|e[i],l=t-e[i],d=s[e[i]-1]++<<l,f=d|(1<<l)-1;d<=f;++d)a[$s[d]>>c]=u}else for(a=new _i(r),i=0;i<r;++i)e[i]&&(a[i]=$s[s[e[i]-1]++]>>15-e[i]);return a},qo=new bn(288),Ot=0;Ot<144;++Ot)qo[Ot]=8;for(var Ot=144;Ot<256;++Ot)qo[Ot]=9;for(var Ot=256;Ot<280;++Ot)qo[Ot]=7;for(var Ot=280;Ot<288;++Ot)qo[Ot]=8;for(var Oy=new bn(32),Ot=0;Ot<32;++Ot)Oy[Ot]=5;var ky=Yi(qo,9,1),qy=Yi(Oy,5,1),Ys=function(e){for(var t=e[0],n=1;n<e.length;++n)e[n]>t&&(t=e[n]);return t},Ln=function(e,t,n){var r=t/8|0;return(e[r]|e[r+1]<<8)>>(t&7)&n},Ws=function(e,t){var n=t/8|0;return(e[n]|e[n+1]<<8|e[n+2]<<16)>>(t&7)},Uy=function(e){return(e+7)/8|0},Fy=function(e,t,n){return(t==null||t<0)&&(t=0),(n==null||n>e.length)&&(n=e.length),new bn(e.subarray(t,n))},Ly=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Rn=function(e,t,n){var r=new Error(t||Ly[e]);if(r.code=e,Error.captureStackTrace&&Error.captureStackTrace(r,Rn),!n)throw r;return r},Nf=function(e,t,n,r){var i=e.length,o=r?r.length:0;if(!i||t.f&&!t.l)return n||new bn(0);var s=!n,a=s||t.i!=2,c=t.i;s&&(n=new bn(i*3));var u=function(G){var V=n.length;if(G>V){var K=new bn(Math.max(V*2,G));K.set(n),n=K}},l=t.f||0,d=t.p||0,f=t.b||0,h=t.l,p=t.d,m=t.m,y=t.n,g=i*8;do{if(!h){l=Ln(e,d,1);var b=Ln(e,d+1,3);if(d+=3,b)if(b==1)h=ky,p=qy,m=9,y=5;else if(b==2){var C=Ln(e,d,31)+257,I=Ln(e,d+10,15)+4,S=C+Ln(e,d+5,31)+1;d+=14;for(var w=new bn(S),R=new bn(19),M=0;M<I;++M)R[Dy[M]]=Ln(e,d+M*3,7);d+=I*3;for(var P=Ys(R),E=(1<<P)-1,N=Yi(R,P,1),M=0;M<S;){var q=N[Ln(e,d,E)];d+=q&15;var v=q>>4;if(v<16)w[M++]=v;else{var j=0,z=0;for(v==16?(z=3+Ln(e,d,3),d+=2,j=w[M-1]):v==17?(z=3+Ln(e,d,7),d+=3):v==18&&(z=11+Ln(e,d,127),d+=7);z--;)w[M++]=j}}var W=w.subarray(0,C),se=w.subarray(C);m=Ys(W),y=Ys(se),h=Yi(W,m,1),p=Yi(se,y,1)}else Rn(1);else{var v=Uy(d)+4,_=e[v-4]|e[v-3]<<8,A=v+_;if(A>i){c&&Rn(0);break}a&&u(f+_),n.set(e.subarray(v,A),f),t.b=f+=_,t.p=d=A*8,t.f=l;continue}if(d>g){c&&Rn(0);break}}a&&u(f+131072);for(var ue=(1<<m)-1,$=(1<<y)-1,ne=d;;ne=d){var j=h[Ws(e,d)&ue],de=j>>4;if(d+=j&15,d>g){c&&Rn(0);break}if(j||Rn(2),de<256)n[f++]=de;else if(de==256){ne=d,h=null;break}else{var _e=de-254;if(de>264){var M=de-257,X=Bf[M];_e=Ln(e,d,(1<<X)-1)+Df[M],d+=X}var ce=p[Ws(e,d)&$],k=ce>>4;ce||Rn(3),d+=ce&15;var se=Ty[k];if(k>3){var X=Rf[k];se+=Ws(e,d)&(1<<X)-1,d+=X}if(d>g){c&&Rn(0);break}a&&u(f+131072);var B=f+_e;if(f<se){var F=o-se,re=Math.min(se,B);for(F+f<0&&Rn(3);f<re;++f)n[f]=r[F+f]}for(;f<B;++f)n[f]=n[f-se]}}t.l=h,t.p=ne,t.b=f,t.f=l,h&&(l=1,t.m=m,t.d=p,t.n=y)}while(!l);return f!=n.length&&s?Fy(n,0,f):n.subarray(0,f)},_P=new bn(0),yP=function(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n},Gy=function(e,t,n){for(var r=e(),i=e.toString(),o=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),s=0;s<r.length;++s){var a=r[s],c=o[s];if(typeof a=="function"){t+=";"+c+"=";var u=a.toString();if(a.prototype)if(u.indexOf("[native code]")!=-1){var l=u.indexOf(" ",8)+1;t+=u.slice(l,u.indexOf("(",l))}else{t+=u;for(var d in a.prototype)t+=";"+c+".prototype."+d+"="+a.prototype[d].toString()}else t+=u}else n[c]=a}return t},Zs=[],gP=function(e){var t=[];for(var n in e)e[n].buffer&&t.push((e[n]=new e[n].constructor(e[n])).buffer);return t},bP=function(e,t,n,r){if(!Zs[n]){for(var i="",o={},s=e.length-1,a=0;a<s;++a)i=Gy(e[a],i,o);Zs[n]={c:Gy(e[s],i,o),e:o}}var c=yP({},Zs[n].e);return hP(Zs[n].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",n,c,gP(c),r)},vP=function(){return[bn,_i,Ry,Bf,Rf,Dy,Df,Ty,ky,qy,$s,Ly,Yi,Ys,Ln,Ws,Uy,Fy,Rn,Nf,CP,Hy,AP]},xP=function(){return[jy,zy]},Hy=function(e){return postMessage(e,[e.buffer])},AP=function(e){return e&&{out:e.size&&new bn(e.size),dictionary:e.dictionary}},SP=function(e,t,n,r,i,o){var s=bP(n,r,i,function(a,c){s.terminate(),o(a,c)});return s.postMessage([e,t],t.consume?[e.buffer]:[]),function(){s.terminate()}},jy=function(e){(e[0]!=31||e[1]!=139||e[2]!=8)&&Rn(6,"invalid gzip data");var t=e[3],n=10;t&4&&(n+=(e[10]|e[11]<<8)+2);for(var r=(t>>3&1)+(t>>4&1);r>0;r-=!e[n++]);return n+(t&2)},zy=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0};function CP(e,t){return Nf(e,{i:2},t&&t.out,t&&t.dictionary)}function IP(e,t,n){return n||(n=t,t={}),typeof n!="function"&&Rn(7),SP(e,t,[vP,xP,function(){return[Vy]}],function(r){return Hy(Vy(r.data[0],r.data[1]))},3,n)}function Vy(e,t){var n=jy(e);return n+8>e.length&&Rn(6,"invalid gzip data"),Nf(e.subarray(n,-8),{i:2},t&&t.out||new bn(zy(e)),t&&t.dictionary)}var wP=typeof TextDecoder<"u"&&new TextDecoder,PP=0;try{wP.decode(_P,{stream:!0}),PP=1}catch{}const EP=[["mmCIF",{stringExtensions:["cif","mmcif","mcif"],binaryExtensions:["bcif"]}],["PDB",{stringExtensions:["pdb","ent"]}]];function BP(e){const t=e.endsWith(".gz");t&&(e=e.replace(/\.gz$/,""));for(const[n,{stringExtensions:r,binaryExtensions:i}]of EP){if(i!=null&&i.some(o=>e.endsWith(o)))return{isCompressed:t,type:n,isBinary:!0};if(r!=null&&r.some(o=>e.endsWith(o)))return{isCompressed:t,type:n,isBinary:!1}}}const Ky=e=>{const t=[];let n=NaN,r;for(const{name:i,position:o}of Object.values(e).toSorted((s,a)=>s.position-a.position)){const s=Ju(i);if(Number.isNaN(n)&&(n=o),r!==void 0){const a=o-r-1;a>0&&t.push("-".repeat(a))}r=o,t.push(s)}return{sequence:t.join(""),startPosition:n}};async function*$y(e,t){var n;for(let r=0;r<e.frameCount;r++){const i=await Zt.resolveInContext(e.getFrameAtIndex(r));if(!$t.hasProtein(i)||t.modelNums!==void 0&&!t.modelNums.includes(i.modelNum))continue;const{traceElementIndex:o}=i.atomicHierarchy.derived.residue,s=((n=Sn.Provider.get(i))==null?void 0:n.assemblies)??[],a=s.length>0?s==null?void 0:s.map(({id:u})=>u):[void 0],c=xt.ofModel(i);for(const u of a){if(t.assemblyIds!==void 0&&(u===void 0||!t.assemblyIds.includes(u)))continue;const l=u!==void 0?await Zt.resolveInContext(Vi.buildAssembly(c,u)):c,d=new Map,{moleculeType:f}=i.atomicHierarchy.derived.residue;xt.eachAtomicHierarchyElement(l,{chain:h=>{d.set(Ze.chainIndex(h),{label_asym_id:vt.chain.label_asym_id(h),auth_asym_id:vt.chain.auth_asym_id(h),label_entity_id:vt.chain.label_entity_id(h),residuesByIndex:new Map})},residue:h=>{const p=d.get(Ze.chainIndex(h));if(p===void 0)throw new Error("Chain not called before residue");const m=Ze.residueIndex(h);if(p.residuesByIndex.has(m))throw new Error("Residue called twice for the same index");if(!Yl(f[m]))return;const y=(()=>{const g=o[m];if(g===-1)return;const b=Ze.clone(h);return b.element=g,b})();p.residuesByIndex.set(m,{label_seq_id:vt.residue.label_seq_id(h),auth_seq_id:vt.residue.auth_seq_id(h),label_comp_id:vt.atom.label_comp_id(h),traceAtom:y?{id:vt.atom.id(y),label_comp_id:vt.atom.label_comp_id(y),label_atom_id:vt.atom.label_atom_id(y),x:vt.atom.x(y),y:vt.atom.y(y),z:vt.atom.z(y),B_iso_or_equiv:vt.atom.B_iso_or_equiv(y)}:void 0})}}),yield{metadata:{entryId:i.entryId,modelNum:i.modelNum,assemblyId:u,suffix:[e.frameCount>1&&(t.modelNums===void 0||t.modelNums.length>1)?i.modelNum.toString():void 0,a.length>1&&(t.assemblyIds===void 0||t.assemblyIds.length>1)?u:void 0].filter(h=>h!==void 0)},chains:d.values().filter(({residuesByIndex:h})=>h.size>0).flatMap(({label_entity_id:h,label_asym_id:p,residuesByIndex:m})=>{var v;const y=i.entities.getEntityIndex(h),g=(v=i.sequence.byEntityKey[y])==null?void 0:v.sequence;if((g==null?void 0:g.kind)!=="protein")return[];const b=Object.fromEntries(m.values().map(({auth_seq_id:_,label_comp_id:A,traceAtom:C})=>[_,{position:_,name:A,atoms:C?{[C.label_atom_id]:{id:C.id,name:C.label_atom_id,x:C.x,y:C.y,z:C.z,bfactor:C.B_iso_or_equiv}}:{}}]));return[{id:p,residues:b,...Ky(b)}]}).toArray()}}}}async function*RP(e,t){var r,i,o,s,a,c;const n=await Zt.resolveInContext(El.parse(e));if(n.isError)throw new Error(n.message);for(const u of n.result.blocks){const l=await Kw(u).run();for await(const d of $y(l,t)){const f=(i=(r=u.categories.pdbx_struct_mod_residue)==null?void 0:r.getField("auth_asym_id"))==null?void 0:i.str,h=(s=(o=u.categories.pdbx_struct_mod_residue)==null?void 0:o.getField("auth_seq_id"))==null?void 0:s.int,p=(c=(a=u.categories.pdbx_struct_mod_residue)==null?void 0:a.getField("parent_comp_id"))==null?void 0:c.str;if(f&&h&&p){for(let m=0;m<u.categories.pdbx_struct_mod_residue.rowCount;m++){const y=f(m),g=d.chains.find(({id:v})=>v===y);if(g===void 0)continue;const b=g.residues[h(m)];b!==void 0&&(b.name=p(m))}for(const m of d.chains)m.sequence=Ky(m.residues).sequence}yield{...d,metadata:{...d.metadata,blockName:u.header}}}}}async function*DP(e,t){const n=await Zt.resolveInContext(iA(e));if(n.isError)throw new Error(n.message);const r=await dP(n.result).run();return yield*$y(r,t)}const NP=e=>new Promise((t,n)=>IP(e,(r,i)=>{r!==null?n(r):t(i)}));async function*MP(e,t,n){const r=n.format??BP(t);if(!r)throw new Error("Unsupported format");let i=e;switch(r.isCompressed&&(i=await NP(e)),r.isBinary||(i=new TextDecoder().decode(e)),r.type){case"mmCIF":return yield*RP(i,n);case"PDB":if(typeof i!="string")throw new Error("PDB data is expected to be textual");return yield*DP(i,n)}}class TP{constructor(t){Kf(this,"value");Kf(this,"next");this.value=t}}class OP{constructor(){ca(this,Gn);ca(this,vi);ca(this,xi);this.clear()}enqueue(t){const n=new TP(t);ur(this,Gn)?(ur(this,vi).next=n,Cr(this,vi,n)):(Cr(this,Gn,n),Cr(this,vi,n)),$f(this,xi)._++}dequeue(){const t=ur(this,Gn);if(t)return Cr(this,Gn,ur(this,Gn).next),$f(this,xi)._--,t.value}peek(){if(ur(this,Gn))return ur(this,Gn).value}clear(){Cr(this,Gn,void 0),Cr(this,vi,void 0),Cr(this,xi,0)}get size(){return ur(this,xi)}*[Symbol.iterator](){let t=ur(this,Gn);for(;t;)yield t.value,t=t.next}}Gn=new WeakMap,vi=new WeakMap,xi=new WeakMap;function kP(e){Yy(e);const t=new OP;let n=0;const r=()=>{n<e&&t.size>0&&(t.dequeue()(),n++)},i=()=>{n--,r()},o=async(c,u,l)=>{const d=(async()=>c(...l))();u(d);try{await d}catch{}i()},s=(c,u,l)=>{new Promise(d=>{t.enqueue(d)}).then(o.bind(void 0,c,u,l)),(async()=>(await Promise.resolve(),n<e&&r()))()},a=(c,...u)=>new Promise(l=>{s(c,l,u)});return Object.defineProperties(a,{activeCount:{get:()=>n},pendingCount:{get:()=>t.size},clearQueue:{value(){t.clear()}},concurrency:{get:()=>e,set(c){Yy(c),e=c,queueMicrotask(()=>{for(;n<e&&t.size>0;)r()})}}}),a}function qP(e,t){const{concurrency:n}=t,r=kP(n);return(...i)=>r(()=>e(...i))}function Yy(e){if(!((Number.isInteger(e)||e===Number.POSITIVE_INFINITY)&&e>0))throw new TypeError("Expected `concurrency` to be a number from 1 and up")}function Wy(e,t){return function(){return e.apply(t,arguments)}}const{toString:UP}=Object.prototype,{getPrototypeOf:Mf}=Object,Xs=(e=>t=>{const n=UP.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Zn=e=>(e=e.toLowerCase(),t=>Xs(t)===e),Qs=e=>t=>typeof t===e,{isArray:Wi}=Array,Uo=Qs("undefined");function FP(e){return e!==null&&!Uo(e)&&e.constructor!==null&&!Uo(e.constructor)&&Dn(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const Zy=Zn("ArrayBuffer");function LP(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&Zy(e.buffer),t}const GP=Qs("string"),Dn=Qs("function"),Xy=Qs("number"),Js=e=>e!==null&&typeof e=="object",HP=e=>e===!0||e===!1,ea=e=>{if(Xs(e)!=="object")return!1;const t=Mf(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(Symbol.toStringTag in e)&&!(Symbol.iterator in e)},jP=Zn("Date"),zP=Zn("File"),VP=Zn("Blob"),KP=Zn("FileList"),$P=e=>Js(e)&&Dn(e.pipe),YP=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Dn(e.append)&&((t=Xs(e))==="formdata"||t==="object"&&Dn(e.toString)&&e.toString()==="[object FormData]"))},WP=Zn("URLSearchParams"),[ZP,XP,QP,JP]=["ReadableStream","Request","Response","Headers"].map(Zn),eE=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Fo(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,i;if(typeof e!="object"&&(e=[e]),Wi(e))for(r=0,i=e.length;r<i;r++)t.call(null,e[r],r,e);else{const o=n?Object.getOwnPropertyNames(e):Object.keys(e),s=o.length;let a;for(r=0;r<s;r++)a=o[r],t.call(null,e[a],a,e)}}function Qy(e,t){t=t.toLowerCase();const n=Object.keys(e);let r=n.length,i;for(;r-- >0;)if(i=n[r],t===i.toLowerCase())return i;return null}const yi=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,Jy=e=>!Uo(e)&&e!==yi;function Tf(){const{caseless:e}=Jy(this)&&this||{},t={},n=(r,i)=>{const o=e&&Qy(t,i)||i;ea(t[o])&&ea(r)?t[o]=Tf(t[o],r):ea(r)?t[o]=Tf({},r):Wi(r)?t[o]=r.slice():t[o]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Fo(arguments[r],n);return t}const tE=(e,t,n,{allOwnKeys:r}={})=>(Fo(t,(i,o)=>{n&&Dn(i)?e[o]=Wy(i,n):e[o]=i},{allOwnKeys:r}),e),nE=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),rE=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},iE=(e,t,n,r)=>{let i,o,s;const a={};if(t=t||{},e==null)return t;do{for(i=Object.getOwnPropertyNames(e),o=i.length;o-- >0;)s=i[o],(!r||r(s,e,t))&&!a[s]&&(t[s]=e[s],a[s]=!0);e=n!==!1&&Mf(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},oE=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},sE=e=>{if(!e)return null;if(Wi(e))return e;let t=e.length;if(!Xy(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},aE=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&Mf(Uint8Array)),cE=(e,t)=>{const r=(e&&e[Symbol.iterator]).call(e);let i;for(;(i=r.next())&&!i.done;){const o=i.value;t.call(e,o[0],o[1])}},uE=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},lE=Zn("HTMLFormElement"),fE=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,i){return r.toUpperCase()+i}),eg=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),dE=Zn("RegExp"),tg=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Fo(n,(i,o)=>{let s;(s=t(i,o,e))!==!1&&(r[o]=s||i)}),Object.defineProperties(e,r)},hE=e=>{tg(e,(t,n)=>{if(Dn(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(Dn(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},mE=(e,t)=>{const n={},r=i=>{i.forEach(o=>{n[o]=!0})};return Wi(e)?r(e):r(String(e).split(t)),n},pE=()=>{},_E=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function yE(e){return!!(e&&Dn(e.append)&&e[Symbol.toStringTag]==="FormData"&&e[Symbol.iterator])}const gE=e=>{const t=new Array(10),n=(r,i)=>{if(Js(r)){if(t.indexOf(r)>=0)return;if(!("toJSON"in r)){t[i]=r;const o=Wi(r)?[]:{};return Fo(r,(s,a)=>{const c=n(s,i+1);!Uo(c)&&(o[a]=c)}),t[i]=void 0,o}}return r};return n(e,0)},bE=Zn("AsyncFunction"),vE=e=>e&&(Js(e)||Dn(e))&&Dn(e.then)&&Dn(e.catch),ng=((e,t)=>e?setImmediate:t?((n,r)=>(yi.addEventListener("message",({source:i,data:o})=>{i===yi&&o===n&&r.length&&r.shift()()},!1),i=>{r.push(i),yi.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Dn(yi.postMessage)),xE=typeof queueMicrotask<"u"?queueMicrotask.bind(yi):typeof process<"u"&&process.nextTick||ng;var ge={isArray:Wi,isArrayBuffer:Zy,isBuffer:FP,isFormData:YP,isArrayBufferView:LP,isString:GP,isNumber:Xy,isBoolean:HP,isObject:Js,isPlainObject:ea,isReadableStream:ZP,isRequest:XP,isResponse:QP,isHeaders:JP,isUndefined:Uo,isDate:jP,isFile:zP,isBlob:VP,isRegExp:dE,isFunction:Dn,isStream:$P,isURLSearchParams:WP,isTypedArray:aE,isFileList:KP,forEach:Fo,merge:Tf,extend:tE,trim:eE,stripBOM:nE,inherits:rE,toFlatObject:iE,kindOf:Xs,kindOfTest:Zn,endsWith:oE,toArray:sE,forEachEntry:cE,matchAll:uE,isHTMLForm:lE,hasOwnProperty:eg,hasOwnProp:eg,reduceDescriptors:tg,freezeMethods:hE,toObjectSet:mE,toCamelCase:fE,noop:pE,toFiniteNumber:_E,findKey:Qy,global:yi,isContextDefined:Jy,isSpecCompliantForm:yE,toJSONObject:gE,isAsyncFn:bE,isThenable:vE,setImmediate:ng,asap:xE};function lt(e,t,n,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}ge.inherits(lt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ge.toJSONObject(this.config),code:this.code,status:this.status}}});const rg=lt.prototype,ig={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{ig[e]={value:e}}),Object.defineProperties(lt,ig),Object.defineProperty(rg,"isAxiosError",{value:!0}),lt.from=(e,t,n,r,i,o)=>{const s=Object.create(rg);return ge.toFlatObject(e,s,function(c){return c!==Error.prototype},a=>a!=="isAxiosError"),lt.call(s,e.message,t,n,r,i),s.cause=e,s.name=e.name,o&&Object.assign(s,o),s};var AE=null;function Of(e){return ge.isPlainObject(e)||ge.isArray(e)}function og(e){return ge.endsWith(e,"[]")?e.slice(0,-2):e}function sg(e,t,n){return e?e.concat(t).map(function(i,o){return i=og(i),!n&&o?"["+i+"]":i}).join(n?".":""):t}function SE(e){return ge.isArray(e)&&!e.some(Of)}const CE=ge.toFlatObject(ge,{},null,function(t){return/^is[A-Z]/.test(t)});function ta(e,t,n){if(!ge.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=ge.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(m,y){return!ge.isUndefined(y[m])});const r=n.metaTokens,i=n.visitor||l,o=n.dots,s=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&ge.isSpecCompliantForm(t);if(!ge.isFunction(i))throw new TypeError("visitor must be a function");function u(p){if(p===null)return"";if(ge.isDate(p))return p.toISOString();if(!c&&ge.isBlob(p))throw new lt("Blob is not supported. Use a Buffer instead.");return ge.isArrayBuffer(p)||ge.isTypedArray(p)?c&&typeof Blob=="function"?new Blob([p]):Buffer.from(p):p}function l(p,m,y){let g=p;if(p&&!y&&typeof p=="object"){if(ge.endsWith(m,"{}"))m=r?m:m.slice(0,-2),p=JSON.stringify(p);else if(ge.isArray(p)&&SE(p)||(ge.isFileList(p)||ge.endsWith(m,"[]"))&&(g=ge.toArray(p)))return m=og(m),g.forEach(function(v,_){!(ge.isUndefined(v)||v===null)&&t.append(s===!0?sg([m],_,o):s===null?m:m+"[]",u(v))}),!1}return Of(p)?!0:(t.append(sg(y,m,o),u(p)),!1)}const d=[],f=Object.assign(CE,{defaultVisitor:l,convertValue:u,isVisitable:Of});function h(p,m){if(!ge.isUndefined(p)){if(d.indexOf(p)!==-1)throw Error("Circular reference detected in "+m.join("."));d.push(p),ge.forEach(p,function(g,b){(!(ge.isUndefined(g)||g===null)&&i.call(t,g,ge.isString(b)?b.trim():b,m,f))===!0&&h(g,m?m.concat(b):[b])}),d.pop()}}if(!ge.isObject(e))throw new TypeError("data must be an object");return h(e),t}function ag(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function kf(e,t){this._pairs=[],e&&ta(e,this,t)}const cg=kf.prototype;cg.append=function(t,n){this._pairs.push([t,n])},cg.toString=function(t){const n=t?function(r){return t.call(this,r,ag)}:ag;return this._pairs.map(function(i){return n(i[0])+"="+n(i[1])},"").join("&")};function IE(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function ug(e,t,n){if(!t)return e;const r=n&&n.encode||IE;ge.isFunction(n)&&(n={serialize:n});const i=n&&n.serialize;let o;if(i?o=i(t,n):o=ge.isURLSearchParams(t)?t.toString():new kf(t,n).toString(r),o){const s=e.indexOf("#");s!==-1&&(e=e.slice(0,s)),e+=(e.indexOf("?")===-1?"?":"&")+o}return e}class lg{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ge.forEach(this.handlers,function(r){r!==null&&t(r)})}}var fg={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},wE=typeof URLSearchParams<"u"?URLSearchParams:kf,PE=typeof FormData<"u"?FormData:null,EE=typeof Blob<"u"?Blob:null,BE={isBrowser:!0,classes:{URLSearchParams:wE,FormData:PE,Blob:EE},protocols:["http","https","file","blob","url","data"]};const qf=typeof window<"u"&&typeof document<"u",Uf=typeof navigator=="object"&&navigator||void 0,RE=qf&&(!Uf||["ReactNative","NativeScript","NS"].indexOf(Uf.product)<0),DE=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",NE=qf&&window.location.href||"http://localhost";var ME=Object.freeze({__proto__:null,hasBrowserEnv:qf,hasStandardBrowserEnv:RE,hasStandardBrowserWebWorkerEnv:DE,navigator:Uf,origin:NE}),_n={...ME,...BE};function TE(e,t){return ta(e,new _n.classes.URLSearchParams,Object.assign({visitor:function(n,r,i,o){return _n.isNode&&ge.isBuffer(n)?(this.append(r,n.toString("base64")),!1):o.defaultVisitor.apply(this,arguments)}},t))}function OE(e){return ge.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function kE(e){const t={},n=Object.keys(e);let r;const i=n.length;let o;for(r=0;r<i;r++)o=n[r],t[o]=e[o];return t}function dg(e){function t(n,r,i,o){let s=n[o++];if(s==="__proto__")return!0;const a=Number.isFinite(+s),c=o>=n.length;return s=!s&&ge.isArray(i)?i.length:s,c?(ge.hasOwnProp(i,s)?i[s]=[i[s],r]:i[s]=r,!a):((!i[s]||!ge.isObject(i[s]))&&(i[s]=[]),t(n,r,i[s],o)&&ge.isArray(i[s])&&(i[s]=kE(i[s])),!a)}if(ge.isFormData(e)&&ge.isFunction(e.entries)){const n={};return ge.forEachEntry(e,(r,i)=>{t(OE(r),i,n,0)}),n}return null}function qE(e,t,n){if(ge.isString(e))try{return(t||JSON.parse)(e),ge.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const Lo={transitional:fg,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",i=r.indexOf("application/json")>-1,o=ge.isObject(t);if(o&&ge.isHTMLForm(t)&&(t=new FormData(t)),ge.isFormData(t))return i?JSON.stringify(dg(t)):t;if(ge.isArrayBuffer(t)||ge.isBuffer(t)||ge.isStream(t)||ge.isFile(t)||ge.isBlob(t)||ge.isReadableStream(t))return t;if(ge.isArrayBufferView(t))return t.buffer;if(ge.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(o){if(r.indexOf("application/x-www-form-urlencoded")>-1)return TE(t,this.formSerializer).toString();if((a=ge.isFileList(t))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return ta(a?{"files[]":t}:t,c&&new c,this.formSerializer)}}return o||i?(n.setContentType("application/json",!1),qE(t)):t}],transformResponse:[function(t){const n=this.transitional||Lo.transitional,r=n&&n.forcedJSONParsing,i=this.responseType==="json";if(ge.isResponse(t)||ge.isReadableStream(t))return t;if(t&&ge.isString(t)&&(r&&!this.responseType||i)){const s=!(n&&n.silentJSONParsing)&&i;try{return JSON.parse(t)}catch(a){if(s)throw a.name==="SyntaxError"?lt.from(a,lt.ERR_BAD_RESPONSE,this,null,this.response):a}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:_n.classes.FormData,Blob:_n.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ge.forEach(["delete","get","head","post","put","patch"],e=>{Lo.headers[e]={}});const UE=ge.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]);var FE=e=>{const t={};let n,r,i;return e&&e.split(`
`).forEach(function(s){i=s.indexOf(":"),n=s.substring(0,i).trim().toLowerCase(),r=s.substring(i+1).trim(),!(!n||t[n]&&UE[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t};const hg=Symbol("internals");function Go(e){return e&&String(e).trim().toLowerCase()}function na(e){return e===!1||e==null?e:ge.isArray(e)?e.map(na):String(e)}function LE(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const GE=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Ff(e,t,n,r,i){if(ge.isFunction(r))return r.call(this,t,n);if(i&&(t=n),!!ge.isString(t)){if(ge.isString(r))return t.indexOf(r)!==-1;if(ge.isRegExp(r))return r.test(t)}}function HE(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function jE(e,t){const n=ge.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(i,o,s){return this[r].call(this,t,i,o,s)},configurable:!0})})}let In=class{constructor(t){t&&this.set(t)}set(t,n,r){const i=this;function o(a,c,u){const l=Go(c);if(!l)throw new Error("header name must be a non-empty string");const d=ge.findKey(i,l);(!d||i[d]===void 0||u===!0||u===void 0&&i[d]!==!1)&&(i[d||c]=na(a))}const s=(a,c)=>ge.forEach(a,(u,l)=>o(u,l,c));if(ge.isPlainObject(t)||t instanceof this.constructor)s(t,n);else if(ge.isString(t)&&(t=t.trim())&&!GE(t))s(FE(t),n);else if(ge.isHeaders(t))for(const[a,c]of t.entries())o(c,a,r);else t!=null&&o(n,t,r);return this}get(t,n){if(t=Go(t),t){const r=ge.findKey(this,t);if(r){const i=this[r];if(!n)return i;if(n===!0)return LE(i);if(ge.isFunction(n))return n.call(this,i,r);if(ge.isRegExp(n))return n.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Go(t),t){const r=ge.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||Ff(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let i=!1;function o(s){if(s=Go(s),s){const a=ge.findKey(r,s);a&&(!n||Ff(r,r[a],a,n))&&(delete r[a],i=!0)}}return ge.isArray(t)?t.forEach(o):o(t),i}clear(t){const n=Object.keys(this);let r=n.length,i=!1;for(;r--;){const o=n[r];(!t||Ff(this,this[o],o,t,!0))&&(delete this[o],i=!0)}return i}normalize(t){const n=this,r={};return ge.forEach(this,(i,o)=>{const s=ge.findKey(r,o);if(s){n[s]=na(i),delete n[o];return}const a=t?HE(o):String(o).trim();a!==o&&delete n[o],n[a]=na(i),r[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return ge.forEach(this,(r,i)=>{r!=null&&r!==!1&&(n[i]=t&&ge.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(i=>r.set(i)),r}static accessor(t){const r=(this[hg]=this[hg]={accessors:{}}).accessors,i=this.prototype;function o(s){const a=Go(s);r[a]||(jE(i,s),r[a]=!0)}return ge.isArray(t)?t.forEach(o):o(t),this}};In.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),ge.reduceDescriptors(In.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}}),ge.freezeMethods(In);function Lf(e,t){const n=this||Lo,r=t||n,i=In.from(r.headers);let o=r.data;return ge.forEach(e,function(a){o=a.call(n,o,i.normalize(),t?t.status:void 0)}),i.normalize(),o}function mg(e){return!!(e&&e.__CANCEL__)}function Zi(e,t,n){lt.call(this,e??"canceled",lt.ERR_CANCELED,t,n),this.name="CanceledError"}ge.inherits(Zi,lt,{__CANCEL__:!0});function pg(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new lt("Request failed with status code "+n.status,[lt.ERR_BAD_REQUEST,lt.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function zE(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function VE(e,t){e=e||10;const n=new Array(e),r=new Array(e);let i=0,o=0,s;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),l=r[o];s||(s=u),n[i]=c,r[i]=u;let d=o,f=0;for(;d!==i;)f+=n[d++],d=d%e;if(i=(i+1)%e,i===o&&(o=(o+1)%e),u-s<t)return;const h=l&&u-l;return h?Math.round(f*1e3/h):void 0}}function KE(e,t){let n=0,r=1e3/t,i,o;const s=(u,l=Date.now())=>{n=l,i=null,o&&(clearTimeout(o),o=null),e.apply(null,u)};return[(...u)=>{const l=Date.now(),d=l-n;d>=r?s(u,l):(i=u,o||(o=setTimeout(()=>{o=null,s(i)},r-d)))},()=>i&&s(i)]}const ra=(e,t,n=3)=>{let r=0;const i=VE(50,250);return KE(o=>{const s=o.loaded,a=o.lengthComputable?o.total:void 0,c=s-r,u=i(c),l=s<=a;r=s;const d={loaded:s,total:a,progress:a?s/a:void 0,bytes:c,rate:u||void 0,estimated:u&&a&&l?(a-s)/u:void 0,event:o,lengthComputable:a!=null,[t?"download":"upload"]:!0};e(d)},n)},_g=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},yg=e=>(...t)=>ge.asap(()=>e(...t));var $E=_n.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,_n.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(_n.origin),_n.navigator&&/(msie|trident)/i.test(_n.navigator.userAgent)):()=>!0,YE=_n.hasStandardBrowserEnv?{write(e,t,n,r,i,o){const s=[e+"="+encodeURIComponent(t)];ge.isNumber(n)&&s.push("expires="+new Date(n).toGMTString()),ge.isString(r)&&s.push("path="+r),ge.isString(i)&&s.push("domain="+i),o===!0&&s.push("secure"),document.cookie=s.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function WE(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function ZE(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function gg(e,t,n){let r=!WE(t);return e&&(r||n==!1)?ZE(e,t):t}const bg=e=>e instanceof In?{...e}:e;function gi(e,t){t=t||{};const n={};function r(u,l,d,f){return ge.isPlainObject(u)&&ge.isPlainObject(l)?ge.merge.call({caseless:f},u,l):ge.isPlainObject(l)?ge.merge({},l):ge.isArray(l)?l.slice():l}function i(u,l,d,f){if(ge.isUndefined(l)){if(!ge.isUndefined(u))return r(void 0,u,d,f)}else return r(u,l,d,f)}function o(u,l){if(!ge.isUndefined(l))return r(void 0,l)}function s(u,l){if(ge.isUndefined(l)){if(!ge.isUndefined(u))return r(void 0,u)}else return r(void 0,l)}function a(u,l,d){if(d in t)return r(u,l);if(d in e)return r(void 0,u)}const c={url:o,method:o,data:o,baseURL:s,transformRequest:s,transformResponse:s,paramsSerializer:s,timeout:s,timeoutMessage:s,withCredentials:s,withXSRFToken:s,adapter:s,responseType:s,xsrfCookieName:s,xsrfHeaderName:s,onUploadProgress:s,onDownloadProgress:s,decompress:s,maxContentLength:s,maxBodyLength:s,beforeRedirect:s,transport:s,httpAgent:s,httpsAgent:s,cancelToken:s,socketPath:s,responseEncoding:s,validateStatus:a,headers:(u,l,d)=>i(bg(u),bg(l),d,!0)};return ge.forEach(Object.keys(Object.assign({},e,t)),function(l){const d=c[l]||i,f=d(e[l],t[l],l);ge.isUndefined(f)&&d!==a||(n[l]=f)}),n}var vg=e=>{const t=gi({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:o,headers:s,auth:a}=t;t.headers=s=In.from(s),t.url=ug(gg(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),a&&s.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let c;if(ge.isFormData(n)){if(_n.hasStandardBrowserEnv||_n.hasStandardBrowserWebWorkerEnv)s.setContentType(void 0);else if((c=s.getContentType())!==!1){const[u,...l]=c?c.split(";").map(d=>d.trim()).filter(Boolean):[];s.setContentType([u||"multipart/form-data",...l].join("; "))}}if(_n.hasStandardBrowserEnv&&(r&&ge.isFunction(r)&&(r=r(t)),r||r!==!1&&$E(t.url))){const u=i&&o&&YE.read(o);u&&s.set(i,u)}return t},XE=typeof XMLHttpRequest<"u"&&function(e){return new Promise(function(n,r){const i=vg(e);let o=i.data;const s=In.from(i.headers).normalize();let{responseType:a,onUploadProgress:c,onDownloadProgress:u}=i,l,d,f,h,p;function m(){h&&h(),p&&p(),i.cancelToken&&i.cancelToken.unsubscribe(l),i.signal&&i.signal.removeEventListener("abort",l)}let y=new XMLHttpRequest;y.open(i.method.toUpperCase(),i.url,!0),y.timeout=i.timeout;function g(){if(!y)return;const v=In.from("getAllResponseHeaders"in y&&y.getAllResponseHeaders()),A={data:!a||a==="text"||a==="json"?y.responseText:y.response,status:y.status,statusText:y.statusText,headers:v,config:e,request:y};pg(function(I){n(I),m()},function(I){r(I),m()},A),y=null}"onloadend"in y?y.onloadend=g:y.onreadystatechange=function(){!y||y.readyState!==4||y.status===0&&!(y.responseURL&&y.responseURL.indexOf("file:")===0)||setTimeout(g)},y.onabort=function(){y&&(r(new lt("Request aborted",lt.ECONNABORTED,e,y)),y=null)},y.onerror=function(){r(new lt("Network Error",lt.ERR_NETWORK,e,y)),y=null},y.ontimeout=function(){let _=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const A=i.transitional||fg;i.timeoutErrorMessage&&(_=i.timeoutErrorMessage),r(new lt(_,A.clarifyTimeoutError?lt.ETIMEDOUT:lt.ECONNABORTED,e,y)),y=null},o===void 0&&s.setContentType(null),"setRequestHeader"in y&&ge.forEach(s.toJSON(),function(_,A){y.setRequestHeader(A,_)}),ge.isUndefined(i.withCredentials)||(y.withCredentials=!!i.withCredentials),a&&a!=="json"&&(y.responseType=i.responseType),u&&([f,p]=ra(u,!0),y.addEventListener("progress",f)),c&&y.upload&&([d,h]=ra(c),y.upload.addEventListener("progress",d),y.upload.addEventListener("loadend",h)),(i.cancelToken||i.signal)&&(l=v=>{y&&(r(!v||v.type?new Zi(null,e,y):v),y.abort(),y=null)},i.cancelToken&&i.cancelToken.subscribe(l),i.signal&&(i.signal.aborted?l():i.signal.addEventListener("abort",l)));const b=zE(i.url);if(b&&_n.protocols.indexOf(b)===-1){r(new lt("Unsupported protocol "+b+":",lt.ERR_BAD_REQUEST,e));return}y.send(o||null)})};const QE=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,i;const o=function(u){if(!i){i=!0,a();const l=u instanceof Error?u:this.reason;r.abort(l instanceof lt?l:new Zi(l instanceof Error?l.message:l))}};let s=t&&setTimeout(()=>{s=null,o(new lt(`timeout ${t} of ms exceeded`,lt.ETIMEDOUT))},t);const a=()=>{e&&(s&&clearTimeout(s),s=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(o):u.removeEventListener("abort",o)}),e=null)};e.forEach(u=>u.addEventListener("abort",o));const{signal:c}=r;return c.unsubscribe=()=>ge.asap(a),c}},JE=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,i;for(;r<n;)i=r+t,yield e.slice(r,i),r=i},e8=async function*(e,t){for await(const n of t8(e))yield*JE(n,t)},t8=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}}finally{await t.cancel()}},xg=(e,t,n,r)=>{const i=e8(e,t);let o=0,s,a=c=>{s||(s=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:u,value:l}=await i.next();if(u){a(),c.close();return}let d=l.byteLength;if(n){let f=o+=d;n(f)}c.enqueue(new Uint8Array(l))}catch(u){throw a(u),u}},cancel(c){return a(c),i.return()}},{highWaterMark:2})},ia=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",Ag=ia&&typeof ReadableStream=="function",n8=ia&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),Sg=(e,...t)=>{try{return!!e(...t)}catch{return!1}},r8=Ag&&Sg(()=>{let e=!1;const t=new Request(_n.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),Cg=64*1024,Gf=Ag&&Sg(()=>ge.isReadableStream(new Response("").body)),oa={stream:Gf&&(e=>e.body)};ia&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!oa[t]&&(oa[t]=ge.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new lt(`Response type '${t}' is not supported`,lt.ERR_NOT_SUPPORT,r)})})})(new Response);const i8=async e=>{if(e==null)return 0;if(ge.isBlob(e))return e.size;if(ge.isSpecCompliantForm(e))return(await new Request(_n.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(ge.isArrayBufferView(e)||ge.isArrayBuffer(e))return e.byteLength;if(ge.isURLSearchParams(e)&&(e=e+""),ge.isString(e))return(await n8(e)).byteLength},o8=async(e,t)=>{const n=ge.toFiniteNumber(e.getContentLength());return n??i8(t)};var s8=ia&&(async e=>{let{url:t,method:n,data:r,signal:i,cancelToken:o,timeout:s,onDownloadProgress:a,onUploadProgress:c,responseType:u,headers:l,withCredentials:d="same-origin",fetchOptions:f}=vg(e);u=u?(u+"").toLowerCase():"text";let h=QE([i,o&&o.toAbortSignal()],s),p;const m=h&&h.unsubscribe&&(()=>{h.unsubscribe()});let y;try{if(c&&r8&&n!=="get"&&n!=="head"&&(y=await o8(l,r))!==0){let A=new Request(t,{method:"POST",body:r,duplex:"half"}),C;if(ge.isFormData(r)&&(C=A.headers.get("content-type"))&&l.setContentType(C),A.body){const[I,S]=_g(y,ra(yg(c)));r=xg(A.body,Cg,I,S)}}ge.isString(d)||(d=d?"include":"omit");const g="credentials"in Request.prototype;p=new Request(t,{...f,signal:h,method:n.toUpperCase(),headers:l.normalize().toJSON(),body:r,duplex:"half",credentials:g?d:void 0});let b=await fetch(p);const v=Gf&&(u==="stream"||u==="response");if(Gf&&(a||v&&m)){const A={};["status","statusText","headers"].forEach(w=>{A[w]=b[w]});const C=ge.toFiniteNumber(b.headers.get("content-length")),[I,S]=a&&_g(C,ra(yg(a),!0))||[];b=new Response(xg(b.body,Cg,I,()=>{S&&S(),m&&m()}),A)}u=u||"text";let _=await oa[ge.findKey(oa,u)||"text"](b,e);return!v&&m&&m(),await new Promise((A,C)=>{pg(A,C,{data:_,headers:In.from(b.headers),status:b.status,statusText:b.statusText,config:e,request:p})})}catch(g){throw m&&m(),g&&g.name==="TypeError"&&/fetch/i.test(g.message)?Object.assign(new lt("Network Error",lt.ERR_NETWORK,e,p),{cause:g.cause||g}):lt.from(g,g&&g.code,e,p)}});const Hf={http:AE,xhr:XE,fetch:s8};ge.forEach(Hf,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Ig=e=>`- ${e}`,a8=e=>ge.isFunction(e)||e===null||e===!1;var wg={getAdapter:e=>{e=ge.isArray(e)?e:[e];const{length:t}=e;let n,r;const i={};for(let o=0;o<t;o++){n=e[o];let s;if(r=n,!a8(n)&&(r=Hf[(s=String(n)).toLowerCase()],r===void 0))throw new lt(`Unknown adapter '${s}'`);if(r)break;i[s||"#"+o]=r}if(!r){const o=Object.entries(i).map(([a,c])=>`adapter ${a} `+(c===!1?"is not supported by the environment":"is not available in the build"));let s=t?o.length>1?`since :
`+o.map(Ig).join(`
`):" "+Ig(o[0]):"as no adapter specified";throw new lt("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return r},adapters:Hf};function jf(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Zi(null,e)}function Pg(e){return jf(e),e.headers=In.from(e.headers),e.data=Lf.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),wg.getAdapter(e.adapter||Lo.adapter)(e).then(function(r){return jf(e),r.data=Lf.call(e,e.transformResponse,r),r.headers=In.from(r.headers),r},function(r){return mg(r)||(jf(e),r&&r.response&&(r.response.data=Lf.call(e,e.transformResponse,r.response),r.response.headers=In.from(r.response.headers))),Promise.reject(r)})}const Eg="1.8.4",sa={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{sa[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const Bg={};sa.transitional=function(t,n,r){function i(o,s){return"[Axios v"+Eg+"] Transitional option '"+o+"'"+s+(r?". "+r:"")}return(o,s,a)=>{if(t===!1)throw new lt(i(s," has been removed"+(n?" in "+n:"")),lt.ERR_DEPRECATED);return n&&!Bg[s]&&(Bg[s]=!0,console.warn(i(s," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(o,s,a):!0}},sa.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function c8(e,t,n){if(typeof e!="object")throw new lt("options must be an object",lt.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let i=r.length;for(;i-- >0;){const o=r[i],s=t[o];if(s){const a=e[o],c=a===void 0||s(a,o,e);if(c!==!0)throw new lt("option "+o+" must be "+c,lt.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new lt("Unknown option "+o,lt.ERR_BAD_OPTION)}}var aa={assertOptions:c8,validators:sa};const cr=aa.validators;let bi=class{constructor(t){this.defaults=t,this.interceptors={request:new lg,response:new lg}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const o=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?o&&!String(r.stack).endsWith(o.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+o):r.stack=o}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=gi(this.defaults,n);const{transitional:r,paramsSerializer:i,headers:o}=n;r!==void 0&&aa.assertOptions(r,{silentJSONParsing:cr.transitional(cr.boolean),forcedJSONParsing:cr.transitional(cr.boolean),clarifyTimeoutError:cr.transitional(cr.boolean)},!1),i!=null&&(ge.isFunction(i)?n.paramsSerializer={serialize:i}:aa.assertOptions(i,{encode:cr.function,serialize:cr.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),aa.assertOptions(n,{baseUrl:cr.spelling("baseURL"),withXsrfToken:cr.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let s=o&&ge.merge(o.common,o[n.method]);o&&ge.forEach(["delete","get","head","post","put","patch","common"],p=>{delete o[p]}),n.headers=In.concat(s,o);const a=[];let c=!0;this.interceptors.request.forEach(function(m){typeof m.runWhen=="function"&&m.runWhen(n)===!1||(c=c&&m.synchronous,a.unshift(m.fulfilled,m.rejected))});const u=[];this.interceptors.response.forEach(function(m){u.push(m.fulfilled,m.rejected)});let l,d=0,f;if(!c){const p=[Pg.bind(this),void 0];for(p.unshift.apply(p,a),p.push.apply(p,u),f=p.length,l=Promise.resolve(n);d<f;)l=l.then(p[d++],p[d++]);return l}f=a.length;let h=n;for(d=0;d<f;){const p=a[d++],m=a[d++];try{h=p(h)}catch(y){m.call(this,y);break}}try{l=Pg.call(this,h)}catch(p){return Promise.reject(p)}for(d=0,f=u.length;d<f;)l=l.then(u[d++],u[d++]);return l}getUri(t){t=gi(this.defaults,t);const n=gg(t.baseURL,t.url,t.allowAbsoluteUrls);return ug(n,t.params,t.paramsSerializer)}};ge.forEach(["delete","get","head","options"],function(t){bi.prototype[t]=function(n,r){return this.request(gi(r||{},{method:t,url:n,data:(r||{}).data}))}}),ge.forEach(["post","put","patch"],function(t){function n(r){return function(o,s,a){return this.request(gi(a||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:o,data:s}))}}bi.prototype[t]=n(),bi.prototype[t+"Form"]=n(!0)});let u8=class Mg{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(o){n=o});const r=this;this.promise.then(i=>{if(!r._listeners)return;let o=r._listeners.length;for(;o-- >0;)r._listeners[o](i);r._listeners=null}),this.promise.then=i=>{let o;const s=new Promise(a=>{r.subscribe(a),o=a}).then(i);return s.cancel=function(){r.unsubscribe(o)},s},t(function(o,s,a){r.reason||(r.reason=new Zi(o,s,a),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new Mg(function(i){t=i}),cancel:t}}};function l8(e){return function(n){return e.apply(null,n)}}function f8(e){return ge.isObject(e)&&e.isAxiosError===!0}const zf={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(zf).forEach(([e,t])=>{zf[t]=e});function Rg(e){const t=new bi(e),n=Wy(bi.prototype.request,t);return ge.extend(n,bi.prototype,t,{allOwnKeys:!0}),ge.extend(n,t,null,{allOwnKeys:!0}),n.create=function(i){return Rg(gi(e,i))},n}const Jt=Rg(Lo);Jt.Axios=bi,Jt.CanceledError=Zi,Jt.CancelToken=u8,Jt.isCancel=mg,Jt.VERSION=Eg,Jt.toFormData=ta,Jt.AxiosError=lt,Jt.Cancel=Jt.CanceledError,Jt.all=function(t){return Promise.all(t)},Jt.spread=l8,Jt.isAxiosError=f8,Jt.mergeConfig=gi,Jt.AxiosHeaders=In,Jt.formToJSON=e=>dg(ge.isHTMLForm(e)?new FormData(e):e),Jt.getAdapter=wg.getAdapter,Jt.HttpStatusCode=zf,Jt.default=Jt;const{Axios:R8,AxiosError:D8,CanceledError:N8,isCancel:M8,CancelToken:T8,VERSION:O8,all:k8,Cancel:q8,isAxiosError:U8,spread:F8,toFormData:L8,AxiosHeaders:G8,HttpStatusCode:H8,formToJSON:j8,getAdapter:z8,mergeConfig:V8}=Jt,d8=e=>new Promise((t,n)=>{const r=new FileReader;r.onloadend=i=>{var s,a,c,u;if((a=(s=i.target)==null?void 0:s.error)!=null&&a.message)return n((c=i.target)==null?void 0:c.error);const o=(u=i.target)==null?void 0:u.result;return o instanceof ArrayBuffer?t(new Uint8Array(o)):n(new Error("Invalid file format"))},r.onerror=i=>n(i),r.readAsArrayBuffer(e)}),h8=qP(async({id:e,...t},n)=>{try{let r,i;switch(t.type){case"file":r=await d8(t.file),i=t.file.name;break;case"url":const o=await Jt.get(t.url,{responseType:"arraybuffer"});r=new Uint8Array(o.data),i=t.url;const s=o.headers["Content-Disposition"];if(typeof s=="string"){const a=s.split("filename=")[1].split(";")[0].trim();a.length>0&&(i=a)}break}for await(const o of MP(r,i,t)){const s=Object.fromEntries(await Promise.all(o.chains.map(async a=>{const c=k3(await O3(a,n));return[a.id,c?{[c.proteinId]:c.proteinPosToChainPos}:[]]})));self.postMessage({id:e,done:!1,structure:{...o,chainIdToProteinIdToMapping:s}})}self.postMessage({id:e,done:!0})}catch(r){self.postMessage({id:e,error:r})}finally{}},{concurrency:5});self.onmessage=({data:e})=>{switch(e.action){case"load-structures":{for(const t of e.structures)h8(t,e.proteins);break}}}})();
