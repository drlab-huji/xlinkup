import{k as yr,g as wr,a8 as Bt}from"./index-aczn_LpH.js";import{useMemo as Ot,useRef as Yt,useSyncExternalStore as _r,useCallback as kr,useLayoutEffect as Pr,useEffect as Sr,useDebugValue as Er}from"https://esm.sh/react@^19.0.0";function br(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var xt={},Tr=function(e,t,r,n,i){var c=new Worker(xt[t]||(xt[t]=URL.createObjectURL(new Blob([e+';addEventListener("error",function(e){e=e.error;postMessage({$e$:[e.message,e.code,e.stack]})})'],{type:"text/javascript"}))));return c.onmessage=function(f){var l=f.data,h=l.$e$;if(h){var a=new Error(h[0]);a.code=h[1],a.stack=h[2],i(a,null)}else i(null,l)},c.postMessage(r,n),c},te=Uint8Array,ue=Uint16Array,Qe=Int32Array,ze=new te([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Ne=new te([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),Ve=new te([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Vt=function(e,t){for(var r=new ue(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var i=new Qe(r[30]),n=1;n<30;++n)for(var c=r[n];c<r[n+1];++c)i[c]=c-r[n]<<5|n;return{b:r,r:i}},Gt=Vt(ze,2),gt=Gt.b,at=Gt.r;gt[28]=258,at[258]=28;var Jt=Vt(Ne,0),Zt=Jt.b,At=Jt.r,Ge=new ue(32768);for(var Q=0;Q<32768;++Q){var Pe=(Q&43690)>>1|(Q&21845)<<1;Pe=(Pe&52428)>>2|(Pe&13107)<<2,Pe=(Pe&61680)>>4|(Pe&3855)<<4,Ge[Q]=((Pe&65280)>>8|(Pe&255)<<8)>>1}var pe=function(e,t,r){for(var n=e.length,i=0,c=new ue(t);i<n;++i)e[i]&&++c[e[i]-1];var f=new ue(t);for(i=1;i<t;++i)f[i]=f[i-1]+c[i-1]<<1;var l;if(r){l=new ue(1<<t);var h=15-t;for(i=0;i<n;++i)if(e[i])for(var a=i<<4|e[i],u=t-e[i],p=f[e[i]-1]++<<u,g=p|(1<<u)-1;p<=g;++p)l[Ge[p]>>h]=a}else for(l=new ue(n),i=0;i<n;++i)e[i]&&(l[i]=Ge[f[e[i]-1]++]>>15-e[i]);return l},Se=new te(288);for(var Q=0;Q<144;++Q)Se[Q]=8;for(var Q=144;Q<256;++Q)Se[Q]=9;for(var Q=256;Q<280;++Q)Se[Q]=7;for(var Q=280;Q<288;++Q)Se[Q]=8;var Le=new te(32);for(var Q=0;Q<32;++Q)Le[Q]=5;var Ir=pe(Se,9,0),Qt=pe(Se,9,1),Rr=pe(Le,5,0),Xt=pe(Le,5,1),Ke=function(e){for(var t=e[0],r=1;r<e.length;++r)e[r]>t&&(t=e[r]);return t},le=function(e,t,r){var n=t/8|0;return(e[n]|e[n+1]<<8)>>(t&7)&r},Be=function(e,t){var r=t/8|0;return(e[r]|e[r+1]<<8|e[r+2]<<16)>>(t&7)},Xe=function(e){return(e+7)/8|0},Ie=function(e,t,r){return(t==null||t<0)&&(t=0),(r==null||r>e.length)&&(r=e.length),new te(e.subarray(t,r))},er=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],ne=function(e,t,r){var n=new Error(t||er[e]);if(n.code=e,Error.captureStackTrace&&Error.captureStackTrace(n,ne),!r)throw n;return n},et=function(e,t,r,n){var i=e.length,c=n?n.length:0;if(!i||t.f&&!t.l)return r||new te(0);var f=!r,l=f||t.i!=2,h=t.i;f&&(r=new te(i*3));var a=function(R){var Y=r.length;if(R>Y){var J=new te(Math.max(Y*2,R));J.set(r),r=J}},u=t.f||0,p=t.p||0,g=t.b||0,I=t.l,L=t.d,z=t.m,v=t.n,y=i*8;do{if(!I){u=le(e,p,1);var _=le(e,p+1,3);if(p+=3,_)if(_==1)I=Qt,L=Xt,z=9,v=5;else if(_==2){var q=le(e,p,31)+257,b=le(e,p+10,15)+4,o=q+le(e,p+5,31)+1;p+=14;for(var s=new te(o),d=new te(19),m=0;m<b;++m)d[Ve[m]]=le(e,p+m*3,7);p+=b*3;for(var w=Ke(d),x=(1<<w)-1,U=pe(d,w,1),m=0;m<o;){var V=U[le(e,p,x)];p+=V&15;var E=V>>4;if(E<16)s[m++]=E;else{var K=0,S=0;for(E==16?(S=3+le(e,p,3),p+=2,K=s[m-1]):E==17?(S=3+le(e,p,7),p+=3):E==18&&(S=11+le(e,p,127),p+=7);S--;)s[m++]=K}}var N=s.subarray(0,q),P=s.subarray(q);z=Ke(N),v=Ke(P),I=pe(N,z,1),L=pe(P,v,1)}else ne(1);else{var E=Xe(p)+4,O=e[E-4]|e[E-3]<<8,D=E+O;if(D>i){h&&ne(0);break}l&&a(g+O),r.set(e.subarray(E,D),g),t.b=g+=O,t.p=p=D*8,t.f=u;continue}if(p>y){h&&ne(0);break}}l&&a(g+131072);for(var ee=(1<<z)-1,T=(1<<v)-1,A=p;;A=p){var K=I[Be(e,p)&ee],k=K>>4;if(p+=K&15,p>y){h&&ne(0);break}if(K||ne(2),k<256)r[g++]=k;else if(k==256){A=p,I=null;break}else{var W=k-254;if(k>264){var m=k-257,C=ze[m];W=le(e,p,(1<<C)-1)+gt[m],p+=C}var B=L[Be(e,p)&T],re=B>>4;B||ne(3),p+=B&15;var P=Zt[re];if(re>3){var C=Ne[re];P+=Be(e,p)&(1<<C)-1,p+=C}if(p>y){h&&ne(0);break}l&&a(g+131072);var M=g+W;if(g<P){var $=c-P,G=Math.min(P,M);for($+g<0&&ne(3);g<G;++g)r[g]=n[$+g]}for(;g<M;++g)r[g]=r[g-P]}}t.l=I,t.p=A,t.b=g,t.f=u,I&&(u=1,t.m=z,t.d=L,t.n=v)}while(!u);return g!=r.length&&f?Ie(r,0,g):r.subarray(0,g)},_e=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},xe=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},nt=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var i=r.length,c=r.slice();if(!i)return{t:rr,l:0};if(i==1){var f=new te(r[0].s+1);return f[r[0].s]=1,{t:f,l:1}}r.sort(function(D,q){return D.f-q.f}),r.push({s:-1,f:25001});var l=r[0],h=r[1],a=0,u=1,p=2;for(r[0]={s:-1,f:l.f+h.f,l,r:h};u!=i-1;)l=r[r[a].f<r[p].f?a++:p++],h=r[a!=u&&r[a].f<r[p].f?a++:p++],r[u++]={s:-1,f:l.f+h.f,l,r:h};for(var g=c[0].s,n=1;n<i;++n)c[n].s>g&&(g=c[n].s);var I=new ue(g+1),L=ct(r[u-1],I,0);if(L>t){var n=0,z=0,v=L-t,y=1<<v;for(c.sort(function(q,b){return I[b.s]-I[q.s]||q.f-b.f});n<i;++n){var _=c[n].s;if(I[_]>t)z+=y-(1<<L-I[_]),I[_]=t;else break}for(z>>=v;z>0;){var E=c[n].s;I[E]<t?z-=1<<t-I[E]++-1:++n}for(;n>=0&&z;--n){var O=c[n].s;I[O]==t&&(--I[O],++z)}L=t}return{t:new te(I),l:L}},ct=function(e,t,r){return e.s==-1?Math.max(ct(e.l,t,r+1),ct(e.r,t,r+1)):t[e.s]=r},Ct=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new ue(++t),n=0,i=e[0],c=1,f=function(h){r[n++]=h},l=1;l<=t;++l)if(e[l]==i&&l!=t)++c;else{if(!i&&c>2){for(;c>138;c-=138)f(32754);c>2&&(f(c>10?c-11<<5|28690:c-3<<5|12305),c=0)}else if(c>3){for(f(i),--c;c>6;c-=6)f(8304);c>2&&(f(c-3<<5|8208),c=0)}for(;c--;)f(i);c=1,i=e[l]}return{c:r.subarray(0,n),n:t}},Ae=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},tr=function(e,t,r){var n=r.length,i=Xe(t+2);e[i]=n&255,e[i+1]=n>>8,e[i+2]=e[i]^255,e[i+3]=e[i+1]^255;for(var c=0;c<n;++c)e[i+c+4]=r[c];return(i+4+n)*8},Mt=function(e,t,r,n,i,c,f,l,h,a,u){_e(t,u++,r),++i[256];for(var p=nt(i,15),g=p.t,I=p.l,L=nt(c,15),z=L.t,v=L.l,y=Ct(g),_=y.c,E=y.n,O=Ct(z),D=O.c,q=O.n,b=new ue(19),o=0;o<_.length;++o)++b[_[o]&31];for(var o=0;o<D.length;++o)++b[D[o]&31];for(var s=nt(b,7),d=s.t,m=s.l,w=19;w>4&&!d[Ve[w-1]];--w);var x=a+5<<3,U=Ae(i,Se)+Ae(c,Le)+f,V=Ae(i,g)+Ae(c,z)+f+14+3*w+Ae(b,d)+2*b[16]+3*b[17]+7*b[18];if(h>=0&&x<=U&&x<=V)return tr(t,u,e.subarray(h,h+a));var K,S,N,P;if(_e(t,u,1+(V<U)),u+=2,V<U){K=pe(g,I,0),S=g,N=pe(z,v,0),P=z;var ee=pe(d,m,0);_e(t,u,E-257),_e(t,u+5,q-1),_e(t,u+10,w-4),u+=14;for(var o=0;o<w;++o)_e(t,u+3*o,d[Ve[o]]);u+=3*w;for(var T=[_,D],A=0;A<2;++A)for(var k=T[A],o=0;o<k.length;++o){var W=k[o]&31;_e(t,u,ee[W]),u+=d[W],W>15&&(_e(t,u,k[o]>>5&127),u+=k[o]>>12)}}else K=Ir,S=Se,N=Rr,P=Le;for(var o=0;o<l;++o){var C=n[o];if(C>255){var W=C>>18&31;xe(t,u,K[W+257]),u+=S[W+257],W>7&&(_e(t,u,C>>23&31),u+=ze[W]);var B=C&31;xe(t,u,N[B]),u+=P[B],B>3&&(xe(t,u,C>>5&8191),u+=Ne[B])}else xe(t,u,K[C]),u+=S[C]}return xe(t,u,K[256]),u+S[256]},Or=new Qe([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),rr=new te(0),xr=function(e,t,r,n,i,c){var f=c.z||e.length,l=new te(n+f+5*(1+Math.ceil(f/7e3))+i),h=l.subarray(n,l.length-i),a=c.l,u=(c.r||0)&7;if(t){u&&(h[0]=c.r>>3);for(var p=Or[t-1],g=p>>13,I=p&8191,L=(1<<r)-1,z=c.p||new ue(32768),v=c.h||new ue(L+1),y=Math.ceil(r/3),_=2*y,E=function(H){return(e[H]^e[H+1]<<y^e[H+2]<<_)&L},O=new Qe(25e3),D=new ue(288),q=new ue(32),b=0,o=0,s=c.i||0,d=0,m=c.w||0,w=0;s+2<f;++s){var x=E(s),U=s&32767,V=v[x];if(z[U]=V,v[x]=U,m<=s){var K=f-s;if((b>7e3||d>24576)&&(K>423||!a)){u=Mt(e,h,0,O,D,q,o,d,w,s-w,u),d=b=o=0,w=s;for(var S=0;S<286;++S)D[S]=0;for(var S=0;S<30;++S)q[S]=0}var N=2,P=0,ee=I,T=U-V&32767;if(K>2&&x==E(s-T))for(var A=Math.min(g,K)-1,k=Math.min(32767,s),W=Math.min(258,K);T<=k&&--ee&&U!=V;){if(e[s+N]==e[s+N-T]){for(var C=0;C<W&&e[s+C]==e[s+C-T];++C);if(C>N){if(N=C,P=T,C>A)break;for(var B=Math.min(T,C-2),re=0,S=0;S<B;++S){var M=s-T+S&32767,$=z[M],G=M-$&32767;G>re&&(re=G,V=M)}}}U=V,V=z[U],T+=U-V&32767}if(P){O[d++]=268435456|at[N]<<18|At[P];var R=at[N]&31,Y=At[P]&31;o+=ze[R]+Ne[Y],++D[257+R],++q[Y],m=s+N,++b}else O[d++]=e[s],++D[e[s]]}}for(s=Math.max(s,m);s<f;++s)O[d++]=e[s],++D[e[s]];u=Mt(e,h,a,O,D,q,o,d,w,s-w,u),a||(c.r=u&7|h[u/8|0]<<3,u-=7,c.h=v,c.p=z,c.i=s,c.w=m)}else{for(var s=c.w||0;s<f+a;s+=65535){var J=s+65535;J>=f&&(h[u/8|0]=a,J=f),u=tr(h,u+1,e.subarray(s,J))}c.i=f}return Ie(l,0,n+Xe(u)+i)},Ar=function(){for(var e=new Int32Array(256),t=0;t<256;++t){for(var r=t,n=9;--n;)r=(r&1&&-306674912)^r>>>1;e[t]=r}return e}(),Cr=function(){var e=-1;return{p:function(t){for(var r=e,n=0;n<t.length;++n)r=Ar[r&255^t[n]]^r>>>8;e=r},d:function(){return~e}}},Mr=function(e,t,r,n,i){if(!i&&(i={l:1},t.dictionary)){var c=t.dictionary.subarray(-32768),f=new te(c.length+e.length);f.set(c),f.set(e,c.length),e=f,i.w=c.length}return xr(e,t.level==null?6:t.level,t.mem==null?i.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,i)},Dr=function(e,t){var r={};for(var n in e)r[n]=e[n];for(var n in t)r[n]=t[n];return r},Dt=function(e,t,r){for(var n=e(),i=e.toString(),c=i.slice(i.indexOf("[")+1,i.lastIndexOf("]")).replace(/\s+/g,"").split(","),f=0;f<n.length;++f){var l=n[f],h=c[f];if(typeof l=="function"){t+=";"+h+"=";var a=l.toString();if(l.prototype)if(a.indexOf("[native code]")!=-1){var u=a.indexOf(" ",8)+1;t+=a.slice(u,a.indexOf("(",u))}else{t+=a;for(var p in l.prototype)t+=";"+h+".prototype."+p+"="+l.prototype[p].toString()}else t+=a}else r[h]=l}return t},qe=[],Lr=function(e){var t=[];for(var r in e)e[r].buffer&&t.push((e[r]=new e[r].constructor(e[r])).buffer);return t},Fr=function(e,t,r,n){if(!qe[r]){for(var i="",c={},f=e.length-1,l=0;l<f;++l)i=Dt(e[l],i,c);qe[r]={c:Dt(e[f],i,c),e:c}}var h=Dr({},qe[r].e);return Tr(qe[r].c+";onmessage=function(e){for(var k in e.data)self[k]=e.data[k];onmessage="+t.toString()+"}",r,h,Lr(h),n)},zr=function(){return[te,ue,Qe,ze,Ne,Ve,gt,Zt,Qt,Xt,Ge,er,pe,Ke,le,Be,Xe,Ie,ne,et,tt,nr,ir]},nr=function(e){return postMessage(e,[e.buffer])},ir=function(e){return e&&{out:e.size&&new te(e.size),dictionary:e.dictionary}},Nr=function(e,t,r,n,i,c){var f=Fr(r,n,i,function(l,h){f.terminate(),c(l,h)});return f.postMessage([e,t],t.consume?[e.buffer]:[]),function(){f.terminate()}},ye=function(e,t){return e[t]|e[t+1]<<8},de=function(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0},it=function(e,t){return de(e,t)+de(e,t+4)*4294967296},ft=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},$r=function(e,t){var r=t.filename;if(e[0]=31,e[1]=139,e[2]=8,e[8]=t.level<2?4:t.level==9?2:0,e[9]=3,t.mtime!=0&&ft(e,4,Math.floor(new Date(t.mtime||Date.now())/1e3)),r){e[3]=8;for(var n=0;n<=r.length;++n)e[n+10]=r.charCodeAt(n)}},jr=function(e){(e[0]!=31||e[1]!=139||e[2]!=8)&&ne(6,"invalid gzip data");var t=e[3],r=10;t&4&&(r+=(e[10]|e[11]<<8)+2);for(var n=(t>>3&1)+(t>>4&1);n>0;n-=!e[r++]);return r+(t&2)},qr=function(e){var t=e.length;return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0},Ur=function(e){return 10+(e.filename?e.filename.length+1:0)},Wr=function(e,t){return((e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31)&&ne(6,"invalid zlib data"),(e[1]>>5&1)==1&&ne(6,"invalid zlib data: "+(e[1]&32?"need":"unexpected")+" dictionary"),(e[1]>>3&4)+2};function Hr(e,t,r){return r||(r=t,t={}),typeof r!="function"&&ne(7),Nr(e,t,[zr],function(n){return nr(tt(n.data[0],ir(n.data[1])))},1,r)}function tt(e,t){return et(e,{i:2},t&&t.out,t&&t.dictionary)}function ti(e,t){t||(t={});var r=Cr(),n=e.length;r.p(e);var i=Mr(e,t,Ur(t),8),c=i.length;return $r(i,t),ft(i,c-8,r.d()),ft(i,c-4,n),i}function Kr(e,t){var r=jr(e);return r+8>e.length&&ne(6,"invalid gzip data"),et(e.subarray(r,-8),{i:2},new te(qr(e)),t)}function Br(e,t){return et(e.subarray(Wr(e),-4),{i:2},t,t)}function Yr(e,t){return e[0]==31&&e[1]==139&&e[2]==8?Kr(e,t):(e[0]&15)!=8||e[0]>>4>7||(e[0]<<8|e[1])%31?tt(e,t):Br(e,t)}var Lt=typeof TextEncoder<"u"&&new TextEncoder,ut=typeof TextDecoder<"u"&&new TextDecoder,Vr=0;try{ut.decode(rr,{stream:!0}),Vr=1}catch{}var Gr=function(e){for(var t="",r=0;;){var n=e[r++],i=(n>127)+(n>223)+(n>239);if(r+i>e.length)return{s:t,r:Ie(e,r-1)};i?i==3?(n=((n&15)<<18|(e[r++]&63)<<12|(e[r++]&63)<<6|e[r++]&63)-65536,t+=String.fromCharCode(55296|n>>10,56320|n&1023)):i&1?t+=String.fromCharCode((n&31)<<6|e[r++]&63):t+=String.fromCharCode((n&15)<<12|(e[r++]&63)<<6|e[r++]&63):t+=String.fromCharCode(n)}};function ri(e,t){var r;if(Lt)return Lt.encode(e);for(var n=e.length,i=new te(e.length+(e.length>>1)),c=0,f=function(a){i[c++]=a},r=0;r<n;++r){if(c+5>i.length){var l=new te(c+8+(n-r<<1));l.set(i),i=l}var h=e.charCodeAt(r);h<128||t?f(h):h<2048?(f(192|h>>6),f(128|h&63)):h>55295&&h<57344?(h=65536+(h&1047552)|e.charCodeAt(++r)&1023,f(240|h>>18),f(128|h>>12&63),f(128|h>>6&63),f(128|h&63)):(f(224|h>>12),f(128|h>>6&63),f(128|h&63))}return Ie(i,0,c)}function sr(e,t){if(t){for(var r="",n=0;n<e.length;n+=16384)r+=String.fromCharCode.apply(null,e.subarray(n,n+16384));return r}else{if(ut)return ut.decode(e);var i=Gr(e),c=i.s,r=i.r;return r.length&&ne(8),c}}var Jr=function(e,t){return t+30+ye(e,t+26)+ye(e,t+28)},Zr=function(e,t,r){var n=ye(e,t+28),i=sr(e.subarray(t+46,t+46+n),!(ye(e,t+8)&2048)),c=t+46+n,f=de(e,t+20),l=r&&f==4294967295?Qr(e,c):[f,de(e,t+24),de(e,t+42)],h=l[0],a=l[1],u=l[2];return[ye(e,t+10),h,a,i,c+ye(e,t+30)+ye(e,t+32),u]},Qr=function(e,t){for(;ye(e,t)!=1;t+=4+ye(e,t+2));return[it(e,t+12),it(e,t+4),it(e,t+20)]},Ft=typeof queueMicrotask=="function"?queueMicrotask:typeof setTimeout=="function"?setTimeout:function(e){e()};function Xr(e,t,r){r||(r=t,t={}),typeof r!="function"&&ne(7);var n=[],i=function(){for(var v=0;v<n.length;++v)n[v]()},c={},f=function(v,y){Ft(function(){r(v,y)})};Ft(function(){f=r});for(var l=e.length-22;de(e,l)!=101010256;--l)if(!l||e.length-l>65558)return f(ne(13,0,1),null),i;var h=ye(e,l+8);if(h){var a=h,u=de(e,l+16),p=u==4294967295||a==65535;if(p){var g=de(e,l-12);p=de(e,g)==101075792,p&&(a=h=de(e,g+32),u=de(e,g+48))}for(var I=t&&t.filter,L=function(v){var y=Zr(e,u,p),_=y[0],E=y[1],O=y[2],D=y[3],q=y[4],b=y[5],o=Jr(e,b);u=q;var s=function(m,w){m?(i(),f(m,null)):(w&&(c[D]=w),--h||f(null,c))};if(!I||I({name:D,size:E,originalSize:O,compression:_}))if(!_)s(null,Ie(e,o,o+E));else if(_==8){var d=e.subarray(o,o+E);if(O<524288||E>.8*O)try{s(null,tt(d,{out:new te(O)}))}catch(m){s(m,null)}else n.push(Hr(d,{size:O},s))}else s(ne(14,"unknown compression type "+_,1),null);else s(null,null)},z=0;z<a;++z)L(z)}else f(null,{});return i}const en=Symbol(),yt=Symbol(),Ce="a",or="f",zt="p",ar="c",cr="t",wt="h",De="w",_t="o",kt="k";let tn=(e,t)=>new Proxy(e,t);const lt=Object.getPrototypeOf,ht=new WeakMap,fr=e=>e&&(ht.has(e)?ht.get(e):lt(e)===Object.prototype||lt(e)===Array.prototype),Je=e=>typeof e=="object"&&e!==null,rn=e=>Object.values(Object.getOwnPropertyDescriptors(e)).some(t=>!t.configurable&&!t.writable),nn=e=>{if(Array.isArray(e))return Array.from(e);const t=Object.getOwnPropertyDescriptors(e);return Object.values(t).forEach(r=>{r.configurable=!0}),Object.create(lt(e),t)},sn=(e,t)=>{const r={[or]:t};let n=!1;const i=(l,h)=>{if(!n){let a=r[Ce].get(e);if(a||(a={},r[Ce].set(e,a)),l===De)a[De]=!0;else{let u=a[l];u||(u=new Set,a[l]=u),u.add(h)}}},c=()=>{n=!0,r[Ce].delete(e)},f={get(l,h){return h===yt?e:(i(kt,h),ur(Reflect.get(l,h),r[Ce],r[ar],r[cr]))},has(l,h){return h===en?(c(),!0):(i(wt,h),Reflect.has(l,h))},getOwnPropertyDescriptor(l,h){return i(_t,h),Reflect.getOwnPropertyDescriptor(l,h)},ownKeys(l){return i(De),Reflect.ownKeys(l)}};return t&&(f.set=f.deleteProperty=()=>!1),[f,r]},Pt=e=>e[yt]||e,ur=(e,t,r,n)=>{if(!fr(e))return e;let i=n&&n.get(e);if(!i){const h=Pt(e);rn(h)?i=[h,nn(h)]:i=[h],n==null||n.set(e,i)}const[c,f]=i;let l=r&&r.get(c);return(!l||l[1][or]!==!!f)&&(l=sn(c,!!f),l[1][zt]=tn(f||c,l[0]),r&&r.set(c,l)),l[1][Ce]=t,l[1][ar]=r,l[1][cr]=n,l[1][zt]},on=(e,t)=>{const r=Reflect.ownKeys(e),n=Reflect.ownKeys(t);return r.length!==n.length||r.some((i,c)=>i!==n[c])},lr=(e,t,r,n,i=Object.is)=>{if(i(e,t))return!1;if(!Je(e)||!Je(t))return!0;const c=r.get(Pt(e));if(!c)return!0;if(n){if(n.get(e)===t)return!1;n.set(e,t)}let f=null;for(const l of c[wt]||[])if(f=Reflect.has(e,l)!==Reflect.has(t,l),f)return f;if(c[De]===!0){if(f=on(e,t),f)return f}else for(const l of c[_t]||[]){const h=!!Reflect.getOwnPropertyDescriptor(e,l),a=!!Reflect.getOwnPropertyDescriptor(t,l);if(f=h!==a,f)return f}for(const l of c[kt]||[])if(f=lr(e[l],t[l],r,n,i),f)return f;if(f===null)throw new Error("invalid used");return f},an=e=>fr(e)&&e[yt]||null,Nt=(e,t=!0)=>{ht.set(e,t)},cn=(e,t,r)=>{const n=[],i=new WeakSet,c=(f,l)=>{var h,a,u;if(i.has(f))return;Je(f)&&i.add(f);const p=Je(f)&&t.get(Pt(f));if(p){if((h=p[wt])===null||h===void 0||h.forEach(g=>{const I=`:has(${String(g)})`;n.push(l?[...l,I]:[I])}),p[De]===!0){const g=":ownKeys";n.push(l?[...l,g]:[g])}else(a=p[_t])===null||a===void 0||a.forEach(g=>{const I=`:hasOwn(${String(g)})`;n.push(l?[...l,I]:[I])});(u=p[kt])===null||u===void 0||u.forEach(g=>{"value"in(Object.getOwnPropertyDescriptor(f,g)||{})&&c(f[g],l?[...l,g]:[g])})}else l&&n.push(l)};return c(e),n},Ze={},St=e=>typeof e=="object"&&e!==null,fn=e=>St(e)&&!$e.has(e)&&(Array.isArray(e)||!(Symbol.iterator in e))&&!(e instanceof WeakMap)&&!(e instanceof WeakSet)&&!(e instanceof Error)&&!(e instanceof Number)&&!(e instanceof Date)&&!(e instanceof String)&&!(e instanceof RegExp)&&!(e instanceof ArrayBuffer)&&!(e instanceof Promise),hr=(e,t)=>{const r=dt.get(e);if((r==null?void 0:r[0])===t)return r[1];const n=Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e));return Nt(n,!0),dt.set(e,[t,n]),Reflect.ownKeys(e).forEach(i=>{if(Object.getOwnPropertyDescriptor(n,i))return;const c=Reflect.get(e,i),{enumerable:f}=Reflect.getOwnPropertyDescriptor(e,i),l={value:c,enumerable:f,configurable:!0};if($e.has(c))Nt(c,!1);else if(Ee.has(c)){const[h,a]=Ee.get(c);l.value=hr(h,a())}Object.defineProperty(n,i,l)}),Object.preventExtensions(n)},un=(e,t,r,n)=>({deleteProperty(i,c){const f=Reflect.get(i,c);r(c);const l=Reflect.deleteProperty(i,c);return l&&n(["delete",[c],f]),l},set(i,c,f,l){const h=!e()&&Reflect.has(i,c),a=Reflect.get(i,c,l);if(h&&($t(a,f)||Fe.has(f)&&$t(a,Fe.get(f))))return!0;r(c),St(f)&&(f=an(f)||f);const u=!Ee.has(f)&&hn(f)?je(f):f;return t(c,u),Reflect.set(i,c,u,l),n(["set",[c],f,a]),!0}}),Ee=new WeakMap,$e=new WeakSet,dt=new WeakMap,Me=[1,1],Fe=new WeakMap;let $t=Object.is,ln=(e,t)=>new Proxy(e,t),hn=fn,dn=hr,pn=un;function je(e={}){if(!St(e))throw new Error("object required");const t=Fe.get(e);if(t)return t;let r=Me[0];const n=new Set,i=(v,y=++Me[0])=>{r!==y&&(r=y,n.forEach(_=>_(v,y)))};let c=Me[1];const f=(v=++Me[1])=>(c!==v&&!n.size&&(c=v,h.forEach(([y])=>{const _=y[1](v);_>r&&(r=_)})),r),l=v=>(y,_)=>{const E=[...y];E[1]=[v,...E[1]],i(E,_)},h=new Map,a=(v,y)=>{const _=!$e.has(y)&&Ee.get(y);if(_){if((Ze?"production":void 0)!=="production"&&h.has(v))throw new Error("prop listener already exists");if(n.size){const E=_[2](l(v));h.set(v,[_,E])}else h.set(v,[_])}},u=v=>{var y;const _=h.get(v);_&&(h.delete(v),(y=_[1])==null||y.call(_))},p=v=>(n.add(v),n.size===1&&h.forEach(([_,E],O)=>{if((Ze?"production":void 0)!=="production"&&E)throw new Error("remove already exists");const D=_[2](l(O));h.set(O,[_,D])}),()=>{n.delete(v),n.size===0&&h.forEach(([_,E],O)=>{E&&(E(),h.set(O,[_]))})});let g=!0;const I=pn(()=>g,a,u,i),L=ln(e,I);Fe.set(e,L);const z=[e,f,p];return Ee.set(L,z),Reflect.ownKeys(e).forEach(v=>{const y=Object.getOwnPropertyDescriptor(e,v);"value"in y&&y.writable&&(L[v]=e[v])}),g=!1,L}function vn(e,t,r){const n=Ee.get(e);(Ze?"production":void 0)!=="production"&&!n&&console.warn("Please use proxy object");let i;const c=[],f=n[2];let l=!1;const a=f(u=>{c.push(u),i||(i=Promise.resolve().then(()=>{i=void 0,l&&t(c.splice(0))}))});return l=!0,()=>{l=!1,a()}}function pt(e){const t=Ee.get(e);(Ze?"production":void 0)!=="production"&&!t&&console.warn("Please use proxy object");const[r,n]=t;return dn(r,n())}function mn(e){return $e.add(e),e}function Et(){return{proxyStateMap:Ee,refSet:$e,snapCache:dt,versionHolder:Me,proxyCache:Fe}}const gn={},yn=(e,t)=>{const r=Yt(void 0);Sr(()=>{r.current=cn(e,t)}),Er(r.current)},wn=yn,_n=new WeakMap;function kn(e,t){const n=Ot(()=>e&&new WeakMap,[e]),i=Yt(void 0);let c=!0;const f=_r(kr(h=>{const a=vn(e,h);return h(),a},[e,void 0]),()=>{const h=pt(e);try{if(!c&&i.current&&!lr(i.current,h,n,new WeakMap))return i.current}catch{}return h},()=>pt(e));c=!1,Pr(()=>{i.current=f}),(gn?"production":void 0)!=="production"&&wn(f,n);const l=Ot(()=>new WeakMap,[]);return ur(f,n,l,_n)}const{proxyStateMap:dr,snapCache:Pn}=Et(),Ue=e=>dr.has(e),Sn=e=>Symbol.toStringTag in e&&e[Symbol.toStringTag]==="Map"&&dr.has(e);function bt(e){const t=[];let r=0;const n=new Map,i=new WeakMap,c=()=>{const a=Pn.get(l),u=a==null?void 0:a[1];if(u&&!i.has(u)){const p=new Map(n);i.set(u,p)}},f=a=>i.get(a)||n;if(e){if(typeof e[Symbol.iterator]!="function")throw new TypeError(`proxyMap:
	initial state must be iterable
		tip: structure should be [[key, value]]`);for(const[a,u]of e)n.set(a,r),t[r++]=u}const l={data:t,index:r,epoch:0,get size(){return Ue(this)||c(),f(this).size},get(a){const p=f(this).get(a);if(p===void 0){this.epoch;return}return this.data[p]},has(a){const u=f(this);return this.epoch,u.has(a)},set(a,u){if(!Ue(this))throw new Error("Cannot perform mutations on a snapshot");const p=n.get(a);return p===void 0?(n.set(a,this.index),this.data[this.index++]=u):this.data[p]=u,this.epoch++,this},delete(a){if(!Ue(this))throw new Error("Cannot perform mutations on a snapshot");const u=n.get(a);return u===void 0?!1:(delete this.data[u],n.delete(a),this.epoch++,!0)},clear(){if(!Ue(this))throw new Error("Cannot perform mutations on a snapshot");this.data.length=0,this.index=0,this.epoch++,n.clear()},forEach(a){this.epoch,f(this).forEach((p,g)=>{a(this.data[p],g,this)})},*entries(){this.epoch;const a=f(this);for(const[u,p]of a)yield[u,this.data[p]]},*keys(){this.epoch;const a=f(this);for(const u of a.keys())yield u},*values(){this.epoch;const a=f(this);for(const u of a.values())yield this.data[u]},[Symbol.iterator](){return this.entries()},get[Symbol.toStringTag](){return"Map"},toJSON(){return new Map(this.entries())}},h=je(l);return Object.defineProperties(h,{size:{enumerable:!1},index:{enumerable:!1},epoch:{enumerable:!1},data:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(h),h}const{proxyStateMap:pr,snapCache:En}=Et(),We=e=>typeof e=="object"?je({x:e}).x:e,He=e=>pr.has(e),bn=e=>Symbol.toStringTag in e&&e[Symbol.toStringTag]==="Set"&&pr.has(e);function se(e){const t=[],r=new Map;let n=0;const i=new WeakMap,c=()=>{const a=En.get(l),u=a==null?void 0:a[1];if(u&&!i.has(u)){const p=new Map(r);i.set(u,p)}},f=a=>i.get(a)||r;if(e){if(typeof e[Symbol.iterator]!="function")throw new TypeError("not iterable");for(const a of e)if(!r.has(a)){const u=We(a);r.set(u,n),t[n++]=u}}const l={data:t,index:n,epoch:0,get size(){return He(this)||c(),r.size},has(a){const u=f(this),p=We(a);return this.epoch,u.has(p)},add(a){if(!He(this))throw new Error("Cannot perform mutations on a snapshot");const u=We(a);return r.has(u)||(r.set(u,this.index),this.data[this.index++]=u,this.epoch++),this},delete(a){if(!He(this))throw new Error("Cannot perform mutations on a snapshot");const u=We(a),p=r.get(u);return p===void 0?!1:(delete this.data[p],r.delete(u),this.epoch++,!0)},clear(){if(!He(this))throw new Error("Cannot perform mutations on a snapshot");this.data.length=0,this.index=0,this.epoch++,r.clear()},forEach(a){this.epoch,f(this).forEach(p=>{a(this.data[p],this.data[p],this)})},*values(){this.epoch;const a=f(this);for(const u of a.values())yield this.data[u]},keys(){return this.epoch,this.values()},*entries(){this.epoch;const a=f(this);for(const u of a.values()){const p=this.data[u];yield[p,p]}},toJSON(){return new Set(this.values())},[Symbol.iterator](){return this.values()},get[Symbol.toStringTag](){return"Set"},intersection(a){this.epoch;const u=se(a),p=se();for(const g of this.values())u.has(g)&&p.add(g);return se(p)},union(a){this.epoch;const u=se(),p=se(a);for(const g of this.values())u.add(g);for(const g of p)u.add(g);return se(u)},difference(a){this.epoch;const u=se(),p=se(a);for(const g of this.values())p.has(g)||u.add(g);return se(u)},symmetricDifference(a){this.epoch;const u=se(),p=se(a);for(const g of this.values())p.has(g)||u.add(g);for(const g of p.values())this.has(g)||u.add(g);return se(u)},isSubsetOf(a){this.epoch;const u=se(a);return this.size<=a.size&&[...this.values()].every(p=>u.has(p))},isSupersetOf(a){this.epoch;const u=se(a);return this.size>=a.size&&[...u].every(p=>this.has(p))},isDisjointFrom(a){this.epoch;const u=se(a);return[...this.values()].every(p=>!u.has(p))}},h=je(l);return Object.defineProperties(h,{size:{enumerable:!1},data:{enumerable:!1},index:{enumerable:!1},epoch:{enumerable:!1},toJSON:{enumerable:!1}}),Object.seal(h),h}const Tn=e=>typeof e=="object"&&e!==null;let st;const In=()=>(st||(st=Et().refSet),st);function Tt(e,t=In){if(!Tn(e)||t().has(e))return e;if(bn(e))return se([...e]);if(Sn(e))return bt([...e.entries()]);const r=Array.isArray(e)?[]:Object.create(Object.getPrototypeOf(e));return Reflect.ownKeys(e).forEach(n=>{r[n]=Tt(e[n],t)}),r}const vr=()=>({experiments:[],experimentIdToThresholds:{},referenceProteinsById:{},proteinIdToReferenceProtein:bt(),structures:[],aminoAcidsMustMatch:!1,experimentIdToVisibleCrosslinkIds:{},experimentIdToGroupedStructureIds:{},groupDuplicatedCrosslinks:!0,proteinIdToXLMapPosition:{},xlMapSettings:{showBackgroundGrid:!0,showProteinsFromOtherExperiments:!0,showProteinsWithoutCrosslinks:!0,colorCrosslinksBy:"type"}}),ae=je(vr()),Rn=(e,t=ae)=>{t.experiments.push(...e);for(const{id:r,crosslinks:n}of e)t.experimentIdToThresholds[r]={lower:22,upper:37},t.experimentIdToVisibleCrosslinkIds[r]=se(n.map(({id:i})=>i)),t.experimentIdToGroupedStructureIds[r]=yr([t.structures.map(({id:i})=>i)])},ni=e=>{var r;const t=(r=ae.experiments.find(n=>n.id===e))==null?void 0:r.proteins.map(({id:n})=>n);if(wr(t)){for(const n of t)ae.proteinIdToReferenceProtein.delete(n);for(const n of ae.structures){if(!n||n.loading)return;for(const[i,c]of Object.entries(n.chainIdToProteinIdToMapping)){const f=t.filter(l=>c[l]!==void 0);for(const l of f)n.chainIdToProteinIdToMapping[i][l]=void 0}}}ae.experiments=ae.experiments.filter(n=>n.id!==e),ae.experimentIdToThresholds=Object.fromEntries(Object.entries(ae.experimentIdToThresholds).filter(([n])=>n!==e)),ae.experimentIdToVisibleCrosslinkIds=Object.fromEntries(Object.entries(ae.experimentIdToVisibleCrosslinkIds).filter(([n])=>n!==e)),ae.experimentIdToGroupedStructureIds=Object.fromEntries(Object.entries(ae.experimentIdToGroupedStructureIds).filter(([n])=>n!==e))},ii=(e,{lower:t,upper:r})=>{ae.experimentIdToThresholds[e]={lower:t,upper:r}},si=(e,t,r)=>{const n=ae.experiments.find(({id:c})=>c===e);if(!n)throw new Error(`Experiment ${e} not found`);const i=n.proteins.find(({id:c})=>c===t);if(!i)throw new Error(`Protein ${t} not found in experiment ${e}`);"name"in r&&r.name!==void 0&&(i.name=r.name),"sequence"in r&&(i.sequence=r.sequence),"domains"in r&&(i.domains=Tt(r.domains))},On=(e,t)=>{if(!t)return;const r=Tt(t);Object.keys(r).forEach(n=>{const i=r[n];i&&(e[n]=i)})},oi=e=>{On(ae,e)},xn=e=>{const t=vr();return Rn(e,t),t},ai=()=>{const{experiments:e,referenceProteinsById:t,structures:r}=kn(ae);return e.length===0&&Object.keys(t).length===0&&r.length===0},ci=()=>{const{proteinIdToReferenceProtein:e,experimentIdToVisibleCrosslinkIds:t,structures:r,...n}=pt(ae);return{proteinIdToReferenceProtein:Array.from(e.entries()),experimentIdToVisibleCrosslinkIds:Object.fromEntries(Object.entries(t).map(([i,c])=>[i,Array.from(c)])),structures:r.flatMap(i=>i.loading?[]:[{...i,chainIdToProteinIdToMapping:Object.fromEntries(Object.entries(i.chainIdToProteinIdToMapping).map(([c,f])=>[c,Object.fromEntries(Object.entries(f).map(([l,h])=>[l,h?Array.from(h.entries()).map(([a,u])=>u!==void 0?[a,u]:[a]):void 0]))]))}]),...n}},An=({proteinIdToReferenceProtein:e,experimentIdToVisibleCrosslinkIds:t,structures:r,...n})=>({proteinIdToReferenceProtein:bt(e),experimentIdToVisibleCrosslinkIds:Object.fromEntries(Object.entries(t).map(([i,c])=>[i,se(c)])),structures:r.map(i=>({...i,chainIdToProteinIdToMapping:Object.fromEntries(Object.entries(i.chainIdToProteinIdToMapping).map(([c,f])=>[c,Object.fromEntries(Object.entries(f).map(([l,h])=>[l,h?mn(new Map(h.map(a=>a.length===1?[a[0],void 0]:a))):void 0]))]))})),...n});var Ye={exports:{}};/* @license
Papa Parse
v5.5.2
https://github.com/mholt/PapaParse
License: MIT
*/var Cn=Ye.exports,jt;function Mn(){return jt||(jt=1,function(e,t){((r,n)=>{e.exports=n()})(Cn,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},i,c=!n.document&&!!n.postMessage,f=n.IS_PAPA_WORKER||!1,l={},h=0,a={};function u(o){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(s){var d=D(s);d.chunkSize=parseInt(d.chunkSize),s.step||s.chunk||(d.chunkSize=null),this._handle=new z(d),(this._handle.streamer=this)._config=d}).call(this,o),this.parseChunk=function(s,d){var m=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<m){let x=this._config.newline;x||(w=this._config.quoteChar||'"',x=this._handle.guessLineEndings(s,w)),s=[...s.split(x).slice(m)].join(x)}this.isFirstChunk&&b(this._config.beforeFirstChunk)&&(w=this._config.beforeFirstChunk(s))!==void 0&&(s=w),this.isFirstChunk=!1,this._halted=!1;var m=this._partialLine+s,w=(this._partialLine="",this._handle.parse(m,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(s=w.meta.cursor,m=(this._finished||(this._partialLine=m.substring(s-this._baseIndex),this._baseIndex=s),w&&w.data&&(this._rowCount+=w.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),f)n.postMessage({results:w,workerId:a.WORKER_ID,finished:m});else if(b(this._config.chunk)&&!d){if(this._config.chunk(w,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=w=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(w.data),this._completeResults.errors=this._completeResults.errors.concat(w.errors),this._completeResults.meta=w.meta),this._completed||!m||!b(this._config.complete)||w&&w.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),m||w&&w.meta.paused||this._nextChunk(),w}this._halted=!0},this._sendError=function(s){b(this._config.error)?this._config.error(s):f&&this._config.error&&n.postMessage({workerId:a.WORKER_ID,error:s,finished:!1})}}function p(o){var s;(o=o||{}).chunkSize||(o.chunkSize=a.RemoteChunkSize),u.call(this,o),this._nextChunk=c?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(d){this._input=d,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(s=new XMLHttpRequest,this._config.withCredentials&&(s.withCredentials=this._config.withCredentials),c||(s.onload=q(this._chunkLoaded,this),s.onerror=q(this._chunkError,this)),s.open(this._config.downloadRequestBody?"POST":"GET",this._input,!c),this._config.downloadRequestHeaders){var d,m=this._config.downloadRequestHeaders;for(d in m)s.setRequestHeader(d,m[d])}var w;this._config.chunkSize&&(w=this._start+this._config.chunkSize-1,s.setRequestHeader("Range","bytes="+this._start+"-"+w));try{s.send(this._config.downloadRequestBody)}catch(x){this._chunkError(x.message)}c&&s.status===0&&this._chunkError()}},this._chunkLoaded=function(){s.readyState===4&&(s.status<200||400<=s.status?this._chunkError():(this._start+=this._config.chunkSize||s.responseText.length,this._finished=!this._config.chunkSize||this._start>=(d=>(d=d.getResponseHeader("Content-Range"))!==null?parseInt(d.substring(d.lastIndexOf("/")+1)):-1)(s),this.parseChunk(s.responseText)))},this._chunkError=function(d){d=s.statusText||d,this._sendError(new Error(d))}}function g(o){(o=o||{}).chunkSize||(o.chunkSize=a.LocalChunkSize),u.call(this,o);var s,d,m=typeof FileReader<"u";this.stream=function(w){this._input=w,d=w.slice||w.webkitSlice||w.mozSlice,m?((s=new FileReader).onload=q(this._chunkLoaded,this),s.onerror=q(this._chunkError,this)):s=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var w=this._input,x=(this._config.chunkSize&&(x=Math.min(this._start+this._config.chunkSize,this._input.size),w=d.call(w,this._start,x)),s.readAsText(w,this._config.encoding));m||this._chunkLoaded({target:{result:x}})},this._chunkLoaded=function(w){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(w.target.result)},this._chunkError=function(){this._sendError(s.error)}}function I(o){var s;u.call(this,o=o||{}),this.stream=function(d){return s=d,this._nextChunk()},this._nextChunk=function(){var d,m;if(!this._finished)return d=this._config.chunkSize,s=d?(m=s.substring(0,d),s.substring(d)):(m=s,""),this._finished=!s,this.parseChunk(m)}}function L(o){u.call(this,o=o||{});var s=[],d=!0,m=!1;this.pause=function(){u.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){u.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(w){this._input=w,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){m&&s.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),s.length?this.parseChunk(s.shift()):d=!0},this._streamData=q(function(w){try{s.push(typeof w=="string"?w:w.toString(this._config.encoding)),d&&(d=!1,this._checkIsFinished(),this.parseChunk(s.shift()))}catch(x){this._streamError(x)}},this),this._streamError=q(function(w){this._streamCleanUp(),this._sendError(w)},this),this._streamEnd=q(function(){this._streamCleanUp(),m=!0,this._streamData("")},this),this._streamCleanUp=q(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function z(o){var s,d,m,w,x=Math.pow(2,53),U=-x,V=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,K=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,S=this,N=0,P=0,ee=!1,T=!1,A=[],k={data:[],errors:[],meta:{}};function W(M){return o.skipEmptyLines==="greedy"?M.join("").trim()==="":M.length===1&&M[0].length===0}function C(){if(k&&m&&(re("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+a.DefaultDelimiter+"'"),m=!1),o.skipEmptyLines&&(k.data=k.data.filter(function(R){return!W(R)})),B()){let R=function(Y,J){b(o.transformHeader)&&(Y=o.transformHeader(Y,J)),A.push(Y)};if(k)if(Array.isArray(k.data[0])){for(var M=0;B()&&M<k.data.length;M++)k.data[M].forEach(R);k.data.splice(0,1)}else k.data.forEach(R)}function $(R,Y){for(var J=o.header?{}:[],H=0;H<R.length;H++){var Z=H,j=R[H],j=((he,F)=>(X=>(o.dynamicTypingFunction&&o.dynamicTyping[X]===void 0&&(o.dynamicTyping[X]=o.dynamicTypingFunction(X)),(o.dynamicTyping[X]||o.dynamicTyping)===!0))(he)?F==="true"||F==="TRUE"||F!=="false"&&F!=="FALSE"&&((X=>{if(V.test(X)&&(X=parseFloat(X),U<X&&X<x))return 1})(F)?parseFloat(F):K.test(F)?new Date(F):F===""?null:F):F)(Z=o.header?H>=A.length?"__parsed_extra":A[H]:Z,j=o.transform?o.transform(j,Z):j);Z==="__parsed_extra"?(J[Z]=J[Z]||[],J[Z].push(j)):J[Z]=j}return o.header&&(H>A.length?re("FieldMismatch","TooManyFields","Too many fields: expected "+A.length+" fields but parsed "+H,P+Y):H<A.length&&re("FieldMismatch","TooFewFields","Too few fields: expected "+A.length+" fields but parsed "+H,P+Y)),J}var G;k&&(o.header||o.dynamicTyping||o.transform)&&(G=1,!k.data.length||Array.isArray(k.data[0])?(k.data=k.data.map($),G=k.data.length):k.data=$(k.data,0),o.header&&k.meta&&(k.meta.fields=A),P+=G)}function B(){return o.header&&A.length===0}function re(M,$,G,R){M={type:M,code:$,message:G},R!==void 0&&(M.row=R),k.errors.push(M)}b(o.step)&&(w=o.step,o.step=function(M){k=M,B()?C():(C(),k.data.length!==0&&(N+=M.data.length,o.preview&&N>o.preview?d.abort():(k.data=k.data[0],w(k,S))))}),this.parse=function(M,$,G){var R=o.quoteChar||'"',R=(o.newline||(o.newline=this.guessLineEndings(M,R)),m=!1,o.delimiter?b(o.delimiter)&&(o.delimiter=o.delimiter(M),k.meta.delimiter=o.delimiter):((R=((Y,J,H,Z,j)=>{var he,F,X,ke;j=j||[",","	","|",";",a.RECORD_SEP,a.UNIT_SEP];for(var be=0;be<j.length;be++){for(var ve,Re=j[be],ce=0,me=0,ie=0,fe=(X=void 0,new y({comments:Z,delimiter:Re,newline:J,preview:10}).parse(Y)),we=0;we<fe.data.length;we++)H&&W(fe.data[we])?ie++:(ve=fe.data[we].length,me+=ve,X===void 0?X=ve:0<ve&&(ce+=Math.abs(ve-X),X=ve));0<fe.data.length&&(me/=fe.data.length-ie),(F===void 0||ce<=F)&&(ke===void 0||ke<me)&&1.99<me&&(F=ce,he=Re,ke=me)}return{successful:!!(o.delimiter=he),bestDelimiter:he}})(M,o.newline,o.skipEmptyLines,o.comments,o.delimitersToGuess)).successful?o.delimiter=R.bestDelimiter:(m=!0,o.delimiter=a.DefaultDelimiter),k.meta.delimiter=o.delimiter),D(o));return o.preview&&o.header&&R.preview++,s=M,d=new y(R),k=d.parse(s,$,G),C(),ee?{meta:{paused:!0}}:k||{meta:{paused:!1}}},this.paused=function(){return ee},this.pause=function(){ee=!0,d.abort(),s=b(o.chunk)?"":s.substring(d.getCharIndex())},this.resume=function(){S.streamer._halted?(ee=!1,S.streamer.parseChunk(s,!0)):setTimeout(S.resume,3)},this.aborted=function(){return T},this.abort=function(){T=!0,d.abort(),k.meta.aborted=!0,b(o.complete)&&o.complete(k),s=""},this.guessLineEndings=function(Y,R){Y=Y.substring(0,1048576);var R=new RegExp(v(R)+"([^]*?)"+v(R),"gm"),G=(Y=Y.replace(R,"")).split("\r"),R=Y.split(`
`),Y=1<R.length&&R[0].length<G[0].length;if(G.length===1||Y)return`
`;for(var J=0,H=0;H<G.length;H++)G[H][0]===`
`&&J++;return J>=G.length/2?`\r
`:"\r"}}function v(o){return o.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function y(o){var s=(o=o||{}).delimiter,d=o.newline,m=o.comments,w=o.step,x=o.preview,U=o.fastMode,V=null,K=!1,S=o.quoteChar==null?'"':o.quoteChar,N=S;if(o.escapeChar!==void 0&&(N=o.escapeChar),(typeof s!="string"||-1<a.BAD_DELIMITERS.indexOf(s))&&(s=","),m===s)throw new Error("Comment character same as delimiter");m===!0?m="#":(typeof m!="string"||-1<a.BAD_DELIMITERS.indexOf(m))&&(m=!1),d!==`
`&&d!=="\r"&&d!==`\r
`&&(d=`
`);var P=0,ee=!1;this.parse=function(T,A,k){if(typeof T!="string")throw new Error("Input must be a string");var W=T.length,C=s.length,B=d.length,re=m.length,M=b(w),$=[],G=[],R=[],Y=P=0;if(!T)return ce();if(U||U!==!1&&T.indexOf(S)===-1){for(var J=T.split(d),H=0;H<J.length;H++){if(R=J[H],P+=R.length,H!==J.length-1)P+=d.length;else if(k)return ce();if(!m||R.substring(0,re)!==m){if(M){if($=[],ke(R.split(s)),me(),ee)return ce()}else ke(R.split(s));if(x&&x<=H)return $=$.slice(0,x),ce(!0)}}return ce()}for(var Z=T.indexOf(s,P),j=T.indexOf(d,P),he=new RegExp(v(N)+v(S),"g"),F=T.indexOf(S,P);;)if(T[P]===S)for(F=P,P++;;){if((F=T.indexOf(S,F+1))===-1)return k||G.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:$.length,index:P}),ve();if(F===W-1)return ve(T.substring(P,F).replace(he,S));if(S===N&&T[F+1]===N)F++;else if(S===N||F===0||T[F-1]!==N){Z!==-1&&Z<F+1&&(Z=T.indexOf(s,F+1));var X=be((j=j!==-1&&j<F+1?T.indexOf(d,F+1):j)===-1?Z:Math.min(Z,j));if(T.substr(F+1+X,C)===s){R.push(T.substring(P,F).replace(he,S)),T[P=F+1+X+C]!==S&&(F=T.indexOf(S,P)),Z=T.indexOf(s,P),j=T.indexOf(d,P);break}if(X=be(j),T.substring(F+1+X,F+1+X+B)===d){if(R.push(T.substring(P,F).replace(he,S)),Re(F+1+X+B),Z=T.indexOf(s,P),F=T.indexOf(S,P),M&&(me(),ee))return ce();if(x&&$.length>=x)return ce(!0);break}G.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:$.length,index:P}),F++}}else if(m&&R.length===0&&T.substring(P,P+re)===m){if(j===-1)return ce();P=j+B,j=T.indexOf(d,P),Z=T.indexOf(s,P)}else if(Z!==-1&&(Z<j||j===-1))R.push(T.substring(P,Z)),P=Z+C,Z=T.indexOf(s,P);else{if(j===-1)break;if(R.push(T.substring(P,j)),Re(j+B),M&&(me(),ee))return ce();if(x&&$.length>=x)return ce(!0)}return ve();function ke(ie){$.push(ie),Y=P}function be(ie){var fe=0;return fe=ie!==-1&&(ie=T.substring(F+1,ie))&&ie.trim()===""?ie.length:fe}function ve(ie){return k||(ie===void 0&&(ie=T.substring(P)),R.push(ie),P=W,ke(R),M&&me()),ce()}function Re(ie){P=ie,ke(R),R=[],j=T.indexOf(d,P)}function ce(ie){if(o.header&&!A&&$.length&&!K){var fe=$[0],we={},rt=new Set(fe);let It=!1;for(let Te=0;Te<fe.length;Te++){let ge=fe[Te];if(we[ge=b(o.transformHeader)?o.transformHeader(ge,Te):ge]){let Oe,Rt=we[ge];for(;Oe=ge+"_"+Rt,Rt++,rt.has(Oe););rt.add(Oe),fe[Te]=Oe,we[ge]++,It=!0,(V=V===null?{}:V)[Oe]=ge}else we[ge]=1,fe[Te]=ge;rt.add(ge)}It&&console.warn("Duplicate headers found and renamed."),K=!0}return{data:$,errors:G,meta:{delimiter:s,linebreak:d,aborted:ee,truncated:!!ie,cursor:Y+(A||0),renamedHeaders:V}}}function me(){w(ce()),$=[],G=[]}},this.abort=function(){ee=!0},this.getCharIndex=function(){return P}}function _(o){var s=o.data,d=l[s.workerId],m=!1;if(s.error)d.userError(s.error,s.file);else if(s.results&&s.results.data){var w={abort:function(){m=!0,E(s.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:O,resume:O};if(b(d.userStep)){for(var x=0;x<s.results.data.length&&(d.userStep({data:s.results.data[x],errors:s.results.errors,meta:s.results.meta},w),!m);x++);delete s.results}else b(d.userChunk)&&(d.userChunk(s.results,w,s.file),delete s.results)}s.finished&&!m&&E(s.workerId,s.results)}function E(o,s){var d=l[o];b(d.userComplete)&&d.userComplete(s),d.terminate(),delete l[o]}function O(){throw new Error("Not implemented.")}function D(o){if(typeof o!="object"||o===null)return o;var s,d=Array.isArray(o)?[]:{};for(s in o)d[s]=D(o[s]);return d}function q(o,s){return function(){o.apply(s,arguments)}}function b(o){return typeof o=="function"}return a.parse=function(o,s){var d=(s=s||{}).dynamicTyping||!1;if(b(d)&&(s.dynamicTypingFunction=d,d={}),s.dynamicTyping=d,s.transform=!!b(s.transform)&&s.transform,!s.worker||!a.WORKERS_SUPPORTED)return d=null,a.NODE_STREAM_INPUT,typeof o=="string"?(o=(m=>m.charCodeAt(0)!==65279?m:m.slice(1))(o),d=new(s.download?p:I)(s)):o.readable===!0&&b(o.read)&&b(o.on)?d=new L(s):(n.File&&o instanceof File||o instanceof Object)&&(d=new g(s)),d.stream(o);(d=(()=>{var m;return!!a.WORKERS_SUPPORTED&&(m=(()=>{var w=n.URL||n.webkitURL||null,x=r.toString();return a.BLOB_URL||(a.BLOB_URL=w.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",x,")();"],{type:"text/javascript"})))})(),(m=new n.Worker(m)).onmessage=_,m.id=h++,l[m.id]=m)})()).userStep=s.step,d.userChunk=s.chunk,d.userComplete=s.complete,d.userError=s.error,s.step=b(s.step),s.chunk=b(s.chunk),s.complete=b(s.complete),s.error=b(s.error),delete s.worker,d.postMessage({input:o,config:s,workerId:d.id})},a.unparse=function(o,s){var d=!1,m=!0,w=",",x=`\r
`,U='"',V=U+U,K=!1,S=null,N=!1,P=((()=>{if(typeof s=="object"){if(typeof s.delimiter!="string"||a.BAD_DELIMITERS.filter(function(A){return s.delimiter.indexOf(A)!==-1}).length||(w=s.delimiter),typeof s.quotes!="boolean"&&typeof s.quotes!="function"&&!Array.isArray(s.quotes)||(d=s.quotes),typeof s.skipEmptyLines!="boolean"&&typeof s.skipEmptyLines!="string"||(K=s.skipEmptyLines),typeof s.newline=="string"&&(x=s.newline),typeof s.quoteChar=="string"&&(U=s.quoteChar),typeof s.header=="boolean"&&(m=s.header),Array.isArray(s.columns)){if(s.columns.length===0)throw new Error("Option columns is empty");S=s.columns}s.escapeChar!==void 0&&(V=s.escapeChar+U),s.escapeFormulae instanceof RegExp?N=s.escapeFormulae:typeof s.escapeFormulae=="boolean"&&s.escapeFormulae&&(N=/^[=+\-@\t\r].*$/)}})(),new RegExp(v(U),"g"));if(typeof o=="string"&&(o=JSON.parse(o)),Array.isArray(o)){if(!o.length||Array.isArray(o[0]))return ee(null,o,K);if(typeof o[0]=="object")return ee(S||Object.keys(o[0]),o,K)}else if(typeof o=="object")return typeof o.data=="string"&&(o.data=JSON.parse(o.data)),Array.isArray(o.data)&&(o.fields||(o.fields=o.meta&&o.meta.fields||S),o.fields||(o.fields=Array.isArray(o.data[0])?o.fields:typeof o.data[0]=="object"?Object.keys(o.data[0]):[]),Array.isArray(o.data[0])||typeof o.data[0]=="object"||(o.data=[o.data])),ee(o.fields||[],o.data||[],K);throw new Error("Unable to serialize unrecognized input");function ee(A,k,W){var C="",B=(typeof A=="string"&&(A=JSON.parse(A)),typeof k=="string"&&(k=JSON.parse(k)),Array.isArray(A)&&0<A.length),re=!Array.isArray(k[0]);if(B&&m){for(var M=0;M<A.length;M++)0<M&&(C+=w),C+=T(A[M],M);0<k.length&&(C+=x)}for(var $=0;$<k.length;$++){var G=(B?A:k[$]).length,R=!1,Y=B?Object.keys(k[$]).length===0:k[$].length===0;if(W&&!B&&(R=W==="greedy"?k[$].join("").trim()==="":k[$].length===1&&k[$][0].length===0),W==="greedy"&&B){for(var J=[],H=0;H<G;H++){var Z=re?A[H]:H;J.push(k[$][Z])}R=J.join("").trim()===""}if(!R){for(var j=0;j<G;j++){0<j&&!Y&&(C+=w);var he=B&&re?A[j]:j;C+=T(k[$][he],j)}$<k.length-1&&(!W||0<G&&!Y)&&(C+=x)}}return C}function T(A,k){var W,C;return A==null?"":A.constructor===Date?JSON.stringify(A).slice(1,25):(C=!1,N&&typeof A=="string"&&N.test(A)&&(A="'"+A,C=!0),W=A.toString().replace(P,V),(C=C||d===!0||typeof d=="function"&&d(A,k)||Array.isArray(d)&&d[k]||((B,re)=>{for(var M=0;M<re.length;M++)if(-1<B.indexOf(re[M]))return!0;return!1})(W,a.BAD_DELIMITERS)||-1<W.indexOf(w)||W.charAt(0)===" "||W.charAt(W.length-1)===" ")?U+W+U:W)}},a.RECORD_SEP="",a.UNIT_SEP="",a.BYTE_ORDER_MARK="\uFEFF",a.BAD_DELIMITERS=["\r",`
`,'"',a.BYTE_ORDER_MARK],a.WORKERS_SUPPORTED=!c&&!!n.Worker,a.NODE_STREAM_INPUT=1,a.LocalChunkSize=10485760,a.RemoteChunkSize=5242880,a.DefaultDelimiter=",",a.Parser=y,a.ParserHandle=z,a.NetworkStreamer=p,a.FileStreamer=g,a.StringStreamer=I,a.ReadableStreamStreamer=L,n.jQuery&&((i=n.jQuery).fn.parse=function(o){var s=o.config||{},d=[];return this.each(function(x){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var U=0;U<this.files.length;U++)d.push({file:this.files[U],inputElem:this,instanceConfig:i.extend({},s)})}),m(),this;function m(){if(d.length===0)b(o.complete)&&o.complete();else{var x,U,V,K,S=d[0];if(b(o.before)){var N=o.before(S.file,S.inputElem);if(typeof N=="object"){if(N.action==="abort")return x="AbortError",U=S.file,V=S.inputElem,K=N.reason,void(b(o.error)&&o.error({name:x},U,V,K));if(N.action==="skip")return void w();typeof N.config=="object"&&(S.instanceConfig=i.extend(S.instanceConfig,N.config))}else if(N==="skip")return void w()}var P=S.instanceConfig.complete;S.instanceConfig.complete=function(ee){b(P)&&P(ee,S.file,S.inputElem),w()},a.parse(S.file,S.instanceConfig)}}function w(){d.splice(0,1),m()}}),f&&(n.onmessage=function(o){o=o.data,a.WORKER_ID===void 0&&o&&(a.WORKER_ID=o.workerId),typeof o.input=="string"?n.postMessage({workerId:a.WORKER_ID,results:a.parse(o.input,o.config),finished:!0}):(n.File&&o.input instanceof File||o.input instanceof Object)&&(o=a.parse(o.input,o.config))&&n.postMessage({workerId:a.WORKER_ID,results:o,finished:!0})}),(p.prototype=Object.create(u.prototype)).constructor=p,(g.prototype=Object.create(u.prototype)).constructor=g,(I.prototype=Object.create(I.prototype)).constructor=I,(L.prototype=Object.create(u.prototype)).constructor=L,a})}(Ye)),Ye.exports}var Dn=Mn();const Ln=br(Dn),Fn=({from:e,to:t})=>`${e.proteinId}-${e.linkPosition}-${t.proteinId}-${t.linkPosition}`,zn=(e,{position:t,sequence:r})=>`${e}-${t}-${r}`,Nn=(e,t)=>e.proteinName!==t.proteinName?e.proteinName.localeCompare(t.proteinName):(e.linkPosition==="ntd"?0:e.linkPosition)-(t.linkPosition==="ntd"?0:t.linkPosition),$n=(e,t)=>Math.min(e.position+e.sequence.length,t.position+t.sequence.length)>Math.max(e.position,t.position),qt=(e,t)=>{let r=e.replaceAll(/[\[\]\{\}]/g,"");for(const[n,i]of Object.entries(t))r=r.replaceAll(i,n);if(!/^[GAVLITSMCPFYWHKRDENQ]*$/.test(r))throw new Error(`Sequence contains invalid amino acid codes: ${r}`);return r.toUpperCase()};function jn(e){return e.Protein1!==void 0&&e.Protein2!==void 0?[e.Protein1,e.Protein2]:e.Protein!==void 0?[e.Protein,e.Protein]:["Protein","Protein"]}function qn(e,t){if(e.PepPos1!==void 0&&e.PepSeq1!==void 0&&e.PepPos2!==void 0&&e.PepSeq2!==void 0)return[{position:Number.parseInt(e.PepPos1),sequence:qt(e.PepSeq1,t)},{position:Number.parseInt(e.PepPos2),sequence:qt(e.PepSeq2,t)}]}function vt(e,t){const r=e.position+t-1;return r===0?{linkPosition:"ntd"}:{linkPositionInPeptide:t,linkPosition:r,aminoAcid:e.sequence[t-1]}}function mt(e){var c;const{aminoAcid:t,position:r}=((c=/^(?<aminoAcid>[ACDEFGHIKLMNPQRSTVWY\{])(?<position>\d+)$/.exec(e))==null?void 0:c.groups)??{};if(!t||!r)throw new Error(`Residue field is formatted incorrectly: "${e}"`);const n=Number.parseInt(r);return t==="{"||n===0?{linkPosition:"ntd"}:{linkPosition:n,aminoAcid:t}}function Ut(e,t){const r=mt(t);if(r.linkPosition==="ntd")return r;const n=vt(e,r.linkPosition);if(n.linkPosition==="ntd")throw new Error("Link positioned at NTD according to peptide, but not according to residue");if(r.aminoAcid!==n.aminoAcid)throw new Error(`Amino acid according to residue is different then expected from peptide (${JSON.stringify(e)}: ${JSON.stringify(r)}, ${JSON.stringify(n)})`);return n}function Wt(e,t){return e===0?{linkPosition:"ntd"}:{linkPosition:e,aminoAcid:t}}function Un(e,t){if(t){if(e.LinkPos1!==void 0&&e.LinkPos2!==void 0)return[vt(t[0],Number.parseInt(e.LinkPos1)),vt(t[1],Number.parseInt(e.LinkPos2))];if(e.ResidueInPep1!==void 0&&e.ResidueInPep2!==void 0)return[Ut(t[0],e.ResidueInPep1),Ut(t[1],e.ResidueInPep2)]}if(e.Residue1!==void 0&&e.Residue2!==void 0)return[mt(e.Residue1),mt(e.Residue2)];if(e.Position1!==void 0&&e.Position2!==void 0)return[Wt(Number.parseInt(e.Position1),e.AminoAcid1),Wt(Number.parseInt(e.Position2),e.AminoAcid2)];throw new Error("Failed to parse crosslink")}function Wn(e,t){const r=jn(e),n=qn(e,t),i=Un(e,n).map((c,f)=>({proteinName:r[f],...c}));return[{peptide:n==null?void 0:n[0],link:i[0]},{peptide:n==null?void 0:n[1],link:i[1]}]}const oe=[];for(let e=0;e<256;++e)oe.push((e+256).toString(16).slice(1));function Hn(e,t=0){return(oe[e[t+0]]+oe[e[t+1]]+oe[e[t+2]]+oe[e[t+3]]+"-"+oe[e[t+4]]+oe[e[t+5]]+"-"+oe[e[t+6]]+oe[e[t+7]]+"-"+oe[e[t+8]]+oe[e[t+9]]+"-"+oe[e[t+10]]+oe[e[t+11]]+oe[e[t+12]]+oe[e[t+13]]+oe[e[t+14]]+oe[e[t+15]]).toLowerCase()}let ot;const Kn=new Uint8Array(16);function Bn(){if(!ot){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");ot=crypto.getRandomValues.bind(crypto)}return ot(Kn)}const Yn=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ht={randomUUID:Yn};function Kt(e,t,r){var i;if(Ht.randomUUID&&!e)return Ht.randomUUID();e=e||{};const n=e.random??((i=e.rng)==null?void 0:i.call(e))??Bn();if(n.length<16)throw new Error("Random bytes length must be >= 16");return n[6]=n[6]&15|64,n[8]=n[8]&63|128,Hn(n)}function*Vn(e,t){const r=/\s*^>(?<id>[^>\s\r\n]+)([^\S\r\n]+(?<desc>[^>\r\n]*?))?(?<sequence>(?:\r?\n[^\S\r\n]*[A-Za-z-]+)+)$\s*/gmy;let n;for(;(n=r.exec(e))!==null;){n.index===r.lastIndex&&r.lastIndex++;const{id:i,desc:c,sequence:f}=n.groups??{};!i||!f||(yield{id:i.trim(),desc:c==null?void 0:c.trim(),sequence:f.split(/\s+/).join("")})}}function fi(e){const t=/\s*^>(?<id>[^>\s\r\n]+)([^\S\r\n]+(?<desc>[^>\r\n]*?))?(?<sequence>(?:\r?\n[^\S\r\n]*[A-Za-z-]+)+)$\s*/gmy;return t.test(e)&&e.replaceAll(t,"").trim().length===0}function ui(e){return e.map(({id:t,desc:r,sequence:n})=>`>${t}${r?` ${r}`:""}
${n}`).join(`

`)}const mr=async(e,t=null,r={M:"Mox",C:"Ccm"},n={},i)=>new Promise((c,f)=>{Ln.parse(e,{header:t===null,skipEmptyLines:!0,complete:async l=>{try{const h={},a={},u=(v,y)=>{if(!(v in h))h[v]=Kt(),a[h[v]]={interProteinCrosslinks:[],intraProteinCrosslinks:[],homoMultimericCrosslinks:[],linkPositionToAminoAcid:new Map,...y?{havePeptides:!0,peptides:[],peptideHashToIndex:{},positionToPeptideIndices:new Map}:{havePeptides:!1}};else if(a[h[v]].havePeptides!==y)throw new Error("Some rows have peptides while others don't");return h[v]},p=(v,y)=>{const _=a[v];if(!_.havePeptides)throw new Error("Some rows have peptides while others don't");const{peptides:E,peptideHashToIndex:O,positionToPeptideIndices:D}=_,q=zn(v,y);if(q in O)return O[q];const b=E.push(y)-1;O[q]=b;for(let o=y.position;o<y.position+y.sequence.length;o++)D.has(o)||D.set(o,[]),D.get(o).push(b);return b},g=({proteinName:v,...y},_)=>{const E=u(v,!!_),O=_?p(E,_):void 0;if(y.linkPosition==="ntd")return a[E].linkPositionToAminoAcid.set("ntd",void 0),{...y,proteinId:E,peptideIndex:O};const D=a[E].linkPositionToAminoAcid.get(y.linkPosition);if(D===void 0)a[E].linkPositionToAminoAcid.set(y.linkPosition,y.aminoAcid);else if(y.aminoAcid!==void 0&&D!==y.aminoAcid)throw new Error(`Amino acids clash: position ${y.linkPosition} in protein "${v}" is specified with both ${D} and ${y.aminoAcid}`);if(O===void 0){if("linkPositionInPeptide"in y)throw new Error;return{...y,proteinId:E}}if(!("linkPositionInPeptide"in y))throw new Error;return{...y,proteinId:E,peptideIndex:O}},I=v=>{const[y,_]=Wn(v,r).toSorted(({link:E},{link:O})=>Nn(E,O));return{from:g(y.link,y.peptide),to:g(_.link,_.peptide),homoMultimeric:y.link.proteinName===_.link.proteinName?y.peptide&&_.peptide?$n(y.peptide,_.peptide):y.link.linkPosition===_.link.linkPosition:!1,score:v.Score!==void 0?Number.parseFloat(v.Score):void 0}};let L;const z={};l.data.forEach((v,y)=>{var O,D;if(t!==null){if(t.length!==v.length)throw new Error("The number of columns doesn't match the number of rows");v=Object.fromEntries(v.map((q,b)=>[t[b],q]))}else v.ID&&(v.id=v.ID);if(v.isDecoy!==void 0&&v.isDecoy.toLowerCase()==="true"||i&&((O=v.Protein1)!=null&&O.startsWith(i)||(D=v.Protein2)!=null&&D.startsWith(i)))return;if(L===void 0)L=v.id!==void 0;else if(L!==(v.id!==void 0))throw new Error("The table contains rows both with and without id field. Either make sure that all the rows have id, or remove the id column to use line numbers instead.");const _={id:v.id??String(y+1),...I(v)};_.from.proteinId===_.to.proteinId?(a[_.from.proteinId].intraProteinCrosslinks.push(_.id),_.homoMultimeric&&a[_.from.proteinId].homoMultimericCrosslinks.push(_.id)):(a[_.from.proteinId].interProteinCrosslinks.push(_.id),a[_.to.proteinId].interProteinCrosslinks.push(_.id));const E=Fn(_);E in z||(z[E]=[]),z[E].push(_)});for(const[v,y]of Object.entries(a))if(y.havePeptides)for(const[_,E]of y.positionToPeptideIndices.entries()){if(E.length===1)continue;const O=new Set(E.map(D=>y.peptides[D].sequence[_-y.peptides[D].position]));if(O.size>1)throw new Error(`Peptides clash: position ${_} in protein "${v}" is specified with multiple amino acids: ${Array.from(O)}`)}c({id:Kt(),name:e instanceof File?e.name.replace(/\.csv$/i,""):void 0,crosslinks:Object.values(z).flatMap(v=>v),proteins:Object.entries(h).map(([v,y])=>{const _=v.replace(/^>/,""),{linkPositionToAminoAcid:E,interProteinCrosslinks:O,intraProteinCrosslinks:D,homoMultimericCrosslinks:q,...b}=a[y];return{id:y,name:_,linkPositionToAminoAcid:Object.fromEntries(E.entries()),peptides:b.havePeptides?b.peptides:void 0,interProteinCrosslinks:O,intraProteinCrosslinks:D,homoMultimericCrosslinks:q,sequence:n[_]}})})}catch(h){f(h)}},error:l=>f(l)})}),Gn=["Score","m/z","Charge","M+H+","Calculated Mass","Deviation in ppm","PepSeq1","Protein1","PepPos1","PepEnd1","PepSeq2","Protein2","PepPos2","PepEnd2","Scan number","is Selected in Table","Candidate identifier","Folder Number","Retention time in sec","miscellaneous","ResidueInPep1","ResidueInPep2","All linkage positions","Spectrum UUID","local False discovery rate","shortest distance in pdb","Light/Heavy(1/2)","pepScore1","pepScore2","xLinkScore","resultId","MS1intensity","finalScoreComponent"],Jn=(e,t)=>new Promise((r,n)=>{Xr(e,{filter:i=>["Result.csv","properties.mxf","db.fasta"].includes(i.name)},async(i,c)=>{var f,l;if(i)return n(i);try{const h={};if(c["db.fasta"])for(const{id:I,sequence:L}of Vn(new TextDecoder().decode(c["db.fasta"])))h[I]=L;let a="DEC_";const u={};let p;for(const I of new TextDecoder().decode(c["properties.mxf"]).split(`
`)){if(I.startsWith("VARMODIFICATION")||I.startsWith("STATMODIFICATION")){p="modification";continue}else if(I.startsWith("END")){p=void 0;continue}if(p==="modification"){const{from:L,to:z}=((f=/(?<from>[A-Za-z]+);(?<to>[A-Za-z]+)/.exec(I))==null?void 0:f.groups)??{};if(!L||!z)continue;u[L]=z}else if(p===void 0){const{value:L}=((l=/^DECOYIDENTIFIER=(?<value>\w+)/.exec(I))==null?void 0:l.groups)??{};L&&(a=L)}}const g=await mr(new TextDecoder().decode(c["Result.csv"]),Gn,u,h,a);t&&(g.name=t),r(g)}catch(h){n(h)}})}),Zn=async e=>An(JSON.parse(sr(Yr(await Bt(e))))),gr=async e=>{if(/\.csv$/i.test(e.name))return mr(e);const t=/\.zhrm$/i;if(t.test(e.name))return Jn(await Bt(e),e.name.replace(t,""));throw new Error("Invalid file format")},Qn=async e=>{const t=await Promise.all(e.map(gr));return xn(t)},li=Object.freeze(Object.defineProperty({__proto__:null,buildStoreFromExperimentFiles:Qn,readExperimentFile:gr,readProjectFile:Zn},Symbol.toStringTag,{value:"Module"}));export{On as _,kn as a,ae as b,Kt as c,Tt as d,je as e,vn as f,ui as g,ni as h,ai as i,gr as j,Rn as k,ci as l,ti as m,ri as n,oi as o,Vn as p,li as q,mn as r,ii as s,si as u,fi as v};
