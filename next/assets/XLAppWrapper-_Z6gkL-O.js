const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/kmeans-BT0PiHSU.js","assets/index-DD997Ml2.js","assets/index-3tt6cl52.css"])))=>i.map(i=>d[i]);
import{c as Oe,a as Ag,s as Ww,n as Eg,r as ur,g as Ig,b as Uw,d as li,e as _,u as Vt,f as Ke,m as Y,j as d,h as Z,i as qw,k as Ln,l as Wt,o as yn,p as Xw,q as Gw,t as rn,v as Yw,w as Kw,L as Zw,x as nr,y as Jw,z as Qw,A as e_,B as t_,C as n_,D as r_,E as ed,F as i_,G as jt,H as Fo,I as s_,J as o_,K as a_,M as Rg,N as l_,O as c_,P as u_,Q as d_,R as h_,S as f_,T as p_,U as m_,V as g_,W as x_,X as b_,Y as y_,Z as v_,_ as w_,$ as __,a0 as S_,a1 as P_,a2 as C_,a3 as k_,a4 as j_,a5 as T_,a6 as M_,a7 as A_,a8 as E_,a9 as I_,aa as R_,ab as Qe,ac as O_,ad as Fh,ae as zh,af as $_,ag as vt,ah as Og,ai as D_,aj as zs,ak as mt,al as td,am as N_,an as nd,ao as L_,ap as rd,aq as F_,ar as ao,as as tu,at as z_,au as ft,av as B_,aw as hl,ax as H_,ay as Bh,az as bn,aA as V_,aB as $g,aC as W_,aD as te,aE as Cr,aF as Kr,aG as U_,aH as Rs,aI as nt,aJ as ci,aK as rt,aL as Zr,aM as lo,aN as yr,aO as gn,aP as co,aQ as id,aR as sd,aS as De,aT as nu,aU as q_,aV as od,aW as Tn,aX as Hh,aY as Nr,aZ as vi,a_ as Jn,a$ as Jr,b0 as fl,b1 as Bs,b2 as Vh,b3 as X_,b4 as $i,b5 as G_,b6 as Dg,b7 as ad,b8 as Y_,b9 as K_,ba as Ng,bb as Lg,bc as Z_,bd as J_,be as Q_,bf as e2,bg as t2,bh as n2,bi as r2,bj as i2,bk as Fg,bl as s2,bm as o2,bn as ru,bo as _i,bp as pl,bq as a2,br as Aa,bs as ml,bt as l2,bu as zg,bv as ld,bw as c2,bx as Bg,by as u2,bz as d2,bA as Hg,bB as Xi,bC as h2,bD as Vg,bE as f2,bF as p2,bG as m2,bH as Wh,bI as g2,bJ as x2,bK as b2,bL as Wg,bM as y2,bN as v2,bO as w2,bP as _2,bQ as S2,bR as P2,bS as C2}from"./index-DD997Ml2.js";import{s as zo,v as Ug,p as qg,u as Hs,a as Je,b as ie,_ as Xg,c as gl,d as Gg,e as k2,f as Uh,r as Yg,g as Kg,h as j2,i as T2,j as M2,k as qh,l as A2,m as E2,n as I2}from"./import-files-D1OBN2w8.js";const Fn=n=>Oe()(n,["immediate","lazyMount","onExitComplete","present","skipAnimationOnMount","unmountOnExit"]);function R2(n,e){const{state:t,send:r,context:i}=n,s=t.matches("mounted","unmountSuspended");return{skip:!i.get("initial"),present:s,setNode(o){o&&r({type:"NODE.SET",node:o})},unmount(){r({type:"UNMOUNT"})}}}var O2=Ag({props({props:n}){return{...n,present:!!n.present}},initialState({prop:n}){return n("present")?"mounted":"unmounted"},refs(){return{node:null,styles:null}},context({bindable:n}){return{unmountAnimationName:n(()=>({defaultValue:null})),prevAnimationName:n(()=>({defaultValue:null})),present:n(()=>({defaultValue:!1})),initial:n(()=>({sync:!0,defaultValue:!1}))}},exit:["clearInitial","cleanupNode"],watch({track:n,action:e,prop:t}){n([()=>t("present")],()=>{e(["setInitial","syncPresence"])})},on:{"NODE.SET":{actions:["setNode","setStyles"]}},states:{mounted:{on:{UNMOUNT:{target:"unmounted",actions:["clearPrevAnimationName","invokeOnExitComplete"]},"UNMOUNT.SUSPEND":{target:"unmountSuspended"}}},unmountSuspended:{effects:["trackAnimationEvents"],on:{MOUNT:{target:"mounted",actions:["setPrevAnimationName"]},UNMOUNT:{target:"unmounted",actions:["clearPrevAnimationName","invokeOnExitComplete"]}}},unmounted:{on:{MOUNT:{target:"mounted",actions:["setPrevAnimationName"]}}}},implementations:{actions:{setInitial:({context:n})=>{n.get("initial")||queueMicrotask(()=>{n.set("initial",!0)})},clearInitial:({context:n})=>{n.set("initial",!1)},cleanupNode:({refs:n})=>{n.set("node",null),n.set("styles",null)},invokeOnExitComplete:({prop:n})=>{n("onExitComplete")?.()},setNode:({refs:n,event:e})=>{n.set("node",e.node)},setStyles:({refs:n,event:e})=>{n.set("styles",Ig(e.node))},syncPresence:({context:n,refs:e,send:t,prop:r})=>{const i=r("present");if(i)return t({type:"MOUNT",src:"presence.changed"});const s=e.get("node");if(!i&&s?.ownerDocument.visibilityState==="hidden")return t({type:"UNMOUNT",src:"visibilitychange"});ur(()=>{const o=Bo(e.get("styles"));n.set("unmountAnimationName",o),o==="none"||o===n.get("prevAnimationName")||e.get("styles")?.display==="none"||e.get("styles")?.animationDuration==="0s"?t({type:"UNMOUNT",src:"presence.changed"}):t({type:"UNMOUNT.SUSPEND"})})},setPrevAnimationName:({context:n,refs:e})=>{ur(()=>{n.set("prevAnimationName",Bo(e.get("styles")))})},clearPrevAnimationName:({context:n})=>{n.set("prevAnimationName",null)}},effects:{trackAnimationEvents:({context:n,refs:e,send:t})=>{const r=e.get("node");if(!r)return;const i=a=>{(a.composedPath?.()?.[0]??a.target)===r&&n.set("prevAnimationName",Bo(e.get("styles")))},s=a=>{const l=Bo(e.get("styles"));Uw(a)===r&&l===n.get("unmountAnimationName")&&t({type:"UNMOUNT",src:"animationend"})};r.addEventListener("animationstart",i),r.addEventListener("animationcancel",s),r.addEventListener("animationend",s);const o=Ww(r,{animationFillMode:"forwards"});return()=>{r.removeEventListener("animationstart",i),r.removeEventListener("animationcancel",s),r.removeEventListener("animationend",s),Eg(()=>o())}}}}});function Bo(n){return n?.animationName||"none"}li()(["onExitComplete","present","immediate"]);function Zg(n,e={}){const{sync:t=!1}=e,r=$2(n);return _.useCallback((...i)=>t?queueMicrotask(()=>r.current?.(...i)):r.current?.(...i),[t,r])}function $2(n){const e=_.useRef(n);return e.current=n,e}const sn=(n={})=>{const{lazyMount:e,unmountOnExit:t,present:r,skipAnimationOnMount:i=!1,...s}=n,o=_.useRef(!1),a={...s,present:r,onExitComplete:Zg(n.onExitComplete)},l=Vt(O2,a),c=R2(l);c.present&&(o.current=!0);const u=!c.present&&!o.current&&e||t&&!c.present&&o.current,h=()=>({"data-state":c.skip&&i?void 0:r?"open":"closed",hidden:!c.present});return{ref:c.setNode,getPresenceProps:h,present:c.present,unmounted:u}},[vn,Ut]=Ke({name:"PresenceContext",hookName:"usePresenceContext",providerName:"<PresenceProvider />"}),[xl,Jg]=Ke({name:"RenderStrategyContext",hookName:"useRenderStrategyContext",providerName:"<RenderStrategyPropsProvider />"}),bl=n=>Oe()(n,["lazyMount","unmountOnExit"]),[Qg,yl]=Ke({name:"CheckboxContext",hookName:"useCheckboxContext",providerName:"<CheckboxProvider />"}),e0=_.forwardRef((n,e)=>{const t=yl(),r=Y(t.getControlProps(),n);return d.jsx(Z.div,{...r,ref:e})});e0.displayName="CheckboxControl";function D2(n){const{value:e,onChange:t,defaultValue:r}=n,[i,s]=_.useState(r),o=e!==void 0,a=o?e:i,l=_.useCallback(c=>(o||s(c),t?.(c)),[o,t]);return[a,l]}function N2(n={}){const{defaultValue:e,value:t,onValueChange:r,disabled:i,readOnly:s,name:o,invalid:a}=n,l=!(i||s),c=Zg(r,{sync:!0}),[u,h]=D2({value:t,defaultValue:e||[],onChange:c}),f=b=>u.some(y=>String(y)===String(b)),p=b=>{f(b)?g(b):m(b)},m=b=>{l&&(f(b)||h(u.concat(b)))},g=b=>{l&&h(u.filter(y=>String(y)!==String(b)))};return{isChecked:f,value:u,name:o,disabled:!!i,readOnly:!!s,invalid:!!a,setValue:h,addValue:m,toggleValue:p,getItemProps:b=>({checked:b.value!=null?f(b.value):void 0,onCheckedChange(){b.value!=null&&p(b.value)},name:o,disabled:i,readOnly:s,invalid:a})}}const[L2,F2]=Ke({name:"CheckboxGroupContext",hookName:"useCheckboxGroupContext",providerName:"<CheckboxGroupProvider />",strict:!1}),t0=_.forwardRef((n,e)=>{const[t,r]=Oe()(n,["defaultValue","value","onValueChange","disabled","invalid","readOnly","name"]),i=N2(t);return d.jsx(L2,{value:i,children:d.jsx(Z.div,{ref:e,role:"group",...r,...qw.build().group.attrs})})});t0.displayName="CheckboxGroup";const n0=_.forwardRef((n,e)=>{const t=yl(),r=Y(t.getHiddenInputProps(),n),i=Ln();return d.jsx(Z.input,{"aria-describedby":i?.ariaDescribedby,...r,ref:e})});n0.displayName="CheckboxHiddenInput";const r0=_.forwardRef((n,e)=>{const t=yl(),r=Y(t.getLabelProps(),n);return d.jsx(Z.span,{...r,ref:e})});r0.displayName="CheckboxLabel";const z2=(n={})=>{const e=F2(),t=Ln(),r=_.useMemo(()=>Y(n,e?.getItemProps({value:n.value})??{}),[n,e]),i=_.useId(),{getRootNode:s}=Wt(),{dir:o}=yn(),a={id:i,ids:{label:t?.ids.label,hiddenInput:t?.ids.control},dir:o,disabled:t?.disabled,readOnly:t?.readOnly,invalid:t?.invalid,required:t?.required,getRootNode:s,...r},l=Vt(Xw,a);return Gw(l,rn)},i0=_.forwardRef((n,e)=>{const[t,r]=Oe()(n,["checked","defaultChecked","disabled","form","id","ids","invalid","name","onCheckedChange","readOnly","required","value"]),i=z2(t),s=Y(i.getRootProps(),r);return d.jsx(Qg,{value:i,children:d.jsx(Z.label,{...s,ref:e})})});i0.displayName="CheckboxRoot";const s0=_.forwardRef((n,e)=>{const[{value:t},r]=Oe()(n,["value"]),i=Y(t.getRootProps(),r);return d.jsx(Qg,{value:t,children:d.jsx(Z.label,{...i,ref:e})})});s0.displayName="CheckboxRootProvider";const[o0,Gi]=Ke({name:"ClipboardContext",hookName:"useClipboardContext",providerName:"<ClipboardProvider />"}),a0=_.forwardRef((n,e)=>{const t=Gi(),r=Y(t.getControlProps(),n);return d.jsx(Z.div,{...r,ref:e})});a0.displayName="ClipboardControl";const l0=_.forwardRef((n,e)=>{const{children:t,copied:r,...i}=n,s=Gi(),o=Y(s.getIndicatorProps({copied:s.copied}),i);return d.jsx(Z.div,{...o,ref:e,children:s.copied?r:t})});l0.displayName="ClipboardIndicator";const c0=_.forwardRef((n,e)=>{const t=Gi(),r=Y(t.getInputProps(),n);return d.jsx(Z.input,{...r,ref:e})});c0.displayName="ClipboardInput";const u0=_.forwardRef((n,e)=>{const t=Gi(),r=Y(t.getLabelProps(),n);return d.jsx(Z.label,{...r,ref:e})});u0.displayName="ClipboardLabel";const B2=n=>{const e=_.useId(),{getRootNode:t}=Wt(),r={id:e,getRootNode:t,...n},i=Vt(Yw,r);return Kw(i,rn)},d0=_.forwardRef((n,e)=>{const[t,r]=Oe()(n,["defaultValue","id","ids","onStatusChange","onValueChange","timeout","value"]),i=B2(t),s=Y(i.getRootProps(),r);return d.jsx(o0,{value:i,children:d.jsx(Z.div,{ref:e,...s})})});d0.displayName="ClipboardRoot";const h0=_.forwardRef((n,e)=>{const[{value:t},r]=Oe()(n,["value"]),i=Y(t.getRootProps(),r);return d.jsx(o0,{value:t,children:d.jsx(Z.div,{ref:e,...i})})});h0.displayName="ClipboardRootProvider";const f0=_.forwardRef((n,e)=>{const t=Gi(),r=Y(t.getTriggerProps(),n);return d.jsx(Z.button,{...r,ref:e})});f0.displayName="ClipboardTrigger";const p0=_.forwardRef((n,e)=>{const t=Gi();return d.jsx(Z.span,{...n,ref:e,children:n.children||t.value})});p0.displayName="ClipboardValueText";const cd=n=>new Zw(n),[m0,kr]=Ke({name:"DialogContext",hookName:"useDialogContext",providerName:"<DialogProvider />"}),g0=_.forwardRef((n,e)=>{const t=kr(),r=Jg(),i=sn({...r,present:t.open}),s=Y(t.getBackdropProps(),i.getPresenceProps(),n);return i.unmounted?null:d.jsx(Z.div,{...s,ref:nr(i.ref,e)})});g0.displayName="DialogBackdrop";const x0=_.forwardRef((n,e)=>{const t=kr(),r=Y(t.getCloseTriggerProps(),n);return d.jsx(Z.button,{...r,ref:e})});x0.displayName="DialogCloseTrigger";const b0=_.forwardRef((n,e)=>{const t=kr(),r=Ut(),i=Y(t.getContentProps(),r.getPresenceProps(),n);return r.unmounted?null:d.jsx(Z.div,{...i,ref:nr(r.ref,e)})});b0.displayName="DialogContent";const y0=_.forwardRef((n,e)=>{const t=kr(),r=Y(t.getDescriptionProps(),n);return d.jsx(Z.div,{...r,ref:e})});y0.displayName="DialogDescription";const v0=_.forwardRef((n,e)=>{const t=kr(),r=Y(t.getPositionerProps(),n);return Ut().unmounted?null:d.jsx(Z.div,{...r,ref:e})});v0.displayName="DialogPositioner";const xn=n=>{const e=_.useId(),{getRootNode:t}=Wt(),{dir:r}=yn(),i={id:e,getRootNode:t,dir:r,...n},s=Vt(Jw,i);return Qw(s,rn)},H2=n=>{const[e,{children:t,...r}]=Fn(n),[i]=bl(e),s=xn(r),o=sn(Y({present:s.open},e));return d.jsx(m0,{value:s,children:d.jsx(xl,{value:i,children:d.jsx(vn,{value:o,children:t})})})},V2=n=>{const[e,{value:t,children:r}]=Fn(n),[i]=bl(e),s=sn(Y({present:t.open},e));return d.jsx(m0,{value:t,children:d.jsx(xl,{value:i,children:d.jsx(vn,{value:s,children:r})})})},w0=_.forwardRef((n,e)=>{const t=kr(),r=Y(t.getTitleProps(),n);return d.jsx(Z.h2,{...r,ref:e})});w0.displayName="DialogTitle";const _0=_.forwardRef((n,e)=>{const t=kr(),r=Ut(),i=Y({...t.getTriggerProps(),"aria-controls":r.unmounted?void 0:t.getTriggerProps()["aria-controls"]},n);return d.jsx(Z.button,{...i,ref:e})});_0.displayName="DialogTrigger";const[S0,jr]=Ke({name:"EditableContext",hookName:"useEditableContext",providerName:"<EditableProvider />"}),P0=_.forwardRef((n,e)=>{const t=jr(),r=Y(t.getAreaProps(),n);return d.jsx(Z.div,{...r,ref:e})});P0.displayName="EditableArea";const C0=_.forwardRef((n,e)=>{const t=jr(),r=Y(t.getCancelTriggerProps(),n);return d.jsx(Z.button,{...r,ref:e})});C0.displayName="EditableCancelTrigger";const k0=_.forwardRef((n,e)=>{const t=jr(),r=Y(t.getControlProps(),n);return d.jsx(Z.div,{...r,ref:e})});k0.displayName="EditableControl";const j0=_.forwardRef((n,e)=>{const t=jr(),r=Y(t.getEditTriggerProps(),n);return d.jsx(Z.button,{...r,ref:e})});j0.displayName="EditableEditTrigger";const T0=_.forwardRef((n,e)=>{const t=jr(),r=Y(t.getInputProps(),n),i=Ln();return d.jsx(Z.input,{"aria-describedby":i?.ariaDescribedby,...r,ref:e})});T0.displayName="EditableInput";const M0=_.forwardRef((n,e)=>{const t=jr(),r=Y(t.getPreviewProps(),n);return d.jsx(Z.span,{...r,ref:e})});M0.displayName="EditablePreview";const uo=n=>{const e=_.useId(),{getRootNode:t}=Wt(),{dir:r}=yn(),i=Ln(),s={id:e,ids:{label:i?.ids.label,input:i?.ids.control},dir:r,disabled:i?.disabled,invalid:i?.invalid,readOnly:i?.readOnly,required:i?.required,getRootNode:t,...n},o=Vt(e_,s);return t_(o,rn)},A0=_.forwardRef((n,e)=>{const[t,r]=Oe()(n,["activationMode","autoResize","defaultEdit","defaultValue","disabled","edit","finalFocusEl","form","id","ids","invalid","maxLength","name","onEditChange","onFocusOutside","onInteractOutside","onPointerDownOutside","onValueChange","onValueCommit","onValueRevert","placeholder","readOnly","required","selectOnFocus","submitMode","translations","value"]),i=uo(t),s=Y(i.getRootProps(),r);return d.jsx(S0,{value:i,children:d.jsx(Z.div,{...s,ref:e})})});A0.displayName="EditableRoot";const E0=_.forwardRef((n,e)=>{const[{value:t},r]=Oe()(n,["value"]),i=Y(t.getRootProps(),r);return d.jsx(S0,{value:t,children:d.jsx(Z.div,{...i,ref:e})})});E0.displayName="EditableRootProvider";const I0=_.forwardRef((n,e)=>{const t=jr(),r=Y(t.getSubmitTriggerProps(),n);return d.jsx(Z.button,{...r,ref:e})});I0.displayName="EditableSubmitTrigger";const R0=_.forwardRef((n,e)=>{const t=Ln(),r=Y(t?.getInputProps(),n);return d.jsx(Z.input,{...r,ref:e})});R0.displayName="FieldInput";var W2=n=>{if(!n)return;const e=Ig(n),t=n_(n),r=r_(n),i=()=>{requestAnimationFrame(()=>{n.style.height="auto";let c;e.boxSizing==="content-box"?c=n.scrollHeight-(parseFloat(e.paddingTop)+parseFloat(e.paddingBottom)):c=n.scrollHeight+parseFloat(e.borderTopWidth)+parseFloat(e.borderBottomWidth),e.maxHeight!=="none"&&c>parseFloat(e.maxHeight)?(e.overflowY==="hidden"&&(n.style.overflowY="scroll"),c=parseFloat(e.maxHeight)):e.overflowY!=="hidden"&&(n.style.overflowY="hidden"),n.style.height=`${c}px`})};n.addEventListener("input",i),n.form?.addEventListener("reset",i);const s=Object.getPrototypeOf(n),o=Object.getOwnPropertyDescriptor(s,"value");Object.defineProperty(n,"value",{...o,set(){o?.set?.apply(this,arguments),i()}});const a=new t.ResizeObserver(()=>{requestAnimationFrame(()=>i())});a.observe(n);const l=new t.MutationObserver(()=>i());return l.observe(n,{attributes:!0,attributeFilter:["rows","placeholder"]}),r.fonts?.addEventListener("loadingdone",i),()=>{n.removeEventListener("input",i),n.form?.removeEventListener("reset",i),r.fonts?.removeEventListener("loadingdone",i),a.disconnect(),l.disconnect()}};const O0=_.forwardRef((n,e)=>{const{autoresize:t,...r}=n,i=_.useRef(null),s=Ln(),o=Y(s?.getTextareaProps(),{style:{resize:t?"none":void 0}},r);return _.useEffect(()=>{if(t)return W2(i.current)},[t]),d.jsx(Z.textarea,{...o,ref:nr(e,i)})});O0.displayName="FieldTextarea";const $0=_.forwardRef((n,e)=>{const t=ed(),r=Y(t.getErrorTextProps(),n);return t.invalid?d.jsx(Z.span,{...r,ref:e}):null});$0.displayName="FieldsetErrorText";const D0=_.forwardRef((n,e)=>{const t=ed(),r=Y(t.getHelperTextProps(),n);return d.jsx(Z.span,{...r,ref:e})});D0.displayName="FieldsetHelperText";const N0=_.forwardRef((n,e)=>{const t=ed(),r=Y(t.getLegendProps(),n);return d.jsx(Z.legend,{...r,ref:e})});N0.displayName="FieldsetLegend";const U2=(n={})=>{const{disabled:e=!1,invalid:t=!1}=n,r=Wt(),i=_.useRef(!1),s=_.useRef(!1),o=n.id??_.useId(),a=_.useRef(null),l=`fieldset::${o}::error-text`,c=`fieldset::${o}::helper-text`;i_(()=>{const g=a.current;if(!g)return;const x=()=>{const w=r.getRootNode();i.current=!!w.getElementById(l),s.current=!!w.getElementById(c)};x();const b=r.getWindow(),y=new b.MutationObserver(x);return y.observe(g,{childList:!0,subtree:!0}),()=>y.disconnect()},[r,l,c]);const u=_.useMemo(()=>{const g=[];return i.current&&t&&g.push(l),s.current&&g.push(c),g.join(" ")||void 0},[t,l,c]),h=_.useMemo(()=>()=>({...Fo.root.attrs,ref:a,disabled:e,"data-disabled":jt(e),"data-invalid":jt(t),"aria-describedby":u}),[e,t,u]),f=_.useMemo(()=>()=>({...Fo.legend.attrs,"data-disabled":jt(e),"data-invalid":jt(t)}),[e,t]),p=_.useMemo(()=>()=>({id:c,...Fo.helperText.attrs}),[c]),m=_.useMemo(()=>()=>({id:l,...Fo.errorText.attrs,"aria-live":"polite"}),[l]);return{refs:{rootRef:a},disabled:e,invalid:t,getRootProps:h,getLegendProps:f,getHelperTextProps:p,getErrorTextProps:m}},L0=_.forwardRef((n,e)=>{const[t,r]=Oe()(n,["id","disabled","invalid"]),i=U2(t),s=Y(i.getRootProps(),r);return d.jsx(s_,{value:i,children:d.jsx(Z.fieldset,{...s,ref:nr(e,i.refs.rootRef)})})});L0.displayName="FieldsetRoot";const[F0,ot]=Ke({name:"MenuContext",hookName:"useMenuContext",providerName:"<MenuProvider />",strict:!1}),z0=_.forwardRef((n,e)=>{const t=ot(),r=Y(t.getArrowProps(),n);return d.jsx(Z.div,{...r,ref:e})});z0.displayName="MenuArrow";const B0=_.forwardRef((n,e)=>{const t=ot(),r=Y(t.getArrowTipProps(),n);return d.jsx(Z.div,{...r,ref:e})});B0.displayName="MenuArrowTip";const[ud,x7]=Ke({name:"MenuItemContext",hookName:"useMenuItemContext",providerName:"<MenuItemProvider />"}),[dd,H0]=Ke({name:"MenuItemPropsContext",hookName:"useMenuItemPropsContext",providerName:"<MenuItemPropsProvider />"}),V0=_.forwardRef((n,e)=>{const[t,r]=Oe()(n,["checked","closeOnSelect","disabled","onCheckedChange","value","valueText"]),i={...t,type:"checkbox"},s=ot(),o=Y(s.getOptionItemProps(i),r),a=s.getOptionItemState(i);return d.jsx(dd,{value:i,children:d.jsx(ud,{value:a,children:d.jsx(Z.div,{...o,ref:e})})})});V0.displayName="MenuCheckboxItem";const W0=_.forwardRef((n,e)=>{const t=ot(),r=Ut(),i=Y(t.getContentProps(),r.getPresenceProps(),n);return r.unmounted?null:d.jsx(Z.div,{...i,ref:nr(r.ref,e)})});W0.displayName="MenuContent";const U0=_.forwardRef((n,e)=>{const t=ot(),r=Y(t.getContextTriggerProps(),n);return d.jsx(Z.button,{...r,ref:e})});U0.displayName="MenuContextTrigger";const q0=_.forwardRef((n,e)=>{const t=ot(),r=Y(t.getIndicatorProps(),n);return d.jsx(Z.div,{...r,ref:e})});q0.displayName="MenuIndicator";const X0=_.forwardRef((n,e)=>{const[t,r]=Oe()(n,["closeOnSelect","disabled","value","valueText","onSelect"]),i=ot(),s=Y(i.getItemProps(t),r),o=i.getItemState(t);return _.useEffect(()=>i.addItemListener({id:o.id,onSelect:t.onSelect}),[o.id,t.onSelect]),d.jsx(dd,{value:t,children:d.jsx(ud,{value:o,children:d.jsx(Z.div,{...s,ref:e})})})});X0.displayName="MenuItem";const[G0,Y0]=Ke({name:"MenuItemGroupContext",hookName:"useMenuItemGroupContext",providerName:"<MenuItemGroupProvider />"}),K0=_.forwardRef((n,e)=>{const[t,r]=Oe()(n,["id"]),i=ot(),o={id:_.useId(),...t},a=Y(i.getItemGroupProps(o),r);return d.jsx(G0,{value:o,children:d.jsx(Z.div,{...a,ref:e})})});K0.displayName="MenuItemGroup";const Z0=_.forwardRef((n,e)=>{const t=ot(),r=Y0(),i=Y(t.getItemGroupLabelProps({htmlFor:r.id}),n);return d.jsx(Z.div,{...i,ref:e})});Z0.displayName="MenuItemGroupLabel";const J0=_.forwardRef((n,e)=>{const t=ot(),r=H0(),i=Y(t.getItemIndicatorProps(r),n);return d.jsx(Z.div,{...i,ref:e})});J0.displayName="MenuItemIndicator";const Q0=_.forwardRef((n,e)=>{const t=ot(),r=H0(),i=Y(t.getItemTextProps(r),n);return d.jsx(Z.div,{...i,ref:e})});Q0.displayName="MenuItemText";const ex=_.forwardRef((n,e)=>{const t=ot(),r=Y(t.getPositionerProps(),n);return Ut().unmounted?null:d.jsx(Z.div,{...r,ref:e})});ex.displayName="MenuPositioner";const tx=_.forwardRef((n,e)=>{const[t,r]=Oe()(n,["closeOnSelect","disabled","value","valueText"]),i=ot(),s=Y0(),o={...t,checked:s.value===t.value,type:"radio",onCheckedChange:()=>s.onValueChange?.({value:t.value})},a=Y(i.getOptionItemProps(o),r),l=i.getOptionItemState(o);return d.jsx(dd,{value:o,children:d.jsx(ud,{value:l,children:d.jsx(Z.div,{...a,ref:e})})})});tx.displayName="MenuRadioItem";const nx=_.forwardRef((n,e)=>{const[t,r]=Oe()(n,["id","onValueChange","value"]),i=ot(),o={id:_.useId(),...t},a=Y(i.getItemGroupProps({id:o.id}),r);return d.jsx(G0,{value:o,children:d.jsx(Z.div,{...a,ref:e})})});nx.displayName="MenuRadioItemGroup";const rx=n=>{const e=_.useRef(n),t=_.useRef(!1);_.useEffect(()=>{e.current=n}),_.useEffect(()=>{t.current!==!0&&(t.current=!0,e.current())},[])},q2=n=>{const e=_.useId(),{getRootNode:t}=Wt(),{dir:r}=yn(),i={id:e,dir:r,getRootNode:t,...n},s=Vt(o_,i);return{api:a_(s,rn),service:s}},[ix,sx]=Ke({name:"MenuMachineContext",hookName:"useMenuMachineContext",providerName:"<MenuMachineProvider />",strict:!1}),[ox,X2]=Ke({name:"MenuMachineContext",hookName:"useMenuMachineContext",providerName:"<MenuMachineProvider />",strict:!1}),G2=n=>{const[e,t]=Fn(n),[r,i]=Oe()(t,["anchorPoint","aria-label","closeOnSelect","composite","defaultHighlightedValue","defaultOpen","highlightedValue","id","ids","loopFocus","navigate","onEscapeKeyDown","onFocusOutside","onHighlightChange","onInteractOutside","onOpenChange","onPointerDownOutside","onSelect","open","positioning","typeahead"]),s=ot(),o=sx(),{api:a,service:l}=q2(r),c=sn(Y({present:a.open},e));rx(()=>{o&&s&&(s.setChild(l),a.setParent(o))});const u=_.useCallback(()=>s?.getTriggerItemProps(a),[a,s]);return d.jsx(ox,{value:u,children:d.jsx(ix,{value:l,children:d.jsx(F0,{value:a,children:d.jsx(vn,{value:c,...i})})})})},Y2=n=>{const e=ot(),t=sx(),[r,{value:i,children:s}]=Fn(n),{api:o,service:a}=i,l=sn(Y({present:o.open},r));rx(()=>{t&&e&&(e.setChild(a),o.setParent(t))});const c=_.useCallback(()=>e?.getTriggerItemProps(o),[o,e]);return d.jsx(ox,{value:c,children:d.jsx(ix,{value:a,children:d.jsx(F0,{value:o,children:d.jsx(vn,{value:l,children:s})})})})},ax=_.forwardRef((n,e)=>{const t=ot(),r=Y(t.getSeparatorProps(),n);return d.jsx(Z.hr,{...r,ref:e})});ax.displayName="MenuSeparator";const lx=_.forwardRef((n,e)=>{const t=ot(),r=Ut(),i=Y({...t.getTriggerProps(),"aria-controls":r.unmounted?void 0:t.getTriggerProps()["aria-controls"]},n);return d.jsx(Z.button,{...i,ref:e})});lx.displayName="MenuTrigger";const cx=_.forwardRef((n,e)=>{const t=X2(),r=Y(t?.()??{},n);return d.jsx(Z.div,{...r,ref:e})});cx.displayName="MenuTriggerItem";const[ux,Yi]=Ke({name:"PaginationContext",hookName:"usePaginationContext",providerName:"<PaginationProvider />"}),dx=_.forwardRef((n,e)=>{const[t,r]=Oe()(n,["index"]),i=Yi(),s=Y(i.getEllipsisProps(t),r);return d.jsx(Z.div,{...s,ref:e})});dx.displayName="PaginationEllipsis";const hx=_.forwardRef((n,e)=>{const[t,r]=Oe()(n,["value","type"]),i=Yi(),s=Y(i.getItemProps(t),r);return d.jsx(Z.button,{...s,ref:e})});hx.displayName="PaginationItem";const fx=_.forwardRef((n,e)=>{const t=Yi(),r=Y(t.getNextTriggerProps(),n);return d.jsx(Z.button,{...r,ref:e})});fx.displayName="PaginationNextTrigger";const px=_.forwardRef((n,e)=>{const t=Yi(),r=Y(t.getPrevTriggerProps(),n);return d.jsx(Z.button,{...r,ref:e})});px.displayName="PaginationPrevTrigger";var K2=Rg("pagination").parts("root","item","ellipsis","prevTrigger","nextTrigger"),cs=K2.build(),Z2=n=>n.ids?.root??`pagination:${n.id}`,J2=n=>n.ids?.prevTrigger??`pagination:${n.id}:prev`,Q2=n=>n.ids?.nextTrigger??`pagination:${n.id}:next`,eS=(n,e)=>n.ids?.ellipsis?.(e)??`pagination:${n.id}:ellipsis:${e}`,tS=(n,e)=>n.ids?.item?.(e)??`pagination:${n.id}:item:${e}`,Ho=(n,e)=>{let t=e-n+1;return Array.from({length:t},(r,i)=>i+n)},nS=n=>n.map(e=>typeof e=="number"?{type:"page",value:e}:{type:"ellipsis"}),Vo="ellipsis",rS=n=>{const{page:e,totalPages:t,siblingCount:r}=n,i=Math.min(2*r+5,t),s=1,o=t,a=Math.max(e-r,s),l=Math.min(e+r,o),c=a>s+1,u=l<o-1,h=i-2;if(!c&&u)return[...Ho(1,h),Vo,o];if(c&&!u){const p=Ho(o-h+1,o);return[s,Vo,...p]}if(c&&u){const p=Ho(a,l);return[s,Vo,...p,Vo,o]}return Ho(s,o)},iS=n=>nS(rS(n));function sS(n,e){const{send:t,scope:r,prop:i,computed:s,context:o}=n,a=s("totalPages"),l=o.get("page"),c=i("translations"),u=i("count"),h=s("previousPage"),f=s("nextPage"),p=s("pageRange"),g=i("type")==="button",x=l===1,b=l===a,y=iS({page:l,totalPages:a,siblingCount:i("siblingCount")});return{count:u,page:l,pageSize:o.get("pageSize"),totalPages:a,pages:y,previousPage:h,nextPage:f,pageRange:p,slice(w){return w.slice(p.start,p.end)},setPageSize(w){t({type:"SET_PAGE_SIZE",size:w})},setPage(w){t({type:"SET_PAGE",page:w})},goToNextPage(){t({type:"NEXT_PAGE"})},goToPrevPage(){t({type:"PREVIOUS_PAGE"})},goToFirstPage(){t({type:"FIRST_PAGE"})},goToLastPage(){t({type:"LAST_PAGE"})},getRootProps(){return e.element({id:Z2(r),...cs.root.attrs,dir:i("dir"),"aria-label":c.rootLabel})},getEllipsisProps(w){return e.element({id:eS(r,w.index),...cs.ellipsis.attrs,dir:i("dir")})},getItemProps(w){const v=w.value,S=v===l;return e.element({id:tS(r,v),...cs.item.attrs,dir:i("dir"),"data-index":v,"data-selected":jt(S),"aria-current":S?"page":void 0,"aria-label":c.itemLabel?.({page:v,totalPages:a}),onClick(){t({type:"SET_PAGE",page:v})},...g&&{type:"button"}})},getPrevTriggerProps(){return e.element({id:J2(r),...cs.prevTrigger.attrs,dir:i("dir"),"data-disabled":jt(x),"aria-label":c.prevTriggerLabel,onClick(){t({type:"PREVIOUS_PAGE"})},...g&&{disabled:x,type:"button"}})},getNextTriggerProps(){return e.element({id:Q2(r),...cs.nextTrigger.attrs,dir:i("dir"),"data-disabled":jt(b),"aria-label":c.nextTriggerLabel,onClick(){t({type:"NEXT_PAGE"})},...g&&{disabled:b,type:"button"}})}}}var oS=Ag({props({props:n}){return{defaultPageSize:10,siblingCount:1,defaultPage:1,type:"button",count:1,...n,translations:{rootLabel:"pagination",prevTriggerLabel:"previous page",nextTriggerLabel:"next page",itemLabel({page:e,totalPages:t}){return`${t>1&&e===t?"last page, ":""}page ${e}`},...n.translations}}},initialState(){return"idle"},context({prop:n,bindable:e,getContext:t}){return{page:e(()=>({value:n("page"),defaultValue:n("defaultPage"),onChange(r){const i=t();n("onPageChange")?.({page:r,pageSize:i.get("pageSize")})}})),pageSize:e(()=>({value:n("pageSize"),defaultValue:n("defaultPageSize"),onChange(r){n("onPageSizeChange")?.({pageSize:r})}}))}},watch({track:n,context:e,action:t}){n([()=>e.get("pageSize")],()=>{t(["setPageIfNeeded"])})},computed:{totalPages:({context:n,prop:e})=>Math.ceil(e("count")/n.get("pageSize")),previousPage:({context:n})=>n.get("page")===1?null:n.get("page")-1,nextPage:({context:n,computed:e})=>n.get("page")===e("totalPages")?null:n.get("page")+1,pageRange:({context:n,prop:e})=>{const t=(n.get("page")-1)*n.get("pageSize"),r=Math.min(t+n.get("pageSize"),e("count"));return{start:t,end:r}},isValidPage:({context:n,computed:e})=>n.get("page")>=1&&n.get("page")<=e("totalPages")},on:{SET_PAGE:{guard:"isValidPage",actions:["setPage"]},SET_PAGE_SIZE:{actions:["setPageSize"]},FIRST_PAGE:{actions:["goToFirstPage"]},LAST_PAGE:{actions:["goToLastPage"]},PREVIOUS_PAGE:{guard:"canGoToPrevPage",actions:["goToPrevPage"]},NEXT_PAGE:{guard:"canGoToNextPage",actions:["goToNextPage"]}},states:{idle:{}},implementations:{guards:{isValidPage:({event:n,computed:e})=>n.page>=1&&n.page<=e("totalPages"),isValidCount:({context:n,event:e})=>n.get("page")>e.count,canGoToNextPage:({context:n,computed:e})=>n.get("page")<e("totalPages"),canGoToPrevPage:({context:n})=>n.get("page")>1},actions:{setPage({context:n,event:e,computed:t}){const r=gc(e.page,t("totalPages"));n.set("page",r)},setPageSize({context:n,event:e}){n.set("pageSize",e.size)},goToFirstPage({context:n}){n.set("page",1)},goToLastPage({context:n,computed:e}){n.set("page",e("totalPages"))},goToPrevPage({context:n,computed:e}){n.set("page",t=>gc(t-1,e("totalPages")))},goToNextPage({context:n,computed:e}){n.set("page",t=>gc(t+1,e("totalPages")))},setPageIfNeeded({context:n,computed:e}){e("isValidPage")||n.set("page",1)}}}}),gc=(n,e)=>Math.min(Math.max(n,1),e);li()(["count","dir","getRootNode","id","ids","onPageChange","onPageSizeChange","page","defaultPage","pageSize","defaultPageSize","siblingCount","translations","type"]);li()(["value","type"]);li()(["index"]);const aS=n=>{const e=_.useId(),{getRootNode:t}=Wt(),{dir:r}=yn(),i={id:e,dir:r,getRootNode:t,...n},s=Vt(oS,i);return sS(s,rn)},mx=_.forwardRef((n,e)=>{const[t,r]=Oe()(n,["count","defaultPage","defaultPageSize","id","ids","onPageChange","onPageSizeChange","page","pageSize","siblingCount","translations","type"]),i=aS(t),s=Y(i.getRootProps(),r);return d.jsx(ux,{value:i,children:d.jsx(Z.nav,{...s,ref:e})})});mx.displayName="PaginationRoot";const gx=_.forwardRef((n,e)=>{const[{value:t},r]=Oe()(n,["value"]),i=Y(t.getRootProps(),r);return d.jsx(ux,{value:t,children:d.jsx(Z.nav,{...i,ref:e})})});gx.displayName="PaginationRootProvider";const[xx,zn]=Ke({name:"PopoverContext",hookName:"usePopoverContext",providerName:"<PopoverProvider />"}),bx=_.forwardRef((n,e)=>{const t=zn(),r=Y(t.getAnchorProps(),n);return d.jsx(Z.div,{...r,ref:e})});bx.displayName="PopoverAnchor";const yx=_.forwardRef((n,e)=>{const t=zn(),r=Y(t.getArrowProps(),n);return d.jsx(Z.div,{...r,ref:e})});yx.displayName="PopoverArrow";const vx=_.forwardRef((n,e)=>{const t=zn(),r=Y(t.getArrowTipProps(),n);return d.jsx(Z.div,{...r,ref:e})});vx.displayName="PopoverArrowTip";const hd=_.forwardRef((n,e)=>{const t=zn(),r=Y(t.getCloseTriggerProps(),n);return d.jsx(Z.button,{...r,ref:e})});hd.displayName="PopoverCloseTrigger";const fd=_.forwardRef((n,e)=>{const t=zn(),r=Ut(),i=Y(t.getContentProps(),r.getPresenceProps(),n);return r.unmounted?null:d.jsx(Z.div,{...i,ref:nr(r.ref,e)})});fd.displayName="PopoverContent";const wx=_.forwardRef((n,e)=>{const t=zn(),r=Y(t.getDescriptionProps(),n);return d.jsx(Z.div,{...r,ref:e})});wx.displayName="PopoverDescription";const _x=_.forwardRef((n,e)=>{const t=zn(),r=Y(t.getIndicatorProps(),n);return d.jsx(Z.div,{...r,ref:e})});_x.displayName="PopoverIndicator";const Sx=_.forwardRef((n,e)=>{const t=zn(),r=Ut(),i=Y(t.getPositionerProps(),n);return r.unmounted?null:d.jsx(Z.div,{...i,ref:e})});Sx.displayName="PopoverPositioner";const iu=n=>{const e=_.useId(),{getRootNode:t}=Wt(),{dir:r}=yn(),i={id:e,dir:r,getRootNode:t,...n},s=Vt(l_,i);return c_(s,rn)},Px=n=>{const[e,{children:t,...r}]=Fn(n),i=iu(r),s=sn(Y({present:i.open},e));return d.jsx(xx,{value:i,children:d.jsx(vn,{value:s,children:t})})},Cx=n=>{const[e,{value:t,children:r}]=Fn(n),i=sn(Y({present:t.open},e));return d.jsx(xx,{value:t,children:d.jsx(vn,{value:i,children:r})})},kx=_.forwardRef((n,e)=>{const t=zn(),r=Y(t.getTitleProps(),n);return d.jsx(Z.div,{...r,ref:e})});kx.displayName="PopoverTitle";const jx=_.forwardRef((n,e)=>{const t=zn(),r=Ut(),i=Y({...t.getTriggerProps(),"aria-controls":r.unmounted?void 0:t.getTriggerProps()["aria-controls"]},n);return d.jsx(Z.button,{...i,ref:e})});jx.displayName="PopoverTrigger";const[Tx,vl]=Ke({name:"ProgressContext",hookName:"useProgressContext",providerName:"<ProgressProvider />"}),Mx=_.forwardRef((n,e)=>{const t=vl(),r=Y(t.getLabelProps(),n);return d.jsx(Z.label,{...r,ref:e})});Mx.displayName="ProgressLabel";const Ax=_.forwardRef((n,e)=>{const t=vl(),r=Y(t.getRangeProps(),n);return d.jsx(Z.div,{...r,ref:e})});Ax.displayName="ProgressRange";const lS=n=>{const e=_.useId(),{getRootNode:t}=Wt(),{dir:r,locale:i}=yn(),s={id:e,dir:r,locale:i,getRootNode:t,...n},o=Vt(u_,s);return d_(o,rn)},Ex=_.forwardRef((n,e)=>{const[t,r]=Oe()(n,["defaultValue","formatOptions","id","ids","locale","max","min","onValueChange","orientation","translations","value"]),i=lS(t),s=Y(i.getRootProps(),r);return d.jsx(Tx,{value:i,children:d.jsx(Z.div,{...s,ref:e})})});Ex.displayName="ProgressRoot";const Ix=_.forwardRef((n,e)=>{const[{value:t},r]=Oe()(n,["value"]),i=Y(t.getRootProps(),r);return d.jsx(Tx,{value:t,children:d.jsx(Z.div,{...i,ref:e})})});Ix.displayName="ProgressRootProvider";const Rx=_.forwardRef((n,e)=>{const t=vl(),r=Y(t.getTrackProps(),n);return d.jsx(Z.div,{...r,ref:e})});Rx.displayName="ProgressTrack";const Ox=_.forwardRef((n,e)=>{const{children:t,...r}=n,i=vl(),s=Y(i.getValueTextProps(),r);return d.jsx(Z.span,{...s,ref:e,children:t||i.percentAsString})});Ox.displayName="ProgressValueText";const[$x,_t]=Ke({name:"SelectContext",hookName:"useSelectContext",providerName:"<SelectProvider />"}),Dx=_.forwardRef((n,e)=>{const t=_t(),r=Y(t.getClearTriggerProps(),n);return d.jsx(Z.button,{...r,ref:e})});Dx.displayName="SelectClearTrigger";const Nx=_.forwardRef((n,e)=>{const t=_t(),r=Ut(),i=Y(t.getContentProps(),r.getPresenceProps(),n);return r.unmounted?null:d.jsx(Z.div,{...i,ref:nr(r.ref,e)})});Nx.displayName="SelectContent";const cS=n=>n.children(_t()),Lx=_.forwardRef((n,e)=>{const t=_t(),r=Y(t.getControlProps(),n);return d.jsx(Z.div,{...r,ref:e})});Lx.displayName="SelectControl";const Fx=_.forwardRef((n,e)=>{const t=_t(),r=Y(t.getHiddenSelectProps(),n),i=t.value.length===0,s=Ln();return d.jsxs(Z.select,{"aria-describedby":s?.ariaDescribedby,...r,ref:e,children:[i&&d.jsx("option",{value:""}),t.collection.items.map((o,a)=>d.jsx("option",{value:t.collection.getItemValue(o)??"",disabled:t.collection.getItemDisabled(o),children:t.collection.stringifyItem(o)},a))]})});Fx.displayName="SelectHiddenSelect";const zx=_.forwardRef((n,e)=>{const t=_t(),r=Y(t.getIndicatorProps(),n);return d.jsx(Z.div,{...r,ref:e})});zx.displayName="SelectIndicator";const[uS,b7]=Ke({name:"SelectItemContext",hookName:"useSelectItemContext",providerName:"<SelectItemProvider />"}),[dS,Bx]=Ke({name:"SelectItemPropsContext",hookName:"useSelectItemPropsContext",providerName:"<SelectItemPropsProvider />"}),Hx=_.forwardRef((n,e)=>{const[t,r]=Oe()(n,["item","persistFocus"]),i=_t(),s=Y(i.getItemProps(t),r),o=i.getItemState(t);return d.jsx(dS,{value:t,children:d.jsx(uS,{value:o,children:d.jsx(Z.div,{...s,ref:e})})})});Hx.displayName="SelectItem";const[hS,fS]=Ke({name:"SelectItemGroupPropsContext",hookName:"useSelectItemGroupPropsContext",providerName:"<SelectItemGroupPropsProvider />"}),Vx=_.forwardRef((n,e)=>{const t=_.useId(),[r,i]=Oe()(n,["id"]),s={id:t,...r},o=_t(),a=Y(o.getItemGroupProps(s),i);return d.jsx(hS,{value:s,children:d.jsx(Z.div,{...a,ref:e})})});Vx.displayName="SelectItemGroup";const Wx=_.forwardRef((n,e)=>{const t=_t(),r=fS(),i=Y(t.getItemGroupLabelProps({htmlFor:r.id}),n);return d.jsx(Z.div,{...i,ref:e})});Wx.displayName="SelectItemGroupLabel";const Ux=_.forwardRef((n,e)=>{const t=_t(),r=Bx(),i=Y(t.getItemIndicatorProps(r),n);return d.jsx(Z.div,{...i,ref:e})});Ux.displayName="SelectItemIndicator";const qx=_.forwardRef((n,e)=>{const t=_t(),r=Bx(),i=Y(t.getItemTextProps(r),n);return d.jsx(Z.span,{...i,ref:e})});qx.displayName="SelectItemText";const Xx=_.forwardRef((n,e)=>{const t=_t(),r=Y(t.getLabelProps(),n);return d.jsx(Z.label,{...r,ref:e})});Xx.displayName="SelectLabel";const Gx=_.forwardRef((n,e)=>{const t=_t(),r=Y(t.getPositionerProps(),n);return Ut().unmounted?null:d.jsx(Z.div,{...r,ref:e})});Gx.displayName="SelectPositioner";const wl=n=>{const e=_.useId(),{dir:t}=yn(),{getRootNode:r}=Wt(),i=Ln(),s={id:e,ids:{label:i?.ids.label,hiddenSelect:i?.ids.control},disabled:i?.disabled,readOnly:i?.readOnly,invalid:i?.invalid,required:i?.required,dir:t,getRootNode:r,...n},o=Vt(h_,s);return f_(o,rn)},pS=(n,e)=>{const[t,r]=Fn(n),[i,s]=Oe()(r,["closeOnSelect","collection","composite","defaultHighlightedValue","defaultOpen","defaultValue","deselectable","disabled","form","highlightedValue","id","ids","invalid","loopFocus","multiple","name","onFocusOutside","onHighlightChange","onInteractOutside","onOpenChange","onPointerDownOutside","onSelect","onValueChange","open","positioning","readOnly","required","scrollToIndexFn","value"]),o=wl(i),a=sn(Y({present:o.open},t)),l=Y(o.getRootProps(),s);return d.jsx($x,{value:o,children:d.jsx(vn,{value:a,children:d.jsx(Z.div,{...l,ref:e})})})},mS=_.forwardRef(pS),gS=(n,e)=>{const[t,r]=Fn(n),[{value:i},s]=Oe()(r,["value"]),o=sn(Y({present:i.open},t)),a=Y(i.getRootProps(),s);return d.jsx($x,{value:i,children:d.jsx(vn,{value:o,children:d.jsx(Z.div,{...a,ref:e})})})},xS=_.forwardRef(gS),Yx=_.forwardRef((n,e)=>{const t=_t(),r=Y(t.getTriggerProps(),n);return d.jsx(Z.button,{...r,ref:e})});Yx.displayName="SelectTrigger";const Kx=_.forwardRef((n,e)=>{const{children:t,placeholder:r,...i}=n,s=_t(),o=Y(s.getValueTextProps(),i);return d.jsx(Z.span,{...o,ref:e,children:t||s.valueAsString||r})});Kx.displayName="SelectValueText";const[Zx,Ki]=Ke({name:"SwitchContext",hookName:"useSwitchContext",providerName:"<SwitchProvider />"}),Jx=_.forwardRef((n,e)=>{const t=Ki(),r=Y(t.getControlProps(),n);return d.jsx(Z.span,{...r,ref:e})});Jx.displayName="SwitchControl";const Qx=_.forwardRef((n,e)=>{const t=Ki(),r=Y(t.getHiddenInputProps(),n),i=Ln();return d.jsx(Z.input,{"aria-describedby":i?.ariaDescribedby,...r,ref:e})});Qx.displayName="SwitchHiddenInput";const e1=_.forwardRef((n,e)=>{const t=Ki(),r=Y(t.getLabelProps(),n);return d.jsx(Z.span,{...r,ref:e})});e1.displayName="SwitchLabel";const bS=n=>{const e=_.useId(),{getRootNode:t}=Wt(),{dir:r}=yn(),i=Ln(),s={id:e,ids:{label:i?.ids.label,hiddenInput:i?.ids.control},dir:r,disabled:i?.disabled,readOnly:i?.readOnly,invalid:i?.invalid,required:i?.required,getRootNode:t,...n},o=Vt(p_,s);return m_(o,rn)},t1=_.forwardRef((n,e)=>{const[t,r]=Oe()(n,["checked","defaultChecked","disabled","form","id","ids","invalid","label","name","onCheckedChange","readOnly","required","value"]),i=bS(t),s=Y(i.getRootProps(),r);return d.jsx(Zx,{value:i,children:d.jsx(Z.label,{...s,ref:e})})});t1.displayName="SwitchRoot";const n1=_.forwardRef((n,e)=>{const[{value:t},r]=Oe()(n,["value"]),i=Y(t.getRootProps(),r);return d.jsx(Zx,{value:t,children:d.jsx(Z.label,{...i,ref:e})})});n1.displayName="SwitchRootProvider";const r1=_.forwardRef((n,e)=>{const t=Ki(),r=Y(t.getThumbProps(),n);return d.jsx(Z.span,{...r,ref:e})});r1.displayName="SwitchThumb";function yS(n,e){const[t,r]=_.useState(n);return _.useEffect(()=>{const i=setTimeout(()=>{r(n)},e);return()=>{clearTimeout(i)}},[n,e]),t}const[i1,_l]=Ke({name:"TabsContext",hookName:"useTabsContext",providerName:"<TabsProvider />"}),s1=_.forwardRef((n,e)=>{const[t,r]=Oe()(n,["value"]),i=_l(),s=Jg(),o=sn({...s,present:yS(i.value===n.value,0),immediate:!0}),a=Y(i.getContentProps(t),o.getPresenceProps(),r);return d.jsx(vn,{value:o,children:o.unmounted?null:d.jsx(Z.div,{...a,ref:nr(o.ref,e)})})});s1.displayName="TabContent";const o1=_.forwardRef((n,e)=>{const t=_l(),r=Y(t.getIndicatorProps(),n);return d.jsx(Z.div,{...r,ref:e})});o1.displayName="TabIndicator";const a1=_.forwardRef((n,e)=>{const t=_l(),r=Y(t.getListProps(),n);return d.jsx(Z.div,{...r,ref:e})});a1.displayName="TabList";const l1=_.forwardRef((n,e)=>{const[t,r]=Oe()(n,["disabled","value"]),i=_l(),s=Y(i.getTriggerProps(t),r);return d.jsx(Z.button,{...s,ref:e})});l1.displayName="TabTrigger";var vS=Rg("tabs").parts("root","list","trigger","content","indicator"),us=vS.build(),wS=n=>n.ids?.root??`tabs:${n.id}`,Os=n=>n.ids?.list??`tabs:${n.id}:list`,su=(n,e)=>n.ids?.content??`tabs:${n.id}:content-${e}`,Wr=(n,e)=>n.ids?.trigger??`tabs:${n.id}:trigger-${e}`,c1=n=>n.ids?.indicator??`tabs:${n.id}:indicator`,_S=n=>n.getById(Os(n)),SS=(n,e)=>n.getById(su(n,e)),xa=(n,e)=>n.getById(Wr(n,e)),Xh=n=>n.getById(c1(n)),ho=n=>{const t=`[role=tab][data-ownedby='${CSS.escape(Os(n))}']:not([disabled])`;return E_(_S(n),t)},PS=n=>S_(ho(n)),CS=n=>__(ho(n)),kS=(n,e)=>w_(ho(n),Wr(n,e.value),e.loopFocus),jS=(n,e)=>v_(ho(n),Wr(n,e.value),e.loopFocus),u1=n=>({left:n?.offsetLeft??0,top:n?.offsetTop??0,width:n?.offsetWidth??0,height:n?.offsetHeight??0}),TS=(n,e)=>{const t=A_(ho(n),Wr(n,e));return d1(u1(t))},d1=n=>({width:`${n.width}px`,height:`${n.height}px`,left:`${n.left}px`,top:`${n.top}px`});function MS(n,e){const{state:t,send:r,context:i,prop:s,scope:o}=n,a=s("translations"),l=t.matches("focused"),c=s("orientation")==="vertical",u=s("orientation")==="horizontal",h=s("composite");function f(p){return{selected:i.get("value")===p.value,focused:i.get("focusedValue")===p.value,disabled:!!p.disabled}}return{value:i.get("value"),focusedValue:i.get("focusedValue"),setValue(p){r({type:"SET_VALUE",value:p})},clearValue(){r({type:"CLEAR_VALUE"})},setIndicatorRect(p){const m=Wr(o,p);r({type:"SET_INDICATOR_RECT",id:m})},syncTabIndex(){r({type:"SYNC_TAB_INDEX"})},selectNext(p){r({type:"TAB_FOCUS",value:p,src:"selectNext"}),r({type:"ARROW_NEXT",src:"selectNext"})},selectPrev(p){r({type:"TAB_FOCUS",value:p,src:"selectPrev"}),r({type:"ARROW_PREV",src:"selectPrev"})},focus(){const p=i.get("value");p&&xa(o,p)?.focus()},getRootProps(){return e.element({...us.root.attrs,id:wS(o),"data-orientation":s("orientation"),"data-focus":jt(l),dir:s("dir")})},getListProps(){return e.element({...us.list.attrs,id:Os(o),role:"tablist",dir:s("dir"),"data-focus":jt(l),"aria-orientation":s("orientation"),"data-orientation":s("orientation"),"aria-label":a?.listLabel,onKeyDown(p){if(p.defaultPrevented||!j_(p)||T_(p))return;const m={ArrowDown(){u||r({type:"ARROW_NEXT",key:"ArrowDown"})},ArrowUp(){u||r({type:"ARROW_PREV",key:"ArrowUp"})},ArrowLeft(){c||r({type:"ARROW_PREV",key:"ArrowLeft"})},ArrowRight(){c||r({type:"ARROW_NEXT",key:"ArrowRight"})},Home(){r({type:"HOME"})},End(){r({type:"END"})}};let g=M_(p,{dir:s("dir"),orientation:s("orientation")});const x=m[g];if(x){p.preventDefault(),x(p);return}}})},getTriggerState:f,getTriggerProps(p){const{value:m,disabled:g}=p,x=f(p);return e.button({...us.trigger.attrs,role:"tab",type:"button",disabled:g,dir:s("dir"),"data-orientation":s("orientation"),"data-disabled":jt(g),"aria-disabled":g,"data-value":m,"aria-selected":x.selected,"data-selected":jt(x.selected),"data-focus":jt(x.focused),"aria-controls":x.selected?su(o,m):void 0,"data-ownedby":Os(o),"data-ssr":jt(i.get("ssr")),id:Wr(o,m),tabIndex:x.selected&&h?0:-1,onFocus(){r({type:"TAB_FOCUS",value:m})},onBlur(b){b.relatedTarget?.getAttribute("role")!=="tab"&&r({type:"TAB_BLUR"})},onClick(b){b.defaultPrevented||C_(b)||g||(k_()&&b.currentTarget.focus(),r({type:"TAB_CLICK",value:m}))}})},getContentProps(p){const{value:m}=p,g=i.get("value")===m;return e.element({...us.content.attrs,dir:s("dir"),id:su(o,m),tabIndex:h?0:-1,"aria-labelledby":Wr(o,m),role:"tabpanel","data-ownedby":Os(o),"data-selected":jt(g),"data-orientation":s("orientation"),hidden:!g})},getIndicatorProps(){const p=i.get("indicatorRect"),m=i.get("indicatorTransition");return e.element({id:c1(o),...us.indicator.attrs,dir:s("dir"),"data-orientation":s("orientation"),style:{"--transition-property":"left, right, top, bottom, width, height","--left":p.left,"--top":p.top,"--width":p.width,"--height":p.height,position:"absolute",willChange:"var(--transition-property)",transitionProperty:"var(--transition-property)",transitionDuration:m?"var(--transition-duration, 150ms)":"0ms",transitionTimingFunction:"var(--transition-timing-function)",[u?"left":"top"]:u?"var(--left)":"var(--top)"}})}}}var{createMachine:AS}=g_(),ES=AS({props({props:n}){return{dir:"ltr",orientation:"horizontal",activationMode:"automatic",loopFocus:!0,composite:!0,navigate(e){P_(e.node)},defaultValue:null,...n}},initialState(){return"idle"},context({prop:n,bindable:e}){return{value:e(()=>({defaultValue:n("defaultValue"),value:n("value"),onChange(t){n("onValueChange")?.({value:t})}})),focusedValue:e(()=>({defaultValue:n("value")||n("defaultValue"),sync:!0,onChange(t){n("onFocusChange")?.({focusedValue:t})}})),ssr:e(()=>({defaultValue:!0})),indicatorTransition:e(()=>({defaultValue:!1})),indicatorRect:e(()=>({defaultValue:{left:"0px",top:"0px",width:"0px",height:"0px"}}))}},watch({context:n,prop:e,track:t,action:r}){t([()=>n.get("value")],()=>{r(["allowIndicatorTransition","syncIndicatorRect","syncTabIndex","navigateIfNeeded"])}),t([()=>e("dir"),()=>e("orientation")],()=>{r(["syncIndicatorRect"])})},on:{SET_VALUE:{actions:["setValue"]},CLEAR_VALUE:{actions:["clearValue"]},SET_INDICATOR_RECT:{actions:["setIndicatorRect"]},SYNC_TAB_INDEX:{actions:["syncTabIndex"]}},entry:["syncIndicatorRect","syncTabIndex","syncSsr"],exit:["cleanupObserver"],states:{idle:{on:{TAB_FOCUS:{target:"focused",actions:["setFocusedValue"]},TAB_CLICK:{target:"focused",actions:["setFocusedValue","setValue"]}}},focused:{on:{TAB_CLICK:{actions:["setFocusedValue","setValue"]},ARROW_PREV:[{guard:"selectOnFocus",actions:["focusPrevTab","selectFocusedTab"]},{actions:["focusPrevTab"]}],ARROW_NEXT:[{guard:"selectOnFocus",actions:["focusNextTab","selectFocusedTab"]},{actions:["focusNextTab"]}],HOME:[{guard:"selectOnFocus",actions:["focusFirstTab","selectFocusedTab"]},{actions:["focusFirstTab"]}],END:[{guard:"selectOnFocus",actions:["focusLastTab","selectFocusedTab"]},{actions:["focusLastTab"]}],TAB_FOCUS:{actions:["setFocusedValue"]},TAB_BLUR:{target:"idle",actions:["clearFocusedValue"]}}}},implementations:{guards:{selectOnFocus:({prop:n})=>n("activationMode")==="automatic"},actions:{selectFocusedTab({context:n,prop:e}){ur(()=>{const t=n.get("focusedValue");if(!t)return;const i=e("deselectable")&&n.get("value")===t?null:t;n.set("value",i)})},setFocusedValue({context:n,event:e,flush:t}){e.value!=null&&t(()=>{n.set("focusedValue",e.value)})},clearFocusedValue({context:n}){n.set("focusedValue",null)},setValue({context:n,event:e,prop:t}){const r=t("deselectable")&&n.get("value")===n.get("focusedValue");n.set("value",r?null:e.value)},clearValue({context:n}){n.set("value",null)},focusFirstTab({scope:n}){ur(()=>{PS(n)?.focus()})},focusLastTab({scope:n}){ur(()=>{CS(n)?.focus()})},focusNextTab({context:n,prop:e,scope:t,event:r}){const i=r.value??n.get("focusedValue");if(!i)return;const s=kS(t,{value:i,loopFocus:e("loopFocus")});ur(()=>{e("composite")?s?.focus():s?.dataset.value!=null&&n.set("focusedValue",s.dataset.value)})},focusPrevTab({context:n,prop:e,scope:t,event:r}){const i=r.value??n.get("focusedValue");if(!i)return;const s=jS(t,{value:i,loopFocus:e("loopFocus")});ur(()=>{e("composite")?s?.focus():s?.dataset.value!=null&&n.set("focusedValue",s.dataset.value)})},syncTabIndex({context:n,scope:e}){ur(()=>{const t=n.get("value");if(!t)return;const r=SS(e,t);if(!r)return;y_(r).length>0?r.removeAttribute("tabindex"):r.setAttribute("tabindex","0")})},cleanupObserver({refs:n}){const e=n.get("indicatorCleanup");e&&e()},allowIndicatorTransition({context:n}){n.set("indicatorTransition",!0)},setIndicatorRect({context:n,event:e,scope:t}){const r=e.id??n.get("value");if(!Xh(t))return;if(!r){n.set("indicatorTransition",!1);return}xa(t,r)&&(n.set("indicatorRect",TS(t,r)),Eg(()=>{n.set("indicatorTransition",!1)}))},syncSsr({context:n}){n.set("ssr",!1)},syncIndicatorRect({context:n,refs:e,scope:t}){const r=e.get("indicatorCleanup");r&&r();const i=n.get("value");if(!i){n.set("indicatorTransition",!1);return}const s=xa(t,i),o=Xh(t);if(!s||!o)return;const a=b_([s],{measure(l){return u1(l)},onEntry({rects:l}){const[c]=l;n.set("indicatorRect",d1(c))}});e.set("indicatorCleanup",a)},navigateIfNeeded({context:n,prop:e,scope:t}){const r=n.get("value");if(!r)return;const i=xa(t,r);x_(i)&&e("navigate")?.({value:r,node:i,href:i.href})}}}});li()(["activationMode","composite","deselectable","dir","getRootNode","id","ids","loopFocus","navigate","onFocusChange","onValueChange","orientation","translations","value","defaultValue"]);li()(["disabled","value"]);li()(["value"]);const h1=n=>{const e=_.useId(),{getRootNode:t}=Wt(),{dir:r}=yn(),i={id:e,dir:r,getRootNode:t,...n},s=Vt(ES,i);return MS(s,rn)},f1=_.forwardRef((n,e)=>{const[t,r]=bl(n),[i,s]=Oe()(r,["activationMode","composite","defaultValue","deselectable","id","ids","loopFocus","navigate","onFocusChange","onValueChange","orientation","translations","value"]),o=h1(i),a=Y(o.getRootProps(),s);return d.jsx(i1,{value:o,children:d.jsx(xl,{value:t,children:d.jsx(Z.div,{...a,ref:e})})})});f1.displayName="TabsRoot";const p1=_.forwardRef((n,e)=>{const[t,r]=bl(n),[{value:i},s]=Oe()(r,["value"]),o=Y(i.getRootProps(),s);return d.jsx(i1,{value:i,children:d.jsx(xl,{value:t,children:d.jsx(Z.div,{...o,ref:e})})})});p1.displayName="TabsRootProvider";const[m1,fo]=Ke({name:"TooltipContext",hookName:"useTooltipContext",providerName:"<TooltipProvider />"}),g1=_.forwardRef((n,e)=>{const t=fo(),r=Y(t.getArrowProps(),n);return d.jsx(Z.div,{...r,ref:e})});g1.displayName="TooltipArrow";const x1=_.forwardRef((n,e)=>{const t=fo(),r=Y(t.getArrowTipProps(),n);return d.jsx(Z.div,{...r,ref:e})});x1.displayName="TooltipArrowTip";const b1=_.forwardRef((n,e)=>{const t=fo(),r=Ut(),i=Y(t.getContentProps(),r.getPresenceProps(),n);return r.unmounted?null:d.jsx(Z.div,{...i,ref:nr(r.ref,e)})});b1.displayName="TooltipContent";const y1=_.forwardRef((n,e)=>{const t=fo(),r=Y(t.getPositionerProps(),n);return Ut().unmounted?null:d.jsx(Z.div,{...r,ref:e})});y1.displayName="TooltipPositioner";const IS=n=>{const e=_.useId(),{getRootNode:t}=Wt(),{dir:r}=yn(),i={id:e,dir:r,getRootNode:t,...n},s=Vt(I_,i);return R_(s,rn)},RS=n=>{const[e,{children:t,...r}]=Fn(n),i=IS(r),s=sn(Y({present:i.open},e));return d.jsx(m1,{value:i,children:d.jsx(vn,{value:s,children:t})})},OS=n=>{const[e,{value:t,children:r}]=Fn(n),i=sn(Y({present:t.open},e));return d.jsx(m1,{value:t,children:d.jsx(vn,{value:i,children:r})})},v1=_.forwardRef((n,e)=>{const t=fo(),r=Y(t.getTriggerProps(),n);return d.jsx(Z.button,{...r,ref:e})});v1.displayName="TooltipTrigger";const{withRootProvider:w1,withContext:po}=Qe({key:"actionBar"});w1(Cx,{defaultProps:{lazyMount:!0,unmountOnExit:!0}});const $S=w1(Px,{defaultProps:{autoFocus:!1,lazyMount:!0,unmountOnExit:!0}}),DS=po("div","positioner",{forwardAsChild:!0}),NS=po(fd,"content",{forwardAsChild:!0}),LS=po("div","separator"),FS=po("button","selectionTrigger"),zS=po(hd,"closeTrigger",{forwardAsChild:!0}),[BS,HS]=O_({name:"AlertStatusContext",hookName:"useAlertStatusContext",providerName:"<Alert />"}),{withProvider:VS,withContext:pd,useStyles:WS}=Qe({key:"alert"}),Qr=VS("div","root",{forwardAsChild:!0,wrapElement(n,e){return d.jsx(BS,{value:{status:e.status||"info"},children:n})}}),Vs=pd("div","title"),mo=pd("div","description"),Zi=pd("div","content"),US={info:Fh,warning:zh,success:$_,error:zh,neutral:Fh},Di=_.forwardRef(function(e,t){const r=HS(),i=WS(),s=typeof r.status=="string"?US[r.status]:_.Fragment,{children:o=d.jsx(s,{}),...a}=e;return d.jsx(vt.span,{ref:t,...a,css:[i.indicator,e.css],children:o})}),_1=_.forwardRef(function(e,t){const r=Og({key:"button"}),[i,s]=_.useMemo(()=>r.splitVariantProps(e),[e,r]);return d.jsx(D_,{value:i,children:d.jsx(zs,{ref:t,...s})})}),qS=_.forwardRef(function(e,t){return d.jsx(mt,{variant:"ghost","aria-label":"Close",ref:t,...e,children:e.children??d.jsx(td,{})})}),{withProvider:XS,withContext:go}=Qe({key:"card"}),S1=XS("div","root"),P1=go("div","body"),C1=go("div","header"),k1=go("div","footer");go("h3","title");go("p","description");const Sl=vt("div",{base:{display:"flex",alignItems:"center",justifyContent:"center"},variants:{inline:{true:{display:"inline-flex"}}}});Sl.displayName="Center";const GS=_.forwardRef(function(e,t){const r=Og({key:"checkmark",recipe:e.recipe}),[i,s]=r.splitVariantProps(e),{checked:o,indeterminate:a,disabled:l,unstyled:c,children:u,...h}=s,f=c?N_:r(i);return d.jsx(vt.svg,{ref:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"3px",strokeLinecap:"round",strokeLinejoin:"round","data-state":a?"indeterminate":o?"checked":"unchecked","data-disabled":nd(l),css:[f,e.css],...h,children:a?d.jsx("path",{d:"M5 12h14"}):o?d.jsx("polyline",{points:"20 6 9 17 4 12"}):null})}),{withProvider:j1,withContext:T1,useStyles:YS}=Qe({key:"checkbox"});j1(s0,"root",{forwardAsChild:!0});const KS=j1(i0,"root",{forwardAsChild:!0}),ZS=T1(r0,"label",{forwardAsChild:!0}),M1=_.forwardRef(function(e,t){const{checked:r,indeterminate:i,...s}=e,o=yl(),a=YS();return r&&o.checked?d.jsx(vt.svg,{ref:t,asChild:!0,...s,css:[a.indicator,e.css],children:r}):i&&o.indeterminate?d.jsx(vt.svg,{ref:t,asChild:!0,...s,css:[a.indicator,e.css],children:i}):d.jsx(GS,{ref:t,checked:o.checked,indeterminate:o.indeterminate,disabled:o.disabled,unstyled:!0,...s,css:[a.indicator,e.css]})}),JS=T1(e0,"control",{forwardAsChild:!0,defaultProps:{children:d.jsx(M1,{})}}),xo=vt(t0,{base:{display:"flex",flexDirection:"column",gap:"1.5"}},{forwardAsChild:!0}),QS=n0,{withProvider:A1,withContext:Ji}=Qe({key:"clipboard"});A1(h0,"root",{forwardAsChild:!0});const eP=A1(d0,"root",{forwardAsChild:!0}),md=Ji(f0,"trigger",{forwardAsChild:!0});Ji(a0,"control",{forwardAsChild:!0});const gd=Ji(l0,"indicator",{forwardAsChild:!0,defaultProps:{copied:d.jsx(rd,{boxSize:"1em"}),children:d.jsx(L_,{boxSize:"1em"})}}),tP=Ji(c0,"input",{forwardAsChild:!0}),nP=Ji(u0,"label",{forwardAsChild:!0});Ji(p0,"valueText",{forwardAsChild:!0});_.forwardRef(function(e,t){return d.jsx(gd,{copied:"Copied",...e,ref:t,children:"Copy"})});const{withProvider:rP,withContext:xd}=Qe({key:"dataList"}),bd=rP("dl","root"),Si=xd("div","item"),Pi=xd("dt","itemLabel"),Ci=xd("dd","itemValue"),{withRootProvider:E1,withContext:Bn}=Qe({key:"dialog"}),rr=E1(V2,{defaultProps:{unmountOnExit:!0,lazyMount:!0}}),iP=E1(H2,{defaultProps:{unmountOnExit:!0,lazyMount:!0}}),sP=Bn(_0,"trigger",{forwardAsChild:!0}),oP=Bn(v0,"positioner",{forwardAsChild:!0}),aP=Bn(b0,"content",{forwardAsChild:!0}),lP=Bn(y0,"description",{forwardAsChild:!0}),cP=Bn(w0,"title",{forwardAsChild:!0}),uP=Bn(x0,"closeTrigger",{forwardAsChild:!0}),dP=_.forwardRef(function(e,t){const r=kr();return d.jsx(vt.button,{...e,ref:t,onClick:()=>r.setOpen(!1)})}),hP=Bn(g0,"backdrop",{forwardAsChild:!0}),fP=Bn("div","body"),pP=Bn("div","footer"),mP=Bn("div","header"),{withProvider:I1,withContext:Tr}=Qe({key:"editable"}),Pl=I1(E0,"root",{forwardAsChild:!0});I1(A0,"root",{forwardAsChild:!0});const Cl=Tr(M0,"preview",{forwardAsChild:!0}),yd=Tr(T0,"input",{forwardAsChild:!0}),gP=_.forwardRef(function(e,t){const r=jr(),i=F_(r.getInputProps(),e);return d.jsx(Z.textarea,{ref:t,...i})}),xP=Tr(gP,"input",{forwardAsChild:!0});Tr(k0,"control",{forwardAsChild:!0});const R1=Tr(P0,"area",{forwardAsChild:!0});Tr(j0,"editTrigger",{forwardAsChild:!0});Tr(I0,"submitTrigger",{forwardAsChild:!0});Tr(C0,"cancelTrigger",{forwardAsChild:!0});const{withProvider:bP,withContext:kl}=Qe({key:"emptyState"}),yP=bP("div","root"),vP=kl("div","content"),wP=kl("div","indicator"),_P=kl("h3","title"),SP=kl("p","description"),{withProvider:PP,withContext:jl}=Qe({key:"fieldset"}),vd=PP(L0,"root");jl($0,"errorText");jl(D0,"helperText");const O1=jl(N0,"legend"),wd=jl(Z.div,"content"),Re=_.forwardRef(function(e,t){const{direction:r,align:i,justify:s,wrap:o,basis:a,grow:l,shrink:c,inline:u,...h}=e;return d.jsx(vt.div,{ref:t,...h,css:{display:u?"inline-flex":"flex",flexDirection:r,alignItems:i,justifyContent:s,flexWrap:o,flexBasis:a,flexGrow:l,flexShrink:c,...e.css}})}),{withContext:CP}=ao({key:"input"}),ki=CP(R0),{withContext:kP}=ao({key:"link"}),Nn=kP("a"),{withProvider:jP,withContext:$1}=Qe({key:"list"}),D1=jP("ul","root",{defaultProps:{role:"list"}}),N1=$1("li","item"),TP=$1("span","indicator"),{withRootProvider:L1,withContext:at}=Qe({key:"menu"});L1(Y2);const bo=L1(G2,{defaultProps:{lazyMount:!0,unmountOnExit:!0}}),yo=at(lx,"trigger",{forwardAsChild:!0}),MP=at(U0,"contextTrigger",{forwardAsChild:!0}),vo=at(ex,"positioner",{forwardAsChild:!0}),ba=at(ax,"separator",{forwardAsChild:!0}),wo=at(W0,"content",{forwardAsChild:!0}),F1=at(B0,"arrowTip",{forwardAsChild:!0}),AP=at(z0,"arrow",{forwardAsChild:!0,defaultProps:{children:d.jsx(F1,{})}});at(q0,"indicator",{forwardAsChild:!0});const z1=at(K0,"itemGroup",{forwardAsChild:!0}),ji=at(Z0,"itemGroupLabel",{forwardAsChild:!0}),Ea=at(X0,"item",{forwardAsChild:!0}),EP=at(cx,"item",{forwardAsChild:!0}),IP=at(Q0,"itemText",{forwardAsChild:!0});at("kbd","itemCommand");const un=at(J0,"itemIndicator",{forwardAsChild:!0,defaultProps:{children:d.jsx(rd,{boxSize:"4"})}}),B1=at(V0,"item",{forwardAsChild:!0}),H1=at(nx,"itemGroup",{forwardAsChild:!0}),qn=at(tx,"item",{forwardAsChild:!0}),{withProvider:V1,withContext:Tl}=Qe({key:"pagination"});V1(gx,"root",{forwardAsChild:!0,forwardProps:["page"]});const RP=V1(mx,"root",{forwardAsChild:!0,forwardProps:["page"]}),OP=Tl(dx,"ellipsis",{forwardAsChild:!0}),$P=Tl(hx,"item",{forwardAsChild:!0}),DP=Tl(fx,"nextTrigger",{forwardAsChild:!0}),NP=Tl(px,"prevTrigger",{forwardAsChild:!0});_.forwardRef(function(e,t){const{format:r="compact",...i}=e,{page:s,totalPages:o,pageRange:a,count:l}=Yi(),c=_.useMemo(()=>r==="short"?`${s} / ${o}`:r==="compact"?`${s} of ${o}`:`${a.start+1} - ${Math.min(a.end,l)} of ${l}`,[r,s,o,a,l]);return d.jsx(ft,{fontWeight:"medium",ref:t,...i,children:c})});const LP=n=>{const{pages:e}=Yi(),{render:t,ellipsis:r,...i}=n;return d.jsx(tu,{each:e,children:(s,o)=>s.type==="ellipsis"?d.jsx(OP,{asChild:!0,index:o,...i,children:r||d.jsx(mt,{as:"span",children:d.jsx(z_,{})})},o):d.jsx($P,{asChild:!0,type:"page",value:s.value,...i,children:t(s)},o)})},{withRootProvider:W1,withContext:qt}=Qe({key:"popover"}),Gh=W1(Cx),U1=W1(Px),Ia=qt(jx,"trigger",{forwardAsChild:!0}),_d=qt(Sx,"positioner",{forwardAsChild:!0}),Sd=qt(fd,"content",{forwardAsChild:!0}),Pd=qt(vx,"arrowTip",{forwardAsChild:!0}),Cd=qt(yx,"arrow",{forwardAsChild:!0,defaultProps:{children:d.jsx(Pd,{})}}),q1=qt(hd,"closeTrigger",{forwardAsChild:!0});qt(_x,"indicator",{forwardAsChild:!0});const FP=qt(kx,"title",{forwardAsChild:!0});qt(wx,"description",{forwardAsChild:!0});const zP=qt("footer","footer"),BP=qt("header","header"),ou=qt("div","body");qt(bx,void 0,{forwardAsChild:!0});const{withProvider:X1,withContext:Ml}=Qe({key:"progress"});X1(Ix,"root",{forwardAsChild:!0});const HP=X1(Ex,"root"),VP=Ml(Mx,"label",{forwardAsChild:!0}),WP=Ml(Rx,"track",{forwardAsChild:!0}),UP=Ml(Ax,"range",{forwardAsChild:!0}),qP=Ml(Ox,"valueText",{forwardAsChild:!0}),{withProvider:G1,withContext:Dt}=Qe({key:"select"}),kd=G1(xS,"root",{forwardAsChild:!0}),XP=G1(mS,"root",{forwardAsChild:!0,defaultProps:{positioning:{sameWidth:!0}}}),Y1=Dt(Yx,"trigger",{forwardAsChild:!0}),K1=Dt(Gx,"positioner",{forwardAsChild:!0}),Z1=Dt(Nx,"content",{forwardAsChild:!0}),J1=Dt(Kx,"valueText",{forwardAsChild:!0}),GP=Dt(Dx,"clearTrigger",{forwardAsChild:!0,defaultProps:{children:d.jsx(td,{boxSize:"1em"})}}),YP=Dt(Vx,"itemGroup",{forwardAsChild:!0}),KP=Dt(Wx,"itemGroupLabel",{forwardAsChild:!0}),Q1=Dt(Hx,"item",{forwardAsChild:!0});Dt(qx,"itemText",{forwardAsChild:!0});const eb=Dt(Ux,"itemIndicator",{forwardAsChild:!0,defaultProps:{children:d.jsx(rd,{})}}),ZP=Dt("div","indicatorGroup"),JP=Dt(zx,"indicator",{forwardAsChild:!0,defaultProps:{children:d.jsx(B_,{})}}),jd=Dt(Lx,"control",{forwardAsChild:!0}),QP=Dt(Xx,"label",{forwardAsChild:!0}),eC=cS,tb=Fx,{useRecipeResult:tC}=ao({key:"separator"}),Ur=_.forwardRef(function(e,t){const{styles:r,className:i,props:s}=tC(e),o=e.orientation||"horizontal";return d.jsx(vt.span,{ref:t,role:Bh(o)?"separator":"presentation","aria-orientation":Bh(o)?o:void 0,...H_(s,["orientation"]),className:hl(i,e.className),css:[r,e.css]})}),_o=_.forwardRef(function(e,t){return d.jsx(bn,{align:"center",...e,direction:"row",ref:t})}),So=_.forwardRef(function(e,t){return d.jsx(bn,{align:"center",...e,direction:"column",ref:t})}),{withProvider:nb,withContext:Td,useStyles:nC}=Qe({key:"switch"});nb(n1,"root",{forwardAsChild:!0});const rC=nb(t1,"root",{forwardAsChild:!0}),iC=Td(e1,"label",{forwardAsChild:!0}),rb=Td(r1,"thumb",{forwardAsChild:!0}),sC=Td(Jx,"control",{forwardAsChild:!0,defaultProps:{children:d.jsx(rb,{})}}),oC=_.forwardRef(function(e,t){const r=Ki(),i=nC(),{fallback:s,children:o,...a}=e;return d.jsx(vt.span,{ref:t,"data-checked":nd(r.checked),...a,css:[i.indicator,e.css],children:r.checked?o:s})}),aC=_.forwardRef(function(e,t){const r=Ki(),{fallback:i,children:s,...o}=e;return d.jsx(vt.span,{ref:t,"data-checked":nd(r.checked),...o,children:r.checked?s:i})}),lC=Qx,{StylesProvider:cC,ClassNamesProvider:uC,useRecipeResult:dC,withContext:ir,PropsProvider:hC}=Qe({key:"table"}),Md=_.forwardRef(function({native:e,...t},r){const{styles:i,props:s,classNames:o}=dC(t),a=_.useMemo(()=>e?{...i.root,"& thead":i.header,"& tbody":i.body,"& tfoot":i.footer,"& thead th":i.columnHeader,"& tr":i.row,"& td":i.cell,"& caption":i.caption}:i.root,[i,e]);return d.jsx(uC,{value:o,children:d.jsx(cC,{value:i,children:d.jsx(vt.table,{ref:r,...s,css:[a,t.css],className:hl(o?.root,t.className)})})})}),fC=hC,En=ir("tr","row"),pC=vt("div",{base:{display:"block",whiteSpace:"nowrap",WebkitOverflowScrolling:"touch",overflow:"auto",maxWidth:"100%"}}),Al=ir("thead","header"),mC=ir("tfoot","footer"),In=ir("th","columnHeader"),zt=ir("td","cell"),gC=ir("caption","caption",{defaultProps:{captionSide:"bottom"}}),Ad=ir("tbody","body"),El=ir("colgroup"),Rn=ir("col"),Yh=Object.freeze(Object.defineProperty({__proto__:null,Body:Ad,Caption:gC,Cell:zt,Column:Rn,ColumnGroup:El,ColumnHeader:In,Footer:mC,Header:Al,Root:Md,RootPropsProvider:fC,Row:En,ScrollArea:pC},Symbol.toStringTag,{value:"Module"})),{withProvider:ib,withContext:Po}=Qe({key:"tabs"}),xC=ib(p1,"root",{forwardAsChild:!0});ib(f1,"root",{forwardAsChild:!0});const sb=Po(l1,"trigger",{forwardAsChild:!0}),Wo=Po(s1,"content",{forwardAsChild:!0});Po("div","contentGroup");const bC=Po(a1,"list",{forwardAsChild:!0});Po(o1,"indicator",{forwardAsChild:!0});const{withProvider:yC,withContext:Il}=Qe({key:"tag"}),vC=yC("div","root"),wC=Il("span","label"),_C=Il("button","closeTrigger",{defaultProps:{children:d.jsx(td,{})}}),SC=Il("span","startElement"),Kh=Il("span","endElement"),{withContext:PC}=ao({key:"textarea"}),CC=PC(O0),{withRootProvider:ob,withContext:Co}=Qe({key:"tooltip"});ob(OS);const kC=ob(RS,{defaultProps:{lazyMount:!0,unmountOnExit:!0}}),jC=Co(v1,"trigger",{forwardAsChild:!0}),TC=Co(y1,"positioner",{forwardAsChild:!0}),MC=Co(b1,"content",{forwardAsChild:!0}),ab=Co(x1,"arrowTip",{forwardAsChild:!0}),AC=Co(g1,"arrow",{forwardAsChild:!0,defaultProps:{children:d.jsx(ab,{})}}),{withContext:EC}=ao({key:"heading"}),Ws=EC("h2"),ko=_.forwardRef(function(e,t){const{gap:r="0.5rem",justify:i,direction:s,align:o,...a}=e;return d.jsx(vt.div,{ref:t,display:"flex",flexWrap:"wrap",justifyContent:i,alignItems:o,flexDirection:s,gap:r,...a,className:hl("chakra-wrap",e.className)})});ko.displayName="Wrap";const IC=V_({display:"flex",alignItems:"flex-start"});_.forwardRef(function(e,t){return d.jsx(vt.div,{ref:t,css:[IC,e.css],...e,className:hl("chakra-wrap__listitem",e.className)})});var Ra=function(){return Ra=Object.assign||function(e){for(var t,r=1,i=arguments.length;r<i;r++){t=arguments[r];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s])}return e},Ra.apply(this,arguments)};function RC(){var n=_.useRef(!1),e=_.useCallback(function(){return n.current},[]);return _.useEffect(function(){return n.current=!0,function(){n.current=!1}},[]),e}function lb(n,e,t){e===void 0&&(e=[]),t===void 0&&(t={loading:!1});var r=_.useRef(0),i=RC(),s=_.useState(t),o=s[0],a=s[1],l=_.useCallback(function(){for(var c=[],u=0;u<arguments.length;u++)c[u]=arguments[u];var h=++r.current;return o.loading||a(function(f){return Ra(Ra({},f),{loading:!0})}),n.apply(void 0,c).then(function(f){return i()&&h===r.current&&a({value:f,loading:!1}),f},function(f){return i()&&h===r.current&&a({error:f,loading:!1}),f})},e);return[o,l]}var xc={exports:{}};/*!
* screenfull
* v5.2.0 - 2021-11-03
* (c) Sindre Sorhus; MIT License
*/var Zh;function OC(){return Zh||(Zh=1,function(n){(function(){var e=typeof window<"u"&&typeof window.document<"u"?window.document:{},t=n.exports,r=function(){for(var o,a=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],l=0,c=a.length,u={};l<c;l++)if(o=a[l],o&&o[1]in e){for(l=0;l<o.length;l++)u[a[0][l]]=o[l];return u}return!1}(),i={change:r.fullscreenchange,error:r.fullscreenerror},s={request:function(o,a){return new Promise((function(l,c){var u=(function(){this.off("change",u),l()}).bind(this);this.on("change",u),o=o||e.documentElement;var h=o[r.requestFullscreen](a);h instanceof Promise&&h.then(u).catch(c)}).bind(this))},exit:function(){return new Promise((function(o,a){if(!this.isFullscreen){o();return}var l=(function(){this.off("change",l),o()}).bind(this);this.on("change",l);var c=e[r.exitFullscreen]();c instanceof Promise&&c.then(l).catch(a)}).bind(this))},toggle:function(o,a){return this.isFullscreen?this.exit():this.request(o,a)},onchange:function(o){this.on("change",o)},onerror:function(o){this.on("error",o)},on:function(o,a){var l=i[o];l&&e.addEventListener(l,a,!1)},off:function(o,a){var l=i[o];l&&e.removeEventListener(l,a,!1)},raw:r};if(!r){t?n.exports={isEnabled:!1}:window.screenfull={isEnabled:!1};return}Object.defineProperties(s,{isFullscreen:{get:function(){return!!e[r.fullscreenElement]}},element:{enumerable:!0,get:function(){return e[r.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return!!e[r.fullscreenEnabled]}}}),t?n.exports=s:window.screenfull=s})()}(xc)),xc.exports}var $C=OC();const ln=$g($C);var DC=function(n,e,t){if(!W_)return[e,function(){}];var r=_.useState(function(){try{var o=sessionStorage.getItem(n);return typeof o!="string"?(sessionStorage.setItem(n,t?String(e):JSON.stringify(e)),e):t?o:JSON.parse(o||"null")}catch{return e}}),i=r[0],s=r[1];return _.useEffect(function(){try{var o=t?String(i):JSON.stringify(i);sessionStorage.setItem(n,o)}catch{}}),[i,s]};const en=_.forwardRef(function(e,t){const r=te.c(26);let i,s,o,a,l,c,u,h;if(r[0]!==e?({showArrow:h,children:i,disabled:a,portalled:c,content:s,contentProps:o,portalRef:l,...u}=e,r[0]=e,r[1]=i,r[2]=s,r[3]=o,r[4]=a,r[5]=l,r[6]=c,r[7]=u,r[8]=h):(i=r[1],s=r[2],o=r[3],a=r[4],l=r[5],c=r[6],u=r[7],h=r[8]),a)return i;let f;r[9]!==i?(f=d.jsx(jC,{asChild:!0,children:i}),r[9]=i,r[10]=f):f=r[10];const p=!c;let m;r[11]!==h?(m=h&&d.jsx(AC,{children:d.jsx(ab,{})}),r[11]=h,r[12]=m):m=r[12];let g;r[13]!==s||r[14]!==o||r[15]!==t||r[16]!==m?(g=d.jsx(TC,{children:d.jsxs(MC,{ref:t,...o,children:[m,s]})}),r[13]=s,r[14]=o,r[15]=t,r[16]=m,r[17]=g):g=r[17];let x;r[18]!==l||r[19]!==p||r[20]!==g?(x=d.jsx(Cr,{disabled:p,container:l,children:g}),r[18]=l,r[19]=p,r[20]=g,r[21]=x):x=r[21];let b;return r[22]!==u||r[23]!==f||r[24]!==x?(b=d.jsxs(kC,{...u,children:[f,x]}),r[22]=u,r[23]=f,r[24]=x,r[25]=b):b=r[25],b}),NC=n=>{const e=Number.parseFloat(n);if(!(Number.isNaN(e)||!Number.isFinite(e)))return e},Jh=_.memo(function(e){const t=te.c(15);let r,i,s,o;t[0]!==e?({value:o,onChange:r,ref:i,...s}=e,t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=o):(r=t[1],i=t[2],s=t[3],o=t[4]);const a=uo({defaultValue:o?.toString(),placeholder:{preview:"---",edit:""},onValueCommit:m=>{const{value:g}=m,x=r(NC(g));x!==void 0?a.setValue(x.toString()):a.clearValue()}});let l;t[5]===Symbol.for("react.memo_cache_sentinel")?(l={color:"fg.subtle"},t[5]=l):l=t[5];const c=a.value?`${a.value} `:a.valueText;let u;t[6]!==c?(u=d.jsx(Cl,{justifyContent:"center",w:"100%",_placeholderShown:l,whiteSpace:"nowrap",children:c}),t[6]=c,t[7]=u):u=t[7];let h;t[8]===Symbol.for("react.memo_cache_sentinel")?(h=d.jsx(yd,{inputMode:"decimal",textAlign:"center",focusRing:"none",borderBottomWidth:"1px",borderBottomColor:"border",borderRadius:0,_focusVisible:{borderColor:"var(--focus-color)",boxShadow:"0px 1px 0px 0px var(--focus-color)"}}),t[8]=h):h=t[8];const f=a.editing&&"";let p;return t[9]!==a||t[10]!==i||t[11]!==s||t[12]!==u||t[13]!==f?(p=d.jsxs(Pl,{value:a,justifyContent:"center",size:"sm",ref:i,...s,children:[u,h,f]}),t[9]=a,t[10]=i,t[11]=s,t[12]=u,t[13]=f,t[14]=p):p=t[14],p});function Ss(n){return 16843009*((n=(858993459&(n-=n>>>1&1431655765))+(n>>>2&858993459))+(n>>>4)&252645135)>>>24}class Us{constructor(e,t){this.length=e,this.t=new Uint32Array(e+32>>>5),t===!0&&this.i()}get(e){return(this.t[e>>>5]&1<<e)!=0}set(e){this.t[e>>>5]|=1<<e}clear(e){this.t[e>>>5]&=~(1<<e)}o(e){this.t[e>>>5]^=1<<e}h(e,t,r){if(t<e)return;const i=this.t,s=r===!0?4294967295:0,o=e>>>5,a=t>>>5;for(let u=o;u<a;++u)i[u]=s;const l=o<<5,c=a<<5;if(r===!0)if(t-e<32)for(let u=e,h=t+1;u<h;++u)i[u>>>5]|=1<<u;else{for(let u=e,h=l;u<h;++u)i[u>>>5]|=1<<u;for(let u=c,h=t+1;u<h;++u)i[u>>>5]|=1<<u}else if(t-e<32)for(let u=e,h=t+1;u<h;++u)i[u>>>5]&=~(1<<u);else{for(let u=e,h=l;u<h;++u)i[u>>>5]&=~(1<<u);for(let u=c,h=t+1;u<h;++u)i[u>>>5]&=~(1<<u)}return this}l(e,t){return this.h(e,t,!0)}u(e,t){return this.h(e,t,!1)}A(...e){const t=this.t,r=e.length;for(let i=0;i<r;++i){const s=e[i];t[s>>>5]|=1<<s}return this}p(...e){const t=this.t,r=e.length;for(let i=0;i<r;++i){const s=e[i];t[s>>>5]&=~(1<<s)}return this}i(){return this.h(0,this.length-1,!0)}M(){return this.h(0,this.length-1,!1)}m(){const e=this.t.length,t=this.t,r=32-this.length%32;for(let i=0;i<e-1;++i)t[i]=~t[i];return t[e-1]=~(t[e-1]<<r)>>>r,this}S(e,t,r){if(t<e)return;const i=this.t,s=r===!0?4294967295:0,o=e>>>5,a=t>>>5;for(let l=o;l<a;++l)if(i[l]!==s)return!1;if(t-e<32){for(let l=e,c=t+1;l<c;++l)if(!!(i[l>>>5]&1<<l)!==r)return!1}else{const l=a<<5;for(let c=e,u=o<<5<<5;c<u;++c)if(!!(i[c>>>5]&1<<c)!==r)return!1;for(let c=l,u=t+1;c<u;++c)if(!!(i[c>>>5]&1<<c)!==r)return!1}return!0}U(e,t){return this.S(e,t,!0)}_(e,t){return this.S(e,t,!1)}q(){return this.S(0,this.length-1,!0)}v(){return this.S(0,this.length-1,!1)}O(...e){const t=this.t,r=e.length;for(let i=0;i<r;++i){const s=e[i];if((t[s>>>5]&1<<s)==0)return!1}return!0}C(...e){const t=this.t,r=e.length;for(let i=0;i<r;++i){const s=e[i];if((t[s>>>5]&1<<s)!=0)return!1}return!0}G(e){const t=this.t,r=e.t,i=Math.min(t.length,r.length);for(let s=0;s<i;++s)if(t[s]!==r[s])return!1;return!0}P(){const e=this.t.length,t=this.t;let r=0;for(let i=0;i<e;++i)r+=Ss(t[i]);return r}R(e){const t=this.t,r=e.t,i=Math.min(t.length,r.length);for(let s=0;s<i;++s)t[s]=t[s]&~r[s];for(let s=t.length;s<i;++s)t[s]=0;return this}I(e){const t=this.t,r=e.t,i=Math.min(t.length,r.length);for(let s=0;s<i;++s)t[s]|=r[s];for(let s=t.length;s<i;++s)t[s]=0;return this}T(e){const t=this.t,r=e.t,i=Math.min(t.length,r.length);for(let s=0;s<i;++s)t[s]&=r[s];for(let s=t.length;s<i;++s)t[s]=0;return this}F(e){const t=this.t,r=e.t,i=Math.min(t.length,r.length);for(let s=0;s<i;++s)if((t[s]&r[s])!=0)return!0;return!1}D(e){const t=this.t,r=e.t,i=Math.min(t.length,r.length);let s=0;for(let o=0;o<i;++o)s+=Ss(t[o]&r[o]);return s}B(e){const t=this.t,r=e.t,i=Math.min(t.length,r.length),s=new Uint32Array(i),o=Object.create(Us.prototype);o.t=s,o.length=Math.min(this.length,e.length);for(let a=0;a<i;++a)s[a]=t[a]&r[a];return o}forEach(e){const t=this.t.length,r=this.t;let i=0;for(let s=0;s<t;++s){let o=r[s];for(;o!==0;){const a=o&-o;e((s<<5)+Ss(a-1),i),o^=a,++i}}}toArray(){const e=this.t,t=Array(this.P()),r=this.t.length;let i=0;for(let s=0;s<r;++s){let o=e[s];for(;o!==0;){const a=o&-o;t[i++]=(s<<5)+Ss(a-1),o^=a}}return t}toString(){return"{"+this.toArray().join(",")+"}"}N(){const e=this.toArray().join(",");return e?"@"+e:"NONE"}clone(){const e=Object.create(Us.prototype);return e.length=this.length,e.t=new Uint32Array(this.t),e}}const LC={matrix:[[58,23,-12,-7,-44,10,-23,-14,-14,-27,-17,-8,1,-9,-22,23,15,5,-74,-45,0],[23,224,-67,-63,-50,-30,-29,1,-56,-41,-6,-33,-44,-53,-43,15,2,18,-93,-6,0],[-12,-67,111,59,-104,-4,4,-84,6,-88,-65,48,-13,18,-29,5,-7,-63,-105,-73,0],[-7,-63,59,85,-83,-17,-1,-63,25,-60,-47,15,-12,40,-8,1,-7,-47,-108,-51,0],[-44,-50,-104,-83,144,-93,4,12,-74,36,30,-64,-67,-56,-65,-43,-41,-3,63,104,0],[10,-30,-4,-17,-93,140,-32,-95,-27,-91,-75,4,-36,-29,-32,5,-26,-68,-80,-79,0],[-23,-29,4,-1,4,-32,137,-50,6,-37,-42,21,-23,27,19,-4,-12,-44,-13,48,0],[-14,1,-84,-63,12,-95,-50,86,-53,53,47,-62,-60,-47,-55,-43,-8,69,-27,-24,0],[-14,-56,6,25,-74,-27,6,-53,75,-48,-30,13,-12,34,68,-3,-4,-44,-71,-49,0],[-27,-41,-88,-60,36,-91,-37,53,-48,88,62,-63,-48,-36,-48,-47,-25,36,-11,-4,0],[-17,-6,-65,-47,30,-75,-42,47,-30,62,103,-45,-54,-21,-31,-35,-9,31,-46,-20,0],[-8,-33,48,15,-64,4,21,-62,13,-63,-45,89,-25,12,2,22,10,-51,-79,-29,0],[1,-44,-13,-12,-67,-36,-23,-60,-12,-48,-54,-25,160,-6,-20,5,-12,-42,-76,-83,0],[-9,-53,18,40,-56,-29,27,-47,34,-36,-21,12,-6,75,34,1,-4,-37,-92,-48,0],[-22,-43,-29,-8,-65,-32,19,-55,68,-48,-31,2,-20,34,113,-10,-14,-49,-58,-39,0],[23,15,5,1,-43,5,-4,-43,-3,-47,-35,22,5,1,-10,53,32,-28,-62,-31,0],[15,2,-7,-7,-41,-26,-12,-8,-4,-25,-9,10,-12,-4,-14,32,68,0,-87,-40,0],[5,18,-63,-47,-3,-68,-44,69,-44,36,31,-51,-42,-37,-49,-28,0,74,-61,-32,0],[-74,-93,-105,-108,63,-80,-13,-27,-71,-11,-46,-79,-76,-92,-58,-62,-87,-61,289,81,0],[-45,-6,-73,-51,104,-79,48,-24,-49,-4,-20,-29,-83,-48,-39,-31,-40,-32,81,162,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]],H:22,$:-300},FC={matrix:[[91,-114,-31,-123],[-114,100,-125,-31],[-31,-125,100,-114],[-123,-31,-114,91]],$:-400,H:120},zC=/^[ACGTRNDEQHILKMFPSWYV]+$/,BC=/^[ABCDGHKMNRSTUVWY]+$/i,HC=/^[ABCGTRNDEQHIJLKMFPSWYUVXZ]+$/i,VC=/[^ACGU]/i,WC=/[^ACGT]/i;function Qh(n){if(!VC.test(n)||!WC.test(n))return 1;const e=BC.test(n),t=zC.test(n);if(t&&!e)return 0;if(t&&e||HC.test(n))return ef(n);throw Error("Unrecognized sequence type: "+n)}function ef(n){let e=0;const t=Math.min(n.length,100);for(let r=0;r<t;r++)switch(n[r]){case"A":case"T":case"U":case"G":case"C":case"N":e++}return e/t>Math.SQRT1_2?1:0}const Ye=new Uint8Array(96);Ye.fill(255),Ye[65]=0,Ye[67]=1,Ye[68]=2,Ye[69]=3,Ye[70]=4,Ye[71]=5,Ye[72]=6,Ye[73]=7,Ye[75]=8,Ye[76]=9,Ye[77]=10,Ye[78]=11,Ye[80]=12,Ye[81]=13,Ye[82]=14,Ye[83]=15,Ye[84]=16,Ye[86]=17,Ye[87]=18,Ye[89]=19,Ye[95]=20;const Ir=new Uint8Array(96);function UC(n,e){const t=Math.floor(100*Math.random());if(e===1)switch(n){case"M":return[0,1][t%2];case"R":return[0,2][t%2];case"W":return[0,3][t%2];case"S":return[1,2][t%2];case"Y":return[1,3][t%2];case"K":return[2,3][t%2];case"V":return[0,1,2][t%3];case"H":return[0,1,3][t%3];case"D":return[0,2,3][t%3];case"B":return[1,2,3][t%3];default:return t%4}switch(n){case"B":return[2,11][t%2];case"Z":return[3,13][t%2];case"J":return[7,9][t%2];default:return t%20}}function qC(n){return n.map(e=>XC[e])}Ir.fill(255),Ir[65]=0,Ir[67]=1,Ir[71]=2,Ir[84]=3,Ir[85]=3;const XC=[0,1,2,2,3,0,4,5,4,5,5,2,0,2,4,0,0,5,3,3];function GC(n,e,t){const r=[],i=t.gapchar;let s=0;for(let o=0;o<e.length;o++){let a=e[o];a<0?r.push(i.repeat(-a)):(r.push(n.substr(s,a)),s+=a)}return r.join("")}function Uo(n,e){const t=[0];let r=0;const i=e.slice();function s(o){(o^t[t.length-1])>=0?t[t.length-1]+=o:t.push(o)}for(let o=0;o<n.length;o++){let a=n[o];if(a<0)s(a);else for(;a>0&&r<i.length;){let l=i[r];l<0?a<-l?(i[r]+=a,s(-a),a=0):(s(l),a+=l,r++):a<l?(i[r]-=a,s(a),a=0):(s(l),a-=l,r++)}}return t}function YC(n,e){const t=[];let r=0,i=0,s=n[0],o=e[0];for(;r<n.length||i<e.length;)s!==o?Math.sign(s)!==Math.sign(o)?s<0||o===void 0?(t.push(s),s=n[++r]):(t.push(o),o=e[++i]):s>0?s>o?(t.push(o),s-=o,o=e[++i]):(t.push(s),o-=s,s=n[++r]):(t.push(Math.min(s,o)),s=n[++r],o=e[++i]):(t.push(o),s=n[++r],o=e[++i]);return t}function KC(n,e){const t=[];let r=0,i=0,s=e[0],o=n[0],a=0;for(;r<e.length||i<n.length;)if(a=t[t.length-1],s!==o){if(Math.sign(s)===Math.sign(o)){if(s>0){if(o>s)return;a>0?t[t.length-1]=a+o:t.push(o),s-=o,o=n[++i];continue}if(s>o){a>0?t[t.length-1]=a-s:t.push(Math.abs(s)),o-=s,s=e[++r];continue}return}if(!(o<0))return;a<0?t[t.length-1]=a+o:t.push(o),o=n[++i]}else a>0?t[t.length-1]=a+Math.abs(s):t.push(Math.abs(s)),s=e[++r],o=n[++i];return t}function tf(n,e){if(Math.sign(n[n.length-1])===Math.sign(e[0])){let t=[...n];return t[t.length-1]+=e[0],t.push(...e.slice(1)),t}return[...n,...e]}function hr(n,e=0){const t=[];let r=0,i=0;for(let s=0;s<n.length;s++)i=n[s],(i^r)>=0?r+=i:(t.push(r),r=i);return t.push(r),t[0]===0&&t.shift(),1&e||t.reverse(),t}function au(n){let e=0,t=0;for(let r=0;r<n.length;r++)t=n[r],e+=t<0?-t:t;return e}function nf(n){const e=[];let t=0,r=0;for(let i=0;i<n.length;i++)if(r=n[i],r<0)for(let s=0;s<-r;s++)e.push(-1);else for(let s=0;s<r;s++)e.push(t),t++;return e}function Oa(n,e,t,r=0){const i=n.V,s=e.V,o=i.length,a=s.length;let l=0,c=[],u=[],h=0,f=0,p=0,m=0;const g=new Uint8Array(Math.ceil((o+1)*a/2)+1);let x=0,b=0,y=0,w=0,v=0,S=t.W[0];const k=t.$,P=1&r?0:-k/2,C=2&r?0:-k/2;c[0]=0,u[0]=-1/0;for(let O=1;O<=a;O++)c[O]=k+P,u[O]=-1/0;for(let O=1;O<=o;O++){h=P,f=-1/0,S=t.W[i[O-1]];for(let R=1;R<=a;R++)v=0,x=c[R]+k,y=u[R],R===a&&(x+=C),x>=y?u[R]=x:v+=1,b=h+k,w=f,O===o&&(b+=C),b>=w?f=b:v+=2,l=c[R-1]+S[s[R-1]],c[R-1]=h,l>=f?l>=u[R]?h=l:(h=u[R],v+=4):f>=u[R]?(h=f,v+=8):(h=u[R],v+=4),p=O*a+R,m=p%2,p>>>=1,g[p]+=m?v:v<<4;c[a]=h}const T=Math.max(l,f,u[u.length-1]),[A,M]=lu(g,o,a,v);return{j:[hr(A),hr(M)],K:T}}function lu(n,e,t,r){let i=e,s=t,o=e*t+t,a=o,l=1;const c=[],u=[];let h=(12&r)>>2,f=0;for(;i>0&&s>0;)o=i*t+s,a=o>>>1,l=o%2,f=n[a],f=l?15&f:f>>>4,h===0?(f>>=2,f===0&&(i--,s--,c.push(1),u.push(1))):h===2?(c.push(-1),u.push(1),f&=2,s--):(c.push(1),u.push(-1),f&=1,i--),h=f;return i>0?(c.push(i),u.push(-i)):s>0&&(c.push(-s),u.push(s)),[c,u]}class cb{constructor(e,t,r,i=0){this.Y=0,this.length=0,this.weight=0,this.length=e,this.J=new Us(e),this.L=new Uint8Array(t*e),this.Z=new Uint8Array(t*e),this.X=new Float32Array(t*e),this.tt=new Float32Array(t*e),this.et=new Uint8Array(e),this.rt=new Float32Array(e),this.nt=new Float32Array(e),this.it=new Float32Array(e),this.st=new Float32Array(e),this.ot=new Float32Array(e),this.Y=r,this.ht=t,this.weight=i}ct(e=0){return new ZC(this,e)}}class ZC{constructor(e,t=0){this.lt=0,this.ht=4,this.offset=0,this.ut=e,this.lt=t,this.ht=e.ht,this.offset=this.lt*this.ht}ft(e){this.lt=e,this.offset=e*this.ht}get J(){return this.ut.J.get(this.lt)}set J(e){e?this.ut.J.set(this.lt):this.ut.J.clear(this.lt)}get L(){return this.ut.L.subarray(this.offset,this.offset+this.ht)}set L(e){this.ut.L.set(e,this.offset)}get et(){return this.ut.et[this.lt]}set et(e){this.ut.et[this.lt]=e}get Z(){return this.ut.Z.subarray(this.offset,this.offset+this.ht)}set Z(e){this.ut.Z.set(e,this.offset)}get X(){return this.ut.X.subarray(this.offset,this.offset+this.ht)}set X(e){this.ut.X.set(e,this.offset)}get tt(){return this.ut.tt.subarray(this.offset,this.offset+this.ht)}set tt(e){this.ut.tt.set(e,this.offset)}get rt(){return this.ut.rt[this.lt]}set rt(e){this.ut.rt[this.lt]=e}get nt(){return this.ut.nt[this.lt]}set nt(e){this.ut.nt[this.lt]=e}get it(){return this.ut.it[this.lt]}set it(e){this.ut.it[this.lt]=e}get st(){return this.ut.st[this.lt]}set st(e){this.ut.st[this.lt]=e}get ot(){return this.ut.ot[this.lt]}set ot(e){this.ut.ot[this.lt]=e}}function JC(n,e,t,r=0){const i=n.V,s=i.length,o=new cb(s,t.dt,1,e);let a=e;const l=t.$;let c=o.ct(),u=0;for(let h=0;h<s;h++){c.ft(h),u=i[h],c.Z[u]=1,c.X[u]=a,c.L[c.et]=u,c.et=1,c.rt=a,c.st=l/2*a,c.ot=l/2*a;for(let f=0;f<t.dt;f++)c.tt[f]=a*t.W[f][u]}return 1&r||(o.st[0]/=2),2&r||(o.st[s-1]/=2),o}function bc(n,e,t,r,i,s=0){const o=au(t),a=n.Y+e.Y,l=n.weight+e.weight,c=new cb(o,i.dt,a,l),u=i.$;let h=c.ct(),f=n.ct(),p=e.ct(),m=nf(t),g=nf(r),x=0,b=0,y=1,w=1,v=!1,S=!1,k=!1,P=!1,C=0;for(let T=0;T<o;T++){if(h.ft(T),x=m[T],f.ft(x),x===-1?(v=y>=0,S=T===o-1||m[T+1]>0):(v=!1,S=!1),y=x,b=g[T],p.ft(b),b===-1?(k=w>=0,P=T==o-1||g[T+1]>0):(k=!1,P=!1),w=b,C=0,x!==-1&&b!==-1){h.nt=f.nt+p.nt,h.it=f.it+p.it,h.rt=f.rt+p.rt,h.Z.set(f.Z),h.X.set(f.X);for(let A=0;A<e.ht;A++){let M=p.Z[A];M&&(h.Z[A]+=M,h.X[A]+=p.X[A]),h.Z[A]&&(h.L[C]=A,C++),h.tt[A]=f.tt[A]+p.tt[A]}h.et=C}else x==-1?(h.nt=p.nt+(v?n.weight:0),h.it=p.it+(S?n.weight:0),h.rt=p.rt,h.Z.set(p.Z),h.X.set(p.X),h.L.set(p.L),h.tt.set(p.tt),h.et=p.et):b==-1&&(h.nt=f.nt+(k?e.weight:0),h.it=f.it+(P?e.weight:0),h.rt=f.rt,h.Z.set(f.Z),h.X.set(f.X),h.L.set(f.L),h.tt.set(f.tt),h.et=f.et);h.st=u/2*(1-h.nt)*h.rt,h.ot=u/2*(1-h.it)*h.rt}return 1&s||(c.st[0]/=2),2&s||(c.st[o-1]/=2),c}function mi(n){return"gt"in n}function QC(n,e){let t=1/0,r=0,i=0,s=n.length;for(let o=0;o<s;o++)for(let a=o+1;a<s;a++)n[o][a]<t&&(t=n[o][a],r=o,i=a);return[{profile:null,wt:e[r],At:e[i],Mt:t,yt:[],St:[],Ut:[],type:1,_t:0,id:"",qt:[],parent:-1,weight:0},r,i]}function ek(n,e,t,r){const[i,s]=e>t?[e,t]:[t,e],o=[],a=n.length;for(let l=0;l<a;l++){if(l==e||l==t)continue;const c=.1*(n[l][e]+n[l][t])/2+.9*Math.min(n[l][e],n[l][t]);n[l].push(c),o.push(c),n[l].splice(i,1),n[l].splice(s,1)}return o.push(0),n.push(o),n.splice(i,1),n.splice(s,1),r.splice(i,1),r.splice(s,1),n}class tk{constructor(e){this.bt=e,this.store=Array(e),this.head=0,this.vt=0}get size(){return(this.vt-this.head+this.bt)%this.bt}get Ot(){return this.head===this.vt}Ct(){if(this.Ot)return null;const e=this.store[this.head];return this.head++,this.head>=this.bt&&(this.head=0),e}Et(){return this.Ot?null:(this.vt--,this.vt<0&&(this.vt=this.bt-1),this.store[this.vt])}Gt(e){this.head--,this.head<0&&(this.head=this.bt-1),this.store[this.head]=e,this.head===this.vt&&(this.vt=(this.vt-1+this.bt)%this.bt)}Pt(e){this.store[this.vt]=e,this.vt++,this.vt>=this.bt&&(this.vt=0),this.head===this.vt&&(this.head=(this.head-1+this.bt)%this.bt)}Rt(e=0){const t=e===0?this.head:(this.head+e+this.bt)%this.bt;return this.store[t]}It(e=0){const t=(this.vt-1-e+this.bt)%this.bt;return this.store[t]}}function cu(n,e,t){const r=new Map,i=new tk(t),s=0|e,o=new Uint16Array(n.V.length-s+1);let a=0,l=0;for(let m=0;m<s;m++)a|=n.V[s-m-1]<<2*m;o[l++]=a;for(let m=s,g=n.V.length;m<g;m++)a=(a<<2)+n.V[m],o[l++]=a;const c=n.Tt.length*(2/(t+1))*2|0,u={Ft:new Uint16Array(c),Dt:new Uint16Array(c),xt:new Uint16Array(c),Bt:new Uint16Array(c),count:0};let h=NaN,f=0,p=-17;for(let m=0;m<o.length;m++){const g=o[m];for(p++;!i.Ot&&((f=i.It())<p||o[f]>=g);)i.Et();if(i.Pt(m),p<0)continue;for(;i.Rt()<p;)i.Ct();let x=i.Rt();if(x===h)u.Bt[u.count-1]=m+s;else{const b=o[x],y=u.count;u.count++,u.Ft[y]=b,u.Dt[y]=x,u.xt[y]=p,u.Bt[y]=m+s,h=x,r.has(b)?r.get(b).push(y):r.set(b,[y])}}return[r,u,o]}function rf(n,e,t,r,i){const[s,o,a]=r??cu(n,8,24),[l,c,u]=i??cu(e,8,24);n.Tt.length,e.Tt.length;const h=new Map;for(let P=0;P<o.count;P++){let C=o.Ft[P];if(!l.has(C))continue;let T=l.get(C);if(T.length>4)continue;let A=n.Tt.substring(o.xt[P],o.Bt[P]);for(let M=0;M<T.length;M++){let O=T[M],R=e.Tt.substring(c.xt[O],c.Bt[O]),j=Math.min(A.length,R.length),I=!1;I=j==A.length?R.indexOf(A)===0:A.indexOf(R)===0;let E,D=0;I?(D=o.xt[P]-c.xt[O],E={Nt:D,Ht:o.xt[P],end:o.xt[P]+j}):(D=o.Dt[P]-c.Dt[O],E={Nt:D,Ht:o.Dt[P],end:o.Dt[P]+8-1}),h.has(D)?h.get(D).push(E):h.set(D,[E])}}let f=[];if(h.forEach(P=>{if(!P.length)return;let C=P[0];f.push(C),P.forEach(T=>{T.Ht<=C.end?C.end=T.end:(C=T,f.push(C))})}),f.length===0)return Oa(n,e,t).j;f.sort((P,C)=>{let T=P.Ht+P.Nt-C.Ht-C.Nt;return T===0?P.Nt-C.Nt:T}),f=function(P,C,T){var A;const M=1/Math.max(C,T),O=C-T;let R=[0],j=new Int16Array(P.length);j[0]=-1;let I=P[0],E=I.end-I.Ht,D=I.end-I.Nt,L=I.Ht-I.Nt,z=Math.min(T-D,C-I.end),B=[E],N=[D],U=[z],q=P[0],X=0,J=P[X],ee=E,re=0;for(let ce=1;ce<P.length;ce++){if(I=P[ce],E=I.end-I.Ht,D=I.end-I.Nt,L=I.Ht-I.Nt,z=I.Nt<O?T-D:C-I.end,re===20){re=0;let fe=[],ve=R.length-1,xe=N[ve],ue=C-I.Ht;for(;ve--;)N[ve]>xe?fe.push(ve):(xe=N[ve],B[ve]+Math.min(U[ve],ue)<ee&&fe.push(ve));fe.forEach(Se=>{R.splice(Se,1),B.splice(Se,1),N.splice(Se,1),U.splice(Se,1)})}if(I.Nt>=q.Nt&&D<N[0]){if(E+z<ee)continue;if(j[ce]=-1,q=P[ce],re++,E<B[0]){R.unshift(ce),B.unshift(E),N.unshift(D),U.unshift(z);continue}E>ee&&(ee=E),R[0]=ce,B[0]=E,N[0]=D,U[0]=z}else{for(let fe=R.length-1;fe>=0;fe--)if(X=R[fe],J=P[X],I.Ht>=J.end&&N[fe]<L){const ve=Math.abs(I.Nt-X)*M,xe=B[fe]+E-ve;if(xe+z<ee)continue;let ue=fe;for(;ue<R.length&&B[ue]<xe;)ue++;if(ue===R.length)ee=xe,U.push(z),B.push(xe),N.push(D),R.push(ce);else{if(D>=N[N.length-1])continue;U.splice(ue,0,z),B.splice(ue,0,xe),N.splice(ue,0,D),R.splice(ue,0,ce)}j[ce]=X,re++;break}E>ee&&(j[ce]=-1,ee=E,U.push(z),B.push(E),N.push(D),R.push(ce),re++)}}let oe=[],me=(A=R.pop())!==null&&A!==void 0?A:0,ge=me;for(;me>-1&&ge>-1;)oe.push(me),me=j[me],ge--;let ae=[];for(let ce=oe.length-1;ce>=0;ce--)ae.push(P[oe[ce]]);return ae}(f,n.V.length,e.V.length);let p={Nt:0,Ht:0,end:0},m=[p],g=[];for(let P=0;P<f.length;P++){let C=f[P];if(C.Nt!==p.Nt){let T=p.end,A=T-p.Nt;for(;n.V[T]===e.V[A]&&T<C.Ht&&A<C.Ht-C.Nt;)T++,A++;for(p.end=T,T=C.Ht,A=T-C.Nt;n.V[T]===e.V[A]&&T>p.end&&A>p.end-p.Nt;)T--,A--;C.Ht=T+1,g.push({$t:C.Nt,kt:p.Nt,Ht:p.end,end:C.Ht}),m.push(C),p=C}else{let T=p.end,A=T-C.Nt,M=0;for(;T<C.Ht&&A<C.Ht-C.Nt&&M<2;)T+=8,A+=8,M=of(a[T],u[A])<=2?0:M+1;for(T>p.end&&(p.end=Math.max(T-2-8,p.end)),T=C.Ht-8,A=T-C.Nt,M=0;T>p.end&&A>p.end-p.Nt&&M<2;)T-=8,A-=8,M=of(a[T],u[A])<=2?0:M+1;if(T<C.Ht-16&&(C.Ht=T+24+2),C.Ht-p.end<=24){p.end=C.end;continue}g.push({kt:p.Nt,$t:C.Nt,Ht:p.end,end:C.Ht}),m.push(C),p=C}}let x=m[0];const b=[],y=[];for(let P=0;P<m.length;P++){x=m[P],b.push(x.end-x.Ht),y.push(x.end-x.Ht);let C=g[P];if(C){if(C.Ht===C.end){const A=Math.abs(C.$t-C.kt);b.push(-A),y.push(A);continue}if(C.Ht-C.kt==C.end-C.$t){const A=C.end-C.Ht;y.push(-A),b.push(A);continue}let T=Oa({Tt:n.Tt.substring(C.Ht,C.end),type:n.type,V:n.V.subarray(C.Ht,C.end)},{Tt:e.Tt.substring(C.Ht-C.kt,C.end-C.$t),type:e.type,V:e.V.subarray(C.Ht-C.kt,C.end-C.$t)},t,3);b.push(...T.j[0]),y.push(...T.j[1])}}sf(b,n.V.length),sf(y,e.V.length);let w=hr(b,1),v=hr(y,1);const S=au(w),k=au(v);return S>k?v=tf(v,[k-S]):S<k&&(w=tf(w,[S-k])),[w,v]}function sf(n,e){let t=e-function(r){let i=0,s=0;for(let o=0;o<r.length;o++)s=r[o],s<0||(i+=s);return i}(n);t>0?n.push(t):t<0&&(n[n.length-1]+=t)}function of(n,e){let t=n^e;return t=1431655765&t|t>>1&1431655765,Ss(t)}const af={Vt:"auto",gapchar:"-",Wt:"auto",debug:!1},nk=new class{constructor(){this.jt=[],this.Kt=2,this.Yt=Object.assign({},af)}Jt(n){if(Array.isArray(n))n.forEach(e=>{this.Jt(e)});else{if(typeof n!="string")throw new TypeError("String type expected for sequences to add.");if(n=n.toUpperCase(),this.Yt.Vt==="auto"){const e=Qh(n);if(this.Kt===2)this.Kt=e;else if(this.Kt!==e)throw Error("All sequences must be of same type.")}this.jt.push(function(e,t){const r=t??Qh(e),i=function(s,o){const a=new Uint8Array(s.length),l=o===0?Ye:Ir;let c=0;for(let u=0,h=s.length;u<h;u++)c=l[s.charCodeAt(u)],c===255&&(c=UC(s[u],o)),a[u]=c;return a}(e,r);return{Tt:e,V:i,zt:r===0?qC(i):i,type:r}}(n,this.Kt))}}reset(){this.jt=[],this.Kt=2,this.Lt()}Lt(){this.Yt=Object.assign({},af)}Qt(n){var e;function t(r,i){return i.some(s=>s==r)}n.method&&t(n.method,["complete","diag"])&&(this.Yt.Wt=n.method),n.type&&t(n.type,["amino","nucleic"])&&(this.Yt.Vt=n.type,this.Kt=n.type==="amino"?0:1),((e=n.gapchar)===null||e===void 0?void 0:e.length)===1&&(this.Yt.gapchar=n.gapchar),n.debug!==void 0&&(this.Yt.debug=!!n.debug)}align(n,e){return new Promise((r,i)=>{if(!Array.isArray(n)||n.some(c=>typeof c!="string"))return i("Array of sequences expected");if(n.length<2)return i("At least 2 sequences are required.");this.reset(),e&&this.Qt(e),this.Jt(n);const s=function(c,u){var h,f;const p=c===0?LC:FC;let m=(h=u?.matrix)!==null&&h!==void 0?h:p.matrix,g=u?.gapextend?2*-u.gapextend:p.H;var x;return{type:c,W:(x=g,m.map(b=>b.map(y=>y+x))),$:(f=u?.gapopen)!==null&&f!==void 0?f:p.$,dt:c===0?20:4}}(this.Kt,e);let o,a=!1;a=this.Yt.Wt==="auto"?this.jt.some(c=>c.Tt.length>1600):this.Yt.Wt==="diag",o=this.jt.length==2?a?rf(this.jt[0],this.jt[1],s):Oa(this.jt[0],this.jt[1],s).j:a?function(c,u){let h=c.map(g=>cu(g,8,24)),f=[],p=[],m=[];for(let g=0;g<h.length;g++){if(g===0)continue;let x=rf(c[0],c[g],u,h[0],h[g]);p=p.length===0?x[0]:YC(p,x[0]),m[g]=x[0],f[g]=x[1]}for(let g=0;g<h.length;g++){if(g===0){f[g]=p;continue}let x=KC(p,m[g]);if(!x)throw console.error("An error occured while computing the center diff. for sequence #"+g,p,m[g]),console.dir(f),console.dir(m),new RangeError;f[g]=Uo(x,f[g])}return f}(this.jt,s):function(c,u){const h=(g,x)=>{const b=f[g.wt],y=f[g.At];let w={};if(mi(b)||b.St.length!==0||h(b,x),mi(y)||y.St.length!==0||h(y,x),mi(b))if(mi(y)){const v=Oa(b.gt,y.gt,u);w.K=v.K,g.Ut=[b.Ut[0],y.Ut[0]],g.yt=v.j,g.profile=bc(b.profile,y.profile,v.j[0],v.j[1],u)}else{y.qt=y.Ut.map(S=>x[S]);const v=function(S,k,P,C=0){const T=k.gt,A=k.weight,M=T.Tt.length,O=S.profile.length;let R=0,j=[],I=[];const E=new Uint8Array(Math.ceil((O+1)*(M+1)/2)+1);let D,L,z,B=0,N=0,U=0,q=0,X=0,J=0,ee=0,re=0,oe=0,me=0,ge=0,ae=0,ce=0;const fe=P.$*A,ve=fe/2,xe=fe/2,ue=1&C?0:-fe/4,Se=2&C?0:-fe/4,Le=T.V,$=S.profile;j[0]=0,I[0]=-1/0;for(let G=1;G<=M;G++)j[G]=ve+xe+ue,I[G]=-1/0;for(let G=1;G<=O;G++){ae=$.st[G-1],ce=$.ot[G-1],z=$.tt.subarray((G-1)*P.dt,G*P.dt),oe=ue,J=-1/0,I[0]=$.st[0];for(let pe=1;pe<=M;pe++)X=0,B=j[pe]+ae,U=re=I[pe],pe===M&&(B-=ae/2),B>=U?I[pe]=B:X+=1,N=oe+ve,q=ee=J,G===O&&(N+=Se),N>=q?J=N:X+=2,me=re+ce,ge=ee+xe,R=j[pe-1]+z[Le[pe-1]],pe===M&&(ge+=Se),j[pe-1]=oe,R>=ge?R>=me?oe=R:(oe=me,X+=4):ge>=me?(oe=ge,X+=8):(oe=me,X+=4),D=G*M+pe,L=D%2,D>>>=1,E[D]+=L?X:X<<4;j[M]=oe}const F=Math.max(R,J,I[I.length-2]),[V,K]=lu(E,O,M,X);return{j:[hr(V),hr(K)],K:F}}(y,b,u);w.K=v.K,g.Ut=[b.Ut[0],...y.Ut],g.yt=[v.j[1],...y.yt.map(S=>Uo(v.j[0],S))],g.profile=bc(b.profile,y.profile,v.j[1],v.j[0],u)}else if(!mi(y)){y.qt=y.Ut.map(S=>x[S]),b.qt=b.Ut.map(S=>x[S]);const v=function(S,k,P,C=0){const T=S.profile.length,A=k.profile.length,M=new Uint8Array(Math.ceil((T+1)*(A+1)/2)+1);let O,R,j=[],I=[],E=0,D=0,L=0,z=0,B=0,N=0,U=0,q=0,X=0,J=0,ee=0,re=0,oe=0,me=0,ge=new Float32Array(P.dt),ae=new Uint8Array(P.dt),ce=0,fe=0,ve=0,xe=0,ue=0,Se=0;const Le=1&C?1:2,$=k.profile,F=S.profile;for(j[0]=0,I[0]=-1/0,ue=1;ue<=A;ue++)j[ue]=$.st[0]+$.ot[ue-1]/Le,I[ue]=-1/0;const V=F.st[0];for(xe=1;xe<=T;xe++){for(ge=F.tt.subarray(P.dt*(xe-1),P.dt*xe),oe=F.st[xe-1],me=F.ot[xe-1],X=V+me/Le,U=-1/0,I[0]=F.st[0],ue=1;ue<=A;ue++){for(N=0,D=j[ue]+oe,z=J=I[ue],ue!==A||2&C||(D-=oe/2),D>=z?I[ue]=D:N+=1,L=X+$.st[ue-1],B=q=U,xe!==T||2&C||(L-=$.st[ue-1]/2),L>=B?U=L:N+=2,E=j[ue-1],ve=$.et[ue-1],Se=0,fe=(ue-1)*P.dt,ae=$.L.subarray(fe,fe+ve);Se<ve;)ce=ae[Se],E+=ge[ce],Se++;ee=J+me,re=q+$.ot[ue-1],ue!==1||2&C||(ee-=me/2),ue!==A||2&C||(ee-=me/2,re-=$.ot[A-1]/2),j[ue-1]=X,E>=re?E>=ee?X=E:(X=ee,N+=4):re>=ee?(X=re,N+=8):(X=ee,N+=4),O=xe*A+ue,R=O%2,O>>>=1,M[O]+=R?N:N<<4}j[A]=X}const K=Math.max(E,U,I[ue-1]),[G,pe]=lu(M,T,A,N);return{j:[hr(G),hr(pe)],K}}(b,y,u);w.K=v.K,g.yt=[...b.yt.map(S=>Uo(v.j[0],S)),...y.yt.map(S=>Uo(v.j[1],S))],g.profile=bc(b.profile,y.profile,v.j[0],v.j[1],u)}return g.Ut=[...b.Ut,...y.Ut],w.K},f=function(g,x){let b,y,w,v=[],S=g.length,k=[];for(let P=0;P<S;P++)v[P]={type:0,gt:x[P],profile:null,wt:P,At:P,Mt:0,Ut:[P],St:[],id:P.toString(),weight:0,parent:-1,_t:0},k[P]=P;for(let P=0,C=S-1;P<C;P++){[b,y,w]=QC(g,k);const T=v[b.wt],A=v[b.At];b.id=T.id<A.id?`|${T.id},${A.id}|`:`|${A.id},${T.id}|`,b._t=Math.max(T._t,A._t)+1,A.parent=T.parent=v.length,k.push(S+P),v.push(b),g=ek(g,y,w,k)}return v[v.length-1].type=2,v}(function(g){const x=g[0].type===0,b=x?6:4,y=Math.pow(b,6),w=g.map(R=>{const j=new Us(y),I=x?R.zt:R.V;let E=0;for(let L=0;L<6;L++)E+=I[L]*Math.pow(b,L);j.set(E);const D=Math.pow(b,5);for(let L=6,z=I.length;L<z;L++)E-=I[L-6],E/=b,E+=I[L]*D,j.set(E);return j}),v=g.length,S=g.map(()=>[]);let k,P,C,T,A,M,O;for(let R=0;R<v;R++){S[R][R]=0,k=w[R],C=k.P(),M=1/(-Math.LN2/Math.log(1-C/y)*2);for(let j=R+1;j<v;j++)T=w[j].P(),A=k.D(w[j]),A+=y-(C+T-A),O=Math.ceil(M*T),A-=O,A=Math.max(A,0),P=1-A/(y-O),S[j][R]=S[R][j]=P}return S}(c),c),p=f[f.length-1],m=function(g){let x=0;return function b(y){let w=0,v=0;switch(y.type){case 2:y.weight=0,b(g[y.wt]),b(g[y.At]);break;case 1:w=g[y.parent].Mt-y.Mt,v=y.id.split(",").length,y.weight=g[y.parent].weight+w/v,b(g[y.wt]),b(g[y.At]);break;case 0:w=g[y.parent].Mt,y.weight=g[y.parent].weight+w,x+=y.weight}}(g[g.length-1]),g.map(b=>b.weight)}(f);return function(g,x,b){let y=0,w=g[y];for(;mi(w)&&y<g.length;)w.profile=JC(w.gt,w.weight,x,void 0),y++,w=g[y]}(f,u),h(p,m),function(g,x){let b=x.slice();return x.forEach((y,w)=>b[y]=w),b.map(y=>g[y])}(p.yt.slice(),p.Ut)}(this.jt,s);const l=function(c,u,h){var f;let p=(f=h?.gapchar)!==null&&f!==void 0?f:"-",m=[];for(let g=0;g<c.length;g++)m.push(GC(c[g].Tt,u[g],{gapchar:p}));return m}(this.jt,o,{gapchar:this.Yt.gapchar});return r(l)}).catch(r=>Promise.reject(r))}},ub={A:{A:10,R:-1,N:0,D:-1,C:-1,Q:-1,E:-1,G:1,H:-2,I:0,L:-1,K:-1,M:-1,F:-3,P:1,S:1,T:2,W:-4,Y:-3,V:1,B:0,Z:-1,X:0,"-":0},R:{A:-1,R:10,N:0,D:-1,C:-1,Q:2,E:0,G:0,H:2,I:-3,L:-3,K:4,M:-2,F:-4,P:-1,S:-1,T:-1,W:0,Y:-2,V:-3,B:0,Z:1,X:0,"-":0},N:{A:0,R:0,N:10,D:2,C:-1,Q:0,E:1,G:0,H:1,I:-2,L:-3,K:1,M:-2,F:-3,P:-1,S:1,T:1,W:-4,Y:-1,V:-2,B:2,Z:0,X:0,"-":0},D:{A:-1,R:-1,N:2,D:10,C:-3,Q:0,E:4,G:1,H:0,I:-3,L:-4,K:0,M:-3,F:-5,P:-2,S:0,T:-1,W:-5,Y:-2,V:-3,B:3,Z:2,X:0,"-":0},C:{A:-1,R:-1,N:-1,D:-3,C:10,Q:-3,E:-4,G:-1,H:0,I:-2,L:-3,K:-3,M:-2,F:0,P:-2,S:1,T:-1,W:1,Y:2,V:-2,B:-2,Z:-3,X:0,"-":0},Q:{A:-1,R:2,N:0,D:0,C:-3,Q:10,E:2,G:-1,H:3,I:-3,L:-2,K:2,M:-2,F:-4,P:0,S:-1,T:-1,W:-3,Y:-1,V:-3,B:0,Z:3,X:0,"-":0},E:{A:-1,R:0,N:1,D:4,C:-4,Q:2,E:10,G:1,H:0,I:-3,L:-4,K:1,M:-3,F:-5,P:-2,S:-1,T:-1,W:-5,Y:-4,V:-2,B:2,Z:3,X:0,"-":0},G:{A:1,R:0,N:0,D:1,C:-1,Q:-1,E:1,G:10,H:-2,I:-3,L:-4,K:-1,M:-3,F:-5,P:-1,S:1,T:0,W:-2,Y:-4,V:-2,B:0,Z:0,X:0,"-":0},H:{A:-2,R:2,N:1,D:0,C:0,Q:3,E:0,G:-2,H:10,I:-3,L:-2,K:1,M:-2,F:0,P:0,S:-1,T:-1,W:-3,Y:4,V:-3,B:0,Z:1,X:0,"-":0},I:{A:0,R:-3,N:-2,D:-3,C:-2,Q:-3,E:-3,G:-3,H:-3,I:10,L:2,K:-3,M:3,F:0,P:-2,S:-1,T:1,W:-4,Y:-2,V:4,B:-2,Z:-3,X:0,"-":0},L:{A:-1,R:-3,N:-3,D:-4,C:-3,Q:-2,E:-4,G:-4,H:-2,I:2,L:10,K:-3,M:3,F:2,P:0,S:-2,T:-1,W:-2,Y:-1,V:2,B:-3,Z:-3,X:0,"-":0},K:{A:-1,R:4,N:1,D:0,C:-3,Q:2,E:1,G:-1,H:1,I:-3,L:-3,K:10,M:-2,F:-5,P:-2,S:-1,T:-1,W:-3,Y:-3,V:-3,B:0,Z:1,X:0,"-":0},M:{A:-1,R:-2,N:-2,D:-3,C:-2,Q:-2,E:-3,G:-3,H:-2,I:3,L:3,K:-2,M:10,F:0,P:-2,S:-1,T:0,W:-3,Y:-3,V:2,B:-2,Z:-2,X:0,"-":0},F:{A:-3,R:-4,N:-3,D:-5,C:0,Q:-4,E:-5,G:-5,H:0,I:0,L:2,K:-5,M:0,F:10,P:-2,S:-2,T:-2,W:-1,Y:5,V:0,B:-4,Z:-4,X:0,"-":0},P:{A:1,R:-1,N:-1,D:-2,C:-2,Q:0,E:-2,G:-1,H:0,I:-2,L:0,K:-2,M:-2,F:-2,P:10,S:1,T:1,W:-5,Y:-3,V:-1,B:-1,Z:-1,X:0,"-":0},S:{A:1,R:-1,N:1,D:0,C:1,Q:-1,E:-1,G:1,H:-1,I:-1,L:-2,K:-1,M:-1,F:-2,P:1,S:10,T:1,W:-3,Y:-1,V:-1,B:0,Z:-1,X:0,"-":0},T:{A:2,R:-1,N:1,D:-1,C:-1,Q:-1,E:-1,G:0,H:-1,I:1,L:-1,K:-1,M:0,F:-2,P:1,S:1,T:10,W:-4,Y:-3,V:0,B:0,Z:-1,X:0,"-":0},W:{A:-4,R:0,N:-4,D:-5,C:1,Q:-3,E:-5,G:-2,H:-3,I:-4,L:-2,K:-3,M:-3,F:-1,P:-5,S:-3,T:-4,W:10,Y:0,V:-4,B:-4,Z:-4,X:0,"-":0},Y:{A:-3,R:-2,N:-1,D:-2,C:2,Q:-1,E:-4,G:-4,H:4,I:-2,L:-1,K:-3,M:-3,F:5,P:-3,S:-1,T:-3,W:0,Y:10,V:-3,B:-1,Z:-2,X:0,"-":0},V:{A:1,R:-3,N:-2,D:-3,C:-2,Q:-3,E:-2,G:-2,H:-3,I:4,L:2,K:-3,M:2,F:0,P:-1,S:-1,T:0,W:-4,Y:-3,V:10,B:-2,Z:-2,X:0,"-":0},B:{A:0,R:0,N:2,D:3,C:-2,Q:0,E:2,G:0,H:0,I:-2,L:-3,K:0,M:-2,F:-4,P:-1,S:0,T:0,W:-4,Y:-1,V:-2,B:10,Z:1,X:0,"-":0},Z:{A:-1,R:1,N:0,D:2,C:-3,Q:3,E:3,G:0,H:1,I:-3,L:-3,K:1,M:-2,F:-4,P:-1,S:-1,T:-1,W:-4,Y:-2,V:-2,B:1,Z:10,X:0,"-":0},X:{A:0,R:0,N:0,D:0,C:0,Q:0,E:0,G:0,H:0,I:0,L:0,K:0,M:0,F:0,P:0,S:0,T:0,W:0,Y:0,V:0,B:0,Z:0,X:1,"-":0},"-":{A:0,R:0,N:0,D:0,C:0,Q:0,E:0,G:0,H:0,I:0,L:0,K:0,M:0,F:0,P:0,S:0,T:0,W:0,Y:0,V:0,B:0,Z:0,X:0,"-":1}},db=Object.values(ub).map(n=>Object.values(n)),lf=Math.min(...db.flat()),rk=Math.max(...db.flat());function hb(n,e){return n==="-"||e==="-"?0:(ub[n][e]-lf)/(rk-lf)}function ik(n,e){const t=Array.from(n),r=Array.from(e),i=[];for(let a=0;a<t.length;a++)t[a]==="-"||r[a]==="-"||i.push(a);const s=i.length;let o=0;for(const a of i)o+=hb(t[a],r[a]);return 1-o/s}function cf(n,e){let t=0;for(const r of e)t+=ik(n,r);return t/(e.length-1)}function sk(n){const e=n[0].length,t=Array.from({length:e},()=>0);let r=0;for(let s=0;s<n.length;s++){const o=cf(n[s],n);for(let a=s+1;a<n.length;a++){const l=cf(n[a],n);for(let c=0;c<e;c++)t[c]+=o*l*hb(n[s][c],n[a][c]);r+=o*l}}return t.map(s=>s/r)}function*ok(...n){if(n.length===0)return;const e=n.map(r=>r[Symbol.iterator]()),t=e.map(r=>r.next());for(let r=0;;){if(t[r].done){if(e[r]=n[r][Symbol.iterator](),t[r]=e[r].next(),++r>=e.length)return}else yield t.map(({value:i})=>i),r=0;t[r]=e[r].next()}}const uf=n=>n.reduce((e,t)=>e+t,0)/n.length,ak=(...n)=>{const e=Math.max(...n.map(t=>t.length));return Array.from(Array(e)).map((t,r)=>n.map(i=>i[r]))};function lk(n){const e=[],t=[];let r=0;return Array.from(n).forEach((i,s)=>{i==="-"?t.push(-1):(e.push(s),t.push(r),++r)}),{alignedSequence:n,toReference:e,fromReference:t}}function fb(n,e){let r=sk(n);return r.every(i=>Number.isNaN(i))&&(r=ak(...n.map(i=>Array.from(i))).map(i=>new Set(i).values().map(s=>i.filter(o=>o===s).length).toArray().toSorted((s,o)=>o-s)[0]/i.length)),{consensus:void 0,conservationScores:r,alignments:n.map(i=>lk(i))}}async function ck(n,e){const t=await nk.align(n,{type:"amino"});return fb(t)}const Ed=(n,e,t=0,r=!1)=>{const i=new Set,s=new Set,o=new Set;for(const[a,l]of n){if(r&&s.size>0)break;const c=(a==="ntd"?1:a)+t-1;if(c<0||c>=e.length){o.add(a);continue}if(e[c]==="-"){o.add(a);continue}a==="ntd"&&t===0||a!=="ntd"&&(l===void 0||e[c]===l)?i.add(a):s.add(a)}return{success:i.size>0&&s.size===0,mappedPositions:i,mismatchedPositions:s,unmappedPositions:o}},pb=n=>{const e=n.keys().map(t=>t==="ntd"?1:t).toArray();return[Math.min(...e),Math.max(...e)]},uk=(n,e)=>{const t=[],[r,i]=pb(n);for(let s=(i-1)*-1;s<=e-r;s+=1)t.push(s);return t},dk=(n,e)=>{let t=new Map;for(const r of uk(e,n.length)){const{success:i,mappedPositions:s}=Ed(e,n,r,!0);i&&t.set(r,s)}return t.entries().map(([r,i])=>({offset:r,mappedPositions:i})).toArray().toSorted((r,i)=>i.mappedPositions.size-r.mappedPositions.size)};async function mb(n,e,t){const{alignments:r,conservationScores:i}=t?fb(t):await ck([n,e.replaceAll("-","X")]),s=r[0].toReference,o=r[1].fromReference;return{alignedSequences:r.map(({alignedSequence:a})=>a),alignmentOffsets:s.map(a=>o[a]),scores:i}}const Id=({linkPositionToAminoAcid:n,peptides:e})=>new Map([...Object.entries(n??{}).map(([t,r])=>[t==="ntd"?"ntd":Number.parseInt(t),r]),...(e??[]).flatMap(({position:t,sequence:r})=>Array.from(r).map((i,s)=>[t+s,i]))]);function df(n,e,t){if(n===0)return 0;const r=t!==void 0,i=r?Math.min(t/.2,t):1,s=n/e,o=Math.min(s/.2,1),a=Math.min(e/10,5),l=Math.min(n/a,1);return r?s*.3+i*.4+o*.15+l*.15:s*.5+o*.25+l*.25}async function hk(n,{sequence:e,...t},r){if(e){const{alignmentOffsets:i,scores:s,alignedSequences:o}=await mb(e,n.sequence,r?[r[1],r[0]]:void 0),a=new Map(Array.from(Array(e.length)).map((c,u)=>[u+1,i[u]!==-1?n.startPosition+i[u]:void 0]));a.set("ntd",i[0]===0?n.startPosition:void 0);const l=a.entries().filter(([c,u])=>u!==void 0&&(c==="ntd"?a.get("ntd")!==void 0:e[c]===n.sequence[u-n.startPosition+1])).toArray().length;return{proteinPosToChainPos:a,alignedSequences:{chain:o[1],protein:o[0]},alignmentScore:uf(s),hits:l,relativeHits:l/e.length,confidence:df(l,e.length,uf(s))}}else{const i=Id(t),s=dk(n.sequence,i);if(s.length===0)return;const{mappedPositions:o,offset:a}=s[0],l=new Map(i.keys().map(u=>[u,o.has(u)?u==="ntd"?n.startPosition:n.startPosition+a+u-1:void 0])),c=o.size;return{proteinPosToChainPos:l,hits:c,relativeHits:c/i.size,confidence:df(c,i.size)}}}function fk(n){const e=n.filter(({alignmentScore:t,hits:r,relativeHits:i})=>{if(t&&t<.2||i<.2)return!1;const s=r/i;return!(r<Math.min(s/10,5))}).toSorted((t,r)=>r.relativeHits!==t.relativeHits?r.relativeHits-t.relativeHits:(r.alignmentScore??0)-(t.alignmentScore??0));return e.length>0?e[0]:void 0}const pk={HIS:"H",ARG:"R",LYS:"K",ILE:"I",PHE:"F",LEU:"L",TRP:"W",ALA:"A",MET:"M",PRO:"P",CYS:"C",ASN:"N",VAL:"V",GLY:"G",SER:"S",GLN:"Q",TYR:"Y",ASP:"D",GLU:"E",THR:"T",SEC:"U",PYL:"O",HSD:"H",HSE:"H",HSP:"H",LSN:"K",ASPP:"D",GLUP:"E",HID:"H",HIE:"H",HIP:"H",LYN:"K",ASH:"D",GLH:"E"};function mk(n){return pk[n]||"X"}const gk=(n,e)=>{const t=e.x-n.x,r=e.y-n.y,i=e.z-n.z;return Math.sqrt(t*t+r*r+i*i)};function*Rl(n,e,t,r){const i=a=>{const l=[];for(const{id:c,residues:u}of e)for(const[h,f]of t[c].entries()){if(h!==a.proteinId)continue;const p=f?.get(a.linkPosition);if(p===void 0||!u[p])continue;const m=mk(u[p].name);if(r&&a.linkPosition!=="ntd"&&a.aminoAcid!==void 0&&m!==a.aminoAcid)continue;const g=u[p].atoms.CA;if(!g){console.warn(`CA is missing in /${c}:${p}`);continue}l.push({chainId:c,position:p,aminoAcid:m,atom:g})}return l},s=i(n.from),o=i(n.to);if(!(s.length===0||o.length===0))for(const[{atom:a,...l},{atom:c,...u}]of ok(s,o))l.chainId===u.chainId&&(l.position===u.position||n.homoMultimeric)||(yield{from:l,to:u,distance:gk(a,c)})}const xk=`import json
from collections import defaultdict


def list_models():
    data = json.loads('%%data%%')

    for model in session.models:
        if not hasattr(model, 'find_residue'):
            continue

        groups = defaultdict(list)
        for group, chain1, pos1, chain2, pos2 in data:
            res1 = model.find_residue(chain1, pos1)
            if res1 is None:
                break
            atom1 = res1.find_atom('CA')
            if atom1 is None:
                break

            res2 = model.find_residue(chain2, pos2)
            if res2 is None:
                break
            atom2 = res2.find_atom('CA')
            if atom2 is None:
                break

            groups[group].append((atom1, atom2))
        else:
            yield model, groups


for model, groups in list(list_models()):
    pbond_groups = []
    for group_name, atom_pairs in groups.items():
        group = session.pb_manager.get_group(group_name)
        for atom1, atom2 in atom_pairs:
            bond = group.new_pseudobond(atom1, atom2)
            bond.radius = 0.8
            if group_name == '%%under%%':
                bond.color =  [243, 168, 59, 255]
            elif group_name == '%%ok%%':
                bond.color = [55, 125, 34, 255]
            elif group_name == '%%over%%':
                bond.color = [235, 50, 35, 255]
        pbond_groups.append(group)
    session.models.add_group(pbond_groups, name='%%experiment_name%%', parent=model)
`,bk=`import json
from collections import defaultdict


EXPERIMENT_NAME = cmd.get_legal_name('%%experiment_name%%')
UNDER_NAME = cmd.get_legal_name('%%under%%')
OK_NAME = cmd.get_legal_name('%%ok%%')
OVER_NAME = cmd.get_legal_name('%%over%%')


def get_atom_id(model, chain, pos):
    try:
        return cmd.id_atom(f'{model}/{chain}//{pos}/CA')
    except:
        return None


def list_models():
    data = json.loads('%%data%%')

    for model in cmd.get_object_list():
        groups = defaultdict(list)
        for group, chain1, pos1, chain2, pos2 in data:
            atom1 = get_atom_id(model, chain1, pos1)
            if atom1 is None:
                break

            atom2 = get_atom_id(model, chain2, pos2)
            if atom2 is None:
                break

            groups[cmd.get_legal_name(group)].append((atom1, atom2))
        else:
            yield model, groups


for model, groups in list(list_models()):
    cmd.group(f'{model}-xlinkup')
    cmd.group(f'{model}-xlinkup.{EXPERIMENT_NAME}')
    for group_name, atom_pairs in groups.items():
        name = f'{model}-xlinkup.{EXPERIMENT_NAME}.{group_name}'
        for atom1, atom2 in atom_pairs:
            cmd.distance(name, f'id {atom1}', f'id {atom2}')

        if group_name == UNDER_NAME:
            cmd.color('brightorange', name)
        elif group_name == OK_NAME:
            cmd.color('green', name)
        elif group_name == OVER_NAME:
            cmd.color('red', name)
`,uu=(n,{startPosition:e,endPosition:t})=>{if(n===void 0)return!1;const r=n==="ntd"?1:n;return e<=r&&r<=t},$a=(n,e)=>n!==void 0?e?.find(t=>uu(n,t)):void 0,qs=(n,e)=>{const t=u=>{const h=e[u.proteinId].sequence;if(u.linkPosition!=="ntd")return u.linkPosition!==void 0&&h?h[u.linkPosition-1]:u.aminoAcid},r=u=>`${e[u].name}${u}`,i=u=>u?.startPosition.toString().padStart(5,"0")??"XXXXX",s={},o=({from:u,to:h})=>{const f=$a(u.linkPosition,e[u.proteinId].domains),p=$a(h.linkPosition,e[h.proteinId].domains),m=`${r(u.proteinId)}${i(f)}:${r(h.proteinId)}${i(p)}`;return m in s||(s[m]={fromProteinId:u.proteinId,fromProteinName:e[u.proteinId].name,fromDomainName:f?.name,toProteinId:h.proteinId,toProteinName:e[h.proteinId].name,toDomainName:p?.name}),m},a={},l=({from:u,to:h})=>{const f=[u,h].map(({linkPosition:p})=>p===void 0?"XXXXX":(p==="ntd"?0:p).toString().padStart(5,"0")).join(";");return f in a||(a[f]={fromProteinId:u.proteinId,fromPosition:u.linkPosition,fromAminoAcid:t(u),toProteinId:h.proteinId,toPosition:h.linkPosition,toAminoAcid:t(h)}),f},c={};return n.forEach((u,h)=>u.forEach(f=>{const p=o(f),m=l(f);p in c?m in c[p]?h in c[p][m]||(c[p][m][h]=[]):c[p][m]={[h]:[]}:c[p]={[m]:{[h]:[]}},c[p][m][h].push(f)})),Object.entries(c).toSorted(([u,h],[f,p])=>u.localeCompare(f)).map(([u,h])=>({...s[u],rows:Object.entries(h).toSorted(([f],[p])=>f.localeCompare(p)).map(([f,p])=>({...a[f],ids:n.map((m,g)=>p[g]?.toSorted((x,b)=>(b.score??0)-(x.score??0)).map(({id:x})=>x)??[]),homoMultimeric:n.map((m,g)=>p[g]?.toSorted((x,b)=>(b.score??0)-(x.score??0)).map(({homoMultimeric:x})=>x)??[]),scores:n.map((m,g)=>p[g]?.toSorted((x,b)=>(b.score??0)-(x.score??0)).map(({score:x})=>x)??[])}))}))},gb=(n,e=!0)=>(Kr(n.length===0||n[0].rows[0].ids.length===1),n.flatMap(({rows:t})=>t.flatMap(({ids:r})=>r.flatMap(i=>e?i[0]:i.flat())))),Mn=(n,{lower:e,upper:t})=>{let r;for(const i of n)if(e!==void 0&&i<e)r="under";else if(t!==void 0&&i>t)r!=="under"&&(r="over");else{r="ok";break}return r},Qi=(n,e,t)=>e.map(r=>Rl(n,r.chains,r.chainIdToProteinIdToMapping,t).map(({distance:i})=>i).toArray()),xb=(n,e)=>{if(n.length===0)return;const t=Mn(n,e),r=n.filter(i=>Mn([i],e)===t);return r.reduce((i,s)=>i+s,0)/r.length},Da=(n,e,t,r)=>Object.fromEntries(n.map(i=>[i.id,Object.fromEntries(e.filter(({from:s,to:o})=>s.linkPosition!==void 0&&o.linkPosition!==void 0).map(s=>[s.id,Mn(Rl(s,i.chains,i.chainIdToProteinIdToMapping,t).map(({distance:o})=>o),r??{})]))])),yk=n=>{switch(n){case"chimerax":return xk;case"pymol":return bk}},vk=async(n,e="XLinkUp",t,r,i)=>{const s=r.map(({category:l,from:c,to:u})=>[i?.[l]??l,c.chainId,c.position,u.chainId,u.position]),o=document.createElement("a"),a=new Blob([yk(n).replaceAll("%%experiment_name%%",e).replaceAll("%%data%%",JSON.stringify(s)).replaceAll("%%under%%",i?.under??"under").replaceAll("%%ok%%",i?.ok??"ok").replaceAll("%%over%%",i?.over??"over")],{type:"text/x-python"});o.href=URL.createObjectURL(a),o.download=`${e}-${t}-xlinks.${n}.py`,o.click()},wk=(n,{from:e,to:t})=>{switch(n){case"chimerax":return`distance /${e.chainId}:${e.position}@ca /${t.chainId}:${t.position}@ca`;case"pymol":return`distance ${e.chainId}//${e.position}/CA, ${t.chainId}//${t.position}/CA`}},Ol=(n,e)=>{const t=Object.fromEntries(n.map(({proteins:u},h)=>[h,Object.fromEntries(u.map(f=>[f.id,f]))])),r=Object.fromEntries(n.map(({proteins:u},h)=>[h,Object.fromEntries(u.map(f=>[f.id,"peptides"in f?f.peptides:void 0]))])),i=(u,h)=>h.peptideIndex!==void 0?r[u][h.proteinId]?.[h.peptideIndex]:void 0,s=[];if(e)for(const{ids:u}of e.flatMap(({rows:h})=>h))s.push(...n.flatMap((h,f)=>u[f].map(p=>[f,h.crosslinks.find(m=>m.id===p)])));else s.push(...n.flatMap((u,h)=>u.crosslinks.map(f=>[h,f])));const o=(u,h)=>{const f=t[u][h.proteinId].sequence;if(h.linkPosition!=="ntd")return h.linkPosition!==void 0&&f?f[h.linkPosition-1]:h.aminoAcid},a=["Experiment","id","Score","Protein1","AminoAcid1","Position1","PeptideSeq1","PeptidePos1","PositionInPeptide1","Protein2","AminoAcid2","Position2","PeptideSeq2","PeptidePos2","PositionInPeptide2"],l={Experiment:s.map(([u])=>n[u].name),id:s.map(([,{id:u}])=>u),Score:s.map(([,{score:u}])=>u),Protein1:s.map(([u,{from:h}])=>t[u][h.proteinId].name),AminoAcid1:s.map(([u,{from:h}])=>o(u,h)),Position1:s.map(([,{from:u}])=>u.linkPosition==="ntd"?0:u.linkPosition),PeptideSeq1:s.map(([u,{from:h}])=>i(u,h)?.sequence),PeptidePos1:s.map(([u,{from:h}])=>i(u,h)?.position),PositionInPeptide1:s.map(([,{from:u}])=>"linkPositionInPeptide"in u?u.linkPositionInPeptide:void 0),Protein2:s.map(([u,{to:h}])=>t[u][h.proteinId].name),AminoAcid2:s.map(([u,{to:h}])=>o(u,h)),Position2:s.map(([,{to:u}])=>u.linkPosition==="ntd"?0:u.linkPosition),PeptideSeq2:s.map(([u,{to:h}])=>i(u,h)?.sequence),PeptidePos2:s.map(([u,{to:h}])=>i(u,h)?.position),PositionInPeptide2:s.map(([,{to:u}])=>"linkPositionInPeptide"in u?u.linkPositionInPeptide:void 0)},c=a.filter(u=>l[u].some(h=>h!==void 0));return{headers:c,rows:s.map((u,h)=>c.map(f=>l[f][h]))}},_k=(n,e,t)=>{const r=Ol([{...n,crosslinks:t}]),i=U_(e).toArray();return r.headers.push(...i.map(([s,o])=>s+o)),t.forEach((s,o)=>{for(const[a,l]of i){const c=s.pairs.find(({from:u,to:h})=>u.chainId===a&&h.chainId===l||u.chainId===l&&h.chainId===a);c?r.rows[o].push(c.distance):r.rows[o].push(void 0)}}),r},$l=(n,e)=>{const t=document.createElement("a"),r=new Blob([n.headers.join(",")+`
`+n.rows.map(i=>i.join(",")).join(`
`)],{type:"text/csv"});t.href=URL.createObjectURL(r),t.download=`${e}.csv`,t.click()},An=n=>{switch(n){case"under":return"orange";case"ok":return"green";case"over":return"red";default:return"rgb(161, 161, 170)"}},Sk=(n,e)=>n&&e?`Crosslink distance is between ${n}  and ${e} `:n&&!e?`Crosslink distance is above ${n} `:!n&&e?`Crosslink distance is below ${e} `:"Crosslink appears in structure",Pk=(n,e)=>{const i=[10,void 0,void 0,void 0];n||(i[1]=1),e||(i[3]=1);const s=(100-i.reduce((o,a)=>(o??0)+(a??0),0))/i.filter(o=>o===void 0).length;return i.map(o=>o??s)};let Zt;const Ck=_.memo(function(e){const t=te.c(67);let r,i,s,o;t[0]!==e?({thresholds:o,experimentId:r,ref:i,...s}=e,t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=o):(r=t[1],i=t[2],s=t[3],o=t[4]);let a;t[5]!==o?(a=o===void 0?{}:o,t[5]=o,t[6]=a):a=t[6];const{lower:l,upper:c}=a,[u,h,f,p]=Pk(!!l,!!c);let m;t[7]===Symbol.for("react.memo_cache_sentinel")?(m=An(void 0),t[7]=m):m=t[7];const g=`${u}%`;let x;t[8]!==g?(x=d.jsx(en,{content:"Crosslink does not appear in structure",openDelay:200,children:d.jsx(ft,{bg:m,w:g,borderLeftRadius:"md"})}),t[8]=g,t[9]=x):x=t[9];const b=`Crosslink distance is below ${l} `,y=!l;let w;t[10]===Symbol.for("react.memo_cache_sentinel")?(w=An("under"),t[10]=w):w=t[10];const v=`${h}%`;let S;t[11]!==v?(S=d.jsx(ft,{bg:w,w:v}),t[11]=v,t[12]=S):S=t[12];let k;t[13]!==S||t[14]!==b||t[15]!==y?(k=d.jsx(en,{content:b,openDelay:200,disabled:y,children:S}),t[13]=S,t[14]=b,t[15]=y,t[16]=k):k=t[16];let P;t[17]!==l||t[18]!==c?(P=Sk(l,c),t[17]=l,t[18]=c,t[19]=P):P=t[19];let C;t[20]===Symbol.for("react.memo_cache_sentinel")?(C=An("ok"),t[20]=C):C=t[20];const T=`${f}%`;let A;t[21]!==T?(A=d.jsx(ft,{bg:C,w:T}),t[21]=T,t[22]=A):A=t[22];let M;t[23]!==P||t[24]!==A?(M=d.jsx(en,{content:P,openDelay:200,children:A}),t[23]=P,t[24]=A,t[25]=M):M=t[25];const O=`Crosslink distance is above ${c} `,R=!c;let j;t[26]===Symbol.for("react.memo_cache_sentinel")?(j=An("over"),t[26]=j):j=t[26];const I=`${p}%`;let E;t[27]!==I?(E=d.jsx(ft,{bg:j,w:I,borderRightRadius:"md"}),t[27]=I,t[28]=E):E=t[28];let D;t[29]!==O||t[30]!==R||t[31]!==E?(D=d.jsx(en,{content:O,openDelay:200,disabled:R,children:E}),t[29]=O,t[30]=R,t[31]=E,t[32]=D):D=t[32];let L;t[33]!==k||t[34]!==M||t[35]!==D||t[36]!==x?(L=d.jsxs(Re,{h:5,children:[x,k,M,D]}),t[33]=k,t[34]=M,t[35]=D,t[36]=x,t[37]=L):L=t[37];const z=`${u+h-5}%`;let B;t[38]!==z?(B=d.jsx(ft,{w:z}),t[38]=z,t[39]=B):B=t[39];let N;t[40]!==r||t[41]!==l||t[42]!==c?(N=ge=>{if(Zt=Rs(Zt),!ge){zo(r,{lower:void 0,upper:c});return}return ge<=0?(Zt=nt(Zt,{type:"error",title:"Lower threshold must be positive"}),l):c&&ge>=c?(Zt=nt(Zt,{type:"error",title:"Lower threshold must be below the upper threshold"}),l):(zo(r,{lower:ge,upper:c}),ge)},t[40]=r,t[41]=l,t[42]=c,t[43]=N):N=t[43];let U;t[44]!==l||t[45]!==N?(U=d.jsx(en,{content:"Lower threshold",children:d.jsx(Jh,{value:l,onChange:N,w:"10%"})}),t[44]=l,t[45]=N,t[46]=U):U=t[46];let q;t[47]===Symbol.for("react.memo_cache_sentinel")?(q=d.jsx(ft,{flexGrow:1}),t[47]=q):q=t[47];let X;t[48]!==r||t[49]!==l||t[50]!==c?(X=ge=>{if(Zt=Rs(Zt),!ge){zo(r,{lower:l,upper:void 0});return}return ge<=0?(Zt=nt(Zt,{type:"error",title:"Upper threshold must be positive"}),l):l&&ge<=l?(Zt=nt(Zt,{type:"error",title:"Upper threshold must be above the lower threshold"}),c):(zo(r,{lower:l,upper:ge}),ge)},t[48]=r,t[49]=l,t[50]=c,t[51]=X):X=t[51];let J;t[52]!==X||t[53]!==c?(J=d.jsx(en,{content:"Upper threshold",children:d.jsx(Jh,{value:c,onChange:X,w:"10%"})}),t[52]=X,t[53]=c,t[54]=J):J=t[54];const ee=`${p-5}%`;let re;t[55]!==ee?(re=d.jsx(ft,{w:ee}),t[55]=ee,t[56]=re):re=t[56];let oe;t[57]!==B||t[58]!==U||t[59]!==J||t[60]!==re?(oe=d.jsxs(Re,{children:[B,U,q,J,re]}),t[57]=B,t[58]=U,t[59]=J,t[60]=re,t[61]=oe):oe=t[61];let me;return t[62]!==i||t[63]!==s||t[64]!==L||t[65]!==oe?(me=d.jsxs(So,{gap:0,align:"stretch",ref:i,...s,children:[L,oe]}),t[62]=i,t[63]=s,t[64]=L,t[65]=oe,t[66]=me):me=t[66],me}),Rd=n=>{const e=te.c(22);let t,r,i,s,o,a,l;e[0]!==n?({name:t,onRename:r,center:o,disabled:a,autoResize:l,ref:i,...s}=n,e[0]=n,e[1]=t,e[2]=r,e[3]=i,e[4]=s,e[5]=o,e[6]=a,e[7]=l):(t=e[1],r=e[2],i=e[3],s=e[4],o=e[5],a=e[6],l=e[7]);const c=o===void 0?!1:o,u=a===void 0?!1:a,h=l===void 0?!1:l,f=uo({defaultValue:t,disabled:u,autoResize:h,onValueCommit:S=>{const{value:k}=S,P=k.trim()===""?void 0:k.trim();P?(r(P),f.setValue(P)):f.setValue(t)}}),p=h?void 0:"full",m=c?"center":void 0;let g;e[8]!==m?(g=d.jsx(Cl,{width:"full",justifyContent:m}),e[8]=m,e[9]=g):g=e[9];const x=c?"center":void 0;let b;e[10]===Symbol.for("react.memo_cache_sentinel")?(b={borderColor:"var(--focus-color)",boxShadow:"0px 1px 0px 0px var(--focus-color)"},e[10]=b):b=e[10];let y;e[11]!==x?(y=d.jsx(yd,{textAlign:x,focusRing:"none",borderBottomWidth:"1px",borderBottomColor:"border",borderRadius:0,_focusVisible:b}),e[11]=x,e[12]=y):y=e[12];let w;e[13]!==y||e[14]!==p||e[15]!==g?(w=d.jsxs(R1,{w:p,children:[g,y]}),e[13]=y,e[14]=p,e[15]=g,e[16]=w):w=e[16];let v;return e[17]!==f||e[18]!==i||e[19]!==s||e[20]!==w?(v=d.jsx(Pl,{value:f,ref:i,...s,children:w}),e[17]=f,e[18]=i,e[19]=s,e[20]=w,e[21]=v):v=e[21],v},Qn=_.forwardRef(function(e,t){const r=te.c(21);let i,s,o,a,l;r[0]!==e?({icon:s,children:i,inputProps:o,rootRef:l,...a}=e,r[0]=e,r[1]=i,r[2]=s,r[3]=o,r[4]=a,r[5]=l):(i=r[1],s=r[2],o=r[3],a=r[4],l=r[5]);let c;r[6]!==o||r[7]!==t?(c=d.jsx(QS,{ref:t,...o}),r[6]=o,r[7]=t,r[8]=c):c=r[8];let u;r[9]!==s?(u=s||d.jsx(M1,{}),r[9]=s,r[10]=u):u=r[10];let h;r[11]!==u?(h=d.jsx(JS,{children:u}),r[11]=u,r[12]=h):h=r[12];let f;r[13]!==i?(f=i!=null&&d.jsx(ZS,{children:i}),r[13]=i,r[14]=f):f=r[14];let p;return r[15]!==a||r[16]!==l||r[17]!==c||r[18]!==h||r[19]!==f?(p=d.jsxs(KS,{ref:l,...a,children:[c,h,f]}),r[15]=a,r[16]=l,r[17]=c,r[18]=h,r[19]=f,r[20]=p):p=r[20],p});function bb(n){return ci({attr:{fill:"none",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{strokeLinecap:"round",strokeLinejoin:"round",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},child:[]}]})(n)}const yb=_.forwardRef(function(e,t){const r=te.c(26);let i,s,o,a,l,c;r[0]!==e?({showArrow:l,children:i,portalled:c,content:s,portalRef:o,...a}=e,r[0]=e,r[1]=i,r[2]=s,r[3]=o,r[4]=a,r[5]=l,r[6]=c):(i=r[1],s=r[2],o=r[3],a=r[4],l=r[5],c=r[6]);const u=c===void 0?!0:c;let h;r[7]!==a.positioning?(h={...a.positioning,gutter:4},r[7]=a.positioning,r[8]=h):h=r[8];let f;r[9]!==i?(f=d.jsx(Ia,{asChild:!0,children:i}),r[9]=i,r[10]=f):f=r[10];const p=!u;let m;r[11]!==l?(m=l&&d.jsx(Cd,{children:d.jsx(Pd,{})}),r[11]=l,r[12]=m):m=r[12];let g;r[13]!==s||r[14]!==t||r[15]!==m?(g=d.jsx(_d,{children:d.jsxs(Sd,{width:"auto",px:"2",py:"1",textStyle:"xs",rounded:"sm",ref:t,children:[m,s]})}),r[13]=s,r[14]=t,r[15]=m,r[16]=g):g=r[16];let x;r[17]!==o||r[18]!==p||r[19]!==g?(x=d.jsx(Cr,{disabled:p,container:o,children:g}),r[17]=o,r[18]=p,r[19]=g,r[20]=x):x=r[20];let b;return r[21]!==a||r[22]!==h||r[23]!==f||r[24]!==x?(b=d.jsxs(U1,{...a,positioning:h,children:[f,x]}),r[21]=a,r[22]=h,r[23]=f,r[24]=x,r[25]=b):b=r[25],b}),du=_.forwardRef(function(e,t){const r=te.c(8);let i,s;r[0]!==e?({children:i,...s}=e,r[0]=e,r[1]=i,r[2]=s):(i=r[1],s=r[2]);let o;r[3]===Symbol.for("react.memo_cache_sentinel")?(o=d.jsx(mt,{variant:"ghost","aria-label":"info",size:"2xs",colorPalette:"gray",ml:1,children:d.jsx(bb,{})}),r[3]=o):o=r[3];let a;return r[4]!==i||r[5]!==t||r[6]!==s?(a=d.jsx(yb,{content:i,...s,ref:t,children:o}),r[4]=i,r[5]=t,r[6]=s,r[7]=a):a=r[7],a}),kk=n=>{const e=te.c(13);let t,r,i,s;e[0]!==n?({checked:r,onCheckedChange:t,ref:i,...s}=n,e[0]=n,e[1]=t,e[2]=r,e[3]=i,e[4]=s):(t=e[1],r=e[2],i=e[3],s=e[4]);let o;e[5]!==t||e[6]!==r?(o=()=>t?.(r==="indeterminate"?{checked:!1}:{checked:!r}),e[5]=t,e[6]=r,e[7]=o):o=e[7];const a=o;let l;return e[8]!==r||e[9]!==a||e[10]!==i||e[11]!==s?(l=d.jsx(Qn,{checked:r,onCheckedChange:a,ref:i,...s}),e[8]=r,e[9]=a,e[10]=i,e[11]=s,e[12]=l):l=e[12],l},ar=_.memo(function(e){const t=te.c(29);let r,i,s,o,a,l,c;t[0]!==e?({name:i,info:r,loading:a,total:l,visible:c,ref:s,...o}=e,t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=o,t[5]=a,t[6]=l,t[7]=c):(r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7]);const u=a===void 0?!1:a,h=c?c===l?!0:"indeterminate":!1,f=u?null:c===l?l:`${c}/${l}`,p=u||!l;let m;t[8]!==i?(m=i!==void 0&&d.jsx(rt,{fontWeight:"semibold",letterSpacing:"tight",children:i}),t[8]=i,t[9]=m):m=t[9];let g;t[10]!==r?(g=r&&d.jsx(du,{content:r}),t[10]=r,t[11]=g):g=t[11];let x;t[12]!==m||t[13]!==g?(x=d.jsxs(_o,{alignItems:"center",gap:0,children:[m,g]}),t[12]=m,t[13]=g,t[14]=x):x=t[14];let b;t[15]!==u?(b=u&&d.jsx(Zr,{size:"xs"}),t[15]=u,t[16]=b):b=t[16];const y=!u&&f;let w;t[17]!==b||t[18]!==y?(w=d.jsxs(rt,{color:"fg.muted",textStyle:"xs",children:[b,y]}),t[17]=b,t[18]=y,t[19]=w):w=t[19];let v;t[20]!==x||t[21]!==w?(v=d.jsxs(Re,{inline:!0,alignItems:"baseline",gap:2,children:[x,w]}),t[20]=x,t[21]=w,t[22]=v):v=t[22];let S;return t[23]!==h||t[24]!==s||t[25]!==o||t[26]!==p||t[27]!==v?(S=d.jsx(kk,{checked:h,disabled:p,ref:s,...o,children:v}),t[23]=h,t[24]=s,t[25]=o,t[26]=p,t[27]=v,t[28]=S):S=t[28],S}),jk=({stat:n,stat2:e,toggleVisibility:t,...r})=>d.jsx(ar,{visible:n.visible+(e?.visible??0),total:n.total+(e?.total??0),onCheckedChange:({checked:i})=>t(i!==!1,n.data,...e?[e.data]:[]),...r}),pn=_.memo(jk),nn=_.forwardRef(function(e,t){const r=te.c(17);let i,s,o,a,l;r[0]!==e?({children:i,portalled:a,portalRef:s,backdrop:l,...o}=e,r[0]=e,r[1]=i,r[2]=s,r[3]=o,r[4]=a,r[5]=l):(i=r[1],s=r[2],o=r[3],a=r[4],l=r[5]);const c=a===void 0?!0:a,u=l===void 0?!0:l,h=!c;let f;r[6]!==u?(f=u&&d.jsx(hP,{}),r[6]=u,r[7]=f):f=r[7];let p;r[8]!==i||r[9]!==t||r[10]!==o?(p=d.jsx(oP,{children:d.jsx(aP,{ref:t,...o,asChild:!1,children:i})}),r[8]=i,r[9]=t,r[10]=o,r[11]=p):p=r[11];let m;return r[12]!==s||r[13]!==h||r[14]!==f||r[15]!==p?(m=d.jsxs(Cr,{disabled:h,container:s,children:[f,p]}),r[12]=s,r[13]=h,r[14]=f,r[15]=p,r[16]=m):m=r[16],m}),on=_.forwardRef(function(e,t){const r=te.c(6);let i;r[0]!==e.children||r[1]!==t?(i=d.jsx(lo,{size:"sm",ref:t,children:e.children}),r[0]=e.children,r[1]=t,r[2]=i):i=r[2];let s;return r[3]!==e||r[4]!==i?(s=d.jsx(uP,{position:"absolute",top:"2",insetEnd:"2",...e,asChild:!0,children:i}),r[3]=e,r[4]=i,r[5]=s):s=r[5],s}),Od=iP,Xt=pP,Gt=mP,wn=fP,Yt=cP,Dl=lP,$d=sP,Sr=dP,es=n=>/^[OPQ][0-9][A-Z0-9]{3}[0-9]|[A-NR-Z][0-9]([A-Z][A-Z0-9]{2}[0-9]){1,2}$/.test(n),vb=n=>/^[A-Z0-9]{1,5}_[A-Z0-9]{1,5}$/i.test(n);function wb(n,e){return function(){return n.apply(e,arguments)}}const{toString:Tk}=Object.prototype,{getPrototypeOf:Dd}=Object,{iterator:Nl,toStringTag:_b}=Symbol,Ll=(n=>e=>{const t=Tk.call(e);return n[t]||(n[t]=t.slice(8,-1).toLowerCase())})(Object.create(null)),_n=n=>(n=n.toLowerCase(),e=>Ll(e)===n),Fl=n=>e=>typeof e===n,{isArray:ts}=Array,Xs=Fl("undefined");function jo(n){return n!==null&&!Xs(n)&&n.constructor!==null&&!Xs(n.constructor)&&Et(n.constructor.isBuffer)&&n.constructor.isBuffer(n)}const Sb=_n("ArrayBuffer");function Mk(n){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(n):e=n&&n.buffer&&Sb(n.buffer),e}const Ak=Fl("string"),Et=Fl("function"),Pb=Fl("number"),To=n=>n!==null&&typeof n=="object",Ek=n=>n===!0||n===!1,ya=n=>{if(Ll(n)!=="object")return!1;const e=Dd(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(_b in n)&&!(Nl in n)},Ik=n=>{if(!To(n)||jo(n))return!1;try{return Object.keys(n).length===0&&Object.getPrototypeOf(n)===Object.prototype}catch{return!1}},Rk=_n("Date"),Ok=_n("File"),$k=_n("Blob"),Dk=_n("FileList"),Nk=n=>To(n)&&Et(n.pipe),Lk=n=>{let e;return n&&(typeof FormData=="function"&&n instanceof FormData||Et(n.append)&&((e=Ll(n))==="formdata"||e==="object"&&Et(n.toString)&&n.toString()==="[object FormData]"))},Fk=_n("URLSearchParams"),[zk,Bk,Hk,Vk]=["ReadableStream","Request","Response","Headers"].map(_n),Wk=n=>n.trim?n.trim():n.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Mo(n,e,{allOwnKeys:t=!1}={}){if(n===null||typeof n>"u")return;let r,i;if(typeof n!="object"&&(n=[n]),ts(n))for(r=0,i=n.length;r<i;r++)e.call(null,n[r],r,n);else{if(jo(n))return;const s=t?Object.getOwnPropertyNames(n):Object.keys(n),o=s.length;let a;for(r=0;r<o;r++)a=s[r],e.call(null,n[a],a,n)}}function Cb(n,e){if(jo(n))return null;e=e.toLowerCase();const t=Object.keys(n);let r=t.length,i;for(;r-- >0;)if(i=t[r],e===i.toLowerCase())return i;return null}const Lr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,kb=n=>!Xs(n)&&n!==Lr;function hu(){const{caseless:n}=kb(this)&&this||{},e={},t=(r,i)=>{const s=n&&Cb(e,i)||i;ya(e[s])&&ya(r)?e[s]=hu(e[s],r):ya(r)?e[s]=hu({},r):ts(r)?e[s]=r.slice():e[s]=r};for(let r=0,i=arguments.length;r<i;r++)arguments[r]&&Mo(arguments[r],t);return e}const Uk=(n,e,t,{allOwnKeys:r}={})=>(Mo(e,(i,s)=>{t&&Et(i)?n[s]=wb(i,t):n[s]=i},{allOwnKeys:r}),n),qk=n=>(n.charCodeAt(0)===65279&&(n=n.slice(1)),n),Xk=(n,e,t,r)=>{n.prototype=Object.create(e.prototype,r),n.prototype.constructor=n,Object.defineProperty(n,"super",{value:e.prototype}),t&&Object.assign(n.prototype,t)},Gk=(n,e,t,r)=>{let i,s,o;const a={};if(e=e||{},n==null)return e;do{for(i=Object.getOwnPropertyNames(n),s=i.length;s-- >0;)o=i[s],(!r||r(o,n,e))&&!a[o]&&(e[o]=n[o],a[o]=!0);n=t!==!1&&Dd(n)}while(n&&(!t||t(n,e))&&n!==Object.prototype);return e},Yk=(n,e,t)=>{n=String(n),(t===void 0||t>n.length)&&(t=n.length),t-=e.length;const r=n.indexOf(e,t);return r!==-1&&r===t},Kk=n=>{if(!n)return null;if(ts(n))return n;let e=n.length;if(!Pb(e))return null;const t=new Array(e);for(;e-- >0;)t[e]=n[e];return t},Zk=(n=>e=>n&&e instanceof n)(typeof Uint8Array<"u"&&Dd(Uint8Array)),Jk=(n,e)=>{const r=(n&&n[Nl]).call(n);let i;for(;(i=r.next())&&!i.done;){const s=i.value;e.call(n,s[0],s[1])}},Qk=(n,e)=>{let t;const r=[];for(;(t=n.exec(e))!==null;)r.push(t);return r},ej=_n("HTMLFormElement"),tj=n=>n.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(t,r,i){return r.toUpperCase()+i}),hf=(({hasOwnProperty:n})=>(e,t)=>n.call(e,t))(Object.prototype),nj=_n("RegExp"),jb=(n,e)=>{const t=Object.getOwnPropertyDescriptors(n),r={};Mo(t,(i,s)=>{let o;(o=e(i,s,n))!==!1&&(r[s]=o||i)}),Object.defineProperties(n,r)},rj=n=>{jb(n,(e,t)=>{if(Et(n)&&["arguments","caller","callee"].indexOf(t)!==-1)return!1;const r=n[t];if(Et(r)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+t+"'")})}})},ij=(n,e)=>{const t={},r=i=>{i.forEach(s=>{t[s]=!0})};return ts(n)?r(n):r(String(n).split(e)),t},sj=()=>{},oj=(n,e)=>n!=null&&Number.isFinite(n=+n)?n:e;function aj(n){return!!(n&&Et(n.append)&&n[_b]==="FormData"&&n[Nl])}const lj=n=>{const e=new Array(10),t=(r,i)=>{if(To(r)){if(e.indexOf(r)>=0)return;if(jo(r))return r;if(!("toJSON"in r)){e[i]=r;const s=ts(r)?[]:{};return Mo(r,(o,a)=>{const l=t(o,i+1);!Xs(l)&&(s[a]=l)}),e[i]=void 0,s}}return r};return t(n,0)},cj=_n("AsyncFunction"),uj=n=>n&&(To(n)||Et(n))&&Et(n.then)&&Et(n.catch),Tb=((n,e)=>n?setImmediate:e?((t,r)=>(Lr.addEventListener("message",({source:i,data:s})=>{i===Lr&&s===t&&r.length&&r.shift()()},!1),i=>{r.push(i),Lr.postMessage(t,"*")}))(`axios@${Math.random()}`,[]):t=>setTimeout(t))(typeof setImmediate=="function",Et(Lr.postMessage)),dj=typeof queueMicrotask<"u"?queueMicrotask.bind(Lr):typeof process<"u"&&process.nextTick||Tb,hj=n=>n!=null&&Et(n[Nl]),H={isArray:ts,isArrayBuffer:Sb,isBuffer:jo,isFormData:Lk,isArrayBufferView:Mk,isString:Ak,isNumber:Pb,isBoolean:Ek,isObject:To,isPlainObject:ya,isEmptyObject:Ik,isReadableStream:zk,isRequest:Bk,isResponse:Hk,isHeaders:Vk,isUndefined:Xs,isDate:Rk,isFile:Ok,isBlob:$k,isRegExp:nj,isFunction:Et,isStream:Nk,isURLSearchParams:Fk,isTypedArray:Zk,isFileList:Dk,forEach:Mo,merge:hu,extend:Uk,trim:Wk,stripBOM:qk,inherits:Xk,toFlatObject:Gk,kindOf:Ll,kindOfTest:_n,endsWith:Yk,toArray:Kk,forEachEntry:Jk,matchAll:Qk,isHTMLForm:ej,hasOwnProperty:hf,hasOwnProp:hf,reduceDescriptors:jb,freezeMethods:rj,toObjectSet:ij,toCamelCase:tj,noop:sj,toFiniteNumber:oj,findKey:Cb,global:Lr,isContextDefined:kb,isSpecCompliantForm:aj,toJSONObject:lj,isAsyncFn:cj,isThenable:uj,setImmediate:Tb,asap:dj,isIterable:hj};function je(n,e,t,r,i){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=n,this.name="AxiosError",e&&(this.code=e),t&&(this.config=t),r&&(this.request=r),i&&(this.response=i,this.status=i.status?i.status:null)}H.inherits(je,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:H.toJSONObject(this.config),code:this.code,status:this.status}}});const Mb=je.prototype,Ab={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(n=>{Ab[n]={value:n}});Object.defineProperties(je,Ab);Object.defineProperty(Mb,"isAxiosError",{value:!0});je.from=(n,e,t,r,i,s)=>{const o=Object.create(Mb);return H.toFlatObject(n,o,function(l){return l!==Error.prototype},a=>a!=="isAxiosError"),je.call(o,n.message,e,t,r,i),o.cause=n,o.name=n.name,s&&Object.assign(o,s),o};const fj=null;function fu(n){return H.isPlainObject(n)||H.isArray(n)}function Eb(n){return H.endsWith(n,"[]")?n.slice(0,-2):n}function ff(n,e,t){return n?n.concat(e).map(function(i,s){return i=Eb(i),!t&&s?"["+i+"]":i}).join(t?".":""):e}function pj(n){return H.isArray(n)&&!n.some(fu)}const mj=H.toFlatObject(H,{},null,function(e){return/^is[A-Z]/.test(e)});function zl(n,e,t){if(!H.isObject(n))throw new TypeError("target must be an object");e=e||new FormData,t=H.toFlatObject(t,{metaTokens:!0,dots:!1,indexes:!1},!1,function(g,x){return!H.isUndefined(x[g])});const r=t.metaTokens,i=t.visitor||u,s=t.dots,o=t.indexes,l=(t.Blob||typeof Blob<"u"&&Blob)&&H.isSpecCompliantForm(e);if(!H.isFunction(i))throw new TypeError("visitor must be a function");function c(m){if(m===null)return"";if(H.isDate(m))return m.toISOString();if(H.isBoolean(m))return m.toString();if(!l&&H.isBlob(m))throw new je("Blob is not supported. Use a Buffer instead.");return H.isArrayBuffer(m)||H.isTypedArray(m)?l&&typeof Blob=="function"?new Blob([m]):Buffer.from(m):m}function u(m,g,x){let b=m;if(m&&!x&&typeof m=="object"){if(H.endsWith(g,"{}"))g=r?g:g.slice(0,-2),m=JSON.stringify(m);else if(H.isArray(m)&&pj(m)||(H.isFileList(m)||H.endsWith(g,"[]"))&&(b=H.toArray(m)))return g=Eb(g),b.forEach(function(w,v){!(H.isUndefined(w)||w===null)&&e.append(o===!0?ff([g],v,s):o===null?g:g+"[]",c(w))}),!1}return fu(m)?!0:(e.append(ff(x,g,s),c(m)),!1)}const h=[],f=Object.assign(mj,{defaultVisitor:u,convertValue:c,isVisitable:fu});function p(m,g){if(!H.isUndefined(m)){if(h.indexOf(m)!==-1)throw Error("Circular reference detected in "+g.join("."));h.push(m),H.forEach(m,function(b,y){(!(H.isUndefined(b)||b===null)&&i.call(e,b,H.isString(y)?y.trim():y,g,f))===!0&&p(b,g?g.concat(y):[y])}),h.pop()}}if(!H.isObject(n))throw new TypeError("data must be an object");return p(n),e}function pf(n){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(n).replace(/[!'()~]|%20|%00/g,function(r){return e[r]})}function Nd(n,e){this._pairs=[],n&&zl(n,this,e)}const Ib=Nd.prototype;Ib.append=function(e,t){this._pairs.push([e,t])};Ib.toString=function(e){const t=e?function(r){return e.call(this,r,pf)}:pf;return this._pairs.map(function(i){return t(i[0])+"="+t(i[1])},"").join("&")};function gj(n){return encodeURIComponent(n).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Rb(n,e,t){if(!e)return n;const r=t&&t.encode||gj;H.isFunction(t)&&(t={serialize:t});const i=t&&t.serialize;let s;if(i?s=i(e,t):s=H.isURLSearchParams(e)?e.toString():new Nd(e,t).toString(r),s){const o=n.indexOf("#");o!==-1&&(n=n.slice(0,o)),n+=(n.indexOf("?")===-1?"?":"&")+s}return n}class mf{constructor(){this.handlers=[]}use(e,t,r){return this.handlers.push({fulfilled:e,rejected:t,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){H.forEach(this.handlers,function(r){r!==null&&e(r)})}}const Ob={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},xj=typeof URLSearchParams<"u"?URLSearchParams:Nd,bj=typeof FormData<"u"?FormData:null,yj=typeof Blob<"u"?Blob:null,vj={isBrowser:!0,classes:{URLSearchParams:xj,FormData:bj,Blob:yj},protocols:["http","https","file","blob","url","data"]},Ld=typeof window<"u"&&typeof document<"u",pu=typeof navigator=="object"&&navigator||void 0,wj=Ld&&(!pu||["ReactNative","NativeScript","NS"].indexOf(pu.product)<0),_j=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Sj=Ld&&window.location.href||"http://localhost",Pj=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Ld,hasStandardBrowserEnv:wj,hasStandardBrowserWebWorkerEnv:_j,navigator:pu,origin:Sj},Symbol.toStringTag,{value:"Module"})),pt={...Pj,...vj};function Cj(n,e){return zl(n,new pt.classes.URLSearchParams,{visitor:function(t,r,i,s){return pt.isNode&&H.isBuffer(t)?(this.append(r,t.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)},...e})}function kj(n){return H.matchAll(/\w+|\[(\w*)]/g,n).map(e=>e[0]==="[]"?"":e[1]||e[0])}function jj(n){const e={},t=Object.keys(n);let r;const i=t.length;let s;for(r=0;r<i;r++)s=t[r],e[s]=n[s];return e}function $b(n){function e(t,r,i,s){let o=t[s++];if(o==="__proto__")return!0;const a=Number.isFinite(+o),l=s>=t.length;return o=!o&&H.isArray(i)?i.length:o,l?(H.hasOwnProp(i,o)?i[o]=[i[o],r]:i[o]=r,!a):((!i[o]||!H.isObject(i[o]))&&(i[o]=[]),e(t,r,i[o],s)&&H.isArray(i[o])&&(i[o]=jj(i[o])),!a)}if(H.isFormData(n)&&H.isFunction(n.entries)){const t={};return H.forEachEntry(n,(r,i)=>{e(kj(r),i,t,0)}),t}return null}function Tj(n,e,t){if(H.isString(n))try{return(e||JSON.parse)(n),H.trim(n)}catch(r){if(r.name!=="SyntaxError")throw r}return(t||JSON.stringify)(n)}const Ao={transitional:Ob,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const r=t.getContentType()||"",i=r.indexOf("application/json")>-1,s=H.isObject(e);if(s&&H.isHTMLForm(e)&&(e=new FormData(e)),H.isFormData(e))return i?JSON.stringify($b(e)):e;if(H.isArrayBuffer(e)||H.isBuffer(e)||H.isStream(e)||H.isFile(e)||H.isBlob(e)||H.isReadableStream(e))return e;if(H.isArrayBufferView(e))return e.buffer;if(H.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let a;if(s){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Cj(e,this.formSerializer).toString();if((a=H.isFileList(e))||r.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return zl(a?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||i?(t.setContentType("application/json",!1),Tj(e)):e}],transformResponse:[function(e){const t=this.transitional||Ao.transitional,r=t&&t.forcedJSONParsing,i=this.responseType==="json";if(H.isResponse(e)||H.isReadableStream(e))return e;if(e&&H.isString(e)&&(r&&!this.responseType||i)){const o=!(t&&t.silentJSONParsing)&&i;try{return JSON.parse(e)}catch(a){if(o)throw a.name==="SyntaxError"?je.from(a,je.ERR_BAD_RESPONSE,this,null,this.response):a}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:pt.classes.FormData,Blob:pt.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};H.forEach(["delete","get","head","post","put","patch"],n=>{Ao.headers[n]={}});const Mj=H.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),Aj=n=>{const e={};let t,r,i;return n&&n.split(`
`).forEach(function(o){i=o.indexOf(":"),t=o.substring(0,i).trim().toLowerCase(),r=o.substring(i+1).trim(),!(!t||e[t]&&Mj[t])&&(t==="set-cookie"?e[t]?e[t].push(r):e[t]=[r]:e[t]=e[t]?e[t]+", "+r:r)}),e},gf=Symbol("internals");function ds(n){return n&&String(n).trim().toLowerCase()}function va(n){return n===!1||n==null?n:H.isArray(n)?n.map(va):String(n)}function Ej(n){const e=Object.create(null),t=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=t.exec(n);)e[r[1]]=r[2];return e}const Ij=n=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(n.trim());function yc(n,e,t,r,i){if(H.isFunction(r))return r.call(this,e,t);if(i&&(e=t),!!H.isString(e)){if(H.isString(r))return e.indexOf(r)!==-1;if(H.isRegExp(r))return r.test(e)}}function Rj(n){return n.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,r)=>t.toUpperCase()+r)}function Oj(n,e){const t=H.toCamelCase(" "+e);["get","set","has"].forEach(r=>{Object.defineProperty(n,r+t,{value:function(i,s,o){return this[r].call(this,e,i,s,o)},configurable:!0})})}let It=class{constructor(e){e&&this.set(e)}set(e,t,r){const i=this;function s(a,l,c){const u=ds(l);if(!u)throw new Error("header name must be a non-empty string");const h=H.findKey(i,u);(!h||i[h]===void 0||c===!0||c===void 0&&i[h]!==!1)&&(i[h||l]=va(a))}const o=(a,l)=>H.forEach(a,(c,u)=>s(c,u,l));if(H.isPlainObject(e)||e instanceof this.constructor)o(e,t);else if(H.isString(e)&&(e=e.trim())&&!Ij(e))o(Aj(e),t);else if(H.isObject(e)&&H.isIterable(e)){let a={},l,c;for(const u of e){if(!H.isArray(u))throw TypeError("Object iterator must return a key-value pair");a[c=u[0]]=(l=a[c])?H.isArray(l)?[...l,u[1]]:[l,u[1]]:u[1]}o(a,t)}else e!=null&&s(t,e,r);return this}get(e,t){if(e=ds(e),e){const r=H.findKey(this,e);if(r){const i=this[r];if(!t)return i;if(t===!0)return Ej(i);if(H.isFunction(t))return t.call(this,i,r);if(H.isRegExp(t))return t.exec(i);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=ds(e),e){const r=H.findKey(this,e);return!!(r&&this[r]!==void 0&&(!t||yc(this,this[r],r,t)))}return!1}delete(e,t){const r=this;let i=!1;function s(o){if(o=ds(o),o){const a=H.findKey(r,o);a&&(!t||yc(r,r[a],a,t))&&(delete r[a],i=!0)}}return H.isArray(e)?e.forEach(s):s(e),i}clear(e){const t=Object.keys(this);let r=t.length,i=!1;for(;r--;){const s=t[r];(!e||yc(this,this[s],s,e,!0))&&(delete this[s],i=!0)}return i}normalize(e){const t=this,r={};return H.forEach(this,(i,s)=>{const o=H.findKey(r,s);if(o){t[o]=va(i),delete t[s];return}const a=e?Rj(s):String(s).trim();a!==s&&delete t[s],t[a]=va(i),r[a]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const t=Object.create(null);return H.forEach(this,(r,i)=>{r!=null&&r!==!1&&(t[i]=e&&H.isArray(r)?r.join(", "):r)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,t])=>e+": "+t).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...t){const r=new this(e);return t.forEach(i=>r.set(i)),r}static accessor(e){const r=(this[gf]=this[gf]={accessors:{}}).accessors,i=this.prototype;function s(o){const a=ds(o);r[a]||(Oj(i,o),r[a]=!0)}return H.isArray(e)?e.forEach(s):s(e),this}};It.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);H.reduceDescriptors(It.prototype,({value:n},e)=>{let t=e[0].toUpperCase()+e.slice(1);return{get:()=>n,set(r){this[t]=r}}});H.freezeMethods(It);function vc(n,e){const t=this||Ao,r=e||t,i=It.from(r.headers);let s=r.data;return H.forEach(n,function(a){s=a.call(t,s,i.normalize(),e?e.status:void 0)}),i.normalize(),s}function Db(n){return!!(n&&n.__CANCEL__)}function ns(n,e,t){je.call(this,n??"canceled",je.ERR_CANCELED,e,t),this.name="CanceledError"}H.inherits(ns,je,{__CANCEL__:!0});function Nb(n,e,t){const r=t.config.validateStatus;!t.status||!r||r(t.status)?n(t):e(new je("Request failed with status code "+t.status,[je.ERR_BAD_REQUEST,je.ERR_BAD_RESPONSE][Math.floor(t.status/100)-4],t.config,t.request,t))}function $j(n){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(n);return e&&e[1]||""}function Dj(n,e){n=n||10;const t=new Array(n),r=new Array(n);let i=0,s=0,o;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),u=r[s];o||(o=c),t[i]=l,r[i]=c;let h=s,f=0;for(;h!==i;)f+=t[h++],h=h%n;if(i=(i+1)%n,i===s&&(s=(s+1)%n),c-o<e)return;const p=u&&c-u;return p?Math.round(f*1e3/p):void 0}}function Nj(n,e){let t=0,r=1e3/e,i,s;const o=(c,u=Date.now())=>{t=u,i=null,s&&(clearTimeout(s),s=null),n(...c)};return[(...c)=>{const u=Date.now(),h=u-t;h>=r?o(c,u):(i=c,s||(s=setTimeout(()=>{s=null,o(i)},r-h)))},()=>i&&o(i)]}const Na=(n,e,t=3)=>{let r=0;const i=Dj(50,250);return Nj(s=>{const o=s.loaded,a=s.lengthComputable?s.total:void 0,l=o-r,c=i(l),u=o<=a;r=o;const h={loaded:o,total:a,progress:a?o/a:void 0,bytes:l,rate:c||void 0,estimated:c&&a&&u?(a-o)/c:void 0,event:s,lengthComputable:a!=null,[e?"download":"upload"]:!0};n(h)},t)},xf=(n,e)=>{const t=n!=null;return[r=>e[0]({lengthComputable:t,total:n,loaded:r}),e[1]]},bf=n=>(...e)=>H.asap(()=>n(...e)),Lj=pt.hasStandardBrowserEnv?((n,e)=>t=>(t=new URL(t,pt.origin),n.protocol===t.protocol&&n.host===t.host&&(e||n.port===t.port)))(new URL(pt.origin),pt.navigator&&/(msie|trident)/i.test(pt.navigator.userAgent)):()=>!0,Fj=pt.hasStandardBrowserEnv?{write(n,e,t,r,i,s){const o=[n+"="+encodeURIComponent(e)];H.isNumber(t)&&o.push("expires="+new Date(t).toGMTString()),H.isString(r)&&o.push("path="+r),H.isString(i)&&o.push("domain="+i),s===!0&&o.push("secure"),document.cookie=o.join("; ")},read(n){const e=document.cookie.match(new RegExp("(^|;\\s*)("+n+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(n){this.write(n,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function zj(n){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(n)}function Bj(n,e){return e?n.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):n}function Lb(n,e,t){let r=!zj(e);return n&&(r||t==!1)?Bj(n,e):e}const yf=n=>n instanceof It?{...n}:n;function ei(n,e){e=e||{};const t={};function r(c,u,h,f){return H.isPlainObject(c)&&H.isPlainObject(u)?H.merge.call({caseless:f},c,u):H.isPlainObject(u)?H.merge({},u):H.isArray(u)?u.slice():u}function i(c,u,h,f){if(H.isUndefined(u)){if(!H.isUndefined(c))return r(void 0,c,h,f)}else return r(c,u,h,f)}function s(c,u){if(!H.isUndefined(u))return r(void 0,u)}function o(c,u){if(H.isUndefined(u)){if(!H.isUndefined(c))return r(void 0,c)}else return r(void 0,u)}function a(c,u,h){if(h in e)return r(c,u);if(h in n)return r(void 0,c)}const l={url:s,method:s,data:s,baseURL:o,transformRequest:o,transformResponse:o,paramsSerializer:o,timeout:o,timeoutMessage:o,withCredentials:o,withXSRFToken:o,adapter:o,responseType:o,xsrfCookieName:o,xsrfHeaderName:o,onUploadProgress:o,onDownloadProgress:o,decompress:o,maxContentLength:o,maxBodyLength:o,beforeRedirect:o,transport:o,httpAgent:o,httpsAgent:o,cancelToken:o,socketPath:o,responseEncoding:o,validateStatus:a,headers:(c,u,h)=>i(yf(c),yf(u),h,!0)};return H.forEach(Object.keys({...n,...e}),function(u){const h=l[u]||i,f=h(n[u],e[u],u);H.isUndefined(f)&&h!==a||(t[u]=f)}),t}const Fb=n=>{const e=ei({},n);let{data:t,withXSRFToken:r,xsrfHeaderName:i,xsrfCookieName:s,headers:o,auth:a}=e;e.headers=o=It.from(o),e.url=Rb(Lb(e.baseURL,e.url,e.allowAbsoluteUrls),n.params,n.paramsSerializer),a&&o.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let l;if(H.isFormData(t)){if(pt.hasStandardBrowserEnv||pt.hasStandardBrowserWebWorkerEnv)o.setContentType(void 0);else if((l=o.getContentType())!==!1){const[c,...u]=l?l.split(";").map(h=>h.trim()).filter(Boolean):[];o.setContentType([c||"multipart/form-data",...u].join("; "))}}if(pt.hasStandardBrowserEnv&&(r&&H.isFunction(r)&&(r=r(e)),r||r!==!1&&Lj(e.url))){const c=i&&s&&Fj.read(s);c&&o.set(i,c)}return e},Hj=typeof XMLHttpRequest<"u",Vj=Hj&&function(n){return new Promise(function(t,r){const i=Fb(n);let s=i.data;const o=It.from(i.headers).normalize();let{responseType:a,onUploadProgress:l,onDownloadProgress:c}=i,u,h,f,p,m;function g(){p&&p(),m&&m(),i.cancelToken&&i.cancelToken.unsubscribe(u),i.signal&&i.signal.removeEventListener("abort",u)}let x=new XMLHttpRequest;x.open(i.method.toUpperCase(),i.url,!0),x.timeout=i.timeout;function b(){if(!x)return;const w=It.from("getAllResponseHeaders"in x&&x.getAllResponseHeaders()),S={data:!a||a==="text"||a==="json"?x.responseText:x.response,status:x.status,statusText:x.statusText,headers:w,config:n,request:x};Nb(function(P){t(P),g()},function(P){r(P),g()},S),x=null}"onloadend"in x?x.onloadend=b:x.onreadystatechange=function(){!x||x.readyState!==4||x.status===0&&!(x.responseURL&&x.responseURL.indexOf("file:")===0)||setTimeout(b)},x.onabort=function(){x&&(r(new je("Request aborted",je.ECONNABORTED,n,x)),x=null)},x.onerror=function(){r(new je("Network Error",je.ERR_NETWORK,n,x)),x=null},x.ontimeout=function(){let v=i.timeout?"timeout of "+i.timeout+"ms exceeded":"timeout exceeded";const S=i.transitional||Ob;i.timeoutErrorMessage&&(v=i.timeoutErrorMessage),r(new je(v,S.clarifyTimeoutError?je.ETIMEDOUT:je.ECONNABORTED,n,x)),x=null},s===void 0&&o.setContentType(null),"setRequestHeader"in x&&H.forEach(o.toJSON(),function(v,S){x.setRequestHeader(S,v)}),H.isUndefined(i.withCredentials)||(x.withCredentials=!!i.withCredentials),a&&a!=="json"&&(x.responseType=i.responseType),c&&([f,m]=Na(c,!0),x.addEventListener("progress",f)),l&&x.upload&&([h,p]=Na(l),x.upload.addEventListener("progress",h),x.upload.addEventListener("loadend",p)),(i.cancelToken||i.signal)&&(u=w=>{x&&(r(!w||w.type?new ns(null,n,x):w),x.abort(),x=null)},i.cancelToken&&i.cancelToken.subscribe(u),i.signal&&(i.signal.aborted?u():i.signal.addEventListener("abort",u)));const y=$j(i.url);if(y&&pt.protocols.indexOf(y)===-1){r(new je("Unsupported protocol "+y+":",je.ERR_BAD_REQUEST,n));return}x.send(s||null)})},Wj=(n,e)=>{const{length:t}=n=n?n.filter(Boolean):[];if(e||t){let r=new AbortController,i;const s=function(c){if(!i){i=!0,a();const u=c instanceof Error?c:this.reason;r.abort(u instanceof je?u:new ns(u instanceof Error?u.message:u))}};let o=e&&setTimeout(()=>{o=null,s(new je(`timeout ${e} of ms exceeded`,je.ETIMEDOUT))},e);const a=()=>{n&&(o&&clearTimeout(o),o=null,n.forEach(c=>{c.unsubscribe?c.unsubscribe(s):c.removeEventListener("abort",s)}),n=null)};n.forEach(c=>c.addEventListener("abort",s));const{signal:l}=r;return l.unsubscribe=()=>H.asap(a),l}},Uj=function*(n,e){let t=n.byteLength;if(t<e){yield n;return}let r=0,i;for(;r<t;)i=r+e,yield n.slice(r,i),r=i},qj=async function*(n,e){for await(const t of Xj(n))yield*Uj(t,e)},Xj=async function*(n){if(n[Symbol.asyncIterator]){yield*n;return}const e=n.getReader();try{for(;;){const{done:t,value:r}=await e.read();if(t)break;yield r}}finally{await e.cancel()}},vf=(n,e,t,r)=>{const i=qj(n,e);let s=0,o,a=l=>{o||(o=!0,r&&r(l))};return new ReadableStream({async pull(l){try{const{done:c,value:u}=await i.next();if(c){a(),l.close();return}let h=u.byteLength;if(t){let f=s+=h;t(f)}l.enqueue(new Uint8Array(u))}catch(c){throw a(c),c}},cancel(l){return a(l),i.return()}},{highWaterMark:2})},Bl=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",zb=Bl&&typeof ReadableStream=="function",Gj=Bl&&(typeof TextEncoder=="function"?(n=>e=>n.encode(e))(new TextEncoder):async n=>new Uint8Array(await new Response(n).arrayBuffer())),Bb=(n,...e)=>{try{return!!n(...e)}catch{return!1}},Yj=zb&&Bb(()=>{let n=!1;const e=new Request(pt.origin,{body:new ReadableStream,method:"POST",get duplex(){return n=!0,"half"}}).headers.has("Content-Type");return n&&!e}),wf=64*1024,mu=zb&&Bb(()=>H.isReadableStream(new Response("").body)),La={stream:mu&&(n=>n.body)};Bl&&(n=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!La[e]&&(La[e]=H.isFunction(n[e])?t=>t[e]():(t,r)=>{throw new je(`Response type '${e}' is not supported`,je.ERR_NOT_SUPPORT,r)})})})(new Response);const Kj=async n=>{if(n==null)return 0;if(H.isBlob(n))return n.size;if(H.isSpecCompliantForm(n))return(await new Request(pt.origin,{method:"POST",body:n}).arrayBuffer()).byteLength;if(H.isArrayBufferView(n)||H.isArrayBuffer(n))return n.byteLength;if(H.isURLSearchParams(n)&&(n=n+""),H.isString(n))return(await Gj(n)).byteLength},Zj=async(n,e)=>{const t=H.toFiniteNumber(n.getContentLength());return t??Kj(e)},Jj=Bl&&(async n=>{let{url:e,method:t,data:r,signal:i,cancelToken:s,timeout:o,onDownloadProgress:a,onUploadProgress:l,responseType:c,headers:u,withCredentials:h="same-origin",fetchOptions:f}=Fb(n);c=c?(c+"").toLowerCase():"text";let p=Wj([i,s&&s.toAbortSignal()],o),m;const g=p&&p.unsubscribe&&(()=>{p.unsubscribe()});let x;try{if(l&&Yj&&t!=="get"&&t!=="head"&&(x=await Zj(u,r))!==0){let S=new Request(e,{method:"POST",body:r,duplex:"half"}),k;if(H.isFormData(r)&&(k=S.headers.get("content-type"))&&u.setContentType(k),S.body){const[P,C]=xf(x,Na(bf(l)));r=vf(S.body,wf,P,C)}}H.isString(h)||(h=h?"include":"omit");const b="credentials"in Request.prototype;m=new Request(e,{...f,signal:p,method:t.toUpperCase(),headers:u.normalize().toJSON(),body:r,duplex:"half",credentials:b?h:void 0});let y=await fetch(m,f);const w=mu&&(c==="stream"||c==="response");if(mu&&(a||w&&g)){const S={};["status","statusText","headers"].forEach(T=>{S[T]=y[T]});const k=H.toFiniteNumber(y.headers.get("content-length")),[P,C]=a&&xf(k,Na(bf(a),!0))||[];y=new Response(vf(y.body,wf,P,()=>{C&&C(),g&&g()}),S)}c=c||"text";let v=await La[H.findKey(La,c)||"text"](y,n);return!w&&g&&g(),await new Promise((S,k)=>{Nb(S,k,{data:v,headers:It.from(y.headers),status:y.status,statusText:y.statusText,config:n,request:m})})}catch(b){throw g&&g(),b&&b.name==="TypeError"&&/Load failed|fetch/i.test(b.message)?Object.assign(new je("Network Error",je.ERR_NETWORK,n,m),{cause:b.cause||b}):je.from(b,b&&b.code,n,m)}}),gu={http:fj,xhr:Vj,fetch:Jj};H.forEach(gu,(n,e)=>{if(n){try{Object.defineProperty(n,"name",{value:e})}catch{}Object.defineProperty(n,"adapterName",{value:e})}});const _f=n=>`- ${n}`,Qj=n=>H.isFunction(n)||n===null||n===!1,Hb={getAdapter:n=>{n=H.isArray(n)?n:[n];const{length:e}=n;let t,r;const i={};for(let s=0;s<e;s++){t=n[s];let o;if(r=t,!Qj(t)&&(r=gu[(o=String(t)).toLowerCase()],r===void 0))throw new je(`Unknown adapter '${o}'`);if(r)break;i[o||"#"+s]=r}if(!r){const s=Object.entries(i).map(([a,l])=>`adapter ${a} `+(l===!1?"is not supported by the environment":"is not available in the build"));let o=e?s.length>1?`since :
`+s.map(_f).join(`
`):" "+_f(s[0]):"as no adapter specified";throw new je("There is no suitable adapter to dispatch the request "+o,"ERR_NOT_SUPPORT")}return r},adapters:gu};function wc(n){if(n.cancelToken&&n.cancelToken.throwIfRequested(),n.signal&&n.signal.aborted)throw new ns(null,n)}function Sf(n){return wc(n),n.headers=It.from(n.headers),n.data=vc.call(n,n.transformRequest),["post","put","patch"].indexOf(n.method)!==-1&&n.headers.setContentType("application/x-www-form-urlencoded",!1),Hb.getAdapter(n.adapter||Ao.adapter)(n).then(function(r){return wc(n),r.data=vc.call(n,n.transformResponse,r),r.headers=It.from(r.headers),r},function(r){return Db(r)||(wc(n),r&&r.response&&(r.response.data=vc.call(n,n.transformResponse,r.response),r.response.headers=It.from(r.response.headers))),Promise.reject(r)})}const Vb="1.11.0",Hl={};["object","boolean","number","function","string","symbol"].forEach((n,e)=>{Hl[n]=function(r){return typeof r===n||"a"+(e<1?"n ":" ")+n}});const Pf={};Hl.transitional=function(e,t,r){function i(s,o){return"[Axios v"+Vb+"] Transitional option '"+s+"'"+o+(r?". "+r:"")}return(s,o,a)=>{if(e===!1)throw new je(i(o," has been removed"+(t?" in "+t:"")),je.ERR_DEPRECATED);return t&&!Pf[o]&&(Pf[o]=!0,console.warn(i(o," has been deprecated since v"+t+" and will be removed in the near future"))),e?e(s,o,a):!0}};Hl.spelling=function(e){return(t,r)=>(console.warn(`${r} is likely a misspelling of ${e}`),!0)};function eT(n,e,t){if(typeof n!="object")throw new je("options must be an object",je.ERR_BAD_OPTION_VALUE);const r=Object.keys(n);let i=r.length;for(;i-- >0;){const s=r[i],o=e[s];if(o){const a=n[s],l=a===void 0||o(a,s,n);if(l!==!0)throw new je("option "+s+" must be "+l,je.ERR_BAD_OPTION_VALUE);continue}if(t!==!0)throw new je("Unknown option "+s,je.ERR_BAD_OPTION)}}const wa={assertOptions:eT,validators:Hl},Pn=wa.validators;let qr=class{constructor(e){this.defaults=e||{},this.interceptors={request:new mf,response:new mf}}async request(e,t){try{return await this._request(e,t)}catch(r){if(r instanceof Error){let i={};Error.captureStackTrace?Error.captureStackTrace(i):i=new Error;const s=i.stack?i.stack.replace(/^.+\n/,""):"";try{r.stack?s&&!String(r.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+s):r.stack=s}catch{}}throw r}}_request(e,t){typeof e=="string"?(t=t||{},t.url=e):t=e||{},t=ei(this.defaults,t);const{transitional:r,paramsSerializer:i,headers:s}=t;r!==void 0&&wa.assertOptions(r,{silentJSONParsing:Pn.transitional(Pn.boolean),forcedJSONParsing:Pn.transitional(Pn.boolean),clarifyTimeoutError:Pn.transitional(Pn.boolean)},!1),i!=null&&(H.isFunction(i)?t.paramsSerializer={serialize:i}:wa.assertOptions(i,{encode:Pn.function,serialize:Pn.function},!0)),t.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),wa.assertOptions(t,{baseUrl:Pn.spelling("baseURL"),withXsrfToken:Pn.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let o=s&&H.merge(s.common,s[t.method]);s&&H.forEach(["delete","get","head","post","put","patch","common"],m=>{delete s[m]}),t.headers=It.concat(o,s);const a=[];let l=!0;this.interceptors.request.forEach(function(g){typeof g.runWhen=="function"&&g.runWhen(t)===!1||(l=l&&g.synchronous,a.unshift(g.fulfilled,g.rejected))});const c=[];this.interceptors.response.forEach(function(g){c.push(g.fulfilled,g.rejected)});let u,h=0,f;if(!l){const m=[Sf.bind(this),void 0];for(m.unshift(...a),m.push(...c),f=m.length,u=Promise.resolve(t);h<f;)u=u.then(m[h++],m[h++]);return u}f=a.length;let p=t;for(h=0;h<f;){const m=a[h++],g=a[h++];try{p=m(p)}catch(x){g.call(this,x);break}}try{u=Sf.call(this,p)}catch(m){return Promise.reject(m)}for(h=0,f=c.length;h<f;)u=u.then(c[h++],c[h++]);return u}getUri(e){e=ei(this.defaults,e);const t=Lb(e.baseURL,e.url,e.allowAbsoluteUrls);return Rb(t,e.params,e.paramsSerializer)}};H.forEach(["delete","get","head","options"],function(e){qr.prototype[e]=function(t,r){return this.request(ei(r||{},{method:e,url:t,data:(r||{}).data}))}});H.forEach(["post","put","patch"],function(e){function t(r){return function(s,o,a){return this.request(ei(a||{},{method:e,headers:r?{"Content-Type":"multipart/form-data"}:{},url:s,data:o}))}}qr.prototype[e]=t(),qr.prototype[e+"Form"]=t(!0)});let tT=class Wb{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(s){t=s});const r=this;this.promise.then(i=>{if(!r._listeners)return;let s=r._listeners.length;for(;s-- >0;)r._listeners[s](i);r._listeners=null}),this.promise.then=i=>{let s;const o=new Promise(a=>{r.subscribe(a),s=a}).then(i);return o.cancel=function(){r.unsubscribe(s)},o},e(function(s,o,a){r.reason||(r.reason=new ns(s,o,a),t(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);t!==-1&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=r=>{e.abort(r)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new Wb(function(i){e=i}),cancel:e}}};function nT(n){return function(t){return n.apply(null,t)}}function rT(n){return H.isObject(n)&&n.isAxiosError===!0}const xu={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(xu).forEach(([n,e])=>{xu[e]=n});function Ub(n){const e=new qr(n),t=wb(qr.prototype.request,e);return H.extend(t,qr.prototype,e,{allOwnKeys:!0}),H.extend(t,e,null,{allOwnKeys:!0}),t.create=function(i){return Ub(ei(n,i))},t}const Xe=Ub(Ao);Xe.Axios=qr;Xe.CanceledError=ns;Xe.CancelToken=tT;Xe.isCancel=Db;Xe.VERSION=Vb;Xe.toFormData=zl;Xe.AxiosError=je;Xe.Cancel=Xe.CanceledError;Xe.all=function(e){return Promise.all(e)};Xe.spread=nT;Xe.isAxiosError=rT;Xe.mergeConfig=ei;Xe.AxiosHeaders=It;Xe.formToJSON=n=>$b(H.isHTMLForm(n)?new FormData(n):n);Xe.getAdapter=Hb.getAdapter;Xe.HttpStatusCode=xu;Xe.default=Xe;const{Axios:w7,AxiosError:_7,CanceledError:S7,isCancel:P7,CancelToken:C7,VERSION:k7,all:j7,Cancel:T7,isAxiosError:M7,spread:A7,toFormData:E7,AxiosHeaders:I7,HttpStatusCode:R7,formToJSON:O7,getAdapter:$7,mergeConfig:D7}=Xe,rs=n=>n,qb=n=>n.split(/[,\s]+/).map(e=>e.trim()).filter(e=>e.length>0),iT="https://rest.uniprot.org/uniprotkb/search",Xb=(n,e)=>Xe.get(iT,{params:{format:"json",...n},validateStatus:null,signal:e}),sT=rs(async({accessions:n},e)=>{const t=n.filter(l=>!es(l));if(t.length>0)throw new Error(`Invalid UniProt accession${t.length!==1?"s":""}: ${t.join(", ")}`);const r=n.map(l=>`(accession:${l})`).join("OR"),{data:i,statusText:s}=await Xb({query:r,fields:"accession,id,gene_primary,sequence",size:500},e),{results:o,messages:a}=i??{};if(!o)throw a!==void 0&&a.length>0?new Error(a.join(", ")):new Error(`Failed to fetch UniProt: ${s}`);return new Map(o.map(({primaryAccession:l,uniProtkbId:c,genes:u,sequence:h})=>[l,{id:c,geneName:u.length>0?u[0].geneName.value:void 0,sequence:h.value}]))}),_c=[],Gb=async({values:n},e)=>{if(n.trim().length===0)return[];const t=[],r=[];for(const o of qb(n))es(o)?r.push({field:"accession",value:o,cached:_c.find(({primaryAccession:a})=>a.toUpperCase()===o.toUpperCase())}):vb(o)?r.push({field:"id",value:o,cached:_c.find(({uniProtkbId:a})=>a.toUpperCase()===o.toUpperCase())}):t.push(o);if(t.length>0)throw new Error(`Invalid UniProt accession${t.length!==1?"s":""} / entry name${t.length!==1?"s":""}: ${t.join(", ")}`);const i=r.filter(({cached:o})=>o===void 0),s=i.length>0?await(async()=>{const{data:o,statusText:a}=await Xb({query:i.map(({field:u,value:h})=>`(${u}:${h})`).join("OR"),fields:"accession,id,gene_primary,sequence,protein_name,organism_name",size:500},e),{results:l,messages:c}=o??{};if(!l)throw c!==void 0&&c.length>0?new Error(c.join(", ")):new Error(`Failed to fetch UniProt: ${a}`);return l})():[];if(i.length>0){const o=i.filter((a,l)=>s[l]===void 0);if(o.length>0)throw new Error(`Couldn't find protein${o.length===1?"":"s:"} ${o.map(({value:a})=>`"${a}"`).join(", ")}`)}return r.map(({field:o,value:a,cached:l})=>{if(l)return l;const c=s.find(({primaryAccession:u,uniProtkbId:h})=>o==="accession"?u.toUpperCase()===a.toUpperCase():o==="id"?h.toUpperCase()===a.toUpperCase():!1);if(!c)throw new Error(`Couldn't find protein${o==="id"?" with entry name":o==="accession"?" with accession":""} "${a}"`);return c&&_c.push(c),c}).map(o=>({uniprotAccession:o.primaryAccession,uniprotEntryName:o.uniProtkbId,recommendedName:o.proteinDescription?.recommendedName?.fullName?.value,organismName:o.organism?.scientificName,geneName:o.genes.length>0?o.genes[0].geneName.value:void 0,sequence:o.sequence.value}))},oT=rs(Gb),aT=rs(async({value:n},e)=>{const t=await Gb({values:n},e);if(t.length===0||t[0]===void 0)throw new Error("UniProt entry not found");return t[0]}),lT="_dragover_1s8s7_1",Ti={dragover:lT},cT=({mappedPeptides:n,offset:e})=>n.map(({sequence:t,position:r})=>({start:r+e-1,end:r+e-1+t.length})),uT=(n,e=0)=>{if(n.length===0)return[];const t=n.map(({start:u})=>u).toSorted((u,h)=>u-h),r=n.map(({end:u})=>u).toSorted((u,h)=>u-h),i=t[0],s=r[r.length-1],o=[];let a=0,l=0,c=0;for(let u=Math.min(0,i);u<s;u++){let h=!1;for(;t[l]===u;)a===0&&(h=!0),a++,l++;const f=a;let p=!1;for(;r[c]===u+1;)a--,c++,a===0&&(p=!0);u>=e&&o.push({count:f,isStart:h,isEnd:p})}return o},hs=n=>n!==void 0&&n>0?`green.400/${Math.min(n*40,100)}`:void 0,dT=n=>{const e=te.c(9),{sequence:t,peptidePositions:r,mappedPositions:i}=n;let s;if(e[0]!==i||e[1]!==r||e[2]!==t){s=[];const l=r?uT(r):i?Array.from(Array(t.length)).map((c,u)=>({count:i.mappedPositions.has(i.offset+u+1)?1:0,isStart:!0,isEnd:!0})):[];for(let c=0;c<t.length;c=c+10,c){const u=Math.min(c+10,t.length),h=l.slice(c,u),f=l[c]?.isStart??!1?0:Math.min(l[c-1]?.count??l[c]?.count??0,l[c]?.count??0),p=l[u]?.isStart??!1?0:Math.min(l[u-1]?.count??0,l[u]?.count??0);s.push({sequence:t.slice(c,u),peptides:h,stableNumOfPeptides:h.every(hT)&&new Set(h.map(fT)).size===1?h[0]?.count??0:void 0,numPeptidesBefore:f,numPeptidesAfter:p})}e[0]=i,e[1]=r,e[2]=t,e[3]=s}else s=e[3];let o;e[4]!==t.length?(o=(l,c)=>d.jsxs(Re,{children:[d.jsx(ft,{direction:"column",minW:3,mt:"1.1lh",h:"0.8lh",bg:hs(l.numPeptidesBefore)}),d.jsxs(Re,{direction:"column",align:"end",children:[d.jsx(rt,{color:"fg.muted",children:t.length<10?t.length:c*10+10}),d.jsxs(rt,{whiteSpace:"pre",children:[l.stableNumOfPeptides?d.jsx(gn,{bg:hs(l.stableNumOfPeptides),children:l.sequence}):d.jsx(tu,{each:Array.from(l.sequence),children:(u,h)=>d.jsx(gn,{bg:hs(l.peptides[h]?.count),borderStartRadius:l.peptides[h]?.isStart??!1?"md":void 0,borderEndRadius:l.peptides[h]?.isEnd??!1?"md":void 0,children:u},h)}),10>l.sequence.length&&d.jsx(gn,{bg:hs(l.numPeptidesAfter),children:" ".repeat(10-l.sequence.length)})]})]}),d.jsx(ft,{direction:"column",minW:3,mt:"1.1lh",h:"0.8lh",bg:hs(l.numPeptidesAfter)})]},c),e[4]=t.length,e[5]=o):o=e[5];let a;return e[6]!==s||e[7]!==o?(a=d.jsx(Re,{gapY:2,wrap:"wrap",children:d.jsx(tu,{each:s,children:o})}),e[6]=s,e[7]=o,e[8]=a):a=e[8],a};let lt;const Yb=({defaultValue:n,onChange:e,disabled:t=!1,setIsEditing:r,defaultEdit:i,inputRef:s,mappedPeptides:o,mappedPositions:a,onDropRef:l,ref:c,...u})=>{const h=uo({defaultValue:n,placeholder:"Enter a sequence, UniProt accession, or drop a FASTA file",disabled:t,defaultEdit:i,onValueCommit:({value:x})=>{const b=x.toUpperCase().replaceAll(/\s/g,"");if(es(b)||vb(b)){lt=nt(lt,{type:"loading",title:`Fetching ${b} from UniProt...`}),aT({value:b}).then(({uniprotEntryName:w,sequence:v})=>{v?(yr.success({id:lt,title:`Loaded ${b} from UniProt`,description:w}),h.setValue(v),e(v)):(yr.error({id:lt,title:`Entry ${b} has no sequence`,description:w}),h.clearValue(),e())}).catch(w=>{yr.error({id:lt,title:"Failed to fetch sequence from UniProt",description:w.message}),h.clearValue(),e()});return}const y=b.replaceAll(/[^GAVLITSMCPFYWHKRDENQ]/g,"");y!==b&&(lt=nt(lt,{type:"warning",title:"Invalid characters removed from the sequence",description:"Please ensure the sequence contains only valid amino acid codes."})),h.setValue(y),e(y!==""?y:void 0)},onEditChange:({edit:x})=>r?.(x)}),f=_.useMemo(()=>o?cT(o):void 0,[o]),p=_.useCallback(x=>{if(x.size===0){lt=nt(lt,{type:"error",title:`${x.name} is empty`});return}x.text().then(b=>{if(!Ug(b)){lt=nt(lt,{type:"error",title:`${x.name} is not a valid FASTA file`});return}const y=qg(b),w=y.next().value;if(w){const v=w.sequence.toUpperCase().replaceAll(/[^GAVLITSMCPFYWHKRDENQ]/g,"").trim(),S=v!==w.sequence.toUpperCase().trim(),k=!!y.next().value;lt=nt(lt,{type:S||k?"warning":"success",title:`Loaded the sequence of ${w.id} from ${x.name}`,description:[S?"Invalid characters were removed from the sequence.":"",k?"Note that only the first sequence is loaded.":""].join(" ")}),h.cancel(),h.setValue(v),e(v)}else{lt=nt(lt,{type:"error",title:`Couldn't parse ${x.name} as FASTA`}),h.edit(),h.setValue(b);return}}).catch(b=>{lt=nt(lt,{type:"error",title:`Couldn't read ${x.name}`,description:b.message})})},[h,e]);_.useEffect(()=>(l&&"current"in l&&(l.current=p),()=>{l&&"current"in l&&(l.current=null)}),[l,p]);const m=_.useCallback(x=>{if(!x.dataTransfer?.items||x.dataTransfer.items.length===0)return;const b=x.dataTransfer.items[0];if(b.kind==="file"){const y=b.getAsFile();y&&p(y)}},[p]);let g=0;return d.jsxs(Pl,{value:h,fontFamily:"mono",onDragEnter:x=>{x.stopPropagation(),++g===1&&x.currentTarget.classList.add(Ti.dragover)},onDragLeave:x=>{x.stopPropagation(),--g===0&&x.currentTarget.classList.remove(Ti.dragover)},onDragOver:x=>{x.preventDefault(),x.stopPropagation()},onDrop:x=>{x.preventDefault(),x.stopPropagation(),x.currentTarget.classList.remove(Ti.dragover),g=0,m(x)},border:"2px solid transparent",ref:c,...u,children:[d.jsxs(Cl,{w:"full",_hover:{bg:"unset"},_placeholderShown:{color:"fg.muted",fontFamily:"body"},children:[h.empty&&h.valueText,!h.empty&&d.jsx(dT,{sequence:h.value,peptidePositions:f,mappedPositions:a})]}),d.jsx(xP,{ref:s,_placeholderShown:{color:"fg.muted",fontFamily:"body"},overflowY:"hidden",onFocus:x=>{x.currentTarget.style.height="auto",x.currentTarget.style.height=`${x.currentTarget.scrollHeight}px`},onInput:x=>{x.currentTarget.style.height="auto",x.currentTarget.style.height=`${x.currentTarget.scrollHeight}px`},onKeyDown:x=>x.key==="Enter"&&h.submit()})]})};function hT(n){const{isStart:e,isEnd:t}=n;return!e&&!t}function fT(n){const{count:e}=n;return e}const ke=_.forwardRef(function(e,t){const r=te.c(15);let i,s,o,a,l;r[0]!==e?({loading:o,disabled:s,loadingText:a,children:i,...l}=e,r[0]=e,r[1]=i,r[2]=s,r[3]=o,r[4]=a,r[5]=l):(i=r[1],s=r[2],o=r[3],a=r[4],l=r[5]);const c=o||s;let u;r[6]!==i||r[7]!==o||r[8]!==a?(u=o&&!a?d.jsxs(d.Fragment,{children:[d.jsx(id,{display:"inline-flex",children:d.jsx(Zr,{size:"inherit",color:"inherit"})}),d.jsx(gn,{opacity:0,children:i})]}):o&&a?d.jsxs(d.Fragment,{children:[d.jsx(Zr,{size:"inherit",color:"inherit",writingMode:"initial"}),a]}):i,r[6]=i,r[7]=o,r[8]=a,r[9]=u):u=r[9];let h;return r[10]!==t||r[11]!==l||r[12]!==c||r[13]!==u?(h=d.jsx(co,{disabled:c,ref:t,...l,children:u}),r[10]=t,r[11]=l,r[12]=c,r[13]=u,r[14]=h):h=r[14],h}),pT=_.memo(function({protein:{id:e,name:t,linkPositionToAminoAcid:r,peptides:i,sequence:s},experimentId:o,isEditing:a,setIsEditing:l,onDropRef:c,closeDialog:u}){const[h,f]=_.useState(s),p=_.useRef(null),{proteinPositionToAminoAcid:m,lastAminoAcidPosition:g}=_.useMemo(()=>{const w=Id({linkPositionToAminoAcid:r,peptides:i}),[v,S]=pb(w);return{proteinPositionToAminoAcid:w,lastAminoAcidPosition:S}},[r,i]),x=_.useMemo(()=>h?Ed(m,h,0,!1):void 0,[h,m]),b=x&&x.mismatchedPositions.size===0&&x.unmappedPositions.size===0&&(x.mappedPositions.size===0||x.success),y=_.useMemo(()=>h&&x&&i?i.filter(({position:w,sequence:v})=>w-1+v.length-1>=0&&w-1<h.length).filter(({position:w,sequence:v})=>Array.from(Array(v.length)).map((S,k)=>w+k).every(S=>x.mappedPositions.has(S))):void 0,[h,x,i]);return sd("keydown",w=>{w.key==="Enter"&&w.target!==p.current&&(!h||b)&&(w.preventDefault(),h!==s&&Hs(o,e,{sequence:h}),u())}),d.jsxs(d.Fragment,{children:[d.jsxs(Gt,{flexDir:"column",children:[d.jsxs(Yt,{children:[t," Sequence"]}),d.jsx(Dl,{children:"Sequences in strcutures are aligned to the provided protein sequences to determine crosslink positions."}),d.jsx(on,{})]}),d.jsxs(wn,{children:[d.jsx(Yb,{defaultValue:s,inputRef:p,onChange:f,setIsEditing:l,defaultEdit:!s,mappedPeptides:y?{mappedPeptides:y,offset:0}:void 0,mappedPositions:x?{mappedPositions:x.mappedPositions,offset:0}:void 0,onDropRef:c}),h&&!a&&d.jsxs(Qr,{status:b?"success":"error",mt:5,children:[d.jsx(Di,{}),d.jsx(Zi,{children:d.jsx(mo,{children:b?i?`${i.length>1?"All":"The"} ${De(i.length,"peptide")} of ${t} ${i.length===1?"was":"were"} mapped succesfully to the sequence.`:`${m.size>1?"All":"The"} ${De(m.size,"crosslink position")} in ${t} ${m.size===1?"was":"were"} mapped succesfully to the sequence.`:h.length<g?`The sequence should be at least ${De(g,"amino acid")} long (because the last ${i?"peptide of":"crosslink position in"} ${t} ${i?"ends at":"is"} ${m.get(g)??""}${g}).`:(x?.mismatchedPositions.size??0)>0?i?`Some peptides of ${t} don't match the sequence.`:`Some positions of ${t} don't match the sequence.`:`The sequence doesn't match the positions of ${t}.`})})]})]}),d.jsxs(Xt,{children:[(a||s===h)&&d.jsx(ke,{variant:"surface",onClick:u,children:"Close"}),s!==h&&!a&&d.jsxs(d.Fragment,{children:[d.jsx(ke,{variant:"surface",onClick:u,children:"Cancel"}),d.jsx(ke,{colorPalette:"green",onClick:()=>{Hs(o,e,{sequence:h}),u()},disabled:!!h&&!b,children:"Save sequence"})]})]})]})}),mT=_.forwardRef(function(e,t){const r=te.c(21);let i,s,o,a,l;r[0]!==e?({children:i,clearable:s,hideIndicator:o,triggerProps:l,...a}=e,r[0]=e,r[1]=i,r[2]=s,r[3]=o,r[4]=a,r[5]=l):(i=r[1],s=r[2],o=r[3],a=r[4],l=r[5]);let c;r[6]!==i||r[7]!==t||r[8]!==l?(c=d.jsx(Y1,{...l,ref:t,children:i}),r[6]=i,r[7]=t,r[8]=l,r[9]=c):c=r[9];let u;r[10]!==s?(u=s&&d.jsx(gT,{}),r[10]=s,r[11]=u):u=r[11];let h;r[12]!==o?(h=!o&&d.jsx(JP,{}),r[12]=o,r[13]=h):h=r[13];let f;r[14]!==u||r[15]!==h?(f=d.jsxs(ZP,{children:[u,h]}),r[14]=u,r[15]=h,r[16]=f):f=r[16];let p;return r[17]!==a||r[18]!==c||r[19]!==f?(p=d.jsxs(jd,{...a,children:[c,f]}),r[17]=a,r[18]=c,r[19]=f,r[20]=p):p=r[20],p}),gT=_.forwardRef(function(e,t){const r=te.c(4);let i;r[0]===Symbol.for("react.memo_cache_sentinel")?(i=d.jsx(lo,{size:"xs",variant:"plain",focusVisibleRing:"inside",focusRingWidth:"2px",pointerEvents:"auto"}),r[0]=i):i=r[0];let s;return r[1]!==e||r[2]!==t?(s=d.jsx(GP,{asChild:!0,...e,ref:t,children:i}),r[1]=e,r[2]=t,r[3]=s):s=r[3],s}),Kb=_.forwardRef(function(e,t){const r=te.c(11);let i,s,o;r[0]!==e?({portalled:o,portalRef:i,...s}=e,r[0]=e,r[1]=i,r[2]=s,r[3]=o):(i=r[1],s=r[2],o=r[3]);const l=!(o===void 0?!0:o);let c;r[4]!==t||r[5]!==s?(c=d.jsx(K1,{children:d.jsx(Z1,{...s,ref:t})}),r[4]=t,r[5]=s,r[6]=c):c=r[6];let u;return r[7]!==i||r[8]!==l||r[9]!==c?(u=d.jsx(Cr,{disabled:l,container:i,children:c}),r[7]=i,r[8]=l,r[9]=c,r[10]=u):u=r[10],u}),Fd=_.forwardRef(function(e,t){const r=te.c(10);let i,s,o;r[0]!==e?({item:s,children:i,...o}=e,r[0]=e,r[1]=i,r[2]=s,r[3]=o):(i=r[1],s=r[2],o=r[3]);let a;r[4]===Symbol.for("react.memo_cache_sentinel")?(a=d.jsx(eb,{}),r[4]=a):a=r[4];let l;return r[5]!==i||r[6]!==s||r[7]!==t||r[8]!==o?(l=d.jsxs(Q1,{item:s,...o,ref:t,children:[i,a]},s.value),r[5]=i,r[6]=s,r[7]=t,r[8]=o,r[9]=l):l=r[9],l}),xT=_.forwardRef(function(e,t){const r=te.c(10);let i,s;r[0]!==e?({children:i,...s}=e,r[0]=e,r[1]=i,r[2]=s):(i=r[1],s=r[2]);let o;r[3]!==i||r[4]!==e.placeholder?(o=d.jsx(eC,{children:l=>{const c=l.selectedItems;return c.length===0?e.placeholder:i?i(c):c.length===1?l.collection.stringifyItem(c[0]):`${c.length} selected`}}),r[3]=i,r[4]=e.placeholder,r[5]=o):o=r[5];let a;return r[6]!==t||r[7]!==s||r[8]!==o?(a=d.jsx(J1,{...s,ref:t,children:o}),r[6]=t,r[7]=s,r[8]=o,r[9]=a):a=r[9],a});_.forwardRef(function(e,t){const r=te.c(10);let i;r[0]!==e.positioning?(i={sameWidth:!0,...e.positioning},r[0]=e.positioning,r[1]=i):i=r[1];let s;r[2]!==e.asChild||r[3]!==e.children?(s=e.asChild?e.children:d.jsxs(d.Fragment,{children:[d.jsx(tb,{}),e.children]}),r[2]=e.asChild,r[3]=e.children,r[4]=s):s=r[4];let o;return r[5]!==e||r[6]!==t||r[7]!==i||r[8]!==s?(o=d.jsx(XP,{...e,ref:t,positioning:i,children:s}),r[5]=e,r[6]=t,r[7]=i,r[8]=s,r[9]=o):o=r[9],o});_.forwardRef(function(e,t){const r=te.c(11);let i,s,o;r[0]!==e?({children:i,label:s,...o}=e,r[0]=e,r[1]=i,r[2]=s,r[3]=o):(i=r[1],s=r[2],o=r[3]);let a;r[4]!==s?(a=d.jsx(KP,{children:s}),r[4]=s,r[5]=a):a=r[5];let l;return r[6]!==i||r[7]!==t||r[8]!==o||r[9]!==a?(l=d.jsxs(YP,{...o,ref:t,children:[a,i]}),r[6]=i,r[7]=t,r[8]=o,r[9]=a,r[10]=l):l=r[10],l});const bT=QP,Cf=n=>{const e=gl();return ie.referenceProteinsById[e]={id:e,...n},e},yT=n=>{const e=ie.proteinIdToReferenceProtein.entries().filter(([t,{id:r}])=>r===n).map(([t])=>t);for(const t of e)ie.proteinIdToReferenceProtein.delete(t);ie.referenceProteinsById=Object.fromEntries(Object.entries(ie.referenceProteinsById).filter(([,{id:t}])=>t!==n));for(const t of ie.structures.flatMap(({chainIdToProteinIdToMapping:r})=>Object.values(r)))t.delete(n);ie.proteinIdToXLMapPosition=Object.fromEntries(Object.entries(ie.proteinIdToXLMapPosition).filter(([t])=>t!==n))},Fa=(n,e)=>Xg(ie.referenceProteinsById[n],e),vT=async n=>{ie.proteinIdToReferenceProtein.delete(n)},wT=async(n,e,t)=>{const r=ie.referenceProteinsById[e],{alignmentOffsets:i}=await mb(n.sequence,r.sequence,t),s={ntd:i[0]===0?"ntd":void 0,...Object.fromEntries(i.map((o,a)=>[a+1,o!==-1?o+1:void 0]))};return ie.proteinIdToReferenceProtein.set(n.id,{id:r.id,xlPosToRefPos:s}),i},Zb=({proteinIdToReferenceProtein:n,referenceProteinsById:e},t)=>t.map(r=>{const i=n.get(r.id)?.id;if(i){const s=e[i];if(s)return{isReferenceProtein:!0,...s}}return{isReferenceProtein:!1,...r}}),_T=n=>Zb(ie,n),ST=(n,e,t)=>{const r=i=>{const s=e.get(i.proteinId);if(!s)return i;const o=t[s.id];if(!o)throw new Error("Reference protein not found");const a=s.xlPosToRefPos[i.linkPosition];return{proteinId:s.id,linkPosition:a,aminoAcid:a!==void 0&&a!=="ntd"?o.sequence[a-1]:void 0}};return n.map(i=>{const[s,o]=[r(i.from),r(i.to)].toSorted((a,l)=>{if(a.proteinId!==l.proteinId)return a.proteinId.localeCompare(l.proteinId);const[c,u]=[a,l].map(({linkPosition:h})=>h===void 0?Number.POSITIVE_INFINITY:h==="ntd"?0:h);return c-u});return{...i,homoMultimeric:i.homoMultimeric||i.from.proteinId!==i.to.proteinId&&s.proteinId===o.proteinId,from:s,to:o,originalCrosslink:i}})},Jb=n=>{const e=te.c(7),{proteinIdToReferenceProtein:t,referenceProteinsById:r}=Je(ie);let i,s;if(e[0]!==n||e[1]!==t||e[2]!==r){let o;e[4]!==t||e[5]!==r?(o=a=>{const{proteins:l,crosslinks:c,...u}=a;return{proteins:Zb({proteinIdToReferenceProtein:t,referenceProteinsById:r},l),crosslinks:ST(c,t,r),...u}},e[4]=t,e[5]=r,e[6]=o):o=e[6],s=n.map(o),e[0]=n,e[1]=t,e[2]=r,e[3]=s}else s=e[3];return i=s,i},PT=n=>{const e=te.c(2);let t,r;return e[0]!==n?(r=n?[n]:[],e[0]=n,e[1]=r):r=e[1],t=r,Jb(t)[0]},zd=()=>{const n=te.c(2),{referenceProteinsById:e}=Je(ie);let t,r;return n[0]!==e?(r=Array.from(Object.values(e)).toSorted(CT),n[0]=e,n[1]=r):r=n[1],t=r,t},Qb=n=>{const e=te.c(10),{proteinIdToReferenceProtein:t,referenceProteinsById:r}=Je(ie);let i;e[0]!==n.id||e[1]!==t?(i=t.get(n.id),e[0]=n.id,e[1]=t,e[2]=i):i=e[2];const s=i;if(!s){let c;return e[3]!==n?(c={resolvedProtein:{isReferenceProtein:!1,...n},xlPosToRefPos:void 0},e[3]=n,e[4]=c):c=e[4],c}const o=r[s.id];let a;e[5]!==o?(a={isReferenceProtein:!0,...o},e[5]=o,e[6]=a):a=e[6];let l;return e[7]!==s.xlPosToRefPos||e[8]!==a?(l={resolvedProtein:a,xlPosToRefPos:s.xlPosToRefPos},e[7]=s.xlPosToRefPos,e[8]=a,e[9]=l):l=e[9],l};function CT(n,e){return n.name.localeCompare(e.name)}const kT=n=>{const e=te.c(30),{closeDialog:t,onAddedReferenceProtein:r}=n,i=_.useRef(null),s=_.useRef(null),[o,a]=_.useState(""),[l,c]=_.useState(""),u=o.length>0&&l.length>0;let h;e[0]!==t||e[1]!==u||e[2]!==o||e[3]!==r||e[4]!==l?(h=C=>{if(C.key==="Enter"){if(C.target===i.current&&o.length>0){C.preventDefault(),s.current?.previousElementSibling?.focus();return}if(C.target!==s.current&&u){C.preventDefault();const T=Cf({name:o,sequence:l});r?.(T),t()}}},e[0]=t,e[1]=u,e[2]=o,e[3]=r,e[4]=l,e[5]=h):h=e[5],sd("keydown",h);let f;e[6]===Symbol.for("react.memo_cache_sentinel")?(f=d.jsx(on,{}),e[6]=f):f=e[6];let p;e[7]===Symbol.for("react.memo_cache_sentinel")?(p=d.jsx(Gt,{children:d.jsx(Yt,{children:"Add Reference Protein"})}),e[7]=p):p=e[7];let m;e[8]===Symbol.for("react.memo_cache_sentinel")?(m=C=>a(C.target.value),e[8]=m):m=e[8];let g;e[9]!==o?(g=d.jsx(nu,{label:"Name",children:d.jsx(ki,{type:"text",ref:i,value:o,onChange:m,autoFocus:!0})}),e[9]=o,e[10]=g):g=e[10];let x;e[11]===Symbol.for("react.memo_cache_sentinel")?(x=d.jsx(nu,{label:"Sequence",children:d.jsx(Yb,{inputRef:s,onChange:C=>c(C??"")})}),e[11]=x):x=e[11];let b;e[12]!==g?(b=d.jsx(wn,{asChild:!0,children:d.jsx(vd,{children:d.jsxs(wd,{children:[g,x]})})}),e[12]=g,e[13]=b):b=e[13];let y;e[14]!==t?(y=d.jsx(ke,{variant:"surface",onClick:t,children:"Close"}),e[14]=t,e[15]=y):y=e[15];const w=!u;let v;e[16]!==t||e[17]!==o||e[18]!==r||e[19]!==l?(v=()=>{const C=Cf({name:o,sequence:l});r?.(C),t()},e[16]=t,e[17]=o,e[18]=r,e[19]=l,e[20]=v):v=e[20];let S;e[21]!==v||e[22]!==w?(S=d.jsx(ke,{colorPalette:"green",disabled:w,onClick:v,children:"Add protein"}),e[21]=v,e[22]=w,e[23]=S):S=e[23];let k;e[24]!==S||e[25]!==y?(k=d.jsxs(Xt,{children:[y,S]}),e[24]=S,e[25]=y,e[26]=k):k=e[26];let P;return e[27]!==k||e[28]!==b?(P=d.jsxs(d.Fragment,{children:[f,p,b,k]}),e[27]=k,e[28]=b,e[29]=P):P=e[29],P},ey=({dialogRef:n,onAddedReferenceProtein:e})=>{const t=xn({restoreFocus:!1});return _.useEffect(()=>{if(n!==void 0)return n.current=t,()=>{n.current=null}},[n,t]),d.jsx(rr,{value:t,placement:"top",size:"xl",lazyMount:!0,unmountOnExit:!0,children:d.jsx(nn,{children:d.jsx(kT,{closeDialog:()=>t.setOpen(!1),onAddedReferenceProtein:e})})})},bu=_.memo(function(e){const t=te.c(11);let r,i,s,o;t[0]!==e?({active:r,children:i,ref:s,...o}=e,t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=o):(r=t[1],i=t[2],s=t[3],o=t[4]);const a=r?void 0:"fg.muted/50";let l;t[5]===Symbol.for("react.memo_cache_sentinel")?(l={color:"unset",textDecorationLine:"underline"},t[5]=l):l=t[5];let c;return t[6]!==i||t[7]!==s||t[8]!==o||t[9]!==a?(c=d.jsx(Nn,{fontSize:"xs",variant:"underline",color:a,textDecorationLine:"none",_hover:l,ref:s,...o,children:i}),t[6]=i,t[7]=s,t[8]=o,t[9]=a,t[10]=c):c=t[10],c}),jT=_.memo(function({protein:e,experimentId:t,onDropRef:r,ref:i,...s}){const[o,a]=_.useState(!1),l=xn({closeOnInteractOutside:!o,closeOnEscape:!o,trapFocus:!1,restoreFocus:!1}),c=_.useRef(null);_.useEffect(()=>(r&&"current"in r&&(r.current=g=>{l.setOpen(!0),setTimeout(()=>c.current?.(g),0)}),()=>{r&&"current"in r&&(r.current=null)}),[r,l]);const u=_.useRef(null),h=zd(),f=_.useMemo(()=>cd({items:[...h.map(({id:g,name:x})=>({value:g,label:x})),{value:"new",label:"Add..."}]}),[h]),{resolvedProtein:p}=Qb(e),m=wl({collection:f,defaultValue:p.isReferenceProtein?[p.id]:void 0,deselectable:!0,onValueChange:async({value:g})=>{if(g[0]==="new"){u.current?.setOpen(!0),m.clearValue();return}if(g.length===0){await vT(e.id);return}if(!e.sequence)throw new Error;await wT(e,g[0])},positioning:{gutter:5,shift:20}});return d.jsxs(d.Fragment,{children:[d.jsx(rr,{value:l,size:"xl",placement:"top",lazyMount:!0,unmountOnExit:!0,children:d.jsx(nn,{h:"fit",children:d.jsx(pT,{protein:e,experimentId:t,isEditing:o,setIsEditing:a,onDropRef:c,closeDialog:()=>{a(!1),l.setOpen(!1)}})})}),d.jsx(ey,{dialogRef:u,onAddedReferenceProtein:g=>{e.domains&&Fa(g,{domains:Gg(e.domains)}),m.setValue([g])}}),d.jsxs(_o,{ref:i,...s,children:[d.jsx(bu,{active:!!e.sequence,onClick:()=>l.setOpen(!0),py:2,children:"Sequence"}),e.sequence&&d.jsxs(kd,{value:m,size:"xs",pt:"2px",children:[d.jsx(jd,{width:"full",children:d.jsx(Y1,{as:"span",asChild:!0,border:"none",pl:0,children:d.jsxs(bu,{active:!m.empty,w:"full",children:[d.jsx(q_,{}),d.jsx(J1,{placeholder:"Reference"})]})})}),d.jsx(Kb,{mt:-1,children:m.collection.items.map(g=>d.jsxs(_.Fragment,{children:[g.value==="new"&&m.collection.items.length>1&&d.jsx(Ur,{},"before-new"),d.jsx(Fd,{item:g,children:g.label})]},g.value))})]})]})]})}),TT="_dragover_1ksss_1",Sc={dragover:TT},MT=n=>{const e=te.c(29),{domain:t,stats:r,toggleVisibility:i,deleteDomain:s}=n,{name:o,startPosition:a,endPosition:l}=t,{interdomain:c,intradomain:u}=r;let h;e[0]!==c||e[1]!==u||e[2]!==o||e[3]!==i?(h=d.jsx(pn,{size:"sm",name:o,stat:c,stat2:u,toggleVisibility:i}),e[0]=c,e[1]=u,e[2]=o,e[3]=i,e[4]=h):h=e[4];let f;e[5]===Symbol.for("react.memo_cache_sentinel")?(f={colorPalette:"red"},e[5]=f):f=e[5];let p;e[6]!==s||e[7]!==a?(p=()=>s(a),e[6]=s,e[7]=a,e[8]=p):p=e[8];let m;e[9]===Symbol.for("react.memo_cache_sentinel")?(m=d.jsx(od,{}),e[9]=m):m=e[9];let g;e[10]!==p?(g=d.jsx(mt,{size:"2xs",variant:"ghost",_hover:f,verticalAlign:"center",ml:2,onClick:p,children:m}),e[10]=p,e[11]=g):g=e[11];let x;e[12]!==l||e[13]!==a||e[14]!==g?(x=d.jsxs(rt,{fontSize:"xs",color:"fg.muted",children:["from ",a," to ",l,g]}),e[12]=l,e[13]=a,e[14]=g,e[15]=x):x=e[15];let b;e[16]!==h||e[17]!==x?(b=d.jsxs(Re,{justifyContent:"space-between",children:[h,x]}),e[16]=h,e[17]=x,e[18]=b):b=e[18];let y;e[19]!==c||e[20]!==i?(y=d.jsx(pn,{name:"Inter-domain",ms:6,size:"sm",info:"Crosslinks that occur between two different domains",stat:c,toggleVisibility:i}),e[19]=c,e[20]=i,e[21]=y):y=e[21];let w;e[22]!==u||e[23]!==i?(w=d.jsx(pn,{name:"Intra-domain",ms:6,size:"sm",info:"Crosslinks that occur within the same domain",stat:u,toggleVisibility:i}),e[22]=u,e[23]=i,e[24]=w):w=e[24];let v;return e[25]!==y||e[26]!==w||e[27]!==b?(v=d.jsxs(xo,{children:[b,y,w]}),e[25]=y,e[26]=w,e[27]=b,e[28]=v):v=e[28],v},kf=n=>{const e=te.c(52),{domains:t,proteinLength:r,addDomain:i}=n,[s,o]=_.useState(""),[a,l]=_.useState(""),[c,u]=_.useState(""),h=_.useRef(null);let f;e[0]!==s?(f=s.length>0?s.trim():void 0,e[0]=s,e[1]=f):f=e[1];const p=f;let m;e:{if(p===void 0){m=void 0;break e}if(p.length===0){m="Domain name can't be empty";break e}if(t?.some(ae=>ae.name===p)??!1){m="Domain name already exist";break e}m=!1}const g=m;let x;e:{if(a.length===0){x=void 0;break e}if(!/^[0-9]+$/.test(a.trim())){x="Invalid position";break e}const ae=Number.parseInt(a);if(!Number.isSafeInteger(ae)||ae<=0){x="Invalid position";break e}if(r!==void 0&&ae>r){x=`Must be smaller than the protein's length (${r})`;break e}const ce=$a(ae,t);if(ce){x=`The position is in an existing domain (${ce.name})`;break e}x=ae}const b=x;let y;e:{if(typeof b!="number"||c.length===0){y=void 0;break e}if(!/^[0-9]+$/.test(c.trim())){y="Invalid position";break e}const ae=Number.parseInt(c);if(!Number.isSafeInteger(ae)){y="Invalid position";break e}if(r!==void 0&&ae>r){y=`Must be smaller than the protein's length (${r})`;break e}if(ae<b){y="Must be larger than the start position";break e}const ce=$a(ae,t);if(ce){y=`The position is in an existing domain (${ce.name})`;break e}y=ae}const w=y;let v;e:{if(typeof b!="number"||typeof w!="number"){v=void 0;break e}const ae=t?.filter(ce=>ce.startPosition<=w&&ce.endPosition>=b)??[];if(ae.length>0)if(ae.length===1){v=`Overlapping with an existing domain (${ae[0].name})`;break e}else{v=`Overlapping with ${De(ae.length,"domain")}: ${Tn(ae.map(AT))}`;break e}v=!1}const S=v;let k;e[2]!==i||e[3]!==w||e[4]!==p||e[5]!==g||e[6]!==S||e[7]!==b?(k=ae=>{ae.preventDefault(),g===!1&&S===!1&&i(p,b,w)},e[2]=i,e[3]=w,e[4]=p,e[5]=g,e[6]=S,e[7]=b,e[8]=k):k=e[8];const P=!!g;let C;e[9]===Symbol.for("react.memo_cache_sentinel")?(C=d.jsx(Hh,{fontSize:"xs",children:"Domain name"}),e[9]=C):C=e[9];let T;e[10]===Symbol.for("react.memo_cache_sentinel")?(T=d.jsx(ki,{size:"xs",onChange:ae=>o(ae.target.value)}),e[10]=T):T=e[10];let A;e[11]!==g?(A=d.jsx(Nr,{children:g}),e[11]=g,e[12]=A):A=e[12];let M;e[13]!==A||e[14]!==P?(M=d.jsxs(vi,{invalid:P,children:[C,T,A]}),e[13]=A,e[14]=P,e[15]=M):M=e[15];const O=!!S;let R;e[16]===Symbol.for("react.memo_cache_sentinel")?(R=d.jsx(Hh,{fontSize:"xs",children:"Position"}),e[16]=R):R=e[16];const j=!!S||typeof b=="string";let I,E;e[17]===Symbol.for("react.memo_cache_sentinel")?(I=ae=>{const{start:ce,end:fe}=/^(?<start>\d+)\s*-\s*(?<end>\d+)$/.exec(ae.target.value.trim())?.groups??{};if(ce&&fe){l(ce),u(fe),h.current?.focus();return}l(ae.target.value)},E=ae=>{ae.key==="-"&&(h.current?.focus(),ae.preventDefault())},e[17]=I,e[18]=E):(I=e[17],E=e[18]);let D;e[19]!==a?(D=d.jsx(ki,{size:"xs",placeholder:"Start",inputMode:"numeric",value:a,onChange:I,onKeyDown:E}),e[19]=a,e[20]=D):D=e[20];let L;e[21]!==b?(L=typeof b=="string"&&d.jsx(Nr,{children:b}),e[21]=b,e[22]=L):L=e[22];let z;e[23]!==j||e[24]!==D||e[25]!==L?(z=d.jsxs(vi,{invalid:j,children:[D,L]}),e[23]=j,e[24]=D,e[25]=L,e[26]=z):z=e[26];const B=!!S||typeof w=="string";let N;e[27]===Symbol.for("react.memo_cache_sentinel")?(N=ae=>u(ae.target.value),e[27]=N):N=e[27];let U;e[28]!==c?(U=d.jsx(ki,{size:"xs",placeholder:"End",inputMode:"numeric",value:c,onChange:N,ref:h}),e[28]=c,e[29]=U):U=e[29];let q;e[30]!==w?(q=typeof w=="string"&&d.jsx(Nr,{children:w}),e[30]=w,e[31]=q):q=e[31];let X;e[32]!==B||e[33]!==U||e[34]!==q?(X=d.jsxs(vi,{invalid:B,children:[U,q]}),e[32]=B,e[33]=U,e[34]=q,e[35]=X):X=e[35];let J;e[36]!==z||e[37]!==X?(J=d.jsxs(_o,{align:"start",children:[z,X]}),e[36]=z,e[37]=X,e[38]=J):J=e[38];let ee;e[39]!==S?(ee=d.jsx(Nr,{children:S}),e[39]=S,e[40]=ee):ee=e[40];let re;e[41]!==O||e[42]!==J||e[43]!==ee?(re=d.jsxs(vi,{invalid:O,children:[R,J,ee]}),e[41]=O,e[42]=J,e[43]=ee,e[44]=re):re=e[44];const oe=g!==!1||S!==!1;let me;e[45]!==oe?(me=d.jsx(co,{size:"xs",type:"submit",disabled:oe,children:"Add"}),e[45]=oe,e[46]=me):me=e[46];let ge;return e[47]!==M||e[48]!==re||e[49]!==me||e[50]!==k?(ge=d.jsx(bn,{asChild:!0,children:d.jsxs("form",{onSubmit:k,children:[M,re,me]})}),e[47]=M,e[48]=re,e[49]=me,e[50]=k,e[51]=ge):ge=e[51],ge};function AT(n){const{name:e}=n;return e}const jf=_.forwardRef(function(e,t){const r=te.c(11);let i,s,o;r[0]!==e?({portalled:o,portalRef:i,...s}=e,r[0]=e,r[1]=i,r[2]=s,r[3]=o):(i=r[1],s=r[2],o=r[3]);const l=!(o===void 0?!0:o);let c;r[4]!==t||r[5]!==s?(c=d.jsx(_d,{children:d.jsx(Sd,{ref:t,...s})}),r[4]=t,r[5]=s,r[6]=c):c=r[6];let u;return r[7]!==i||r[8]!==l||r[9]!==c?(u=d.jsx(Cr,{disabled:l,container:i,children:c}),r[7]=i,r[8]=l,r[9]=c,r[10]=u):u=r[10],u}),Tf=_.forwardRef(function(e,t){const r=te.c(4);let i;r[0]===Symbol.for("react.memo_cache_sentinel")?(i=d.jsx(Pd,{}),r[0]=i):i=r[0];let s;return r[1]!==e||r[2]!==t?(s=d.jsx(Cd,{...e,ref:t,children:i}),r[1]=e,r[2]=t,r[3]=s):s=r[3],s});_.forwardRef(function(e,t){const r=te.c(4);let i;r[0]===Symbol.for("react.memo_cache_sentinel")?(i=d.jsx(lo,{size:"sm"}),r[0]=i):i=r[0];let s;return r[1]!==e||r[2]!==t?(s=d.jsx(q1,{position:"absolute",top:"1",insetEnd:"1",...e,asChild:!0,ref:t,children:i}),r[1]=e,r[2]=t,r[3]=s):s=r[3],s});const ty=n=>{const e=te.c(43);let t,r,i,s,o,a;e[0]!==n?({protein:i,experimentId:r,domainNameToStats:t,toggleVisibility:a,ref:s,...o}=n,e[0]=n,e[1]=t,e[2]=r,e[3]=i,e[4]=s,e[5]=o,e[6]=a):(t=e[1],r=e[2],i=e[3],s=e[4],o=e[5],a=e[6]);let l;e[7]===Symbol.for("react.memo_cache_sentinel")?(l={},e[7]=l):l=e[7];const c=iu(l);let u;e[8]===Symbol.for("react.memo_cache_sentinel")?(u={portalled:!1,positioning:{placement:"right"}},e[8]=u):u=e[8];const h=iu(u);let f;e[9]!==r||e[10]!==i.domains||e[11]!==i.id||e[12]!==i.isReferenceProtein?(f=k=>{const P=i.domains?.filter(C=>C.startPosition!==k);i.isReferenceProtein?Fa(i.id,{domains:P}):r&&Hs(r,i.id,{domains:P})},e[9]=r,e[10]=i.domains,e[11]=i.id,e[12]=i.isReferenceProtein,e[13]=f):f=e[13];const p=f;let m;e[14]!==h||e[15]!==r||e[16]!==i.domains||e[17]!==i.id||e[18]!==i.isReferenceProtein?(m=(k,P,C)=>{const T=[...i.domains??[],{name:k,startPosition:P,endPosition:C}].toSorted(ET);i.isReferenceProtein?Fa(i.id,{domains:T}):r&&Hs(r,i.id,{domains:T}),h.setOpen(!1)},e[14]=h,e[15]=r,e[16]=i.domains,e[17]=i.id,e[18]=i.isReferenceProtein,e[19]=m):m=e[19];const g=m;let x;e[20]!==c.open||e[21]!==i.domains?(x=c.open||Jn(i.domains),e[20]=c.open,e[21]=i.domains,e[22]=x):x=e[22];let b;e[23]!==i.domains?(b=Jn(i.domains)?De(i.domains.length,"domain"):"Domains",e[23]=i.domains,e[24]=b):b=e[24];let y;e[25]!==s||e[26]!==o||e[27]!==x||e[28]!==b?(y=d.jsx(Ia,{asChild:!0,children:d.jsx(bu,{active:x,ref:s,...o,children:b})}),e[25]=s,e[26]=o,e[27]=x,e[28]=b,e[29]=y):y=e[29];let w;e[30]===Symbol.for("react.memo_cache_sentinel")?(w=d.jsx(Tf,{}),e[30]=w):w=e[30];let v;e[31]!==g||e[32]!==h||e[33]!==p||e[34]!==t||e[35]!==i.domains||e[36]!==i.sequence?.length||e[37]!==a?(v=d.jsxs(jf,{maxH:"unset",children:[w,d.jsx(ou,{children:d.jsx(bn,{gapY:5,children:Jn(i.domains)?d.jsxs(d.Fragment,{children:[i.domains.map(k=>d.jsx(MT,{domain:k,stats:t[k.name],toggleVisibility:a,deleteDomain:p},k.startPosition)),d.jsxs(Gh,{value:h,size:"xs",lazyMount:!0,unmountOnExit:!0,children:[d.jsx(Ia,{asChild:!0,children:d.jsxs(ke,{size:"2xs",children:[d.jsx(Jr,{}),"Add domain"]})}),d.jsxs(jf,{portalled:!1,children:[d.jsx(Tf,{}),d.jsx(ou,{children:d.jsx(kf,{domains:i.domains,proteinLength:i.sequence?.length,addDomain:g})})]})]})]}):d.jsx(kf,{domains:i.domains,proteinLength:i.sequence?.length,addDomain:g})})})]}),e[31]=g,e[32]=h,e[33]=p,e[34]=t,e[35]=i.domains,e[36]=i.sequence?.length,e[37]=a,e[38]=v):v=e[38];let S;return e[39]!==c||e[40]!==y||e[41]!==v?(S=d.jsxs(Gh,{value:c,size:"sm",unmountOnExit:!0,lazyMount:!0,children:[y,v]}),e[39]=c,e[40]=y,e[41]=v,e[42]=S):S=e[42],S};function ET(n,e){return n.startPosition-e.startPosition}const IT=({protein:n,stats:e,domainNameToStats:t,toggleVisibility:r,experimentId:i,hideMultiProteinToggles:s,ref:o,...a})=>{const l=e.interprotein.visible+e.intraprotein.visible>0,{resolvedProtein:c}=Qb(n),u=_.useRef(null);let h=0;return d.jsxs(S1,{borderColor:l?"colorPalette.solid":void 0,onDragEnter:f=>{f.stopPropagation(),++h===1&&f.currentTarget.classList.add(Sc.dragover)},onDragLeave:f=>{f.stopPropagation(),--h===0&&f.currentTarget.classList.remove(Sc.dragover)},onDragOver:f=>{f.stopPropagation(),f.preventDefault()},onDrop:f=>{f.stopPropagation(),f.preventDefault(),f.currentTarget.classList.remove(Sc.dragover),h=0;const p=f.dataTransfer.items[0]?.getAsFile();p&&u?.current?.(p)},ref:o,...a,children:[d.jsxs(C1,{children:[d.jsxs(Re,{flexDir:"row",alignItems:"center",children:[d.jsx(Rd,{name:n.name,onRename:f=>Hs(i,n.id,{name:f}),size:"lg",fontWeight:"semibold"},n.name),d.jsx(pn,{stat:e.interprotein,stat2:e.intraprotein,toggleVisibility:r,dir:"rtl"})]}),d.jsx(jT,{protein:n,experimentId:i,onDropRef:u}),d.jsx(ty,{protein:c,domainNameToStats:t,toggleVisibility:r,experimentId:i,w:"fit-content",mt:-2})]}),d.jsx(P1,{p:s&&e.homomultimeric.total===0?0:void 0,children:d.jsxs(xo,{children:[!s&&d.jsxs(d.Fragment,{children:[d.jsx(pn,{name:"Inter-protein",info:"Crosslinks that occur between two different proteins",stat:e.interprotein,toggleVisibility:r}),d.jsx(pn,{name:"Intra-protein",info:"Crosslinks that occur within the same protein",stat:e.intraprotein,toggleVisibility:r})]}),e.homomultimeric.total>0&&d.jsx(pn,{ms:s?void 0:6,name:"Homo-multimeric",info:"Crosslinks that occur between overlapping peptides",stat:e.homomultimeric,toggleVisibility:r})]})}),d.jsx(k1,{})]})},RT=_.memo(IT),Bd=(n,e)=>{const t=ie.experimentIdToGroupedStructureIds[n];t.flat(2).every(r=>!e.includes(r))||(ie.experimentIdToGroupedStructureIds[n]=fl(t.map(r=>r.filter(i=>!e.includes(i)))))},ny=(n,e)=>{ie.experimentIdToGroupedStructureIds[n]=fl([...ie.experimentIdToGroupedStructureIds[n],e])},Pc=(n,e)=>{const t=ie.experimentIdToGroupedStructureIds[n].flat().filter(r=>e.flat().every(i=>i!==r));ie.experimentIdToGroupedStructureIds[n]=fl([...e,t])},OT=(n,e)=>{const t=ie.experimentIdToGroupedStructureIds[n];ie.experimentIdToGroupedStructureIds[n]=fl([e,...t])},za=(n,e,t)=>{const r=new Set(ie.experimentIdToVisibleCrosslinkIds[n]),i=e?r.union(t):r.difference(t);ie.experimentIdToVisibleCrosslinkIds[n]=i},$T=n=>{const e=ie.experiments.find(({id:r})=>r===n);if(!e)return;const t=new Set(e?.crosslinks.map(({id:r})=>r));ie.experimentIdToVisibleCrosslinkIds[n]=t},DT=n=>n.split("_").map(e=>{const[t,r]=e.split("-").map(i=>Number.parseInt(i));return{startPosition:t,endPosition:r}}),NT=n=>n.split("_").at(-1),LT=rs(async({accession:n},e)=>{if(!es(n))throw new Error(`Invalid UniProt accession: ${n}`);const{data:t,statusText:r}=await Xe.get(`https://ted.cathdb.info/api/v1/uniprot/summary/${n}`,{signal:e,validateStatus:null});if(t.data===void 0)throw t.detail!==void 0?new Error(t.detail):new Error(`Failed to fetch ${n} domains:`+r);return t.data.filter(({uniprot_acc:i})=>i===n).map(({ted_id:i,chopping:s})=>({id:i,name:NT(i),domains:DT(s)}))}),FT=async n=>{const e=ie.experiments.find(({id:i})=>i===n);if(!e)return;const t=e?.proteins.map(({name:i})=>i);if(!t)return;const r=await sT({accessions:t});for(const i of e.proteins){const s=i.name,o=r.get(s);if(o){if(i.name=o.geneName??o.id,!i.sequence){const a=Id(i);(a.size===0||Ed(a,o.sequence,0,!0).success)&&(i.sequence=o.sequence)}if(!Jn(i.domains)){const a=await LT({accession:s}).catch(()=>{});a&&(i.domains=a.flatMap(({name:l,domains:c})=>c.map(({startPosition:u,endPosition:h},f)=>({name:l+(c.length>1?`-${X_(f+1)}`:""),startPosition:u,endPosition:h}))))}}}},zT=_.memo(function({experiment:{id:e,proteins:t},resolvedExperiment:{proteins:r,crosslinks:i},ref:s,...o}){const a=_.useMemo(()=>{const g=x=>({total:x.length,data:new Set(x)});return Object.fromEntries(t.map(({id:x,interProteinCrosslinks:b,intraProteinCrosslinks:y,homoMultimericCrosslinks:w},v)=>[x,{stats:{interprotein:g(b),intraprotein:g(y),homomultimeric:g(w)},domainNameToStats:Object.fromEntries(r[v].domains?.map(S=>{const k=r[v].id,P=[],C=[];for(const{id:T,from:A,to:M}of i){const O=A.proteinId===k&&uu(A.linkPosition,S),R=M.proteinId===k&&uu(M.linkPosition,S);!O&&!R||(O===R?C.push(T):P.push(T))}return[S.name,{interdomain:g(P),intradomain:g(C)}]})??[])}]))},[t,i,r]),{experimentIdToVisibleCrosslinkIds:l}=Je(ie),c=l[e],u=_.useMemo(()=>{const g=y=>y.intersection(c).size,x=y=>Bs(Object.entries(y).map(([w,{data:v,...S}])=>[w,{visible:g(v),data:v,...S}])),b={};for(const[y,{stats:w,domainNameToStats:v}]of Object.entries(a))b[y]={stats:x(w),domainNameToStats:Bs(Object.entries(v).map(([S,k])=>[S,x(k)]))};return b},[a,c]),h=_.useCallback((g,...x)=>za(e,g,x.length===1?x[0]:new Set(x.flatMap(b=>Array.from(b)))),[e]),[{loading:f},p]=lb(FT),m=_.useMemo(()=>t.length>0&&t.every(({name:g})=>es(g)),[t]);return d.jsxs(ft,{position:"relative",ref:s,...o,children:[(m||f)&&d.jsxs(ke,{my:5,colorPalette:"teal",onClick:()=>!f&&_.startTransition(()=>{p(e)}),w:"full",loading:f,loadingText:`Loading protein${t.length>1?"s":""} data from UniProt...`,children:[d.jsx(Vh,{}),"Load protein",t.length>1?"s":""," data from UniProt",d.jsx(Vh,{style:{transform:"rotateY(180deg)"}})]}),d.jsx(Re,{gapY:5,gapX:10,wrap:"wrap",children:t.map(g=>d.jsx(RT,{experimentId:e,protein:g,stats:u[g.id].stats,domainNameToStats:u[g.id].domainNameToStats,toggleVisibility:h,hideMultiProteinToggles:t.length===1,w:"30%",overflow:"clip",size:"sm"},g.id))})]})}),BT=_.memo(function({experimentId:e,structureToXlinkIdToStatus:t,allCrosslinkIds:r,visibleCrosslinkIds:i,unmappedCrosslinkIds:s,numOfDistanceConstraints:o,ref:a,...l}){const c=_.useMemo(()=>{if(Object.keys(t).length===0)return null;const p={};for(const m of Object.values(t))for(const[g,x]of Object.entries(m))g in p||(p[g]=new Set),x!==void 0&&p[g].add(x);return{missing:Object.entries(p).filter(([m,g])=>g.size===0).map(([m])=>m),appear:Object.entries(p).filter(([m,g])=>g.size>0).map(([m])=>m),withoutConflicts:Object.entries(p).filter(([m,g])=>!g.has("under")&&!g.has("over")).map(([m])=>m),withConflicts:Object.entries(p).filter(([m,g])=>g.has("under")||g.has("over")).map(([m])=>m)}},[t]),u=_.useCallback(p=>p?{loading:!1,visible:p.filter(m=>i.has(m)).length,total:p.length,onCheckedChange:({checked:m})=>za(e,m!==!1,new Set(p))}:{loading:!0,visible:void 0,total:void 0},[i,e]),h=_.useMemo(()=>{if(!(!s||s.size===0))return d.jsx(ar,{ms:6,name:"Not mapped to reference protein",info:"Crosslinks that one or both of their residues are not mapped to the reference protein",...u(Array.from(s))})},[s,u]),f=_.useMemo(()=>{if(c!==null)return o>0?d.jsxs(d.Fragment,{children:[d.jsx(ar,{ms:6,name:"Without any conflict",info:`Crosslinks that don't violate the distance constraint${o!==1?"s":""} in any of the structures`,...u(c.withoutConflicts)}),d.jsx(ar,{ms:12,name:"Missing in all structures",info:"Crosslinks that don't appear in any of the structures",...u(c.missing)}),d.jsx(ar,{ms:6,name:"With some conflicts",info:`Crosslinks that violate the distance constraint${o!==1?"s":""} in some of the structures`,...u(c.withConflicts)})]}):d.jsxs(d.Fragment,{children:[d.jsx(ar,{ms:6,name:"Missing in all structures",info:"Crosslinks that don't appear in any of the structures",...u(c.missing)}),d.jsx(ar,{ms:6,name:"Appear in all structures",info:"Crosslinks that appear in all of the structures",...u(c.appear)})]})},[c,u,o]);return d.jsxs(xo,{ref:a,...l,children:[d.jsx(ar,{name:"All crosslinks",visible:i.size,total:r.size,onCheckedChange:({checked:p})=>za(e,p!==!1,r)}),h,f]})}),HT=async(n,e)=>{const t=ie.structures.find(({id:r})=>r===n);if(!t)throw new Error("Structure not found");t.chainIdToProteinIdToMapping=e},VT=async(n,e,t,r)=>{const i=ie.structures.find(({id:l})=>l===n);if(!i)throw new Error("Structure not found");const s=i.chains.find(({id:l})=>l===e);if(!s)throw new Error("Chain not found in structure");const o=await hk(s,t,r);if(!o){let l=`Chain ${e} couldn't be mapped to `;throw t.sequence?l+=`the provided sequence of ${t.name}.`:l+=`${t.name}. Try adding a sequence to ${t.name} to perform sequence alignment.`,new Error(l)}let a=(()=>{let l=`${De(o.hits,"position")} matched (${Math.round(o.relativeHits*100)}% of ${t.name}'s positions)`;return o.alignmentScore&&(l+=`, alignment score is ${Math.round(o.alignmentScore*100)}%`),l+"."})();return fk([o])!==o&&(a="Note that this mapping might be wrong: "+a),i.chainIdToProteinIdToMapping[e].set(t.id,o.proteinPosToChainPos),{message:a,mapping:o}},WT=(n,e)=>{const t=ie.structures.find(r=>r.id===n);t&&Xg(t,e)},UT=(n,e,t)=>{const r=ie.structures.find(i=>i.id===n);r&&r.chainIdToProteinIdToMapping[e].delete(t)},qT=n=>{ie.structures=ie.structures.filter(({id:e})=>!n.includes(e));for(const{id:e}of ie.experiments)Bd(e,n)},XT=n=>{const e=te.c(9),{id:t}=n,{experimentIdToGroupedStructureIds:r}=Je(ie),i=r[t],s=i.some(GT),{structures:o}=Je(ie);let a;e:{if(!s){let h;e[0]===Symbol.for("react.memo_cache_sentinel")?(h=[],e[0]=h):h=e[0];let f;e[1]!==i?(f=[h,i],e[1]=i,e[2]=f):f=e[2],a=f;break e}let l;if(e[3]!==i||e[4]!==o){const h=i.flat(2);l=o.filter(f=>{const{id:p}=f;return h.includes(p)}),e[3]=i,e[4]=o,e[5]=l}else l=e[5];const c=l;let u;e[6]!==i||e[7]!==c?(u=[c,i],e[6]=i,e[7]=c,e[8]=u):u=e[8],a=u}return a};function GT(n){return n.length>0}const Mt=n=>{const e=te.c(24);let t,r,i,s,o,a,l;e[0]!==n?({startElement:a,endElement:r,onClose:i,closable:l,children:t,ref:s,...o}=n,e[0]=n,e[1]=t,e[2]=r,e[3]=i,e[4]=s,e[5]=o,e[6]=a,e[7]=l):(t=e[1],r=e[2],i=e[3],s=e[4],o=e[5],a=e[6],l=e[7]);const c=l===void 0?!!i:l;let u;e[8]!==a?(u=a&&d.jsx(SC,{children:a}),e[8]=a,e[9]=u):u=e[9];let h;e[10]!==t?(h=d.jsx(wC,{children:t}),e[10]=t,e[11]=h):h=e[11];let f;e[12]!==r?(f=r&&d.jsx(Kh,{children:r}),e[12]=r,e[13]=f):f=e[13];let p;e[14]!==c||e[15]!==i?(p=c&&d.jsx(Kh,{children:d.jsx(_C,{onClick:i})}),e[14]=c,e[15]=i,e[16]=p):p=e[16];let m;return e[17]!==s||e[18]!==o||e[19]!==u||e[20]!==h||e[21]!==f||e[22]!==p?(m=d.jsxs(vC,{ref:s,...o,children:[u,h,f,p]}),e[17]=s,e[18]=o,e[19]=u,e[20]=h,e[21]=f,e[22]=p,e[23]=m):m=e[23],m};function Hd(n){return ci({attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M221.69,199.77,160,96.92V40h8a8,8,0,0,0,0-16H88a8,8,0,0,0,0,16h8V96.92L34.31,199.77A16,16,0,0,0,48,224H208a16,16,0,0,0,13.72-24.23Zm-90.08-42.91c-15.91-8.05-31.05-12.32-45.22-12.81l24.47-40.8A7.93,7.93,0,0,0,112,99.14V40h32V99.14a7.93,7.93,0,0,0,1.14,4.11L183.36,167C171.4,169.34,154.29,168.34,131.61,156.86Z"},child:[]}]})(n)}function YT(n){return ci({attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M195.51,62.66,212.44,44A6,6,0,1,0,203.56,36L186.63,54.58A94,94,0,0,0,60.49,193.34L43.56,212A6,6,0,0,0,52.44,220l16.93-18.62A94,94,0,0,0,195.51,62.66ZM46,128A81.93,81.93,0,0,1,178.53,63.49L68.59,184.43A81.69,81.69,0,0,1,46,128Zm82,82a81.57,81.57,0,0,1-50.53-17.49L187.41,71.57A81.94,81.94,0,0,1,128,210Z"},child:[]}]})(n)}function ry(n){return ci({attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216,112v96a16,16,0,0,1-16,16H56a16,16,0,0,1-16-16V112A16,16,0,0,1,56,96H80a8,8,0,0,1,0,16H56v96H200V112H176a8,8,0,0,1,0-16h24A16,16,0,0,1,216,112ZM93.66,69.66,120,43.31V136a8,8,0,0,0,16,0V43.31l26.34,26.35a8,8,0,0,0,11.32-11.32l-40-40a8,8,0,0,0-11.32,0l-40,40A8,8,0,0,0,93.66,69.66Z"},child:[]}]})(n)}function iy(n){return ci({attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M221.69,199.77,160,96.92V40h8a8,8,0,0,0,0-16H88a8,8,0,0,0,0,16h8V96.92L34.31,199.77A16,16,0,0,0,48,224H208a16,16,0,0,0,13.72-24.23ZM110.86,103.25A7.93,7.93,0,0,0,112,99.14V40h32V99.14a7.93,7.93,0,0,0,1.14,4.11L183.36,167c-12,2.37-29.07,1.37-51.75-10.11-15.91-8.05-31.05-12.32-45.22-12.81ZM48,208l28.54-47.58c14.25-1.74,30.31,1.85,47.82,10.72,19,9.61,35,12.88,48,12.88a69.89,69.89,0,0,0,19.55-2.7L208,208Z"},child:[]}]})(n)}const Mf=(n,e)=>n===void 0?d.jsx(YT,{}):n==="ntd"?"N`":`${e??""}${n}`,Af=n=>{const e=te.c(6);let t,r;e[0]!==n?({hoverKey:t,...r}=n,e[0]=n,e[1]=t,e[2]=r):(t=e[1],r=e[2]);const i=`xlp${$i(t)}`;let s;return e[3]!==r||e[4]!==i?(s=d.jsx(Mt,{className:i,...r}),e[3]=r,e[4]=i,e[5]=s):s=e[5],s},Ef=n=>{const e=te.c(12),{proteinId:t,proteinName:r,domainName:i}=n;let s;e[0]!==i?(s=i?{borderRightRadius:0}:{},e[0]=i,e[1]=s):s=e[1];let o;e[2]!==t||e[3]!==r||e[4]!==s?(o=d.jsx(Af,{hoverKey:t,...s,children:r}),e[2]=t,e[3]=r,e[4]=s,e[5]=o):o=e[5];let a;e[6]!==i||e[7]!==t?(a=i&&d.jsx(Af,{hoverKey:t+i,borderLeftRadius:0,children:i}),e[6]=i,e[7]=t,e[8]=a):a=e[8];let l;return e[9]!==o||e[10]!==a?(l=d.jsxs(d.Fragment,{children:[o,a]}),e[9]=o,e[10]=a,e[11]=l):l=e[11],l},sy=_.memo(function(e){const t=te.c(59);let r,i,s,o,a,l,c,u,h;t[0]!==e?({rowHeader:c,groupHeader:s,field:i,checked:r,groupedChecked:o,toggle:u,toggleGroup:h,ref:a,...l}=e,t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=o,t[5]=a,t[6]=l,t[7]=c,t[8]=u,t[9]=h):(r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8],h=t[9]);const f=c.ids.flat().length>1,p=c.homoMultimeric.flat().filter(KT).length,m=p===c.ids.flat().length?"all":p>0?"some":"none";let g;t[10]!==s||t[11]!==o||t[12]!==h?(g=s&&d.jsxs("span",{style:{flexShrink:0,display:"flex",fontWeight:"bolder"},children:[o!==void 0&&d.jsx(Qn,{size:"xs",mx:2,checked:o,inputProps:{onClick:D=>{const{shiftKey:L}=D;return h?.(o!==!0,s,L)}},disabled:!h,visibility:h?void 0:"hidden"}),d.jsxs(Re,{onClick:D=>{const{shiftKey:L}=D;return h?.(o!==!0,s,L)},children:[d.jsx(Ef,{proteinId:s.fromProteinId,proteinName:s.fromProteinName,domainName:s.fromDomainName}),"-",d.jsx(Ef,{proteinId:s.toProteinId,proteinName:s.toProteinName,domainName:s.toDomainName})]})]}),t[10]=s,t[11]=o,t[12]=h,t[13]=g):g=t[13];let x;t[14]===Symbol.for("react.memo_cache_sentinel")?(x=d.jsx("div",{style:{minWidth:"10px",flexGrow:1}}),t[14]=x):x=t[14];const b=i?void 0:3;let y;t[15]!==r||t[16]!==c||t[17]!==u?(y={onClick:D=>{const{shiftKey:L}=D;return u?.(r!==!0,c,L)}},t[15]=r,t[16]=c,t[17]=u,t[18]=y):y=t[18];const w=!u,v=u?void 0:"hidden";let S;t[19]!==r||t[20]!==y||t[21]!==w||t[22]!==v?(S=d.jsx(Qn,{size:"xs",mx:2,checked:r,inputProps:y,disabled:w,visibility:v}),t[19]=r,t[20]=y,t[21]=w,t[22]=v,t[23]=S):S=t[23];let k;t[24]!==r||t[25]!==c||t[26]!==u?(k=D=>{const{shiftKey:L}=D;return u?.(r!==!0,c,L)},t[24]=r,t[25]=c,t[26]=u,t[27]=k):k=t[27];const P=c.fromPosition===void 0?.5:void 0;let C;t[28]!==c.fromAminoAcid||t[29]!==c.fromPosition?(C=Mf(c.fromPosition,c.fromAminoAcid),t[28]=c.fromAminoAcid,t[29]=c.fromPosition,t[30]=C):C=t[30];let T;t[31]!==C||t[32]!==P?(T=d.jsx(Mt,{opacity:P,children:C}),t[31]=C,t[32]=P,t[33]=T):T=t[33];const A=c.toPosition===void 0?.5:void 0;let M;t[34]!==c.toAminoAcid||t[35]!==c.toPosition?(M=Mf(c.toPosition,c.toAminoAcid),t[34]=c.toAminoAcid,t[35]=c.toPosition,t[36]=M):M=t[36];let O;t[37]!==A||t[38]!==M?(O=d.jsx(Mt,{opacity:A,children:M}),t[37]=A,t[38]=M,t[39]=O):O=t[39];let R;t[40]!==T||t[41]!==O||t[42]!==k?(R=d.jsxs(Re,{onClick:k,children:[T,"-",O]}),t[40]=T,t[41]=O,t[42]=k,t[43]=R):R=t[43];let j;t[44]!==R||t[45]!==b||t[46]!==S?(j=d.jsxs(Re,{flexShrink:0,mr:b,children:[S,R]}),t[44]=R,t[45]=b,t[46]=S,t[47]=j):j=t[47];let I;t[48]!==i||t[49]!==f||t[50]!==m||t[51]!==c?(I=i&&d.jsx(rt,{ml:5,mr:3,fontFamily:"mono",fontSize:"2xs",minW:"8",textAlign:"right",children:c[i].length===1&&d.jsxs(d.Fragment,{children:[m==="all"&&"M ",m==="some"&&d.jsx("span",{style:{color:"gray"},children:"m "}),c[i][0][0],f?"..":""]})}),t[48]=i,t[49]=f,t[50]=m,t[51]=c,t[52]=I):I=t[52];let E;return t[53]!==a||t[54]!==l||t[55]!==g||t[56]!==j||t[57]!==I?(E=d.jsxs(Re,{minW:"fit-content",justify:"space-between",align:"baseline",wrap:"nowrap",whiteSpace:"nowrap",ref:a,...l,children:[g,x,j,I]}),t[53]=a,t[54]=l,t[55]=g,t[56]=j,t[57]=I,t[58]=E):E=t[58],E});function KT(n){return n===!0}function gi(n,e,t){let r=t.initialDeps??[],i;function s(){var o,a,l,c;let u;t.key&&((o=t.debug)!=null&&o.call(t))&&(u=Date.now());const h=n();if(!(h.length!==r.length||h.some((m,g)=>r[g]!==m)))return i;r=h;let p;if(t.key&&((a=t.debug)!=null&&a.call(t))&&(p=Date.now()),i=e(...h),t.key&&((l=t.debug)!=null&&l.call(t))){const m=Math.round((Date.now()-u)*100)/100,g=Math.round((Date.now()-p)*100)/100,x=g/16,b=(y,w)=>{for(y=String(y);y.length<w;)y=" "+y;return y};console.info(`%c ${b(g,5)} /${b(m,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*x,120))}deg 100% 31%);`,t?.key)}return(c=t?.onChange)==null||c.call(t,i),i}return s.updateDeps=o=>{r=o},s}function If(n,e){if(n===void 0)throw new Error("Unexpected undefined");return n}const ZT=(n,e)=>Math.abs(n-e)<1.01,oy=(n,e,t)=>{let r;return function(...i){n.clearTimeout(r),r=n.setTimeout(()=>e.apply(this,i),t)}},Rf=n=>{const{offsetWidth:e,offsetHeight:t}=n;return{width:e,height:t}},JT=n=>n,Vd=n=>{const e=Math.max(n.startIndex-n.overscan,0),t=Math.min(n.endIndex+n.overscan,n.count-1),r=[];for(let i=e;i<=t;i++)r.push(i);return r},QT=(n,e)=>{const t=n.scrollElement;if(!t)return;const r=n.targetWindow;if(!r)return;const i=o=>{const{width:a,height:l}=o;e({width:Math.round(a),height:Math.round(l)})};if(i(Rf(t)),!r.ResizeObserver)return()=>{};const s=new r.ResizeObserver(o=>{const a=()=>{const l=o[0];if(l?.borderBoxSize){const c=l.borderBoxSize[0];if(c){i({width:c.inlineSize,height:c.blockSize});return}}i(Rf(t))};n.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(a):a()});return s.observe(t,{box:"border-box"}),()=>{s.unobserve(t)}},Gs={passive:!0},eM=(n,e)=>{const t=n.scrollElement;if(!t)return;const r=()=>{e({width:t.innerWidth,height:t.innerHeight})};return r(),t.addEventListener("resize",r,Gs),()=>{t.removeEventListener("resize",r)}},Ba=typeof window>"u"?!0:"onscrollend"in window,tM=(n,e)=>{const t=n.scrollElement;if(!t)return;const r=n.targetWindow;if(!r)return;let i=0;const s=n.options.useScrollendEvent&&Ba?()=>{}:oy(r,()=>{e(i,!1)},n.options.isScrollingResetDelay),o=u=>()=>{const{horizontal:h,isRtl:f}=n.options;i=h?t.scrollLeft*(f&&-1||1):t.scrollTop,s(),e(i,u)},a=o(!0),l=o(!1);l(),t.addEventListener("scroll",a,Gs);const c=n.options.useScrollendEvent&&Ba;return c&&t.addEventListener("scrollend",l,Gs),()=>{t.removeEventListener("scroll",a),c&&t.removeEventListener("scrollend",l)}},nM=(n,e)=>{const t=n.scrollElement;if(!t)return;const r=n.targetWindow;if(!r)return;let i=0;const s=n.options.useScrollendEvent&&Ba?()=>{}:oy(r,()=>{e(i,!1)},n.options.isScrollingResetDelay),o=u=>()=>{i=t[n.options.horizontal?"scrollX":"scrollY"],s(),e(i,u)},a=o(!0),l=o(!1);l(),t.addEventListener("scroll",a,Gs);const c=n.options.useScrollendEvent&&Ba;return c&&t.addEventListener("scrollend",l,Gs),()=>{t.removeEventListener("scroll",a),c&&t.removeEventListener("scrollend",l)}},rM=(n,e,t)=>{if(e?.borderBoxSize){const r=e.borderBoxSize[0];if(r)return Math.round(r[t.options.horizontal?"inlineSize":"blockSize"])}return n[t.options.horizontal?"offsetWidth":"offsetHeight"]},iM=(n,{adjustments:e=0,behavior:t},r)=>{var i,s;const o=n+e;(s=(i=r.scrollElement)==null?void 0:i.scrollTo)==null||s.call(i,{[r.options.horizontal?"left":"top"]:o,behavior:t})},sM=(n,{adjustments:e=0,behavior:t},r)=>{var i,s;const o=n+e;(s=(i=r.scrollElement)==null?void 0:i.scrollTo)==null||s.call(i,{[r.options.horizontal?"left":"top"]:o,behavior:t})};class oM{constructor(e){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let t=null;const r=()=>t||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:t=new this.targetWindow.ResizeObserver(i=>{i.forEach(s=>{const o=()=>{this._measureElement(s.target,s)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()})}));return{disconnect:()=>{var i;(i=r())==null||i.disconnect(),t=null},observe:i=>{var s;return(s=r())==null?void 0:s.observe(i,{box:"border-box"})},unobserve:i=>{var s;return(s=r())==null?void 0:s.unobserve(i)}}})(),this.range=null,this.setOptions=t=>{Object.entries(t).forEach(([r,i])=>{typeof i>"u"&&delete t[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:JT,rangeExtractor:Vd,onChange:()=>{},measureElement:rM,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...t}},this.notify=t=>{var r,i;(i=(r=this.options).onChange)==null||i.call(r,this,t)},this.maybeNotify=gi(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),t=>{this.notify(t)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(t=>t()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var t;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((t=this.scrollElement)==null?void 0:t.window)??null,this.elementsCache.forEach(i=>{this.observer.observe(i)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,i=>{this.scrollRect=i,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(i,s)=>{this.scrollAdjustments=0,this.scrollDirection=s?this.getScrollOffset()<i?"forward":"backward":null,this.scrollOffset=i,this.isScrolling=s,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(t,r)=>{const i=new Map,s=new Map;for(let o=r-1;o>=0;o--){const a=t[o];if(i.has(a.lane))continue;const l=s.get(a.lane);if(l==null||a.end>l.end?s.set(a.lane,a):a.end<l.end&&i.set(a.lane,!0),i.size===this.options.lanes)break}return s.size===this.options.lanes?Array.from(s.values()).sort((o,a)=>o.end===a.end?o.index-a.index:o.end-a.end)[0]:void 0},this.getMeasurementOptions=gi(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(t,r,i,s,o)=>(this.pendingMeasuredCacheIndexes=[],{count:t,paddingStart:r,scrollMargin:i,getItemKey:s,enabled:o}),{key:!1}),this.getMeasurements=gi(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:t,paddingStart:r,scrollMargin:i,getItemKey:s,enabled:o},a)=>{if(!o)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(u=>{this.itemSizeCache.set(u.key,u.size)}));const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const c=this.measurementsCache.slice(0,l);for(let u=l;u<t;u++){const h=s(u),f=this.options.lanes===1?c[u-1]:this.getFurthestMeasurement(c,u),p=f?f.end+this.options.gap:r+i,m=a.get(h),g=typeof m=="number"?m:this.options.estimateSize(u),x=p+g,b=f?f.lane:u%this.options.lanes;c[u]={index:u,start:p,size:g,end:x,key:h,lane:b}}return this.measurementsCache=c,c},{key:!1,debug:()=>this.options.debug}),this.calculateRange=gi(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(t,r,i,s)=>this.range=t.length>0&&r>0?aM({measurements:t,outerSize:r,scrollOffset:i,lanes:s}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=gi(()=>{let t=null,r=null;const i=this.calculateRange();return i&&(t=i.startIndex,r=i.endIndex),this.maybeNotify.updateDeps([this.isScrolling,t,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,t,r]},(t,r,i,s,o)=>s===null||o===null?[]:t({startIndex:s,endIndex:o,overscan:r,count:i}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=t=>{const r=this.options.indexAttribute,i=t.getAttribute(r);return i?parseInt(i,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(t,r)=>{const i=this.indexFromElement(t),s=this.measurementsCache[i];if(!s)return;const o=s.key,a=this.elementsCache.get(o);a!==t&&(a&&this.observer.unobserve(a),this.observer.observe(t),this.elementsCache.set(o,t)),t.isConnected&&this.resizeItem(i,this.options.measureElement(t,r,this))},this.resizeItem=(t,r)=>{const i=this.measurementsCache[t];if(!i)return;const s=this.itemSizeCache.get(i.key)??i.size,o=r-s;o!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(i,o,this):i.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=o,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(i.index),this.itemSizeCache=new Map(this.itemSizeCache.set(i.key,r)),this.notify(!1))},this.measureElement=t=>{if(!t){this.elementsCache.forEach((r,i)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(i))});return}this._measureElement(t,void 0)},this.getVirtualItems=gi(()=>[this.getVirtualIndexes(),this.getMeasurements()],(t,r)=>{const i=[];for(let s=0,o=t.length;s<o;s++){const a=t[s],l=r[a];i.push(l)}return i},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=t=>{const r=this.getMeasurements();if(r.length!==0)return If(r[ay(0,r.length-1,i=>If(r[i]).start,t)])},this.getOffsetForAlignment=(t,r,i=0)=>{const s=this.getSize(),o=this.getScrollOffset();r==="auto"&&(r=t>=o+s?"end":"start"),r==="center"?t+=(i-s)/2:r==="end"&&(t-=s);const a=this.getTotalSize()+this.options.scrollMargin-s;return Math.max(Math.min(a,t),0)},this.getOffsetForIndex=(t,r="auto")=>{t=Math.max(0,Math.min(t,this.options.count-1));const i=this.measurementsCache[t];if(!i)return;const s=this.getSize(),o=this.getScrollOffset();if(r==="auto")if(i.end>=o+s-this.options.scrollPaddingEnd)r="end";else if(i.start<=o+this.options.scrollPaddingStart)r="start";else return[o,r];const a=r==="end"?i.end+this.options.scrollPaddingEnd:i.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(a,r,i.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.scrollToOffset=(t,{align:r="start",behavior:i}={})=>{i==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(t,r),{adjustments:void 0,behavior:i})},this.scrollToIndex=(t,{align:r="auto",behavior:i}={})=>{i==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),t=Math.max(0,Math.min(t,this.options.count-1));let s=0;const o=10,a=c=>{if(!this.targetWindow)return;const u=this.getOffsetForIndex(t,c);if(!u){console.warn("Failed to get offset for index:",t);return}const[h,f]=u;this._scrollToOffset(h,{adjustments:void 0,behavior:i}),this.targetWindow.requestAnimationFrame(()=>{const p=this.getScrollOffset(),m=this.getOffsetForIndex(t,f);if(!m){console.warn("Failed to get offset for index:",t);return}ZT(m[0],p)||l(f)})},l=c=>{this.targetWindow&&(s++,s<o?this.targetWindow.requestAnimationFrame(()=>a(c)):console.warn(`Failed to scroll to index ${t} after ${o} attempts.`))};a(r)},this.scrollBy=(t,{behavior:r}={})=>{r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+t,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var t;const r=this.getMeasurements();let i;if(r.length===0)i=this.options.paddingStart;else if(this.options.lanes===1)i=((t=r[r.length-1])==null?void 0:t.end)??0;else{const s=Array(this.options.lanes).fill(null);let o=r.length-1;for(;o>=0&&s.some(a=>a===null);){const a=r[o];s[a.lane]===null&&(s[a.lane]=a.end),o--}i=Math.max(...s.filter(a=>a!==null))}return Math.max(i-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(t,{adjustments:r,behavior:i})=>{this.options.scrollToFn(t,{behavior:i,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(e)}}const ay=(n,e,t,r)=>{for(;n<=e;){const i=(n+e)/2|0,s=t(i);if(s<r)n=i+1;else if(s>r)e=i-1;else return i}return n>0?n-1:0};function aM({measurements:n,outerSize:e,scrollOffset:t,lanes:r}){const i=n.length-1,s=l=>n[l].start;if(n.length<=r)return{startIndex:0,endIndex:i};let o=ay(0,i,s,t),a=o;if(r===1)for(;a<i&&n[a].end<t+e;)a++;else if(r>1){const l=Array(r).fill(0);for(;a<i&&l.some(u=>u<t+e);){const u=n[a];l[u.lane]=u.end,a++}const c=Array(r).fill(t+e);for(;o>=0&&c.some(u=>u>=t);){const u=n[o];c[u.lane]=u.start,o--}o=Math.max(0,o-o%r),a=Math.min(i,a+(r-1-a%r))}return{startIndex:o,endIndex:a}}const Of=typeof document<"u"?_.useLayoutEffect:_.useEffect;function ly(n){const e=_.useReducer(()=>({}),{})[1],t={...n,onChange:(i,s)=>{var o;s?G_.flushSync(e):e(),(o=n.onChange)==null||o.call(n,i,s)}},[r]=_.useState(()=>new oM(t));return r.setOptions(t),Of(()=>r._didMount(),[]),Of(()=>r._willUpdate()),r}function cy(n){return ly({observeElementRect:QT,observeElementOffset:tM,scrollToFn:sM,...n})}function uy(n){return ly({getScrollElement:()=>typeof document<"u"?window:null,observeElementRect:eM,observeElementOffset:nM,scrollToFn:iM,initialOffset:()=>typeof document<"u"?window.scrollY:0,...n})}const Vl=_.forwardRef(function(e,t){const r=te.c(13);let i,s,o,a;r[0]!==e?({children:i,portalled:a,portalRef:s,...o}=e,r[0]=e,r[1]=i,r[2]=s,r[3]=o,r[4]=a):(i=r[1],s=r[2],o=r[3],a=r[4]);const c=!(a===void 0?!0:a);let u;r[5]!==i||r[6]!==t||r[7]!==o?(u=d.jsx(DS,{children:d.jsx(NS,{ref:t,...o,asChild:!1,children:i})}),r[5]=i,r[6]=t,r[7]=o,r[8]=u):u=r[8];let h;return r[9]!==s||r[10]!==c||r[11]!==u?(h=d.jsx(Cr,{disabled:c,container:s,children:u}),r[9]=s,r[10]=c,r[11]=u,r[12]=h):h=r[12],h}),Wl=_.forwardRef(function(e,t){const r=te.c(4);let i;r[0]===Symbol.for("react.memo_cache_sentinel")?(i=d.jsx(lo,{size:"sm"}),r[0]=i):i=r[0];let s;return r[1]!==e||r[2]!==t?(s=d.jsx(zS,{...e,asChild:!0,ref:t,children:i}),r[1]=e,r[2]=t,r[3]=s):s=r[3],s}),Ul=$S,ql=FS,Ni=LS;function lM(n){return ci({attr:{viewBox:"0 0 32 32"},child:[{tag:"path",attr:{d:"M 5 5 L 5 9 L 6 9 L 6 23 L 5 23 L 5 27 L 9 27 L 9 26 L 23 26 L 23 27 L 27 27 L 27 23 L 26 23 L 26 9 L 27 9 L 27 5 L 23 5 L 23 6 L 9 6 L 9 5 Z M 9 8 L 23 8 L 23 9 L 24 9 L 24 23 L 23 23 L 23 24 L 9 24 L 9 23 L 8 23 L 8 9 L 9 9 Z M 10 10 L 10 18 L 14 18 L 14 22 L 22 22 L 22 14 L 18 14 L 18 10 Z M 12 12 L 16 12 L 16 16 L 12 16 Z M 18 16 L 20 16 L 20 20 L 16 20 L 16 18 L 18 18 Z"},child:[]}]})(n)}const cM=_.memo(function(e){const t=te.c(28);let r,i,s,o,a,l,c;t[0]!==e?({experimentId:i,structure:c,checked:r,onToggle:o,onClick:s,ref:a,...l}=e,t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=o,t[5]=a,t[6]=l,t[7]=c):(r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7]);const{id:u,name:h}=c;let f;t[8]!==r||t[9]!==i||t[10]!==o||t[11]!==u?(f={onClick:w=>{const{shiftKey:v}=w;return o?.(!r,i,u,v)}},t[8]=r,t[9]=i,t[10]=o,t[11]=u,t[12]=f):f=t[12];const p=!o,m=o?void 0:"hidden";let g;t[13]!==r||t[14]!==f||t[15]!==p||t[16]!==m?(g=d.jsx(Qn,{size:"xs",inputProps:f,disabled:p,visibility:m,checked:r}),t[13]=r,t[14]=f,t[15]=p,t[16]=m,t[17]=g):g=t[17];let x;t[18]!==h?(x=Dg(h,15),t[18]=h,t[19]=x):x=t[19];let b;t[20]!==s||t[21]!==x?(b=d.jsx(ke,{variant:"ghost",size:"2xs",writingMode:"vertical-lr",minH:"fit",flexGrow:1,justifyContent:"end",onClick:s,children:x}),t[20]=s,t[21]=x,t[22]=b):b=t[22];let y;return t[23]!==a||t[24]!==l||t[25]!==g||t[26]!==b?(y=d.jsxs(Re,{flexDir:"column",h:"100%",justifyContent:"space-between",alignItems:"center",gap:3,ref:a,...l,children:[g,b]}),t[23]=a,t[24]=l,t[25]=g,t[26]=b,t[27]=y):y=t[27],y}),fr=_.forwardRef(function(e,t){const r=te.c(11);let i,s,o;r[0]!==e?({portalled:o,portalRef:i,...s}=e,r[0]=e,r[1]=i,r[2]=s,r[3]=o):(i=r[1],s=r[2],o=r[3]);const l=!(o===void 0?!0:o);let c;r[4]!==t||r[5]!==s?(c=d.jsx(vo,{children:d.jsx(wo,{ref:t,...s})}),r[4]=t,r[5]=s,r[6]=c):c=r[6];let u;return r[7]!==i||r[8]!==l||r[9]!==c?(u=d.jsx(Cr,{disabled:l,container:i,children:c}),r[7]=i,r[8]=l,r[9]=c,r[10]=u):u=r[10],u});_.forwardRef(function(e,t){const r=te.c(4);let i;r[0]===Symbol.for("react.memo_cache_sentinel")?(i=d.jsx(F1,{}),r[0]=i):i=r[0];let s;return r[1]!==e||r[2]!==t?(s=d.jsx(AP,{ref:t,...e,children:i}),r[1]=e,r[2]=t,r[3]=s):s=r[3],s});const Mi=_.forwardRef(function(e,t){const r=te.c(4);let i;r[0]===Symbol.for("react.memo_cache_sentinel")?(i=d.jsx(id,{axis:"horizontal",insetStart:"4",asChild:!0,children:d.jsx(un,{children:d.jsx(ad,{})})}),r[0]=i):i=r[0];let s;return r[1]!==e||r[2]!==t?(s=d.jsxs(B1,{ps:"8",ref:t,...e,children:[i,e.children]}),r[1]=e,r[2]=t,r[3]=s):s=r[3],s}),Ai=_.forwardRef(function(e,t){const r=te.c(10);let i,s;r[0]!==e?({children:i,...s}=e,r[0]=e,r[1]=i,r[2]=s):(i=r[1],s=r[2]);let o;r[3]===Symbol.for("react.memo_cache_sentinel")?(o=d.jsx(id,{axis:"horizontal",insetStart:"4",asChild:!0,children:d.jsx(un,{children:d.jsx(ad,{})})}),r[3]=o):o=r[3];let a;r[4]!==i?(a=d.jsx(IP,{children:i}),r[4]=i,r[5]=a):a=r[5];let l;return r[6]!==t||r[7]!==s||r[8]!==a?(l=d.jsxs(qn,{ps:"8",ref:t,...s,children:[o,a]}),r[6]=t,r[7]=s,r[8]=a,r[9]=l):l=r[9],l}),uM=_.forwardRef(function(e,t){const r=te.c(11);let i,s,o;r[0]!==e?({title:o,children:i,...s}=e,r[0]=e,r[1]=i,r[2]=s,r[3]=o):(i=r[1],s=r[2],o=r[3]);let a;r[4]!==o?(a=o&&d.jsx(ji,{userSelect:"none",children:o}),r[4]=o,r[5]=a):a=r[5];let l;return r[6]!==i||r[7]!==t||r[8]!==s||r[9]!==a?(l=d.jsxs(z1,{ref:t,...s,children:[a,i]}),r[6]=i,r[7]=t,r[8]=s,r[9]=a,r[10]=l):l=r[10],l}),Cc=_.forwardRef(function(e,t){const r=te.c(10);let i,s,o;r[0]!==e?({startIcon:o,children:i,...s}=e,r[0]=e,r[1]=i,r[2]=s,r[3]=o):(i=r[1],s=r[2],o=r[3]);let a;r[4]===Symbol.for("react.memo_cache_sentinel")?(a=d.jsx(Y_,{}),r[4]=a):a=r[4];let l;return r[5]!==i||r[6]!==t||r[7]!==s||r[8]!==o?(l=d.jsxs(EP,{ref:t,...s,children:[o,i,a]}),r[5]=i,r[6]=t,r[7]=s,r[8]=o,r[9]=l):l=r[9],l}),yu=H1,dM=MP,pr=bo,Ei=ba,tn=Ea,Fr=yo,dy=_.memo(function({field:e,onFieldClick:t,viewName:r,experiments:i,groupedCrosslinkIds:s,disableMenus:o,exportFigureDialog:a,showingStructures:l,ref:c,...u}){const h=ie?Math.min(...i.map(({id:b})=>ie.experimentIdToGroupedStructureIds[b].flat().length)):void 0,f=h&&h>2?Math.min(3,h-1):void 0,p=i.some(({id:b})=>ie.experimentIdToGroupedStructureIds[b].filter(y=>y.length>0).length>1),m=_.useCallback(()=>{i.forEach((b,y)=>{const w=ie.experimentIdToGroupedStructureIds[b.id].flat(),v=Da(ie.structures.filter(({id:k})=>w.includes(k)),b.crosslinks,ie.aminoAcidsMustMatch,ie.experimentIdToThresholds[b.id]),S={};for(const k of w){const P=s.flatMap(({rows:M})=>M.map(O=>O.ids[y][0])).map(M=>v[k][M]),C=Object.fromEntries(Object.entries(Object.groupBy(P,M=>M??"unmapped")).map(([M,O])=>[M,O?.length??0])),A=["ok","below","above","unmapped"].map(M=>(C[M]??0).toString().padStart(5,"0")).join("")+P.map(M=>{switch(M){case"over":return"+";case"ok":return"V";case"under":return"-";case void 0:return" "}}).join("");A in S||(S[A]=[]),S[A].push(k)}Pc(b.id,Object.keys(S).toSorted((k,P)=>P.localeCompare(k)).map(k=>S[k]))})},[i,s]),g=_.useCallback(()=>{f&&K_(async()=>{const{kmeans:b}=await import("./kmeans-BT0PiHSU.js");return{kmeans:b}},__vite__mapDeps([0,1,2])).then(({kmeans:b})=>{i.forEach((y,w)=>{const v=ie.experimentIdToGroupedStructureIds[y.id].flat(),S=Da(ie.structures.filter(({id:P})=>v.includes(P)),y.crosslinks,ie.aminoAcidsMustMatch,ie.experimentIdToThresholds[y.id]),{clusters:k}=b(v.map(P=>s.flatMap(({rows:C})=>C.map(T=>T.ids[w][0])).map(C=>{switch(S[P][C]){case"over":return 10;case"ok":return 0;case"under":return-10;case void 0:return-500}})),f,{});Pc(y.id,Array.from(new Array(f)).map((P,C)=>v.filter((T,A)=>k[A]===C)))})})},[f,i,s]),x=_.useCallback(()=>i.forEach(({id:b})=>Pc(b,[ie.experimentIdToGroupedStructureIds[b].flat()])),[i]);return d.jsxs(Re,{h:"100%",flexDirection:"column",justify:"space-between",ref:c,...u,children:[d.jsxs(Re,{my:3,gap:2,children:[d.jsxs(pr,{size:"sm",positioning:{gutter:2},onSelect:({value:b})=>b==="figure"?a?.setOpen(!0):b==="table"?$l(Ol(i,s),`${r}-xlinks`):null,children:[d.jsx(Fr,{asChild:!0,children:d.jsxs(ke,{size:"2xs",variant:"outline",disabled:o,children:[d.jsx(ry,{}),"Export"]})}),d.jsxs(fr,{children:[d.jsxs(tn,{value:"figure",disabled:!a,children:[d.jsx(Ng,{}),"Figure..."]}),d.jsxs(tn,{value:"table",children:[d.jsx(Lg,{}),"Crosslink Table"]})]})]}),l&&d.jsxs(pr,{size:"sm",positioning:{gutter:2},onSelect:({value:b})=>b==="kmeans"?g():b==="identical"?m():b==="ungroup"?x():null,children:[d.jsx(Fr,{asChild:!0,children:d.jsxs(ke,{size:"2xs",variant:"outline",disabled:o,children:[d.jsx(Z_,{}),"Structures"]})}),d.jsxs(fr,{children:[d.jsxs(uM,{children:[d.jsx(ji,{fontSize:"xs",userSelect:"none",cursor:"default",children:"Group structures by"}),d.jsxs(tn,{value:"identical",disabled:(h??0)<2,children:[d.jsx(J_,{}),"Identical Crosslinking Pattern"]}),d.jsxs(tn,{value:"kmeans",disabled:!f,children:[d.jsx(Q_,{}),d.jsx(rt,{fontStyle:"italic",marginRight:-1,children:"k"}),"-means",f?` (${De(f,"cluster")})`:null]})]}),d.jsx(Ei,{}),d.jsxs(tn,{value:"ungroup",disabled:!p,children:[d.jsx(e2,{}),"Ungroup"]})]})]})]}),d.jsxs(Re,{minW:"fit-content",justify:"space-between",align:"baseline",wrap:"nowrap",whiteSpace:"nowrap",py:3,opacity:0,_hover:{opacity:1},transition:"opacity 0.2s",mr:e?void 0:3,children:[d.jsxs("span",{style:{flexShrink:0,display:"flex",fontWeight:"bolder"},children:[d.jsx(Mt,{children:"From"}),"-",d.jsx(Mt,{children:"To"})]}),d.jsx("div",{style:{minWidth:"10px",flexGrow:1}}),d.jsxs("span",{style:{flexShrink:0,display:"flex"},children:[d.jsx(Mt,{children:"From"}),"-",d.jsx(Mt,{children:"To"})]}),e&&(t?d.jsx(ke,{size:"2xs",fontSize:"2xs",ml:2,mr:3,minW:"12",px:1,fontFamily:"mono",onClick:t,children:e}):d.jsx(rt,{ml:5,mr:3,fontFamily:"mono",fontSize:"2xs",minW:"7",textAlign:"right",children:e}))]})]})}),hM="_weak_1r16j_1",kc={weak:hM},hy=_.forwardRef(function(e,t){const r=te.c(5);let i;r[0]===Symbol.for("react.memo_cache_sentinel")?(i=d.jsx(ad,{}),r[0]=i):i=r[0];let s;r[1]===Symbol.for("react.memo_cache_sentinel")?(s=d.jsx(t2,{}),r[1]=s):s=r[1];let o;return r[2]!==e||r[3]!==t?(o=d.jsx(gd,{copied:i,...e,ref:t,children:s}),r[2]=e,r[3]=t,r[4]=o):o=r[4],o}),Wd=_.forwardRef(function(e,t){const r=te.c(3);let i;return r[0]!==e||r[1]!==t?(i=d.jsx(gd,{copied:"Copied",...e,ref:t,children:"Copy"}),r[0]=e,r[1]=t,r[2]=i):i=r[2],i});_.forwardRef(function(e,t){const r=te.c(3);let i;return r[0]!==e||r[1]!==t?(i=d.jsx(nP,{textStyle:"sm",fontWeight:"medium",display:"inline-block",mb:"1",...e,ref:t}),r[0]=e,r[1]=t,r[2]=i):i=r[2],i});_.forwardRef(function(e,t){const r=te.c(5);let i,s;r[0]===Symbol.for("react.memo_cache_sentinel")?(i=d.jsx(hy,{}),s=d.jsx(Wd,{}),r[0]=i,r[1]=s):(i=r[0],s=r[1]);let o;return r[2]!==e||r[3]!==t?(o=d.jsx(md,{asChild:!0,children:d.jsxs(co,{ref:t,size:"sm",variant:"surface",...e,children:[i,s]})}),r[2]=e,r[3]=t,r[4]=o):o=r[4],o});_.forwardRef(function(e,t){const r=te.c(5);let i,s;r[0]===Symbol.for("react.memo_cache_sentinel")?(i=d.jsx(n2,{}),s=d.jsx(Wd,{}),r[0]=i,r[1]=s):(i=r[0],s=r[1]);let o;return r[2]!==e||r[3]!==t?(o=d.jsx(md,{asChild:!0,children:d.jsxs(co,{unstyled:!0,variant:"plain",size:"xs",display:"inline-flex",alignItems:"center",gap:"2",ref:t,...e,children:[i,s]})}),r[2]=e,r[3]=t,r[4]=o):o=r[4],o});const fM=_.forwardRef(function(e,t){const r=te.c(5);let i,s;r[0]===Symbol.for("react.memo_cache_sentinel")?(i=d.jsx(hy,{}),s=d.jsx(Wd,{srOnly:!0}),r[0]=i,r[1]=s):(i=r[0],s=r[1]);let o;return r[2]!==e||r[3]!==t?(o=d.jsx(md,{asChild:!0,children:d.jsxs(mt,{ref:t,size:"xs",variant:"subtle",...e,children:[i,s]})}),r[2]=e,r[3]=t,r[4]=o):o=r[4],o});_.forwardRef(function(e,t){const r=te.c(3);let i;return r[0]!==e||r[1]!==t?(i=d.jsx(tP,{asChild:!0,children:d.jsx(ki,{ref:t,...e})}),r[0]=e,r[1]=t,r[2]=i):i=r[2],i});const pM=eP;function mM({pae:n,chainIdToResidueIdToIndex:e},t,r,i,s){const o=e[t]?.[r],a=e[i]?.[s];if(!(o===void 0||a===void 0))return((n[o]?.[a]??0)+(n[a]?.[o]??0))/2}function _a(n,e){return n==null||e==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function gM(n,e){return n==null||e==null?NaN:e<n?-1:e>n?1:e>=n?0:NaN}function fy(n){let e,t,r;n.length!==2?(e=_a,t=(a,l)=>_a(n(a),l),r=(a,l)=>n(a)-l):(e=n===_a||n===gM?n:xM,t=n,r=n);function i(a,l,c=0,u=a.length){if(c<u){if(e(l,l)!==0)return u;do{const h=c+u>>>1;t(a[h],l)<0?c=h+1:u=h}while(c<u)}return c}function s(a,l,c=0,u=a.length){if(c<u){if(e(l,l)!==0)return u;do{const h=c+u>>>1;t(a[h],l)<=0?c=h+1:u=h}while(c<u)}return c}function o(a,l,c=0,u=a.length){const h=i(a,l,c,u-1);return h>c&&r(a[h-1],l)>-r(a[h],l)?h-1:h}return{left:i,center:o,right:s}}function xM(){return 0}function bM(n){return n===null?NaN:+n}const yM=fy(_a),Ud=yM.right;fy(bM).center;function vM(n,e){let t=0;for(let r of n)r!=null&&(r=+r)>=r&&++t;return t}function jc(n,e){let t,r;if(e===void 0)for(const i of n)i!=null&&(t===void 0?i>=i&&(t=r=i):(t>i&&(t=i),r<i&&(r=i)));else{let i=-1;for(let s of n)(s=e(s,++i,n))!=null&&(t===void 0?s>=s&&(t=r=s):(t>s&&(t=s),r<s&&(r=s)))}return[t,r]}function wM(n){return n}var _M=Array.prototype,SM=_M.slice;function Tc(n){return()=>n}const PM=Math.sqrt(50),CM=Math.sqrt(10),kM=Math.sqrt(2);function Ha(n,e,t){const r=(e-n)/Math.max(0,t),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),o=s>=PM?10:s>=CM?5:s>=kM?2:1;let a,l,c;return i<0?(c=Math.pow(10,-i)/o,a=Math.round(n*c),l=Math.round(e*c),a/c<n&&++a,l/c>e&&--l,c=-c):(c=Math.pow(10,i)*o,a=Math.round(n/c),l=Math.round(e/c),a*c<n&&++a,l*c>e&&--l),l<a&&.5<=t&&t<2?Ha(n,e,t*2):[a,l,c]}function qd(n,e,t){if(e=+e,n=+n,t=+t,!(t>0))return[];if(n===e)return[n];const r=e<n,[i,s,o]=r?Ha(e,n,t):Ha(n,e,t);if(!(s>=i))return[];const a=s-i+1,l=new Array(a);if(r)if(o<0)for(let c=0;c<a;++c)l[c]=(s-c)/-o;else for(let c=0;c<a;++c)l[c]=(s-c)*o;else if(o<0)for(let c=0;c<a;++c)l[c]=(i+c)/-o;else for(let c=0;c<a;++c)l[c]=(i+c)*o;return l}function Li(n,e,t){return e=+e,n=+n,t=+t,Ha(n,e,t)[2]}function jM(n,e,t){e=+e,n=+n,t=+t;const r=e<n,i=r?Li(e,n,t):Li(n,e,t);return(r?-1:1)*(i<0?1/-i:i)}function TM(n,e,t){let r;for(;;){const i=Li(n,e,t);if(i===r||i===0||!isFinite(i))return[n,e];i>0?(n=Math.floor(n/i)*i,e=Math.ceil(e/i)*i):i<0&&(n=Math.ceil(n*i)/i,e=Math.floor(e*i)/i),r=i}}function MM(n){return Math.max(1,Math.ceil(Math.log(vM(n))/Math.LN2)+1)}function AM(){var n=wM,e=jc,t=MM;function r(i){Array.isArray(i)||(i=Array.from(i));var s,o=i.length,a,l,c=new Array(o);for(s=0;s<o;++s)c[s]=n(i[s],s,i);var u=e(c),h=u[0],f=u[1],p=t(c,h,f);if(!Array.isArray(p)){const w=f,v=+p;if(e===jc&&([h,f]=TM(h,f,v)),p=qd(h,f,v),p[0]<=h&&(l=Li(h,f,v)),p[p.length-1]>=f)if(w>=f&&e===jc){const S=Li(h,f,v);isFinite(S)&&(S>0?f=(Math.floor(f/S)+1)*S:S<0&&(f=(Math.ceil(f*-S)+1)/-S))}else p.pop()}for(var m=p.length,g=0,x=m;p[g]<=h;)++g;for(;p[x-1]>f;)--x;(g||x<m)&&(p=p.slice(g,x),m=x-g);var b=new Array(m+1),y;for(s=0;s<=m;++s)y=b[s]=[],y.x0=s>0?p[s-1]:h,y.x1=s<m?p[s]:f;if(isFinite(l)){if(l>0)for(s=0;s<o;++s)(a=c[s])!=null&&h<=a&&a<=f&&b[Math.min(m,Math.floor((a-h)/l))].push(i[s]);else if(l<0){for(s=0;s<o;++s)if((a=c[s])!=null&&h<=a&&a<=f){const w=Math.floor((h-a)*l);b[Math.min(m,w+(p[w]<=a))].push(i[s])}}}else for(s=0;s<o;++s)(a=c[s])!=null&&h<=a&&a<=f&&b[Ud(p,a,0,m)].push(i[s]);return b}return r.value=function(i){return arguments.length?(n=typeof i=="function"?i:Tc(i),r):n},r.domain=function(i){return arguments.length?(e=typeof i=="function"?i:Tc([i[0],i[1]]),r):e},r.thresholds=function(i){return arguments.length?(t=typeof i=="function"?i:Tc(Array.isArray(i)?SM.call(i):i),r):t},r}var EM={value:()=>{}};function Eo(){for(var n=0,e=arguments.length,t={},r;n<e;++n){if(!(r=arguments[n]+"")||r in t||/[\s.]/.test(r))throw new Error("illegal type: "+r);t[r]=[]}return new Sa(t)}function Sa(n){this._=n}function IM(n,e){return n.trim().split(/^|\s+/).map(function(t){var r="",i=t.indexOf(".");if(i>=0&&(r=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:r}})}Sa.prototype=Eo.prototype={constructor:Sa,on:function(n,e){var t=this._,r=IM(n+"",t),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(n=r[s]).type)&&(i=RM(t[i],n.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<o;)if(i=(n=r[s]).type)t[i]=$f(t[i],n.name,e);else if(e==null)for(i in t)t[i]=$f(t[i],n.name,null);return this},copy:function(){var n={},e=this._;for(var t in e)n[t]=e[t].slice();return new Sa(n)},call:function(n,e){if((i=arguments.length-2)>0)for(var t=new Array(i),r=0,i,s;r<i;++r)t[r]=arguments[r+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(s=this._[n],r=0,i=s.length;r<i;++r)s[r].value.apply(e,t)},apply:function(n,e,t){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var r=this._[n],i=0,s=r.length;i<s;++i)r[i].value.apply(e,t)}};function RM(n,e){for(var t=0,r=n.length,i;t<r;++t)if((i=n[t]).name===e)return i.value}function $f(n,e,t){for(var r=0,i=n.length;r<i;++r)if(n[r].name===e){n[r]=EM,n=n.slice(0,r).concat(n.slice(r+1));break}return t!=null&&n.push({name:e,value:t}),n}var vu="http://www.w3.org/1999/xhtml";const Df={svg:"http://www.w3.org/2000/svg",xhtml:vu,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Xl(n){var e=n+="",t=e.indexOf(":");return t>=0&&(e=n.slice(0,t))!=="xmlns"&&(n=n.slice(t+1)),Df.hasOwnProperty(e)?{space:Df[e],local:n}:n}function OM(n){return function(){var e=this.ownerDocument,t=this.namespaceURI;return t===vu&&e.documentElement.namespaceURI===vu?e.createElement(n):e.createElementNS(t,n)}}function $M(n){return function(){return this.ownerDocument.createElementNS(n.space,n.local)}}function py(n){var e=Xl(n);return(e.local?$M:OM)(e)}function DM(){}function Xd(n){return n==null?DM:function(){return this.querySelector(n)}}function NM(n){typeof n!="function"&&(n=Xd(n));for(var e=this._groups,t=e.length,r=new Array(t),i=0;i<t;++i)for(var s=e[i],o=s.length,a=r[i]=new Array(o),l,c,u=0;u<o;++u)(l=s[u])&&(c=n.call(l,l.__data__,u,s))&&("__data__"in l&&(c.__data__=l.__data__),a[u]=c);return new Ht(r,this._parents)}function LM(n){return n==null?[]:Array.isArray(n)?n:Array.from(n)}function FM(){return[]}function my(n){return n==null?FM:function(){return this.querySelectorAll(n)}}function zM(n){return function(){return LM(n.apply(this,arguments))}}function BM(n){typeof n=="function"?n=zM(n):n=my(n);for(var e=this._groups,t=e.length,r=[],i=[],s=0;s<t;++s)for(var o=e[s],a=o.length,l,c=0;c<a;++c)(l=o[c])&&(r.push(n.call(l,l.__data__,c,o)),i.push(l));return new Ht(r,i)}function gy(n){return function(){return this.matches(n)}}function xy(n){return function(e){return e.matches(n)}}var HM=Array.prototype.find;function VM(n){return function(){return HM.call(this.children,n)}}function WM(){return this.firstElementChild}function UM(n){return this.select(n==null?WM:VM(typeof n=="function"?n:xy(n)))}var qM=Array.prototype.filter;function XM(){return Array.from(this.children)}function GM(n){return function(){return qM.call(this.children,n)}}function YM(n){return this.selectAll(n==null?XM:GM(typeof n=="function"?n:xy(n)))}function KM(n){typeof n!="function"&&(n=gy(n));for(var e=this._groups,t=e.length,r=new Array(t),i=0;i<t;++i)for(var s=e[i],o=s.length,a=r[i]=[],l,c=0;c<o;++c)(l=s[c])&&n.call(l,l.__data__,c,s)&&a.push(l);return new Ht(r,this._parents)}function by(n){return new Array(n.length)}function ZM(){return new Ht(this._enter||this._groups.map(by),this._parents)}function Va(n,e){this.ownerDocument=n.ownerDocument,this.namespaceURI=n.namespaceURI,this._next=null,this._parent=n,this.__data__=e}Va.prototype={constructor:Va,appendChild:function(n){return this._parent.insertBefore(n,this._next)},insertBefore:function(n,e){return this._parent.insertBefore(n,e)},querySelector:function(n){return this._parent.querySelector(n)},querySelectorAll:function(n){return this._parent.querySelectorAll(n)}};function JM(n){return function(){return n}}function QM(n,e,t,r,i,s){for(var o=0,a,l=e.length,c=s.length;o<c;++o)(a=e[o])?(a.__data__=s[o],r[o]=a):t[o]=new Va(n,s[o]);for(;o<l;++o)(a=e[o])&&(i[o]=a)}function eA(n,e,t,r,i,s,o){var a,l,c=new Map,u=e.length,h=s.length,f=new Array(u),p;for(a=0;a<u;++a)(l=e[a])&&(f[a]=p=o.call(l,l.__data__,a,e)+"",c.has(p)?i[a]=l:c.set(p,l));for(a=0;a<h;++a)p=o.call(n,s[a],a,s)+"",(l=c.get(p))?(r[a]=l,l.__data__=s[a],c.delete(p)):t[a]=new Va(n,s[a]);for(a=0;a<u;++a)(l=e[a])&&c.get(f[a])===l&&(i[a]=l)}function tA(n){return n.__data__}function nA(n,e){if(!arguments.length)return Array.from(this,tA);var t=e?eA:QM,r=this._parents,i=this._groups;typeof n!="function"&&(n=JM(n));for(var s=i.length,o=new Array(s),a=new Array(s),l=new Array(s),c=0;c<s;++c){var u=r[c],h=i[c],f=h.length,p=rA(n.call(u,u&&u.__data__,c,r)),m=p.length,g=a[c]=new Array(m),x=o[c]=new Array(m),b=l[c]=new Array(f);t(u,h,g,x,b,p,e);for(var y=0,w=0,v,S;y<m;++y)if(v=g[y]){for(y>=w&&(w=y+1);!(S=x[w])&&++w<m;);v._next=S||null}}return o=new Ht(o,r),o._enter=a,o._exit=l,o}function rA(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function iA(){return new Ht(this._exit||this._groups.map(by),this._parents)}function sA(n,e,t){var r=this.enter(),i=this,s=this.exit();return typeof n=="function"?(r=n(r),r&&(r=r.selection())):r=r.append(n+""),e!=null&&(i=e(i),i&&(i=i.selection())),t==null?s.remove():t(s),r&&i?r.merge(i).order():i}function oA(n){for(var e=n.selection?n.selection():n,t=this._groups,r=e._groups,i=t.length,s=r.length,o=Math.min(i,s),a=new Array(i),l=0;l<o;++l)for(var c=t[l],u=r[l],h=c.length,f=a[l]=new Array(h),p,m=0;m<h;++m)(p=c[m]||u[m])&&(f[m]=p);for(;l<i;++l)a[l]=t[l];return new Ht(a,this._parents)}function aA(){for(var n=this._groups,e=-1,t=n.length;++e<t;)for(var r=n[e],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function lA(n){n||(n=cA);function e(h,f){return h&&f?n(h.__data__,f.__data__):!h-!f}for(var t=this._groups,r=t.length,i=new Array(r),s=0;s<r;++s){for(var o=t[s],a=o.length,l=i[s]=new Array(a),c,u=0;u<a;++u)(c=o[u])&&(l[u]=c);l.sort(e)}return new Ht(i,this._parents).order()}function cA(n,e){return n<e?-1:n>e?1:n>=e?0:NaN}function uA(){var n=arguments[0];return arguments[0]=this,n.apply(null,arguments),this}function dA(){return Array.from(this)}function hA(){for(var n=this._groups,e=0,t=n.length;e<t;++e)for(var r=n[e],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function fA(){let n=0;for(const e of this)++n;return n}function pA(){return!this.node()}function mA(n){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var i=e[t],s=0,o=i.length,a;s<o;++s)(a=i[s])&&n.call(a,a.__data__,s,i);return this}function gA(n){return function(){this.removeAttribute(n)}}function xA(n){return function(){this.removeAttributeNS(n.space,n.local)}}function bA(n,e){return function(){this.setAttribute(n,e)}}function yA(n,e){return function(){this.setAttributeNS(n.space,n.local,e)}}function vA(n,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttribute(n):this.setAttribute(n,t)}}function wA(n,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,t)}}function _A(n,e){var t=Xl(n);if(arguments.length<2){var r=this.node();return t.local?r.getAttributeNS(t.space,t.local):r.getAttribute(t)}return this.each((e==null?t.local?xA:gA:typeof e=="function"?t.local?wA:vA:t.local?yA:bA)(t,e))}function yy(n){return n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView}function SA(n){return function(){this.style.removeProperty(n)}}function PA(n,e,t){return function(){this.style.setProperty(n,e,t)}}function CA(n,e,t){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(n):this.style.setProperty(n,r,t)}}function kA(n,e,t){return arguments.length>1?this.each((e==null?SA:typeof e=="function"?CA:PA)(n,e,t??"")):Fi(this.node(),n)}function Fi(n,e){return n.style.getPropertyValue(e)||yy(n).getComputedStyle(n,null).getPropertyValue(e)}function jA(n){return function(){delete this[n]}}function TA(n,e){return function(){this[n]=e}}function MA(n,e){return function(){var t=e.apply(this,arguments);t==null?delete this[n]:this[n]=t}}function AA(n,e){return arguments.length>1?this.each((e==null?jA:typeof e=="function"?MA:TA)(n,e)):this.node()[n]}function vy(n){return n.trim().split(/^|\s+/)}function Gd(n){return n.classList||new wy(n)}function wy(n){this._node=n,this._names=vy(n.getAttribute("class")||"")}wy.prototype={add:function(n){var e=this._names.indexOf(n);e<0&&(this._names.push(n),this._node.setAttribute("class",this._names.join(" ")))},remove:function(n){var e=this._names.indexOf(n);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(n){return this._names.indexOf(n)>=0}};function _y(n,e){for(var t=Gd(n),r=-1,i=e.length;++r<i;)t.add(e[r])}function Sy(n,e){for(var t=Gd(n),r=-1,i=e.length;++r<i;)t.remove(e[r])}function EA(n){return function(){_y(this,n)}}function IA(n){return function(){Sy(this,n)}}function RA(n,e){return function(){(e.apply(this,arguments)?_y:Sy)(this,n)}}function OA(n,e){var t=vy(n+"");if(arguments.length<2){for(var r=Gd(this.node()),i=-1,s=t.length;++i<s;)if(!r.contains(t[i]))return!1;return!0}return this.each((typeof e=="function"?RA:e?EA:IA)(t,e))}function $A(){this.textContent=""}function DA(n){return function(){this.textContent=n}}function NA(n){return function(){var e=n.apply(this,arguments);this.textContent=e??""}}function LA(n){return arguments.length?this.each(n==null?$A:(typeof n=="function"?NA:DA)(n)):this.node().textContent}function FA(){this.innerHTML=""}function zA(n){return function(){this.innerHTML=n}}function BA(n){return function(){var e=n.apply(this,arguments);this.innerHTML=e??""}}function HA(n){return arguments.length?this.each(n==null?FA:(typeof n=="function"?BA:zA)(n)):this.node().innerHTML}function VA(){this.nextSibling&&this.parentNode.appendChild(this)}function WA(){return this.each(VA)}function UA(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function qA(){return this.each(UA)}function XA(n){var e=typeof n=="function"?n:py(n);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function GA(){return null}function YA(n,e){var t=typeof n=="function"?n:py(n),r=e==null?GA:typeof e=="function"?e:Xd(e);return this.select(function(){return this.insertBefore(t.apply(this,arguments),r.apply(this,arguments)||null)})}function KA(){var n=this.parentNode;n&&n.removeChild(this)}function ZA(){return this.each(KA)}function JA(){var n=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(n,this.nextSibling):n}function QA(){var n=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(n,this.nextSibling):n}function eE(n){return this.select(n?QA:JA)}function tE(n){return arguments.length?this.property("__data__",n):this.node().__data__}function nE(n){return function(e){n.call(this,e,this.__data__)}}function rE(n){return n.trim().split(/^|\s+/).map(function(e){var t="",r=e.indexOf(".");return r>=0&&(t=e.slice(r+1),e=e.slice(0,r)),{type:e,name:t}})}function iE(n){return function(){var e=this.__on;if(e){for(var t=0,r=-1,i=e.length,s;t<i;++t)s=e[t],(!n.type||s.type===n.type)&&s.name===n.name?this.removeEventListener(s.type,s.listener,s.options):e[++r]=s;++r?e.length=r:delete this.__on}}}function sE(n,e,t){return function(){var r=this.__on,i,s=nE(e);if(r){for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===n.type&&i.name===n.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=t),i.value=e;return}}this.addEventListener(n.type,s,t),i={type:n.type,name:n.name,value:e,listener:s,options:t},r?r.push(i):this.__on=[i]}}function oE(n,e,t){var r=rE(n+""),i,s=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,u;l<c;++l)for(i=0,u=a[l];i<s;++i)if((o=r[i]).type===u.type&&o.name===u.name)return u.value}return}for(a=e?sE:iE,i=0;i<s;++i)this.each(a(r[i],e,t));return this}function Py(n,e,t){var r=yy(n),i=r.CustomEvent;typeof i=="function"?i=new i(e,t):(i=r.document.createEvent("Event"),t?(i.initEvent(e,t.bubbles,t.cancelable),i.detail=t.detail):i.initEvent(e,!1,!1)),n.dispatchEvent(i)}function aE(n,e){return function(){return Py(this,n,e)}}function lE(n,e){return function(){return Py(this,n,e.apply(this,arguments))}}function cE(n,e){return this.each((typeof e=="function"?lE:aE)(n,e))}function*uE(){for(var n=this._groups,e=0,t=n.length;e<t;++e)for(var r=n[e],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var Cy=[null];function Ht(n,e){this._groups=n,this._parents=e}function Io(){return new Ht([[document.documentElement]],Cy)}function dE(){return this}Ht.prototype=Io.prototype={constructor:Ht,select:NM,selectAll:BM,selectChild:UM,selectChildren:YM,filter:KM,data:nA,enter:ZM,exit:iA,join:sA,merge:oA,selection:dE,order:aA,sort:lA,call:uA,nodes:dA,node:hA,size:fA,empty:pA,each:mA,attr:_A,style:kA,property:AA,classed:OA,text:LA,html:HA,raise:WA,lower:qA,append:XA,insert:YA,remove:ZA,clone:eE,datum:tE,on:oE,dispatch:cE,[Symbol.iterator]:uE};function hn(n){return typeof n=="string"?new Ht([[document.querySelector(n)]],[document.documentElement]):new Ht([[n]],Cy)}function hE(n){let e;for(;e=n.sourceEvent;)n=e;return n}function Yn(n,e){if(n=hE(n),e===void 0&&(e=n.currentTarget),e){var t=e.ownerSVGElement||e;if(t.createSVGPoint){var r=t.createSVGPoint();return r.x=n.clientX,r.y=n.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[n.clientX-i.left-e.clientLeft,n.clientY-i.top-e.clientTop]}}return[n.pageX,n.pageY]}const fE={passive:!1},Ys={capture:!0,passive:!1};function Mc(n){n.stopImmediatePropagation()}function Ii(n){n.preventDefault(),n.stopImmediatePropagation()}function ky(n){var e=n.document.documentElement,t=hn(n).on("dragstart.drag",Ii,Ys);"onselectstart"in e?t.on("selectstart.drag",Ii,Ys):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function jy(n,e){var t=n.document.documentElement,r=hn(n).on("dragstart.drag",null);e&&(r.on("click.drag",Ii,Ys),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in t?r.on("selectstart.drag",null):(t.style.MozUserSelect=t.__noselect,delete t.__noselect)}const qo=n=>()=>n;function wu(n,{sourceEvent:e,subject:t,target:r,identifier:i,active:s,x:o,y:a,dx:l,dy:c,dispatch:u}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:t,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:l,enumerable:!0,configurable:!0},dy:{value:c,enumerable:!0,configurable:!0},_:{value:u}})}wu.prototype.on=function(){var n=this._.on.apply(this._,arguments);return n===this._?this:n};function pE(n){return!n.ctrlKey&&!n.button}function mE(){return this.parentNode}function gE(n,e){return e??{x:n.x,y:n.y}}function xE(){return navigator.maxTouchPoints||"ontouchstart"in this}function bE(){var n=pE,e=mE,t=gE,r=xE,i={},s=Eo("start","drag","end"),o=0,a,l,c,u,h=0;function f(v){v.on("mousedown.drag",p).filter(r).on("touchstart.drag",x).on("touchmove.drag",b,fE).on("touchend.drag touchcancel.drag",y).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(v,S){if(!(u||!n.call(this,v,S))){var k=w(this,e.call(this,v,S),v,S,"mouse");k&&(hn(v.view).on("mousemove.drag",m,Ys).on("mouseup.drag",g,Ys),ky(v.view),Mc(v),c=!1,a=v.clientX,l=v.clientY,k("start",v))}}function m(v){if(Ii(v),!c){var S=v.clientX-a,k=v.clientY-l;c=S*S+k*k>h}i.mouse("drag",v)}function g(v){hn(v.view).on("mousemove.drag mouseup.drag",null),jy(v.view,c),Ii(v),i.mouse("end",v)}function x(v,S){if(n.call(this,v,S)){var k=v.changedTouches,P=e.call(this,v,S),C=k.length,T,A;for(T=0;T<C;++T)(A=w(this,P,v,S,k[T].identifier,k[T]))&&(Mc(v),A("start",v,k[T]))}}function b(v){var S=v.changedTouches,k=S.length,P,C;for(P=0;P<k;++P)(C=i[S[P].identifier])&&(Ii(v),C("drag",v,S[P]))}function y(v){var S=v.changedTouches,k=S.length,P,C;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),P=0;P<k;++P)(C=i[S[P].identifier])&&(Mc(v),C("end",v,S[P]))}function w(v,S,k,P,C,T){var A=s.copy(),M=Yn(T||k,S),O,R,j;if((j=t.call(v,new wu("beforestart",{sourceEvent:k,target:f,identifier:C,active:o,x:M[0],y:M[1],dx:0,dy:0,dispatch:A}),P))!=null)return O=j.x-M[0]||0,R=j.y-M[1]||0,function I(E,D,L){var z=M,B;switch(E){case"start":i[C]=I,B=o++;break;case"end":delete i[C],--o;case"drag":M=Yn(L||D,S),B=o;break}A.call(E,v,new wu(E,{sourceEvent:D,subject:j,target:f,identifier:C,active:B,x:M[0]+O,y:M[1]+R,dx:M[0]-z[0],dy:M[1]-z[1],dispatch:A}),P)}}return f.filter=function(v){return arguments.length?(n=typeof v=="function"?v:qo(!!v),f):n},f.container=function(v){return arguments.length?(e=typeof v=="function"?v:qo(v),f):e},f.subject=function(v){return arguments.length?(t=typeof v=="function"?v:qo(v),f):t},f.touchable=function(v){return arguments.length?(r=typeof v=="function"?v:qo(!!v),f):r},f.on=function(){var v=s.on.apply(s,arguments);return v===s?f:v},f.clickDistance=function(v){return arguments.length?(h=(v=+v)*v,f):Math.sqrt(h)},f}function Yd(n,e,t){n.prototype=e.prototype=t,t.constructor=n}function Ty(n,e){var t=Object.create(n.prototype);for(var r in e)t[r]=e[r];return t}function Ro(){}var Ks=.7,Wa=1/Ks,Ri="\\s*([+-]?\\d+)\\s*",Zs="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",On="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",yE=/^#([0-9a-f]{3,8})$/,vE=new RegExp(`^rgb\\(${Ri},${Ri},${Ri}\\)$`),wE=new RegExp(`^rgb\\(${On},${On},${On}\\)$`),_E=new RegExp(`^rgba\\(${Ri},${Ri},${Ri},${Zs}\\)$`),SE=new RegExp(`^rgba\\(${On},${On},${On},${Zs}\\)$`),PE=new RegExp(`^hsl\\(${Zs},${On},${On}\\)$`),CE=new RegExp(`^hsla\\(${Zs},${On},${On},${Zs}\\)$`),Nf={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Yd(Ro,ti,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:Lf,formatHex:Lf,formatHex8:kE,formatHsl:jE,formatRgb:Ff,toString:Ff});function Lf(){return this.rgb().formatHex()}function kE(){return this.rgb().formatHex8()}function jE(){return My(this).formatHsl()}function Ff(){return this.rgb().formatRgb()}function ti(n){var e,t;return n=(n+"").trim().toLowerCase(),(e=yE.exec(n))?(t=e[1].length,e=parseInt(e[1],16),t===6?zf(e):t===3?new At(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?Xo(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?Xo(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=vE.exec(n))?new At(e[1],e[2],e[3],1):(e=wE.exec(n))?new At(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=_E.exec(n))?Xo(e[1],e[2],e[3],e[4]):(e=SE.exec(n))?Xo(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=PE.exec(n))?Vf(e[1],e[2]/100,e[3]/100,1):(e=CE.exec(n))?Vf(e[1],e[2]/100,e[3]/100,e[4]):Nf.hasOwnProperty(n)?zf(Nf[n]):n==="transparent"?new At(NaN,NaN,NaN,0):null}function zf(n){return new At(n>>16&255,n>>8&255,n&255,1)}function Xo(n,e,t,r){return r<=0&&(n=e=t=NaN),new At(n,e,t,r)}function TE(n){return n instanceof Ro||(n=ti(n)),n?(n=n.rgb(),new At(n.r,n.g,n.b,n.opacity)):new At}function _u(n,e,t,r){return arguments.length===1?TE(n):new At(n,e,t,r??1)}function At(n,e,t,r){this.r=+n,this.g=+e,this.b=+t,this.opacity=+r}Yd(At,_u,Ty(Ro,{brighter(n){return n=n==null?Wa:Math.pow(Wa,n),new At(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?Ks:Math.pow(Ks,n),new At(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new At(Xr(this.r),Xr(this.g),Xr(this.b),Ua(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Bf,formatHex:Bf,formatHex8:ME,formatRgb:Hf,toString:Hf}));function Bf(){return`#${zr(this.r)}${zr(this.g)}${zr(this.b)}`}function ME(){return`#${zr(this.r)}${zr(this.g)}${zr(this.b)}${zr((isNaN(this.opacity)?1:this.opacity)*255)}`}function Hf(){const n=Ua(this.opacity);return`${n===1?"rgb(":"rgba("}${Xr(this.r)}, ${Xr(this.g)}, ${Xr(this.b)}${n===1?")":`, ${n})`}`}function Ua(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function Xr(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function zr(n){return n=Xr(n),(n<16?"0":"")+n.toString(16)}function Vf(n,e,t,r){return r<=0?n=e=t=NaN:t<=0||t>=1?n=e=NaN:e<=0&&(n=NaN),new fn(n,e,t,r)}function My(n){if(n instanceof fn)return new fn(n.h,n.s,n.l,n.opacity);if(n instanceof Ro||(n=ti(n)),!n)return new fn;if(n instanceof fn)return n;n=n.rgb();var e=n.r/255,t=n.g/255,r=n.b/255,i=Math.min(e,t,r),s=Math.max(e,t,r),o=NaN,a=s-i,l=(s+i)/2;return a?(e===s?o=(t-r)/a+(t<r)*6:t===s?o=(r-e)/a+2:o=(e-t)/a+4,a/=l<.5?s+i:2-s-i,o*=60):a=l>0&&l<1?0:o,new fn(o,a,l,n.opacity)}function AE(n,e,t,r){return arguments.length===1?My(n):new fn(n,e,t,r??1)}function fn(n,e,t,r){this.h=+n,this.s=+e,this.l=+t,this.opacity=+r}Yd(fn,AE,Ty(Ro,{brighter(n){return n=n==null?Wa:Math.pow(Wa,n),new fn(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?Ks:Math.pow(Ks,n),new fn(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,e=isNaN(n)||isNaN(this.s)?0:this.s,t=this.l,r=t+(t<.5?t:1-t)*e,i=2*t-r;return new At(Ac(n>=240?n-240:n+120,i,r),Ac(n,i,r),Ac(n<120?n+240:n-120,i,r),this.opacity)},clamp(){return new fn(Wf(this.h),Go(this.s),Go(this.l),Ua(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=Ua(this.opacity);return`${n===1?"hsl(":"hsla("}${Wf(this.h)}, ${Go(this.s)*100}%, ${Go(this.l)*100}%${n===1?")":`, ${n})`}`}}));function Wf(n){return n=(n||0)%360,n<0?n+360:n}function Go(n){return Math.max(0,Math.min(1,n||0))}function Ac(n,e,t){return(n<60?e+(t-e)*n/60:n<180?t:n<240?e+(t-e)*(240-n)/60:e)*255}const Kd=n=>()=>n;function EE(n,e){return function(t){return n+t*e}}function IE(n,e,t){return n=Math.pow(n,t),e=Math.pow(e,t)-n,t=1/t,function(r){return Math.pow(n+r*e,t)}}function RE(n){return(n=+n)==1?Ay:function(e,t){return t-e?IE(e,t,n):Kd(isNaN(e)?t:e)}}function Ay(n,e){var t=e-n;return t?EE(n,t):Kd(isNaN(n)?e:n)}const qa=function n(e){var t=RE(e);function r(i,s){var o=t((i=_u(i)).r,(s=_u(s)).r),a=t(i.g,s.g),l=t(i.b,s.b),c=Ay(i.opacity,s.opacity);return function(u){return i.r=o(u),i.g=a(u),i.b=l(u),i.opacity=c(u),i+""}}return r.gamma=n,r}(1);function OE(n,e){e||(e=[]);var t=n?Math.min(e.length,n.length):0,r=e.slice(),i;return function(s){for(i=0;i<t;++i)r[i]=n[i]*(1-s)+e[i]*s;return r}}function $E(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function DE(n,e){var t=e?e.length:0,r=n?Math.min(t,n.length):0,i=new Array(r),s=new Array(t),o;for(o=0;o<r;++o)i[o]=Zd(n[o],e[o]);for(;o<t;++o)s[o]=e[o];return function(a){for(o=0;o<r;++o)s[o]=i[o](a);return s}}function NE(n,e){var t=new Date;return n=+n,e=+e,function(r){return t.setTime(n*(1-r)+e*r),t}}function dn(n,e){return n=+n,e=+e,function(t){return n*(1-t)+e*t}}function LE(n,e){var t={},r={},i;(n===null||typeof n!="object")&&(n={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in n?t[i]=Zd(n[i],e[i]):r[i]=e[i];return function(s){for(i in t)r[i]=t[i](s);return r}}var Su=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ec=new RegExp(Su.source,"g");function FE(n){return function(){return n}}function zE(n){return function(e){return n(e)+""}}function Ey(n,e){var t=Su.lastIndex=Ec.lastIndex=0,r,i,s,o=-1,a=[],l=[];for(n=n+"",e=e+"";(r=Su.exec(n))&&(i=Ec.exec(e));)(s=i.index)>t&&(s=e.slice(t,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,l.push({i:o,x:dn(r,i)})),t=Ec.lastIndex;return t<e.length&&(s=e.slice(t),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?zE(l[0].x):FE(e):(e=l.length,function(c){for(var u=0,h;u<e;++u)a[(h=l[u]).i]=h.x(c);return a.join("")})}function Zd(n,e){var t=typeof e,r;return e==null||t==="boolean"?Kd(e):(t==="number"?dn:t==="string"?(r=ti(e))?(e=r,qa):Ey:e instanceof ti?qa:e instanceof Date?NE:$E(e)?OE:Array.isArray(e)?DE:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?LE:dn)(n,e)}function BE(n,e){return n=+n,e=+e,function(t){return Math.round(n*(1-t)+e*t)}}var Uf=180/Math.PI,Pu={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Iy(n,e,t,r,i,s){var o,a,l;return(o=Math.sqrt(n*n+e*e))&&(n/=o,e/=o),(l=n*t+e*r)&&(t-=n*l,r-=e*l),(a=Math.sqrt(t*t+r*r))&&(t/=a,r/=a,l/=a),n*r<e*t&&(n=-n,e=-e,l=-l,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(e,n)*Uf,skewX:Math.atan(l)*Uf,scaleX:o,scaleY:a}}var Yo;function HE(n){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(n+"");return e.isIdentity?Pu:Iy(e.a,e.b,e.c,e.d,e.e,e.f)}function VE(n){return n==null||(Yo||(Yo=document.createElementNS("http://www.w3.org/2000/svg","g")),Yo.setAttribute("transform",n),!(n=Yo.transform.baseVal.consolidate()))?Pu:(n=n.matrix,Iy(n.a,n.b,n.c,n.d,n.e,n.f))}function Ry(n,e,t,r){function i(c){return c.length?c.pop()+" ":""}function s(c,u,h,f,p,m){if(c!==h||u!==f){var g=p.push("translate(",null,e,null,t);m.push({i:g-4,x:dn(c,h)},{i:g-2,x:dn(u,f)})}else(h||f)&&p.push("translate("+h+e+f+t)}function o(c,u,h,f){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),f.push({i:h.push(i(h)+"rotate(",null,r)-2,x:dn(c,u)})):u&&h.push(i(h)+"rotate("+u+r)}function a(c,u,h,f){c!==u?f.push({i:h.push(i(h)+"skewX(",null,r)-2,x:dn(c,u)}):u&&h.push(i(h)+"skewX("+u+r)}function l(c,u,h,f,p,m){if(c!==h||u!==f){var g=p.push(i(p)+"scale(",null,",",null,")");m.push({i:g-4,x:dn(c,h)},{i:g-2,x:dn(u,f)})}else(h!==1||f!==1)&&p.push(i(p)+"scale("+h+","+f+")")}return function(c,u){var h=[],f=[];return c=n(c),u=n(u),s(c.translateX,c.translateY,u.translateX,u.translateY,h,f),o(c.rotate,u.rotate,h,f),a(c.skewX,u.skewX,h,f),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,h,f),c=u=null,function(p){for(var m=-1,g=f.length,x;++m<g;)h[(x=f[m]).i]=x.x(p);return h.join("")}}}var WE=Ry(HE,"px, ","px)","deg)"),UE=Ry(VE,", ",")",")"),qE=1e-12;function qf(n){return((n=Math.exp(n))+1/n)/2}function XE(n){return((n=Math.exp(n))-1/n)/2}function GE(n){return((n=Math.exp(2*n))-1)/(n+1)}const YE=function n(e,t,r){function i(s,o){var a=s[0],l=s[1],c=s[2],u=o[0],h=o[1],f=o[2],p=u-a,m=h-l,g=p*p+m*m,x,b;if(g<qE)b=Math.log(f/c)/e,x=function(P){return[a+P*p,l+P*m,c*Math.exp(e*P*b)]};else{var y=Math.sqrt(g),w=(f*f-c*c+r*g)/(2*c*t*y),v=(f*f-c*c-r*g)/(2*f*t*y),S=Math.log(Math.sqrt(w*w+1)-w),k=Math.log(Math.sqrt(v*v+1)-v);b=(k-S)/e,x=function(P){var C=P*b,T=qf(S),A=c/(t*y)*(T*GE(e*C+S)-XE(S));return[a+A*p,l+A*m,c*T/qf(e*C+S)]}}return x.duration=b*1e3*e/Math.SQRT2,x}return i.rho=function(s){var o=Math.max(.001,+s),a=o*o,l=a*a;return n(o,a,l)},i}(Math.SQRT2,2,4);var zi=0,Ps=0,fs=0,Oy=1e3,Xa,Cs,Ga=0,ni=0,Gl=0,Js=typeof performance=="object"&&performance.now?performance:Date,$y=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(n){setTimeout(n,17)};function Jd(){return ni||($y(KE),ni=Js.now()+Gl)}function KE(){ni=0}function Ya(){this._call=this._time=this._next=null}Ya.prototype=Qd.prototype={constructor:Ya,restart:function(n,e,t){if(typeof n!="function")throw new TypeError("callback is not a function");t=(t==null?Jd():+t)+(e==null?0:+e),!this._next&&Cs!==this&&(Cs?Cs._next=this:Xa=this,Cs=this),this._call=n,this._time=t,Cu()},stop:function(){this._call&&(this._call=null,this._time=1/0,Cu())}};function Qd(n,e,t){var r=new Ya;return r.restart(n,e,t),r}function ZE(){Jd(),++zi;for(var n=Xa,e;n;)(e=ni-n._time)>=0&&n._call.call(void 0,e),n=n._next;--zi}function Xf(){ni=(Ga=Js.now())+Gl,zi=Ps=0;try{ZE()}finally{zi=0,QE(),ni=0}}function JE(){var n=Js.now(),e=n-Ga;e>Oy&&(Gl-=e,Ga=n)}function QE(){for(var n,e=Xa,t,r=1/0;e;)e._call?(r>e._time&&(r=e._time),n=e,e=e._next):(t=e._next,e._next=null,e=n?n._next=t:Xa=t);Cs=n,Cu(r)}function Cu(n){if(!zi){Ps&&(Ps=clearTimeout(Ps));var e=n-ni;e>24?(n<1/0&&(Ps=setTimeout(Xf,n-Js.now()-Gl)),fs&&(fs=clearInterval(fs))):(fs||(Ga=Js.now(),fs=setInterval(JE,Oy)),zi=1,$y(Xf))}}function Gf(n,e,t){var r=new Ya;return e=e==null?0:+e,r.restart(i=>{r.stop(),n(i+e)},e,t),r}var e3=Eo("start","end","cancel","interrupt"),t3=[],Dy=0,Yf=1,ku=2,Pa=3,Kf=4,ju=5,Ca=6;function Yl(n,e,t,r,i,s){var o=n.__transition;if(!o)n.__transition={};else if(t in o)return;n3(n,t,{name:e,index:r,group:i,on:e3,tween:t3,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:Dy})}function eh(n,e){var t=Sn(n,e);if(t.state>Dy)throw new Error("too late; already scheduled");return t}function Hn(n,e){var t=Sn(n,e);if(t.state>Pa)throw new Error("too late; already running");return t}function Sn(n,e){var t=n.__transition;if(!t||!(t=t[e]))throw new Error("transition not found");return t}function n3(n,e,t){var r=n.__transition,i;r[e]=t,t.timer=Qd(s,0,t.time);function s(c){t.state=Yf,t.timer.restart(o,t.delay,t.time),t.delay<=c&&o(c-t.delay)}function o(c){var u,h,f,p;if(t.state!==Yf)return l();for(u in r)if(p=r[u],p.name===t.name){if(p.state===Pa)return Gf(o);p.state===Kf?(p.state=Ca,p.timer.stop(),p.on.call("interrupt",n,n.__data__,p.index,p.group),delete r[u]):+u<e&&(p.state=Ca,p.timer.stop(),p.on.call("cancel",n,n.__data__,p.index,p.group),delete r[u])}if(Gf(function(){t.state===Pa&&(t.state=Kf,t.timer.restart(a,t.delay,t.time),a(c))}),t.state=ku,t.on.call("start",n,n.__data__,t.index,t.group),t.state===ku){for(t.state=Pa,i=new Array(f=t.tween.length),u=0,h=-1;u<f;++u)(p=t.tween[u].value.call(n,n.__data__,t.index,t.group))&&(i[++h]=p);i.length=h+1}}function a(c){for(var u=c<t.duration?t.ease.call(null,c/t.duration):(t.timer.restart(l),t.state=ju,1),h=-1,f=i.length;++h<f;)i[h].call(n,u);t.state===ju&&(t.on.call("end",n,n.__data__,t.index,t.group),l())}function l(){t.state=Ca,t.timer.stop(),delete r[e];for(var c in r)return;delete n.__transition}}function ka(n,e){var t=n.__transition,r,i,s=!0,o;if(t){e=e==null?null:e+"";for(o in t){if((r=t[o]).name!==e){s=!1;continue}i=r.state>ku&&r.state<ju,r.state=Ca,r.timer.stop(),r.on.call(i?"interrupt":"cancel",n,n.__data__,r.index,r.group),delete t[o]}s&&delete n.__transition}}function r3(n){return this.each(function(){ka(this,n)})}function i3(n,e){var t,r;return function(){var i=Hn(this,n),s=i.tween;if(s!==t){r=t=s;for(var o=0,a=r.length;o<a;++o)if(r[o].name===e){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function s3(n,e,t){var r,i;if(typeof t!="function")throw new Error;return function(){var s=Hn(this,n),o=s.tween;if(o!==r){i=(r=o).slice();for(var a={name:e,value:t},l=0,c=i.length;l<c;++l)if(i[l].name===e){i[l]=a;break}l===c&&i.push(a)}s.tween=i}}function o3(n,e){var t=this._id;if(n+="",arguments.length<2){for(var r=Sn(this.node(),t).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===n)return o.value;return null}return this.each((e==null?i3:s3)(t,n,e))}function th(n,e,t){var r=n._id;return n.each(function(){var i=Hn(this,r);(i.value||(i.value={}))[e]=t.apply(this,arguments)}),function(i){return Sn(i,r).value[e]}}function Ny(n,e){var t;return(typeof e=="number"?dn:e instanceof ti?qa:(t=ti(e))?(e=t,qa):Ey)(n,e)}function a3(n){return function(){this.removeAttribute(n)}}function l3(n){return function(){this.removeAttributeNS(n.space,n.local)}}function c3(n,e,t){var r,i=t+"",s;return function(){var o=this.getAttribute(n);return o===i?null:o===r?s:s=e(r=o,t)}}function u3(n,e,t){var r,i=t+"",s;return function(){var o=this.getAttributeNS(n.space,n.local);return o===i?null:o===r?s:s=e(r=o,t)}}function d3(n,e,t){var r,i,s;return function(){var o,a=t(this),l;return a==null?void this.removeAttribute(n):(o=this.getAttribute(n),l=a+"",o===l?null:o===r&&l===i?s:(i=l,s=e(r=o,a)))}}function h3(n,e,t){var r,i,s;return function(){var o,a=t(this),l;return a==null?void this.removeAttributeNS(n.space,n.local):(o=this.getAttributeNS(n.space,n.local),l=a+"",o===l?null:o===r&&l===i?s:(i=l,s=e(r=o,a)))}}function f3(n,e){var t=Xl(n),r=t==="transform"?UE:Ny;return this.attrTween(n,typeof e=="function"?(t.local?h3:d3)(t,r,th(this,"attr."+n,e)):e==null?(t.local?l3:a3)(t):(t.local?u3:c3)(t,r,e))}function p3(n,e){return function(t){this.setAttribute(n,e.call(this,t))}}function m3(n,e){return function(t){this.setAttributeNS(n.space,n.local,e.call(this,t))}}function g3(n,e){var t,r;function i(){var s=e.apply(this,arguments);return s!==r&&(t=(r=s)&&m3(n,s)),t}return i._value=e,i}function x3(n,e){var t,r;function i(){var s=e.apply(this,arguments);return s!==r&&(t=(r=s)&&p3(n,s)),t}return i._value=e,i}function b3(n,e){var t="attr."+n;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;var r=Xl(n);return this.tween(t,(r.local?g3:x3)(r,e))}function y3(n,e){return function(){eh(this,n).delay=+e.apply(this,arguments)}}function v3(n,e){return e=+e,function(){eh(this,n).delay=e}}function w3(n){var e=this._id;return arguments.length?this.each((typeof n=="function"?y3:v3)(e,n)):Sn(this.node(),e).delay}function _3(n,e){return function(){Hn(this,n).duration=+e.apply(this,arguments)}}function S3(n,e){return e=+e,function(){Hn(this,n).duration=e}}function P3(n){var e=this._id;return arguments.length?this.each((typeof n=="function"?_3:S3)(e,n)):Sn(this.node(),e).duration}function C3(n,e){if(typeof e!="function")throw new Error;return function(){Hn(this,n).ease=e}}function k3(n){var e=this._id;return arguments.length?this.each(C3(e,n)):Sn(this.node(),e).ease}function j3(n,e){return function(){var t=e.apply(this,arguments);if(typeof t!="function")throw new Error;Hn(this,n).ease=t}}function T3(n){if(typeof n!="function")throw new Error;return this.each(j3(this._id,n))}function M3(n){typeof n!="function"&&(n=gy(n));for(var e=this._groups,t=e.length,r=new Array(t),i=0;i<t;++i)for(var s=e[i],o=s.length,a=r[i]=[],l,c=0;c<o;++c)(l=s[c])&&n.call(l,l.__data__,c,s)&&a.push(l);return new er(r,this._parents,this._name,this._id)}function A3(n){if(n._id!==this._id)throw new Error;for(var e=this._groups,t=n._groups,r=e.length,i=t.length,s=Math.min(r,i),o=new Array(r),a=0;a<s;++a)for(var l=e[a],c=t[a],u=l.length,h=o[a]=new Array(u),f,p=0;p<u;++p)(f=l[p]||c[p])&&(h[p]=f);for(;a<r;++a)o[a]=e[a];return new er(o,this._parents,this._name,this._id)}function E3(n){return(n+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||e==="start"})}function I3(n,e,t){var r,i,s=E3(e)?eh:Hn;return function(){var o=s(this,n),a=o.on;a!==r&&(i=(r=a).copy()).on(e,t),o.on=i}}function R3(n,e){var t=this._id;return arguments.length<2?Sn(this.node(),t).on.on(n):this.each(I3(t,n,e))}function O3(n){return function(){var e=this.parentNode;for(var t in this.__transition)if(+t!==n)return;e&&e.removeChild(this)}}function $3(){return this.on("end.remove",O3(this._id))}function D3(n){var e=this._name,t=this._id;typeof n!="function"&&(n=Xd(n));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var a=r[o],l=a.length,c=s[o]=new Array(l),u,h,f=0;f<l;++f)(u=a[f])&&(h=n.call(u,u.__data__,f,a))&&("__data__"in u&&(h.__data__=u.__data__),c[f]=h,Yl(c[f],e,t,f,c,Sn(u,t)));return new er(s,this._parents,e,t)}function N3(n){var e=this._name,t=this._id;typeof n!="function"&&(n=my(n));for(var r=this._groups,i=r.length,s=[],o=[],a=0;a<i;++a)for(var l=r[a],c=l.length,u,h=0;h<c;++h)if(u=l[h]){for(var f=n.call(u,u.__data__,h,l),p,m=Sn(u,t),g=0,x=f.length;g<x;++g)(p=f[g])&&Yl(p,e,t,g,f,m);s.push(f),o.push(u)}return new er(s,o,e,t)}var L3=Io.prototype.constructor;function F3(){return new L3(this._groups,this._parents)}function z3(n,e){var t,r,i;return function(){var s=Fi(this,n),o=(this.style.removeProperty(n),Fi(this,n));return s===o?null:s===t&&o===r?i:i=e(t=s,r=o)}}function Ly(n){return function(){this.style.removeProperty(n)}}function B3(n,e,t){var r,i=t+"",s;return function(){var o=Fi(this,n);return o===i?null:o===r?s:s=e(r=o,t)}}function H3(n,e,t){var r,i,s;return function(){var o=Fi(this,n),a=t(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(n),Fi(this,n))),o===l?null:o===r&&l===i?s:(i=l,s=e(r=o,a))}}function V3(n,e){var t,r,i,s="style."+e,o="end."+s,a;return function(){var l=Hn(this,n),c=l.on,u=l.value[s]==null?a||(a=Ly(e)):void 0;(c!==t||i!==u)&&(r=(t=c).copy()).on(o,i=u),l.on=r}}function W3(n,e,t){var r=(n+="")=="transform"?WE:Ny;return e==null?this.styleTween(n,z3(n,r)).on("end.style."+n,Ly(n)):typeof e=="function"?this.styleTween(n,H3(n,r,th(this,"style."+n,e))).each(V3(this._id,n)):this.styleTween(n,B3(n,r,e),t).on("end.style."+n,null)}function U3(n,e,t){return function(r){this.style.setProperty(n,e.call(this,r),t)}}function q3(n,e,t){var r,i;function s(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&U3(n,o,t)),r}return s._value=e,s}function X3(n,e,t){var r="style."+(n+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,q3(n,e,t??""))}function G3(n){return function(){this.textContent=n}}function Y3(n){return function(){var e=n(this);this.textContent=e??""}}function K3(n){return this.tween("text",typeof n=="function"?Y3(th(this,"text",n)):G3(n==null?"":n+""))}function Z3(n){return function(e){this.textContent=n.call(this,e)}}function J3(n){var e,t;function r(){var i=n.apply(this,arguments);return i!==t&&(e=(t=i)&&Z3(i)),e}return r._value=n,r}function Q3(n){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(n==null)return this.tween(e,null);if(typeof n!="function")throw new Error;return this.tween(e,J3(n))}function eI(){for(var n=this._name,e=this._id,t=Fy(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,l,c=0;c<a;++c)if(l=o[c]){var u=Sn(l,e);Yl(l,n,t,c,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new er(r,this._parents,n,t)}function tI(){var n,e,t=this,r=t._id,i=t.size();return new Promise(function(s,o){var a={value:o},l={value:function(){--i===0&&s()}};t.each(function(){var c=Hn(this,r),u=c.on;u!==n&&(e=(n=u).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),c.on=e}),i===0&&s()})}var nI=0;function er(n,e,t,r){this._groups=n,this._parents=e,this._name=t,this._id=r}function Fy(){return++nI}var Vn=Io.prototype;er.prototype={constructor:er,select:D3,selectAll:N3,selectChild:Vn.selectChild,selectChildren:Vn.selectChildren,filter:M3,merge:A3,selection:F3,transition:eI,call:Vn.call,nodes:Vn.nodes,node:Vn.node,size:Vn.size,empty:Vn.empty,each:Vn.each,on:R3,attr:f3,attrTween:b3,style:W3,styleTween:X3,text:K3,textTween:Q3,remove:$3,tween:o3,delay:w3,duration:P3,ease:k3,easeVarying:T3,end:tI,[Symbol.iterator]:Vn[Symbol.iterator]};function rI(n){return((n*=2)<=1?n*n*n:(n-=2)*n*n+2)/2}var iI={time:null,delay:0,duration:250,ease:rI};function sI(n,e){for(var t;!(t=n.__transition)||!(t=t[e]);)if(!(n=n.parentNode))throw new Error(`transition ${e} not found`);return t}function oI(n){var e,t;n instanceof er?(e=n._id,n=n._name):(e=Fy(),(t=iI).time=Jd(),n=n==null?null:n+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,l,c=0;c<a;++c)(l=o[c])&&Yl(l,n,e,c,o,t||sI(l,e));return new er(r,this._parents,n,e)}Io.prototype.interrupt=r3;Io.prototype.transition=oI;const Tu=Math.PI,Mu=2*Tu,Rr=1e-6,aI=Mu-Rr;function zy(n){this._+=n[0];for(let e=1,t=n.length;e<t;++e)this._+=arguments[e]+n[e]}function lI(n){let e=Math.floor(n);if(!(e>=0))throw new Error(`invalid digits: ${n}`);if(e>15)return zy;const t=10**e;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*t)/t+r[i]}}class By{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?zy:lI(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,r,i){this._append`Q${+e},${+t},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,t,r,i,s,o){this._append`C${+e},${+t},${+r},${+i},${this._x1=+s},${this._y1=+o}`}arcTo(e,t,r,i,s){if(e=+e,t=+t,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,a=this._y1,l=r-e,c=i-t,u=o-e,h=a-t,f=u*u+h*h;if(this._x1===null)this._append`M${this._x1=e},${this._y1=t}`;else if(f>Rr)if(!(Math.abs(h*l-c*u)>Rr)||!s)this._append`L${this._x1=e},${this._y1=t}`;else{let p=r-o,m=i-a,g=l*l+c*c,x=p*p+m*m,b=Math.sqrt(g),y=Math.sqrt(f),w=s*Math.tan((Tu-Math.acos((g+f-x)/(2*b*y)))/2),v=w/y,S=w/b;Math.abs(v-1)>Rr&&this._append`L${e+v*u},${t+v*h}`,this._append`A${s},${s},0,0,${+(h*p>u*m)},${this._x1=e+S*l},${this._y1=t+S*c}`}}arc(e,t,r,i,s,o){if(e=+e,t=+t,r=+r,o=!!o,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(i),l=r*Math.sin(i),c=e+a,u=t+l,h=1^o,f=o?i-s:s-i;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>Rr||Math.abs(this._y1-u)>Rr)&&this._append`L${c},${u}`,r&&(f<0&&(f=f%Mu+Mu),f>aI?this._append`A${r},${r},0,1,${h},${e-a},${t-l}A${r},${r},0,1,${h},${this._x1=c},${this._y1=u}`:f>Rr&&this._append`A${r},${r},0,${+(f>=Tu)},${h},${this._x1=e+r*Math.cos(s)},${this._y1=t+r*Math.sin(s)}`)}rect(e,t,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function yi(){return new By}yi.prototype=By.prototype;function cI(n){const e=+this._x.call(null,n),t=+this._y.call(null,n);return Hy(this.cover(e,t),e,t,n)}function Hy(n,e,t,r){if(isNaN(e)||isNaN(t))return n;var i,s=n._root,o={data:r},a=n._x0,l=n._y0,c=n._x1,u=n._y1,h,f,p,m,g,x,b,y;if(!s)return n._root=o,n;for(;s.length;)if((g=e>=(h=(a+c)/2))?a=h:c=h,(x=t>=(f=(l+u)/2))?l=f:u=f,i=s,!(s=s[b=x<<1|g]))return i[b]=o,n;if(p=+n._x.call(null,s.data),m=+n._y.call(null,s.data),e===p&&t===m)return o.next=s,i?i[b]=o:n._root=o,n;do i=i?i[b]=new Array(4):n._root=new Array(4),(g=e>=(h=(a+c)/2))?a=h:c=h,(x=t>=(f=(l+u)/2))?l=f:u=f;while((b=x<<1|g)===(y=(m>=f)<<1|p>=h));return i[y]=s,i[b]=o,n}function uI(n){var e,t,r=n.length,i,s,o=new Array(r),a=new Array(r),l=1/0,c=1/0,u=-1/0,h=-1/0;for(t=0;t<r;++t)isNaN(i=+this._x.call(null,e=n[t]))||isNaN(s=+this._y.call(null,e))||(o[t]=i,a[t]=s,i<l&&(l=i),i>u&&(u=i),s<c&&(c=s),s>h&&(h=s));if(l>u||c>h)return this;for(this.cover(l,c).cover(u,h),t=0;t<r;++t)Hy(this,o[t],a[t],n[t]);return this}function dI(n,e){if(isNaN(n=+n)||isNaN(e=+e))return this;var t=this._x0,r=this._y0,i=this._x1,s=this._y1;if(isNaN(t))i=(t=Math.floor(n))+1,s=(r=Math.floor(e))+1;else{for(var o=i-t||1,a=this._root,l,c;t>n||n>=i||r>e||e>=s;)switch(c=(e<r)<<1|n<t,l=new Array(4),l[c]=a,a=l,o*=2,c){case 0:i=t+o,s=r+o;break;case 1:t=i-o,s=r+o;break;case 2:i=t+o,r=s-o;break;case 3:t=i-o,r=s-o;break}this._root&&this._root.length&&(this._root=a)}return this._x0=t,this._y0=r,this._x1=i,this._y1=s,this}function hI(){var n=[];return this.visit(function(e){if(!e.length)do n.push(e.data);while(e=e.next)}),n}function fI(n){return arguments.length?this.cover(+n[0][0],+n[0][1]).cover(+n[1][0],+n[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function bt(n,e,t,r,i){this.node=n,this.x0=e,this.y0=t,this.x1=r,this.y1=i}function pI(n,e,t){var r,i=this._x0,s=this._y0,o,a,l,c,u=this._x1,h=this._y1,f=[],p=this._root,m,g;for(p&&f.push(new bt(p,i,s,u,h)),t==null?t=1/0:(i=n-t,s=e-t,u=n+t,h=e+t,t*=t);m=f.pop();)if(!(!(p=m.node)||(o=m.x0)>u||(a=m.y0)>h||(l=m.x1)<i||(c=m.y1)<s))if(p.length){var x=(o+l)/2,b=(a+c)/2;f.push(new bt(p[3],x,b,l,c),new bt(p[2],o,b,x,c),new bt(p[1],x,a,l,b),new bt(p[0],o,a,x,b)),(g=(e>=b)<<1|n>=x)&&(m=f[f.length-1],f[f.length-1]=f[f.length-1-g],f[f.length-1-g]=m)}else{var y=n-+this._x.call(null,p.data),w=e-+this._y.call(null,p.data),v=y*y+w*w;if(v<t){var S=Math.sqrt(t=v);i=n-S,s=e-S,u=n+S,h=e+S,r=p.data}}return r}function mI(n){if(isNaN(u=+this._x.call(null,n))||isNaN(h=+this._y.call(null,n)))return this;var e,t=this._root,r,i,s,o=this._x0,a=this._y0,l=this._x1,c=this._y1,u,h,f,p,m,g,x,b;if(!t)return this;if(t.length)for(;;){if((m=u>=(f=(o+l)/2))?o=f:l=f,(g=h>=(p=(a+c)/2))?a=p:c=p,e=t,!(t=t[x=g<<1|m]))return this;if(!t.length)break;(e[x+1&3]||e[x+2&3]||e[x+3&3])&&(r=e,b=x)}for(;t.data!==n;)if(i=t,!(t=t.next))return this;return(s=t.next)&&delete t.next,i?(s?i.next=s:delete i.next,this):e?(s?e[x]=s:delete e[x],(t=e[0]||e[1]||e[2]||e[3])&&t===(e[3]||e[2]||e[1]||e[0])&&!t.length&&(r?r[b]=t:this._root=t),this):(this._root=s,this)}function gI(n){for(var e=0,t=n.length;e<t;++e)this.remove(n[e]);return this}function xI(){return this._root}function bI(){var n=0;return this.visit(function(e){if(!e.length)do++n;while(e=e.next)}),n}function yI(n){var e=[],t,r=this._root,i,s,o,a,l;for(r&&e.push(new bt(r,this._x0,this._y0,this._x1,this._y1));t=e.pop();)if(!n(r=t.node,s=t.x0,o=t.y0,a=t.x1,l=t.y1)&&r.length){var c=(s+a)/2,u=(o+l)/2;(i=r[3])&&e.push(new bt(i,c,u,a,l)),(i=r[2])&&e.push(new bt(i,s,u,c,l)),(i=r[1])&&e.push(new bt(i,c,o,a,u)),(i=r[0])&&e.push(new bt(i,s,o,c,u))}return this}function vI(n){var e=[],t=[],r;for(this._root&&e.push(new bt(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var i=r.node;if(i.length){var s,o=r.x0,a=r.y0,l=r.x1,c=r.y1,u=(o+l)/2,h=(a+c)/2;(s=i[0])&&e.push(new bt(s,o,a,u,h)),(s=i[1])&&e.push(new bt(s,u,a,l,h)),(s=i[2])&&e.push(new bt(s,o,h,u,c)),(s=i[3])&&e.push(new bt(s,u,h,l,c))}t.push(r)}for(;r=t.pop();)n(r.node,r.x0,r.y0,r.x1,r.y1);return this}function wI(n){return n[0]}function _I(n){return arguments.length?(this._x=n,this):this._x}function SI(n){return n[1]}function PI(n){return arguments.length?(this._y=n,this):this._y}function nh(n,e,t){var r=new rh(e??wI,t??SI,NaN,NaN,NaN,NaN);return n==null?r:r.addAll(n)}function rh(n,e,t,r,i,s){this._x=n,this._y=e,this._x0=t,this._y0=r,this._x1=i,this._y1=s,this._root=void 0}function Zf(n){for(var e={data:n.data},t=e;n=n.next;)t=t.next={data:n.data};return e}var St=nh.prototype=rh.prototype;St.copy=function(){var n=new rh(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,t,r;if(!e)return n;if(!e.length)return n._root=Zf(e),n;for(t=[{source:e,target:n._root=new Array(4)}];e=t.pop();)for(var i=0;i<4;++i)(r=e.source[i])&&(r.length?t.push({source:r,target:e.target[i]=new Array(4)}):e.target[i]=Zf(r));return n};St.add=cI;St.addAll=uI;St.cover=dI;St.data=hI;St.extent=fI;St.find=pI;St.remove=mI;St.removeAll=gI;St.root=xI;St.size=bI;St.visit=yI;St.visitAfter=vI;St.x=_I;St.y=PI;function yt(n){return function(){return n}}function mr(n){return(n()-.5)*1e-6}function CI(n){return n.x+n.vx}function kI(n){return n.y+n.vy}function jI(n){var e,t,r,i=1,s=1;typeof n!="function"&&(n=yt(n==null?1:+n));function o(){for(var c,u=e.length,h,f,p,m,g,x,b=0;b<s;++b)for(h=nh(e,CI,kI).visitAfter(a),c=0;c<u;++c)f=e[c],g=t[f.index],x=g*g,p=f.x+f.vx,m=f.y+f.vy,h.visit(y);function y(w,v,S,k,P){var C=w.data,T=w.r,A=g+T;if(C){if(C.index>f.index){var M=p-C.x-C.vx,O=m-C.y-C.vy,R=M*M+O*O;R<A*A&&(M===0&&(M=mr(r),R+=M*M),O===0&&(O=mr(r),R+=O*O),R=(A-(R=Math.sqrt(R)))/R*i,f.vx+=(M*=R)*(A=(T*=T)/(x+T)),f.vy+=(O*=R)*A,C.vx-=M*(A=1-A),C.vy-=O*A)}return}return v>p+A||k<p-A||S>m+A||P<m-A}}function a(c){if(c.data)return c.r=t[c.data.index];for(var u=c.r=0;u<4;++u)c[u]&&c[u].r>c.r&&(c.r=c[u].r)}function l(){if(e){var c,u=e.length,h;for(t=new Array(u),c=0;c<u;++c)h=e[c],t[h.index]=+n(h,c,e)}}return o.initialize=function(c,u){e=c,r=u,l()},o.iterations=function(c){return arguments.length?(s=+c,o):s},o.strength=function(c){return arguments.length?(i=+c,o):i},o.radius=function(c){return arguments.length?(n=typeof c=="function"?c:yt(+c),l(),o):n},o}function TI(n){return n.index}function Jf(n,e){var t=n.get(e);if(!t)throw new Error("node not found: "+e);return t}function MI(n){var e=TI,t=h,r,i=yt(30),s,o,a,l,c,u=1;n==null&&(n=[]);function h(x){return 1/Math.min(a[x.source.index],a[x.target.index])}function f(x){for(var b=0,y=n.length;b<u;++b)for(var w=0,v,S,k,P,C,T,A;w<y;++w)v=n[w],S=v.source,k=v.target,P=k.x+k.vx-S.x-S.vx||mr(c),C=k.y+k.vy-S.y-S.vy||mr(c),T=Math.sqrt(P*P+C*C),T=(T-s[w])/T*x*r[w],P*=T,C*=T,k.vx-=P*(A=l[w]),k.vy-=C*A,S.vx+=P*(A=1-A),S.vy+=C*A}function p(){if(o){var x,b=o.length,y=n.length,w=new Map(o.map((S,k)=>[e(S,k,o),S])),v;for(x=0,a=new Array(b);x<y;++x)v=n[x],v.index=x,typeof v.source!="object"&&(v.source=Jf(w,v.source)),typeof v.target!="object"&&(v.target=Jf(w,v.target)),a[v.source.index]=(a[v.source.index]||0)+1,a[v.target.index]=(a[v.target.index]||0)+1;for(x=0,l=new Array(y);x<y;++x)v=n[x],l[x]=a[v.source.index]/(a[v.source.index]+a[v.target.index]);r=new Array(y),m(),s=new Array(y),g()}}function m(){if(o)for(var x=0,b=n.length;x<b;++x)r[x]=+t(n[x],x,n)}function g(){if(o)for(var x=0,b=n.length;x<b;++x)s[x]=+i(n[x],x,n)}return f.initialize=function(x,b){o=x,c=b,p()},f.links=function(x){return arguments.length?(n=x,p(),f):n},f.id=function(x){return arguments.length?(e=x,f):e},f.iterations=function(x){return arguments.length?(u=+x,f):u},f.strength=function(x){return arguments.length?(t=typeof x=="function"?x:yt(+x),m(),f):t},f.distance=function(x){return arguments.length?(i=typeof x=="function"?x:yt(+x),g(),f):i},f}const AI=1664525,EI=1013904223,Qf=4294967296;function II(){let n=1;return()=>(n=(AI*n+EI)%Qf)/Qf}function RI(n){return n.x}function OI(n){return n.y}var $I=10,DI=Math.PI*(3-Math.sqrt(5));function NI(n){var e,t=1,r=.001,i=1-Math.pow(r,1/300),s=0,o=.6,a=new Map,l=Qd(h),c=Eo("tick","end"),u=II();n==null&&(n=[]);function h(){f(),c.call("tick",e),t<r&&(l.stop(),c.call("end",e))}function f(g){var x,b=n.length,y;g===void 0&&(g=1);for(var w=0;w<g;++w)for(t+=(s-t)*i,a.forEach(function(v){v(t)}),x=0;x<b;++x)y=n[x],y.fx==null?y.x+=y.vx*=o:(y.x=y.fx,y.vx=0),y.fy==null?y.y+=y.vy*=o:(y.y=y.fy,y.vy=0);return e}function p(){for(var g=0,x=n.length,b;g<x;++g){if(b=n[g],b.index=g,b.fx!=null&&(b.x=b.fx),b.fy!=null&&(b.y=b.fy),isNaN(b.x)||isNaN(b.y)){var y=$I*Math.sqrt(.5+g),w=g*DI;b.x=y*Math.cos(w),b.y=y*Math.sin(w)}(isNaN(b.vx)||isNaN(b.vy))&&(b.vx=b.vy=0)}}function m(g){return g.initialize&&g.initialize(n,u),g}return p(),e={tick:f,restart:function(){return l.restart(h),e},stop:function(){return l.stop(),e},nodes:function(g){return arguments.length?(n=g,p(),a.forEach(m),e):n},alpha:function(g){return arguments.length?(t=+g,e):t},alphaMin:function(g){return arguments.length?(r=+g,e):r},alphaDecay:function(g){return arguments.length?(i=+g,e):+i},alphaTarget:function(g){return arguments.length?(s=+g,e):s},velocityDecay:function(g){return arguments.length?(o=1-g,e):1-o},randomSource:function(g){return arguments.length?(u=g,a.forEach(m),e):u},force:function(g,x){return arguments.length>1?(x==null?a.delete(g):a.set(g,m(x)),e):a.get(g)},find:function(g,x,b){var y=0,w=n.length,v,S,k,P,C;for(b==null?b=1/0:b*=b,y=0;y<w;++y)P=n[y],v=g-P.x,S=x-P.y,k=v*v+S*S,k<b&&(C=P,b=k);return C},on:function(g,x){return arguments.length>1?(c.on(g,x),e):c.on(g)}}}function LI(){var n,e,t,r,i=yt(-30),s,o=1,a=1/0,l=.81;function c(p){var m,g=n.length,x=nh(n,RI,OI).visitAfter(h);for(r=p,m=0;m<g;++m)e=n[m],x.visit(f)}function u(){if(n){var p,m=n.length,g;for(s=new Array(m),p=0;p<m;++p)g=n[p],s[g.index]=+i(g,p,n)}}function h(p){var m=0,g,x,b=0,y,w,v;if(p.length){for(y=w=v=0;v<4;++v)(g=p[v])&&(x=Math.abs(g.value))&&(m+=g.value,b+=x,y+=x*g.x,w+=x*g.y);p.x=y/b,p.y=w/b}else{g=p,g.x=g.data.x,g.y=g.data.y;do m+=s[g.data.index];while(g=g.next)}p.value=m}function f(p,m,g,x){if(!p.value)return!0;var b=p.x-e.x,y=p.y-e.y,w=x-m,v=b*b+y*y;if(w*w/l<v)return v<a&&(b===0&&(b=mr(t),v+=b*b),y===0&&(y=mr(t),v+=y*y),v<o&&(v=Math.sqrt(o*v)),e.vx+=b*p.value*r/v,e.vy+=y*p.value*r/v),!0;if(p.length||v>=a)return;(p.data!==e||p.next)&&(b===0&&(b=mr(t),v+=b*b),y===0&&(y=mr(t),v+=y*y),v<o&&(v=Math.sqrt(o*v)));do p.data!==e&&(w=s[p.data.index]*r/v,e.vx+=b*w,e.vy+=y*w);while(p=p.next)}return c.initialize=function(p,m){n=p,t=m,u()},c.strength=function(p){return arguments.length?(i=typeof p=="function"?p:yt(+p),u(),c):i},c.distanceMin=function(p){return arguments.length?(o=p*p,c):Math.sqrt(o)},c.distanceMax=function(p){return arguments.length?(a=p*p,c):Math.sqrt(a)},c.theta=function(p){return arguments.length?(l=p*p,c):Math.sqrt(l)},c}function FI(n){var e=yt(.1),t,r,i;typeof n!="function"&&(n=yt(n==null?0:+n));function s(a){for(var l=0,c=t.length,u;l<c;++l)u=t[l],u.vx+=(i[l]-u.x)*r[l]*a}function o(){if(t){var a,l=t.length;for(r=new Array(l),i=new Array(l),a=0;a<l;++a)r[a]=isNaN(i[a]=+n(t[a],a,t))?0:+e(t[a],a,t)}}return s.initialize=function(a){t=a,o()},s.strength=function(a){return arguments.length?(e=typeof a=="function"?a:yt(+a),o(),s):e},s.x=function(a){return arguments.length?(n=typeof a=="function"?a:yt(+a),o(),s):n},s}function zI(n){var e=yt(.1),t,r,i;typeof n!="function"&&(n=yt(n==null?0:+n));function s(a){for(var l=0,c=t.length,u;l<c;++l)u=t[l],u.vy+=(i[l]-u.y)*r[l]*a}function o(){if(t){var a,l=t.length;for(r=new Array(l),i=new Array(l),a=0;a<l;++a)r[a]=isNaN(i[a]=+n(t[a],a,t))?0:+e(t[a],a,t)}}return s.initialize=function(a){t=a,o()},s.strength=function(a){return arguments.length?(e=typeof a=="function"?a:yt(+a),o(),s):e},s.y=function(a){return arguments.length?(n=typeof a=="function"?a:yt(+a),o(),s):n},s}function BI(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function Ka(n,e){if((t=(n=e?n.toExponential(e-1):n.toExponential()).indexOf("e"))<0)return null;var t,r=n.slice(0,t);return[r.length>1?r[0]+r.slice(2):r,+n.slice(t+1)]}function Bi(n){return n=Ka(Math.abs(n)),n?n[1]:NaN}function HI(n,e){return function(t,r){for(var i=t.length,s=[],o=0,a=n[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),s.push(t.substring(i-=a,i+a)),!((l+=a+1)>r));)a=n[o=(o+1)%n.length];return s.reverse().join(e)}}function VI(n){return function(e){return e.replace(/[0-9]/g,function(t){return n[+t]})}}var WI=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Za(n){if(!(e=WI.exec(n)))throw new Error("invalid format: "+n);var e;return new ih({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}Za.prototype=ih.prototype;function ih(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}ih.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function UI(n){e:for(var e=n.length,t=1,r=-1,i;t<e;++t)switch(n[t]){case".":r=i=t;break;case"0":r===0&&(r=t),i=t;break;default:if(!+n[t])break e;r>0&&(r=0);break}return r>0?n.slice(0,r)+n.slice(i+1):n}var Vy;function qI(n,e){var t=Ka(n,e);if(!t)return n+"";var r=t[0],i=t[1],s=i-(Vy=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return s===o?r:s>o?r+new Array(s-o+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+Ka(n,Math.max(0,e+s-1))[0]}function ep(n,e){var t=Ka(n,e);if(!t)return n+"";var r=t[0],i=t[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const tp={"%":(n,e)=>(n*100).toFixed(e),b:n=>Math.round(n).toString(2),c:n=>n+"",d:BI,e:(n,e)=>n.toExponential(e),f:(n,e)=>n.toFixed(e),g:(n,e)=>n.toPrecision(e),o:n=>Math.round(n).toString(8),p:(n,e)=>ep(n*100,e),r:ep,s:qI,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function np(n){return n}var rp=Array.prototype.map,ip=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function XI(n){var e=n.grouping===void 0||n.thousands===void 0?np:HI(rp.call(n.grouping,Number),n.thousands+""),t=n.currency===void 0?"":n.currency[0]+"",r=n.currency===void 0?"":n.currency[1]+"",i=n.decimal===void 0?".":n.decimal+"",s=n.numerals===void 0?np:VI(rp.call(n.numerals,String)),o=n.percent===void 0?"%":n.percent+"",a=n.minus===void 0?"":n.minus+"",l=n.nan===void 0?"NaN":n.nan+"";function c(h){h=Za(h);var f=h.fill,p=h.align,m=h.sign,g=h.symbol,x=h.zero,b=h.width,y=h.comma,w=h.precision,v=h.trim,S=h.type;S==="n"?(y=!0,S="g"):tp[S]||(w===void 0&&(w=12),v=!0,S="g"),(x||f==="0"&&p==="=")&&(x=!0,f="0",p="=");var k=g==="$"?t:g==="#"&&/[boxX]/.test(S)?"0"+S.toLowerCase():"",P=g==="$"?r:/[%p]/.test(S)?o:"",C=tp[S],T=/[defgprs%]/.test(S);w=w===void 0?6:/[gprs]/.test(S)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function A(M){var O=k,R=P,j,I,E;if(S==="c")R=C(M)+R,M="";else{M=+M;var D=M<0||1/M<0;if(M=isNaN(M)?l:C(Math.abs(M),w),v&&(M=UI(M)),D&&+M==0&&m!=="+"&&(D=!1),O=(D?m==="("?m:a:m==="-"||m==="("?"":m)+O,R=(S==="s"?ip[8+Vy/3]:"")+R+(D&&m==="("?")":""),T){for(j=-1,I=M.length;++j<I;)if(E=M.charCodeAt(j),48>E||E>57){R=(E===46?i+M.slice(j+1):M.slice(j))+R,M=M.slice(0,j);break}}}y&&!x&&(M=e(M,1/0));var L=O.length+M.length+R.length,z=L<b?new Array(b-L+1).join(f):"";switch(y&&x&&(M=e(z+M,z.length?b-R.length:1/0),z=""),p){case"<":M=O+M+R+z;break;case"=":M=O+z+M+R;break;case"^":M=z.slice(0,L=z.length>>1)+O+M+R+z.slice(L);break;default:M=z+O+M+R;break}return s(M)}return A.toString=function(){return h+""},A}function u(h,f){var p=c((h=Za(h),h.type="f",h)),m=Math.max(-8,Math.min(8,Math.floor(Bi(f)/3)))*3,g=Math.pow(10,-m),x=ip[8+m/3];return function(b){return p(g*b)+x}}return{format:c,formatPrefix:u}}var Ko,Wy,Uy;GI({thousands:",",grouping:[3],currency:["$",""]});function GI(n){return Ko=XI(n),Wy=Ko.format,Uy=Ko.formatPrefix,Ko}function YI(n){return Math.max(0,-Bi(Math.abs(n)))}function KI(n,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Bi(e)/3)))*3-Bi(Math.abs(n)))}function ZI(n,e){return n=Math.abs(n),e=Math.abs(e)-n,Math.max(0,Bi(e)-Bi(n))+1}function qy(n,e){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(e).domain(n);break}return this}function JI(n){return function(){return n}}function QI(n){return+n}var sp=[0,1];function wi(n){return n}function Au(n,e){return(e-=n=+n)?function(t){return(t-n)/e}:JI(isNaN(e)?NaN:.5)}function eR(n,e){var t;return n>e&&(t=n,n=e,e=t),function(r){return Math.max(n,Math.min(e,r))}}function tR(n,e,t){var r=n[0],i=n[1],s=e[0],o=e[1];return i<r?(r=Au(i,r),s=t(o,s)):(r=Au(r,i),s=t(s,o)),function(a){return s(r(a))}}function nR(n,e,t){var r=Math.min(n.length,e.length)-1,i=new Array(r),s=new Array(r),o=-1;for(n[r]<n[0]&&(n=n.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=Au(n[o],n[o+1]),s[o]=t(e[o],e[o+1]);return function(a){var l=Ud(n,a,1,r)-1;return s[l](i[l](a))}}function rR(n,e){return e.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function iR(){var n=sp,e=sp,t=Zd,r,i,s,o=wi,a,l,c;function u(){var f=Math.min(n.length,e.length);return o!==wi&&(o=eR(n[0],n[f-1])),a=f>2?nR:tR,l=c=null,h}function h(f){return f==null||isNaN(f=+f)?s:(l||(l=a(n.map(r),e,t)))(r(o(f)))}return h.invert=function(f){return o(i((c||(c=a(e,n.map(r),dn)))(f)))},h.domain=function(f){return arguments.length?(n=Array.from(f,QI),u()):n.slice()},h.range=function(f){return arguments.length?(e=Array.from(f),u()):e.slice()},h.rangeRound=function(f){return e=Array.from(f),t=BE,u()},h.clamp=function(f){return arguments.length?(o=f?!0:wi,u()):o!==wi},h.interpolate=function(f){return arguments.length?(t=f,u()):t},h.unknown=function(f){return arguments.length?(s=f,h):s},function(f,p){return r=f,i=p,u()}}function sR(){return iR()(wi,wi)}function oR(n,e,t,r){var i=jM(n,e,t),s;switch(r=Za(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(n),Math.abs(e));return r.precision==null&&!isNaN(s=KI(i,o))&&(r.precision=s),Uy(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=ZI(i,Math.max(Math.abs(n),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=YI(i))&&(r.precision=s-(r.type==="%")*2);break}}return Wy(r)}function aR(n){var e=n.domain;return n.ticks=function(t){var r=e();return qd(r[0],r[r.length-1],t??10)},n.tickFormat=function(t,r){var i=e();return oR(i[0],i[i.length-1],t??10,r)},n.nice=function(t){t==null&&(t=10);var r=e(),i=0,s=r.length-1,o=r[i],a=r[s],l,c,u=10;for(a<o&&(c=o,o=a,a=c,c=i,i=s,s=c);u-- >0;){if(c=Li(o,a,t),c===l)return r[i]=o,r[s]=a,e(r);if(c>0)o=Math.floor(o/c)*c,a=Math.ceil(a/c)*c;else if(c<0)o=Math.ceil(o*c)/c,a=Math.floor(a*c)/c;else break;l=c}return n},n}function sh(){var n=sR();return n.copy=function(){return rR(n,sh())},qy.apply(n,arguments),aR(n)}function Xy(){var n=[.5],e=[0,1],t,r=1;function i(s){return s!=null&&s<=s?e[Ud(n,s,0,r)]:t}return i.domain=function(s){return arguments.length?(n=Array.from(s),r=Math.min(n.length,e.length-1),i):n.slice()},i.range=function(s){return arguments.length?(e=Array.from(s),r=Math.min(n.length,e.length-1),i):e.slice()},i.invertExtent=function(s){var o=e.indexOf(s);return[n[o-1],n[o]]},i.unknown=function(s){return arguments.length?(t=s,i):t},i.copy=function(){return Xy().domain(n).range(e).unknown(t)},qy.apply(i,arguments)}const Zo=n=>()=>n;function lR(n,{sourceEvent:e,target:t,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:n,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:t,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function Zn(n,e,t){this.k=n,this.x=e,this.y=t}Zn.prototype={constructor:Zn,scale:function(n){return n===1?this:new Zn(this.k*n,this.x,this.y)},translate:function(n,e){return n===0&e===0?this:new Zn(this.k,this.x+this.k*n,this.y+this.k*e)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Kl=new Zn(1,0,0);Gy.prototype=Zn.prototype;function Gy(n){for(;!n.__zoom;)if(!(n=n.parentNode))return Kl;return n.__zoom}function Ic(n){n.stopImmediatePropagation()}function ps(n){n.preventDefault(),n.stopImmediatePropagation()}function cR(n){return(!n.ctrlKey||n.type==="wheel")&&!n.button}function uR(){var n=this;return n instanceof SVGElement?(n=n.ownerSVGElement||n,n.hasAttribute("viewBox")?(n=n.viewBox.baseVal,[[n.x,n.y],[n.x+n.width,n.y+n.height]]):[[0,0],[n.width.baseVal.value,n.height.baseVal.value]]):[[0,0],[n.clientWidth,n.clientHeight]]}function op(){return this.__zoom||Kl}function dR(n){return-n.deltaY*(n.deltaMode===1?.05:n.deltaMode?1:.002)*(n.ctrlKey?10:1)}function hR(){return navigator.maxTouchPoints||"ontouchstart"in this}function fR(n,e,t){var r=n.invertX(e[0][0])-t[0][0],i=n.invertX(e[1][0])-t[1][0],s=n.invertY(e[0][1])-t[0][1],o=n.invertY(e[1][1])-t[1][1];return n.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function pR(){var n=cR,e=uR,t=fR,r=dR,i=hR,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],a=250,l=YE,c=Eo("start","zoom","end"),u,h,f,p=500,m=150,g=0,x=10;function b(j){j.property("__zoom",op).on("wheel.zoom",C,{passive:!1}).on("mousedown.zoom",T).on("dblclick.zoom",A).filter(i).on("touchstart.zoom",M).on("touchmove.zoom",O).on("touchend.zoom touchcancel.zoom",R).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}b.transform=function(j,I,E,D){var L=j.selection?j.selection():j;L.property("__zoom",op),j!==L?S(j,I,E,D):L.interrupt().each(function(){k(this,arguments).event(D).start().zoom(null,typeof I=="function"?I.apply(this,arguments):I).end()})},b.scaleBy=function(j,I,E,D){b.scaleTo(j,function(){var L=this.__zoom.k,z=typeof I=="function"?I.apply(this,arguments):I;return L*z},E,D)},b.scaleTo=function(j,I,E,D){b.transform(j,function(){var L=e.apply(this,arguments),z=this.__zoom,B=E==null?v(L):typeof E=="function"?E.apply(this,arguments):E,N=z.invert(B),U=typeof I=="function"?I.apply(this,arguments):I;return t(w(y(z,U),B,N),L,o)},E,D)},b.translateBy=function(j,I,E,D){b.transform(j,function(){return t(this.__zoom.translate(typeof I=="function"?I.apply(this,arguments):I,typeof E=="function"?E.apply(this,arguments):E),e.apply(this,arguments),o)},null,D)},b.translateTo=function(j,I,E,D,L){b.transform(j,function(){var z=e.apply(this,arguments),B=this.__zoom,N=D==null?v(z):typeof D=="function"?D.apply(this,arguments):D;return t(Kl.translate(N[0],N[1]).scale(B.k).translate(typeof I=="function"?-I.apply(this,arguments):-I,typeof E=="function"?-E.apply(this,arguments):-E),z,o)},D,L)};function y(j,I){return I=Math.max(s[0],Math.min(s[1],I)),I===j.k?j:new Zn(I,j.x,j.y)}function w(j,I,E){var D=I[0]-E[0]*j.k,L=I[1]-E[1]*j.k;return D===j.x&&L===j.y?j:new Zn(j.k,D,L)}function v(j){return[(+j[0][0]+ +j[1][0])/2,(+j[0][1]+ +j[1][1])/2]}function S(j,I,E,D){j.on("start.zoom",function(){k(this,arguments).event(D).start()}).on("interrupt.zoom end.zoom",function(){k(this,arguments).event(D).end()}).tween("zoom",function(){var L=this,z=arguments,B=k(L,z).event(D),N=e.apply(L,z),U=E==null?v(N):typeof E=="function"?E.apply(L,z):E,q=Math.max(N[1][0]-N[0][0],N[1][1]-N[0][1]),X=L.__zoom,J=typeof I=="function"?I.apply(L,z):I,ee=l(X.invert(U).concat(q/X.k),J.invert(U).concat(q/J.k));return function(re){if(re===1)re=J;else{var oe=ee(re),me=q/oe[2];re=new Zn(me,U[0]-oe[0]*me,U[1]-oe[1]*me)}B.zoom(null,re)}})}function k(j,I,E){return!E&&j.__zooming||new P(j,I)}function P(j,I){this.that=j,this.args=I,this.active=0,this.sourceEvent=null,this.extent=e.apply(j,I),this.taps=0}P.prototype={event:function(j){return j&&(this.sourceEvent=j),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(j,I){return this.mouse&&j!=="mouse"&&(this.mouse[1]=I.invert(this.mouse[0])),this.touch0&&j!=="touch"&&(this.touch0[1]=I.invert(this.touch0[0])),this.touch1&&j!=="touch"&&(this.touch1[1]=I.invert(this.touch1[0])),this.that.__zoom=I,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(j){var I=hn(this.that).datum();c.call(j,this.that,new lR(j,{sourceEvent:this.sourceEvent,target:b,transform:this.that.__zoom,dispatch:c}),I)}};function C(j,...I){if(!n.apply(this,arguments))return;var E=k(this,I).event(j),D=this.__zoom,L=Math.max(s[0],Math.min(s[1],D.k*Math.pow(2,r.apply(this,arguments)))),z=Yn(j);if(E.wheel)(E.mouse[0][0]!==z[0]||E.mouse[0][1]!==z[1])&&(E.mouse[1]=D.invert(E.mouse[0]=z)),clearTimeout(E.wheel);else{if(D.k===L)return;E.mouse=[z,D.invert(z)],ka(this),E.start()}ps(j),E.wheel=setTimeout(B,m),E.zoom("mouse",t(w(y(D,L),E.mouse[0],E.mouse[1]),E.extent,o));function B(){E.wheel=null,E.end()}}function T(j,...I){if(f||!n.apply(this,arguments))return;var E=j.currentTarget,D=k(this,I,!0).event(j),L=hn(j.view).on("mousemove.zoom",U,!0).on("mouseup.zoom",q,!0),z=Yn(j,E),B=j.clientX,N=j.clientY;ky(j.view),Ic(j),D.mouse=[z,this.__zoom.invert(z)],ka(this),D.start();function U(X){if(ps(X),!D.moved){var J=X.clientX-B,ee=X.clientY-N;D.moved=J*J+ee*ee>g}D.event(X).zoom("mouse",t(w(D.that.__zoom,D.mouse[0]=Yn(X,E),D.mouse[1]),D.extent,o))}function q(X){L.on("mousemove.zoom mouseup.zoom",null),jy(X.view,D.moved),ps(X),D.event(X).end()}}function A(j,...I){if(n.apply(this,arguments)){var E=this.__zoom,D=Yn(j.changedTouches?j.changedTouches[0]:j,this),L=E.invert(D),z=E.k*(j.shiftKey?.5:2),B=t(w(y(E,z),D,L),e.apply(this,I),o);ps(j),a>0?hn(this).transition().duration(a).call(S,B,D,j):hn(this).call(b.transform,B,D,j)}}function M(j,...I){if(n.apply(this,arguments)){var E=j.touches,D=E.length,L=k(this,I,j.changedTouches.length===D).event(j),z,B,N,U;for(Ic(j),B=0;B<D;++B)N=E[B],U=Yn(N,this),U=[U,this.__zoom.invert(U),N.identifier],L.touch0?!L.touch1&&L.touch0[2]!==U[2]&&(L.touch1=U,L.taps=0):(L.touch0=U,z=!0,L.taps=1+!!u);u&&(u=clearTimeout(u)),z&&(L.taps<2&&(h=U[0],u=setTimeout(function(){u=null},p)),ka(this),L.start())}}function O(j,...I){if(this.__zooming){var E=k(this,I).event(j),D=j.changedTouches,L=D.length,z,B,N,U;for(ps(j),z=0;z<L;++z)B=D[z],N=Yn(B,this),E.touch0&&E.touch0[2]===B.identifier?E.touch0[0]=N:E.touch1&&E.touch1[2]===B.identifier&&(E.touch1[0]=N);if(B=E.that.__zoom,E.touch1){var q=E.touch0[0],X=E.touch0[1],J=E.touch1[0],ee=E.touch1[1],re=(re=J[0]-q[0])*re+(re=J[1]-q[1])*re,oe=(oe=ee[0]-X[0])*oe+(oe=ee[1]-X[1])*oe;B=y(B,Math.sqrt(re/oe)),N=[(q[0]+J[0])/2,(q[1]+J[1])/2],U=[(X[0]+ee[0])/2,(X[1]+ee[1])/2]}else if(E.touch0)N=E.touch0[0],U=E.touch0[1];else return;E.zoom("touch",t(w(B,N,U),E.extent,o))}}function R(j,...I){if(this.__zooming){var E=k(this,I).event(j),D=j.changedTouches,L=D.length,z,B;for(Ic(j),f&&clearTimeout(f),f=setTimeout(function(){f=null},p),z=0;z<L;++z)B=D[z],E.touch0&&E.touch0[2]===B.identifier?delete E.touch0:E.touch1&&E.touch1[2]===B.identifier&&delete E.touch1;if(E.touch1&&!E.touch0&&(E.touch0=E.touch1,delete E.touch1),E.touch0)E.touch0[1]=this.__zoom.invert(E.touch0[0]);else if(E.end(),E.taps===2&&(B=Yn(B,this),Math.hypot(h[0]-B[0],h[1]-B[1])<x)){var N=hn(this).on("dblclick.zoom");N&&N.apply(this,arguments)}}}return b.wheelDelta=function(j){return arguments.length?(r=typeof j=="function"?j:Zo(+j),b):r},b.filter=function(j){return arguments.length?(n=typeof j=="function"?j:Zo(!!j),b):n},b.touchable=function(j){return arguments.length?(i=typeof j=="function"?j:Zo(!!j),b):i},b.extent=function(j){return arguments.length?(e=typeof j=="function"?j:Zo([[+j[0][0],+j[0][1]],[+j[1][0],+j[1][1]]]),b):e},b.scaleExtent=function(j){return arguments.length?(s[0]=+j[0],s[1]=+j[1],b):[s[0],s[1]]},b.translateExtent=function(j){return arguments.length?(o[0][0]=+j[0][0],o[1][0]=+j[1][0],o[0][1]=+j[0][1],o[1][1]=+j[1][1],b):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},b.constrain=function(j){return arguments.length?(t=j,b):t},b.duration=function(j){return arguments.length?(a=+j,b):a},b.interpolate=function(j){return arguments.length?(l=j,b):l},b.on=function(){var j=c.on.apply(c,arguments);return j===c?b:j},b.clickDistance=function(j){return arguments.length?(g=(j=+j)*j,b):Math.sqrt(g)},b.tapDistance=function(j){return arguments.length?(x=+j,b):x},b}function Ja(n){"@babel/helpers - typeof";return Ja=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ja(n)}var mR=/^\s+/,gR=/\s+$/;function he(n,e){if(n=n||"",e=e||{},n instanceof he)return n;if(!(this instanceof he))return new he(n,e);var t=xR(n);this._originalInput=n,this._r=t.r,this._g=t.g,this._b=t.b,this._a=t.a,this._roundA=Math.round(100*this._a)/100,this._format=e.format||t.format,this._gradientType=e.gradientType,this._r<1&&(this._r=Math.round(this._r)),this._g<1&&(this._g=Math.round(this._g)),this._b<1&&(this._b=Math.round(this._b)),this._ok=t.ok}he.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(e.r*299+e.g*587+e.b*114)/1e3},getLuminance:function(){var e=this.toRgb(),t,r,i,s,o,a;return t=e.r/255,r=e.g/255,i=e.b/255,t<=.03928?s=t/12.92:s=Math.pow((t+.055)/1.055,2.4),r<=.03928?o=r/12.92:o=Math.pow((r+.055)/1.055,2.4),i<=.03928?a=i/12.92:a=Math.pow((i+.055)/1.055,2.4),.2126*s+.7152*o+.0722*a},setAlpha:function(e){return this._a=Yy(e),this._roundA=Math.round(100*this._a)/100,this},toHsv:function(){var e=lp(this._r,this._g,this._b);return{h:e.h*360,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=lp(this._r,this._g,this._b),t=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.v*100);return this._a==1?"hsv("+t+", "+r+"%, "+i+"%)":"hsva("+t+", "+r+"%, "+i+"%, "+this._roundA+")"},toHsl:function(){var e=ap(this._r,this._g,this._b);return{h:e.h*360,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=ap(this._r,this._g,this._b),t=Math.round(e.h*360),r=Math.round(e.s*100),i=Math.round(e.l*100);return this._a==1?"hsl("+t+", "+r+"%, "+i+"%)":"hsla("+t+", "+r+"%, "+i+"%, "+this._roundA+")"},toHex:function(e){return cp(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(e){return wR(this._r,this._g,this._b,this._a,e)},toHex8String:function(e){return"#"+this.toHex8(e)},toRgb:function(){return{r:Math.round(this._r),g:Math.round(this._g),b:Math.round(this._b),a:this._a}},toRgbString:function(){return this._a==1?"rgb("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+")":"rgba("+Math.round(this._r)+", "+Math.round(this._g)+", "+Math.round(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:Math.round(Ue(this._r,255)*100)+"%",g:Math.round(Ue(this._g,255)*100)+"%",b:Math.round(Ue(this._b,255)*100)+"%",a:this._a}},toPercentageRgbString:function(){return this._a==1?"rgb("+Math.round(Ue(this._r,255)*100)+"%, "+Math.round(Ue(this._g,255)*100)+"%, "+Math.round(Ue(this._b,255)*100)+"%)":"rgba("+Math.round(Ue(this._r,255)*100)+"%, "+Math.round(Ue(this._g,255)*100)+"%, "+Math.round(Ue(this._b,255)*100)+"%, "+this._roundA+")"},toName:function(){return this._a===0?"transparent":this._a<1?!1:RR[cp(this._r,this._g,this._b,!0)]||!1},toFilter:function(e){var t="#"+up(this._r,this._g,this._b,this._a),r=t,i=this._gradientType?"GradientType = 1, ":"";if(e){var s=he(e);r="#"+up(s._r,s._g,s._b,s._a)}return"progid:DXImageTransform.Microsoft.gradient("+i+"startColorstr="+t+",endColorstr="+r+")"},toString:function(e){var t=!!e;e=e||this._format;var r=!1,i=this._a<1&&this._a>=0,s=!t&&i&&(e==="hex"||e==="hex6"||e==="hex3"||e==="hex4"||e==="hex8"||e==="name");return s?e==="name"&&this._a===0?this.toName():this.toRgbString():(e==="rgb"&&(r=this.toRgbString()),e==="prgb"&&(r=this.toPercentageRgbString()),(e==="hex"||e==="hex6")&&(r=this.toHexString()),e==="hex3"&&(r=this.toHexString(!0)),e==="hex4"&&(r=this.toHex8String(!0)),e==="hex8"&&(r=this.toHex8String()),e==="name"&&(r=this.toName()),e==="hsl"&&(r=this.toHslString()),e==="hsv"&&(r=this.toHsvString()),r||this.toHexString())},clone:function(){return he(this.toString())},_applyModification:function(e,t){var r=e.apply(null,[this].concat([].slice.call(t)));return this._r=r._r,this._g=r._g,this._b=r._b,this.setAlpha(r._a),this},lighten:function(){return this._applyModification(CR,arguments)},brighten:function(){return this._applyModification(kR,arguments)},darken:function(){return this._applyModification(jR,arguments)},desaturate:function(){return this._applyModification(_R,arguments)},saturate:function(){return this._applyModification(SR,arguments)},greyscale:function(){return this._applyModification(PR,arguments)},spin:function(){return this._applyModification(TR,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(ER,arguments)},complement:function(){return this._applyCombination(MR,arguments)},monochromatic:function(){return this._applyCombination(IR,arguments)},splitcomplement:function(){return this._applyCombination(AR,arguments)},triad:function(){return this._applyCombination(dp,[3])},tetrad:function(){return this._applyCombination(dp,[4])}};he.fromRatio=function(n,e){if(Ja(n)=="object"){var t={};for(var r in n)n.hasOwnProperty(r)&&(r==="a"?t[r]=n[r]:t[r]=ks(n[r]));n=t}return he(n,e)};function xR(n){var e={r:0,g:0,b:0},t=1,r=null,i=null,s=null,o=!1,a=!1;return typeof n=="string"&&(n=NR(n)),Ja(n)=="object"&&(Wn(n.r)&&Wn(n.g)&&Wn(n.b)?(e=bR(n.r,n.g,n.b),o=!0,a=String(n.r).substr(-1)==="%"?"prgb":"rgb"):Wn(n.h)&&Wn(n.s)&&Wn(n.v)?(r=ks(n.s),i=ks(n.v),e=vR(n.h,r,i),o=!0,a="hsv"):Wn(n.h)&&Wn(n.s)&&Wn(n.l)&&(r=ks(n.s),s=ks(n.l),e=yR(n.h,r,s),o=!0,a="hsl"),n.hasOwnProperty("a")&&(t=n.a)),t=Yy(t),{ok:o,format:n.format||a,r:Math.min(255,Math.max(e.r,0)),g:Math.min(255,Math.max(e.g,0)),b:Math.min(255,Math.max(e.b,0)),a:t}}function bR(n,e,t){return{r:Ue(n,255)*255,g:Ue(e,255)*255,b:Ue(t,255)*255}}function ap(n,e,t){n=Ue(n,255),e=Ue(e,255),t=Ue(t,255);var r=Math.max(n,e,t),i=Math.min(n,e,t),s,o,a=(r+i)/2;if(r==i)s=o=0;else{var l=r-i;switch(o=a>.5?l/(2-r-i):l/(r+i),r){case n:s=(e-t)/l+(e<t?6:0);break;case e:s=(t-n)/l+2;break;case t:s=(n-e)/l+4;break}s/=6}return{h:s,s:o,l:a}}function yR(n,e,t){var r,i,s;n=Ue(n,360),e=Ue(e,100),t=Ue(t,100);function o(c,u,h){return h<0&&(h+=1),h>1&&(h-=1),h<1/6?c+(u-c)*6*h:h<1/2?u:h<2/3?c+(u-c)*(2/3-h)*6:c}if(e===0)r=i=s=t;else{var a=t<.5?t*(1+e):t+e-t*e,l=2*t-a;r=o(l,a,n+1/3),i=o(l,a,n),s=o(l,a,n-1/3)}return{r:r*255,g:i*255,b:s*255}}function lp(n,e,t){n=Ue(n,255),e=Ue(e,255),t=Ue(t,255);var r=Math.max(n,e,t),i=Math.min(n,e,t),s,o,a=r,l=r-i;if(o=r===0?0:l/r,r==i)s=0;else{switch(r){case n:s=(e-t)/l+(e<t?6:0);break;case e:s=(t-n)/l+2;break;case t:s=(n-e)/l+4;break}s/=6}return{h:s,s:o,v:a}}function vR(n,e,t){n=Ue(n,360)*6,e=Ue(e,100),t=Ue(t,100);var r=Math.floor(n),i=n-r,s=t*(1-e),o=t*(1-i*e),a=t*(1-(1-i)*e),l=r%6,c=[t,o,s,s,a,t][l],u=[a,t,t,o,s,s][l],h=[s,s,a,t,t,o][l];return{r:c*255,g:u*255,b:h*255}}function cp(n,e,t,r){var i=[mn(Math.round(n).toString(16)),mn(Math.round(e).toString(16)),mn(Math.round(t).toString(16))];return r&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function wR(n,e,t,r,i){var s=[mn(Math.round(n).toString(16)),mn(Math.round(e).toString(16)),mn(Math.round(t).toString(16)),mn(Ky(r))];return i&&s[0].charAt(0)==s[0].charAt(1)&&s[1].charAt(0)==s[1].charAt(1)&&s[2].charAt(0)==s[2].charAt(1)&&s[3].charAt(0)==s[3].charAt(1)?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0)+s[3].charAt(0):s.join("")}function up(n,e,t,r){var i=[mn(Ky(r)),mn(Math.round(n).toString(16)),mn(Math.round(e).toString(16)),mn(Math.round(t).toString(16))];return i.join("")}he.equals=function(n,e){return!n||!e?!1:he(n).toRgbString()==he(e).toRgbString()};he.random=function(){return he.fromRatio({r:Math.random(),g:Math.random(),b:Math.random()})};function _R(n,e){e=e===0?0:e||10;var t=he(n).toHsl();return t.s-=e/100,t.s=Zl(t.s),he(t)}function SR(n,e){e=e===0?0:e||10;var t=he(n).toHsl();return t.s+=e/100,t.s=Zl(t.s),he(t)}function PR(n){return he(n).desaturate(100)}function CR(n,e){e=e===0?0:e||10;var t=he(n).toHsl();return t.l+=e/100,t.l=Zl(t.l),he(t)}function kR(n,e){e=e===0?0:e||10;var t=he(n).toRgb();return t.r=Math.max(0,Math.min(255,t.r-Math.round(255*-(e/100)))),t.g=Math.max(0,Math.min(255,t.g-Math.round(255*-(e/100)))),t.b=Math.max(0,Math.min(255,t.b-Math.round(255*-(e/100)))),he(t)}function jR(n,e){e=e===0?0:e||10;var t=he(n).toHsl();return t.l-=e/100,t.l=Zl(t.l),he(t)}function TR(n,e){var t=he(n).toHsl(),r=(t.h+e)%360;return t.h=r<0?360+r:r,he(t)}function MR(n){var e=he(n).toHsl();return e.h=(e.h+180)%360,he(e)}function dp(n,e){if(isNaN(e)||e<=0)throw new Error("Argument to polyad must be a positive number");for(var t=he(n).toHsl(),r=[he(n)],i=360/e,s=1;s<e;s++)r.push(he({h:(t.h+s*i)%360,s:t.s,l:t.l}));return r}function AR(n){var e=he(n).toHsl(),t=e.h;return[he(n),he({h:(t+72)%360,s:e.s,l:e.l}),he({h:(t+216)%360,s:e.s,l:e.l})]}function ER(n,e,t){e=e||6,t=t||30;var r=he(n).toHsl(),i=360/t,s=[he(n)];for(r.h=(r.h-(i*e>>1)+720)%360;--e;)r.h=(r.h+i)%360,s.push(he(r));return s}function IR(n,e){e=e||6;for(var t=he(n).toHsv(),r=t.h,i=t.s,s=t.v,o=[],a=1/e;e--;)o.push(he({h:r,s:i,v:s})),s=(s+a)%1;return o}he.mix=function(n,e,t){t=t===0?0:t||50;var r=he(n).toRgb(),i=he(e).toRgb(),s=t/100,o={r:(i.r-r.r)*s+r.r,g:(i.g-r.g)*s+r.g,b:(i.b-r.b)*s+r.b,a:(i.a-r.a)*s+r.a};return he(o)};he.readability=function(n,e){var t=he(n),r=he(e);return(Math.max(t.getLuminance(),r.getLuminance())+.05)/(Math.min(t.getLuminance(),r.getLuminance())+.05)};he.isReadable=function(n,e,t){var r=he.readability(n,e),i,s;switch(s=!1,i=LR(t),i.level+i.size){case"AAsmall":case"AAAlarge":s=r>=4.5;break;case"AAlarge":s=r>=3;break;case"AAAsmall":s=r>=7;break}return s};he.mostReadable=function(n,e,t){var r=null,i=0,s,o,a,l;t=t||{},o=t.includeFallbackColors,a=t.level,l=t.size;for(var c=0;c<e.length;c++)s=he.readability(n,e[c]),s>i&&(i=s,r=he(e[c]));return he.isReadable(n,r,{level:a,size:l})||!o?r:(t.includeFallbackColors=!1,he.mostReadable(n,["#fff","#000"],t))};var Eu=he.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},RR=he.hexNames=OR(Eu);function OR(n){var e={};for(var t in n)n.hasOwnProperty(t)&&(e[n[t]]=t);return e}function Yy(n){return n=parseFloat(n),(isNaN(n)||n<0||n>1)&&(n=1),n}function Ue(n,e){$R(n)&&(n="100%");var t=DR(n);return n=Math.min(e,Math.max(0,parseFloat(n))),t&&(n=parseInt(n*e,10)/100),Math.abs(n-e)<1e-6?1:n%e/parseFloat(e)}function Zl(n){return Math.min(1,Math.max(0,n))}function Lt(n){return parseInt(n,16)}function $R(n){return typeof n=="string"&&n.indexOf(".")!=-1&&parseFloat(n)===1}function DR(n){return typeof n=="string"&&n.indexOf("%")!=-1}function mn(n){return n.length==1?"0"+n:""+n}function ks(n){return n<=1&&(n=n*100+"%"),n}function Ky(n){return Math.round(parseFloat(n)*255).toString(16)}function hp(n){return Lt(n)/255}var cn=function(){var n="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",t="(?:"+e+")|(?:"+n+")",r="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?",i="[\\s|\\(]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")[,|\\s]+("+t+")\\s*\\)?";return{CSS_UNIT:new RegExp(t),rgb:new RegExp("rgb"+r),rgba:new RegExp("rgba"+i),hsl:new RegExp("hsl"+r),hsla:new RegExp("hsla"+i),hsv:new RegExp("hsv"+r),hsva:new RegExp("hsva"+i),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();function Wn(n){return!!cn.CSS_UNIT.exec(n)}function NR(n){n=n.replace(mR,"").replace(gR,"").toLowerCase();var e=!1;if(Eu[n])n=Eu[n],e=!0;else if(n=="transparent")return{r:0,g:0,b:0,a:0,format:"name"};var t;return(t=cn.rgb.exec(n))?{r:t[1],g:t[2],b:t[3]}:(t=cn.rgba.exec(n))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=cn.hsl.exec(n))?{h:t[1],s:t[2],l:t[3]}:(t=cn.hsla.exec(n))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=cn.hsv.exec(n))?{h:t[1],s:t[2],v:t[3]}:(t=cn.hsva.exec(n))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=cn.hex8.exec(n))?{r:Lt(t[1]),g:Lt(t[2]),b:Lt(t[3]),a:hp(t[4]),format:e?"name":"hex8"}:(t=cn.hex6.exec(n))?{r:Lt(t[1]),g:Lt(t[2]),b:Lt(t[3]),format:e?"name":"hex"}:(t=cn.hex4.exec(n))?{r:Lt(t[1]+""+t[1]),g:Lt(t[2]+""+t[2]),b:Lt(t[3]+""+t[3]),a:hp(t[4]+""+t[4]),format:e?"name":"hex8"}:(t=cn.hex3.exec(n))?{r:Lt(t[1]+""+t[1]),g:Lt(t[2]+""+t[2]),b:Lt(t[3]+""+t[3]),format:e?"name":"hex"}:!1}function LR(n){var e,t;return n=n||{level:"AA",size:"small"},e=(n.level||"AA").toUpperCase(),t=(n.size||"small").toLowerCase(),e!=="AA"&&e!=="AAA"&&(e="AA"),t!=="small"&&t!=="large"&&(t="small"),{level:e,size:t}}function Zy(n,e){window.dispatchEvent(new StorageEvent("storage",{key:n,newValue:e}))}const fp=(n,e)=>{const t=JSON.stringify(e);window.localStorage.setItem(n,t),Zy(n,t)},FR=n=>{window.localStorage.removeItem(n),Zy(n,null)},pp=n=>window.localStorage.getItem(n),zR=n=>(window.addEventListener("storage",n),()=>window.removeEventListener("storage",n)),BR=()=>{throw Error("useLocalStorage is a client-only hook")};function Jy(n,e){const t=()=>pp(n),r=_.useSyncExternalStore(zR,t,BR),i=_.useCallback(s=>{try{const o=typeof s=="function"?s(JSON.parse(r)):s;o==null?FR(n):fp(n,o)}catch(o){console.warn(o)}},[n,r]);return _.useEffect(()=>{pp(n)===null&&typeof e<"u"&&fp(n,e)},[n,e]),[r?JSON.parse(r):e,i]}const Iu=[{key:"pymol",name:"PyMOL"},{key:"chimerax",name:"ChimeraX"}];function HR(n,e){const t=window.localStorage.getItem(n);if(t!==null)try{const r=JSON.parse(t);if(e.includes(r))return!0}catch{return!1}return!1}function Qy(n,e,t){return Kr(e.length>0),t===void 0&&(t=e[0]),HR(n,e)||window.localStorage.removeItem(n),Jy(n,t)}const oh=()=>{const[n,e]=Qy("preferredVisualizationTool",Iu.map(({key:t})=>t));return[Iu.find(({key:t})=>t===n),e]},ev=()=>Qy("colorResiduesByReliability",[!0,!1]),mp=({aminoAcid:n},{aminoAcid:e},t)=>n&&e&&n!==e&&d.jsx(yb,{showArrow:!0,content:`The crosslinked residue (${n}) is different from the aligned residue in the structure (${e})`,children:d.jsx(mt,{verticalAlign:"middle",ml:"0.2rem",mb:"0.1rem",size:"2xs",height:"unset",minW:"unset",variant:"ghost",color:t,backgroundColor:"transparent",children:d.jsx(Fg,{style:{height:"unset",width:"unset"}})})}),VR=n=>{const e=n.filter(({homoMultimeric:a})=>a);if(e.length===0)return null;const t=e.map(({id:a})=>a),r=n.length-t.length,i=d.jsxs(d.Fragment,{children:[n.length===1?"This crosslink":n.length===t.length?"These crosslinks":`${t.length} of the crosslinks (id${t.length>1?"s":""}: ${Tn(t)})`," ",t.length===1?"is":"are"," classified as ",d.jsx("b",{children:"homo-multimeric"})]}),s=(()=>{if(!(e[0].from.proteinId===e[0].to.proteinId))return null;if(e[0].from.linkPosition===e[0].to.linkPosition)return"the same residue";const c=new Set;for(const u of e)u.originalCrosslink?.from.proteinId!==u.originalCrosslink?.to.proteinId&&c.add("different proteins"),(u.from.peptideIndex!==void 0||u.originalCrosslink?.from.peptideIndex!==void 0)&&(u.to.peptideIndex!==void 0||u.originalCrosslink?.to.peptideIndex!==void 0)&&c.add("overlapping peptides");return c.size===0?null:Array.from(c).join(" / ")})(),o=d.jsx(d.Fragment,{children:r>0?d.jsxs(d.Fragment,{children:["However, because ",r," of the crosslinks"," ",r===1?"is":"are"," not classified as homo-multimeric, distances within the same chain are"," ",d.jsx("b",{children:"not excluded"})]}):d.jsxs(d.Fragment,{children:["Therefore, distances within the same chain are ",d.jsx("b",{children:"excluded"})]})});return d.jsx(Qr,{status:"neutral",children:d.jsx(Zi,{overflow:"clip",children:d.jsxs(mo,{children:[i,s?` because ${t.length===1?"it occurs":"they occur"} between ${s}`:"",". ",o,"."]})})})},gp=n=>n===void 0?"(unmapped residue)":n==="ntd"?"N'":n.toString(),WR=sh([0,5,10,15,20,25,30],["rgb(5, 113, 47)","rgb(44, 148, 76)","rgb(86, 181, 103)","rgb(142, 208, 139)","rgb(188, 228, 181)","rgb(225, 243, 220)"]),UR=Xy([50,70,90,100],["#E1863A","#F5EB51","#5DCDED","#2B71F6"]),qR=(n,{from:e,to:t})=>{if(n===void 0)return null;const r=mM(n,e.chainId,e.position,t.chainId,t.position);if(r===void 0)return null;const i=he(WR(r)),s=he.mostReadable(i,["black","white"]);return d.jsx(d.Fragment,{children:d.jsx(rt,{fontSize:"xs",backgroundColor:i.toHexString(),color:s.toHexString(),borderWidth:"0.5px",borderColor:s.toHexString(),rounded:"sm",ml:5,paddingX:1,children:`PAE: ${r.toFixed(2)} `})})},XR=function(n){const e=te.c(74);let t,r,i,s,o;e[0]!==n?({experiment:r,crosslinkIds:t,structure:o,ref:i,...s}=n,e[0]=n,e[1]=t,e[2]=r,e[3]=i,e[4]=s,e[5]=o):(t=e[1],r=e[2],i=e[3],s=e[4],o=e[5]);const{experimentIdToThresholds:a,aminoAcidsMustMatch:l}=Je(ie),c=a[r.id],[u]=oh(),[h]=ev(),f=r.crosslinks;let p,m,g,x,b,y,w,v,S,k,P,C;if(e[6]!==l||e[7]!==h||e[8]!==t||e[9]!==r.crosslinks||e[10]!==r.name||e[11]!==r.proteins||e[12]!==i||e[13]!==s||e[14]!==o||e[15]!==c||e[16]!==u){x=Symbol.for("react.early_return_sentinel");e:{let R;e[29]!==t?(R=K=>{const{id:G}=K;return t.includes(G)},e[29]=t,e[30]=R):R=e[30];const j=f.filter(R);if(j.length===0){x=null;break e}const I=r.proteins.find(K=>{const{id:G}=K;return G==j[0].from.proteinId}),E=r.proteins.find(K=>{const{id:G}=K;return G==j[0].to.proteinId});if(!I||!E){x=null;break e}const D=VR(j),L=j[0].from.linkPosition&&j[0].to.linkPosition?Rl(j[0],o.chains,o.chainIdToProteinIdToMapping,l).toArray().toSorted(YR):[],z=j.flatMap(KR);let B;e[31]!==c?(B=c??{},e[31]=c,e[32]=B):B=e[32];const N=Mn(L.map(ZR),B);let U;const q=L.map(JR).filter(K=>Mn([K],c??{})===N);U=q.reduce(QR,0)/q.length;const X=U,J=o.scoreType==="plddt"?UR:o.scoreType==="bfactor"?sh(o.scoreRange?[o.scoreRange[0],o.scoreRange[0]+(o.scoreRange[1]-o.scoreRange[0])/2,o.scoreRange[1]]:[1,80],["blue","white","red"]):void 0;g=nn,k=i,P=s;let ee;e[33]!==I.name?(ee=d.jsx("span",{className:kc.weak,children:I.name}),e[33]=I.name,e[34]=ee):ee=e[34];const re=I.id!==E.id&&`${E.name} `;let oe;e[35]!==re?(oe=d.jsxs("span",{className:kc.weak,children:[" to ",re]}),e[35]=re,e[36]=oe):oe=e[36];let me;e[37]===Symbol.for("react.memo_cache_sentinel")?(me=d.jsx("br",{}),e[37]=me):me=e[37];let ge;e[38]===Symbol.for("react.memo_cache_sentinel")?(ge=d.jsx("span",{className:kc.weak,children:"in "}),e[38]=ge):ge=e[38];let ae;e[39]!==o.name?(ae=d.jsxs(gn,{pl:5,children:[ge,o.name]}),e[39]=o.name,e[40]=ae):ae=e[40];const ce=d.jsxs(Yt,{children:[ee," ",j[0].from.aminoAcid??"",gp(j[0].from.linkPosition),oe,j[0].to.aminoAcid??"",gp(j[0].to.linkPosition),me,ae]});let fe;e[41]===Symbol.for("react.memo_cache_sentinel")?(fe=d.jsx(Pi,{children:"Experiment"}),e[41]=fe):fe=e[41];let ve;e[42]!==r.name?(ve=d.jsxs(Si,{children:[fe,d.jsx(Ci,{children:r.name})]}),e[42]=r.name,e[43]=ve):ve=e[43];const xe=j.length>1?"s":"";let ue;e[44]!==xe?(ue=d.jsxs(Pi,{children:["Crosslink ID",xe]}),e[44]=xe,e[45]=ue):ue=e[45];const Se=d.jsx(Ci,{children:j.map(e5).join(", ")});let Le;e[46]!==ue||e[47]!==Se?(Le=d.jsxs(Si,{children:[ue,Se]}),e[46]=ue,e[47]=Se,e[48]=Le):Le=e[48];const $=z.length>0&&d.jsxs(Si,{children:[d.jsxs(Pi,{children:["Crosslink score",j.length>1?"s":""]}),d.jsx(Ci,{children:j.map(t5).join(", ")})]});let F;e[49]!==ve||e[50]!==Le||e[51]!==$?(F=d.jsx(Dl,{asChild:!0,children:d.jsxs(bd,{size:"sm",orientation:"horizontal",wordBreak:"break-word",children:[ve,Le,$]})}),e[49]=ve,e[50]=Le,e[51]=$,e[52]=F):F=e[52];let V;e[53]===Symbol.for("react.memo_cache_sentinel")?(V=d.jsx(on,{}),e[53]=V):V=e[53],e[54]!==ce||e[55]!==F?(C=d.jsxs(Gt,{flexDir:"column",children:[ce,F,V]}),e[54]=ce,e[55]=F,e[56]=C):C=e[56],m=wn,p=So,b=5,y="stretch",w=D,v=L.length===0&&"The crosslink was not found in this structure.",S=L.length>0&&d.jsxs(d.Fragment,{children:[d.jsxs(Ws,{size:"md",children:["Crosslink Distance:"," ",d.jsxs(gn,{color:An(N),children:[X.toFixed(2)," "]})]}),d.jsx(D1,{mt:"10px",gap:2,variant:"plain",align:"center",children:L.map((K,G)=>{const pe=Mn([K.distance],c??{});return d.jsxs(N1,{children:[d.jsx(TP,{color:N===pe?An(N):void 0,asChild:!0,children:N===pe?d.jsx(r2,{}):d.jsx(i2,{})}),d.jsx(en,{content:o.scoreType&&`${o.scoreType}: ${o.chains.find(W=>{const{id:de}=W;return de===K.from.chainId})?.residues[K.from.position].atoms.CA.score?.toFixed(2)??"?"}${o.scoreType==="bfactor"?" ":""}`,children:d.jsxs(Mt,{color:h&&J?he.mostReadable(he(J(o.chains.find(W=>{const{id:de}=W;return de===K.from.chainId})?.residues[K.from.position].atoms.CA.score??0)),["black","white"]).toHexString():void 0,backgroundColor:h?J?.(o.chains.find(W=>{const{id:de}=W;return de===K.from.chainId})?.residues[K.from.position].atoms.CA.score??0):void 0,children:["/",K.from.chainId,":",K.from.aminoAcid??"",K.from.position,mp(j[0].from,K.from,h&&J?he.mostReadable(he(J(o.chains.find(W=>{const{id:de}=W;return de===K.from.chainId})?.residues[K.from.position].atoms.CA.score??0)),["black","white"]).toHexString():void 0)]})}),"-",d.jsx(en,{content:o.scoreType&&`${o.scoreType}: ${o.chains.find(W=>{const{id:de}=W;return de===K.to.chainId})?.residues[K.to.position].atoms.CA.score?.toFixed(2)??"?"}${o.scoreType==="bfactor"?" ":""}`,children:d.jsxs(Mt,{color:h&&J?he.mostReadable(he(J(o.chains.find(W=>{const{id:de}=W;return de===K.to.chainId})?.residues[K.to.position].atoms.CA.score??0)),["black","white"]).toHexString():void 0,backgroundColor:h?J?.(o.chains.find(W=>{const{id:de}=W;return de===K.to.chainId})?.residues[K.to.position].atoms.CA.score??0):void 0,children:["/",K.to.chainId,":",K.to.aminoAcid??"",K.to.position,mp(j[0].to,K.to,h&&J?he.mostReadable(he(J(o.chains.find(W=>{const{id:de}=W;return de===K.to.chainId})?.residues[K.to.position].atoms.CA.score??0)),["black","white"]).toHexString():void 0)]})}),d.jsx("span",{style:{marginLeft:"10px",marginRight:"10px"},children:" - "}),d.jsxs("span",{style:{color:An(Mn([K.distance],c??{}))},children:[Math.round((K.distance+Number.EPSILON)*100)/100," ",""]}),qR(o.pae,K),d.jsx(en,{content:`Copy as ${u.name} command`,ids:{trigger:String(G)},showArrow:!0,children:d.jsx(pM,{value:wk(u.key,K),asChild:!0,ids:{root:String(G)},ml:5,children:d.jsx(fM,{size:"2xs",variant:"plain"})})})]},G)})})]})}e[6]=l,e[7]=h,e[8]=t,e[9]=r.crosslinks,e[10]=r.name,e[11]=r.proteins,e[12]=i,e[13]=s,e[14]=o,e[15]=c,e[16]=u,e[17]=p,e[18]=m,e[19]=g,e[20]=x,e[21]=b,e[22]=y,e[23]=w,e[24]=v,e[25]=S,e[26]=k,e[27]=P,e[28]=C}else p=e[17],m=e[18],g=e[19],x=e[20],b=e[21],y=e[22],w=e[23],v=e[24],S=e[25],k=e[26],P=e[27],C=e[28];if(x!==Symbol.for("react.early_return_sentinel"))return x;let T;e[57]!==p||e[58]!==b||e[59]!==y||e[60]!==w||e[61]!==v||e[62]!==S?(T=d.jsxs(p,{gap:b,align:y,children:[w,v,S]}),e[57]=p,e[58]=b,e[59]=y,e[60]=w,e[61]=v,e[62]=S,e[63]=T):T=e[63];let A;e[64]!==m||e[65]!==T?(A=d.jsx(m,{children:T}),e[64]=m,e[65]=T,e[66]=A):A=e[66];let M;e[67]===Symbol.for("react.memo_cache_sentinel")?(M=d.jsx(Xt,{}),e[67]=M):M=e[67];let O;return e[68]!==g||e[69]!==A||e[70]!==k||e[71]!==P||e[72]!==C?(O=d.jsxs(g,{ref:k,...P,children:[C,A,M]}),e[68]=g,e[69]=A,e[70]=k,e[71]=P,e[72]=C,e[73]=O):O=e[73],O},GR=n=>{const e=te.c(5),{dialog:t,dialogProps:r}=n;let i;e[0]!==r?(i=r&&d.jsx(XR,{...r}),e[0]=r,e[1]=i):i=e[1];let s;return e[2]!==t||e[3]!==i?(s=d.jsx(rr,{value:t,unmountOnExit:!0,lazyMount:!0,children:i}),e[2]=t,e[3]=i,e[4]=s):s=e[4],s};function YR(n,e){return n.distance-e.distance}function KR(n){const{score:e}=n;return e!==void 0?[e]:[]}function ZR(n){const{distance:e}=n;return e}function JR(n){const{distance:e}=n;return e}function QR(n,e){return n+e}function e5(n){const{id:e}=n;return e}function t5(n){const{score:e}=n;return e!==void 0?e.toString():"(no score)"}const ah=_.memo(n=>{const e=te.c(28);let t,r,i,s,o,a,l;e[0]!==n?({inputProps:r,children:t,rootRef:o,trackLabel:l,thumbLabel:a,ref:i,...s}=n,e[0]=n,e[1]=t,e[2]=r,e[3]=i,e[4]=s,e[5]=o,e[6]=a,e[7]=l):(t=e[1],r=e[2],i=e[3],s=e[4],o=e[5],a=e[6],l=e[7]);let c;e[8]!==r||e[9]!==i?(c=d.jsx(lC,{ref:i,...r}),e[8]=r,e[9]=i,e[10]=c):c=e[10];let u;e[11]!==a?(u=a&&d.jsx(aC,{fallback:a?.off,children:a?.on}),e[11]=a,e[12]=u):u=e[12];let h;e[13]!==u?(h=d.jsx(rb,{children:u}),e[13]=u,e[14]=h):h=e[14];let f;e[15]!==l?(f=l&&d.jsx(oC,{fallback:l.off,children:l.on}),e[15]=l,e[16]=f):f=e[16];let p;e[17]!==h||e[18]!==f?(p=d.jsxs(sC,{children:[h,f]}),e[17]=h,e[18]=f,e[19]=p):p=e[19];let m;e[20]!==t?(m=t!=null&&d.jsx(iC,{children:t}),e[20]=t,e[21]=m):m=e[21];let g;return e[22]!==s||e[23]!==o||e[24]!==c||e[25]!==p||e[26]!==m?(g=d.jsxs(rC,{ref:o,...s,children:[c,p,m]}),e[22]=s,e[23]=o,e[24]=c,e[25]=p,e[26]=m,e[27]=g):g=e[27],g}),n5=({experiment:n,structure:e,ref:t,...r})=>{const{experimentIdToThresholds:i}=Je(ie),s=i[n.id],o=_.useMemo(()=>s?.lower&&!s?.upper?[{category:"under",colorPalette:"below",text:`Below ${s.lower} `},{category:"ok",colorPalette:"green",text:`Above ${s.lower} `}]:!s?.lower&&s?.upper?[{category:"ok",colorPalette:"green",text:`Below ${s.upper} `},{category:"over",colorPalette:"red",text:`Above ${s.upper} `}]:s?.lower&&s?.upper?[{category:"under",colorPalette:"below",text:`Below ${s.lower} `},{category:"ok",colorPalette:"green",text:`Between ${s.lower}  and ${s.upper} `},{category:"over",colorPalette:"red",text:`Above ${s.upper} `}]:[],[s]),{experimentIdToVisibleCrosslinkIds:a,aminoAcidsMustMatch:l}=Je(ie),c=a[n.id],u=_.useMemo(()=>Object.fromEntries(n.crosslinks.filter(({id:y})=>c.has(y)).map(y=>[y.id,y])),[n.crosslinks,c]),h=_.useMemo(()=>Object.fromEntries(n.proteins.map(y=>[y.id,y])),[n.proteins]),f=_.useMemo(()=>gb(qs([Object.values(u)],h),!0).map(y=>u[y]),[u,h]),p=_.useMemo(()=>{if(!s)return[];const y=[];for(const w of f){const v=Rl(w,e.chains,e.chainIdToProteinIdToMapping,l).toArray(),S=Mn(v.map(({distance:k})=>k),s);y.push({...w,category:S,pairs:v.map(k=>({...k,category:Mn([k.distance],s)}))})}return y},[f,e,l,s]),[m,g]=_.useState({under:!0,ok:!0,over:!0}),x=_.useMemo(()=>p.filter(({category:y})=>y&&m[y]),[p,m]),[b]=oh();return d.jsxs(vd,{ref:t,...r,children:[d.jsx(O1,{children:"Export crosslinks in structure"}),d.jsx(wd,{children:d.jsx(xo,{children:o.map(({category:y,colorPalette:w,text:v})=>{const S=p.some(k=>k.category===y);return d.jsx(ah,{colorPalette:w,checked:m[y]&&S,onCheckedChange:({checked:k})=>g(P=>({...P,[y]:k})),disabled:!S,children:v},y)})})}),d.jsxs(_o,{alignSelf:"end",children:["Export ",De(x.length,"crosslink"),":",d.jsxs(zs,{attached:!0,children:[d.jsxs(ke,{size:"xs",variant:"subtle",disabled:x.length===0,onClick:()=>$l(_k(n,e.chains.map(({id:y})=>y),x),`${n.name??"XLinkUp"}-${e.name}-xlinks`),children:[d.jsx(Lg,{}),"Distance Table"]}),d.jsx(en,{showArrow:!0,content:`Python script that adds the selected distances to the models in the current ${b.name} session`,children:d.jsxs(ke,{size:"xs",variant:"subtle",disabled:x.length===0,onClick:()=>vk(b.key,n.name,e.name,x.flatMap(({category:y,pairs:w})=>w.filter(v=>v.category===y)),Object.fromEntries(o.map(({category:y,text:w})=>[y,w]))),children:[d.jsx(s2,{}),b.name," Script"]})})]})]})]})},r5=n=>{const e=n.filter(({sequence:t})=>!/^[GAVLITSMCPFYWHKRDENQX-]*$/.test(t.toUpperCase()));return e.length>0?{error:{type:"error",title:`The sequence${e.length!==1?"s":""} of ${Tn(e.map(({id:t})=>t))} contain invalid characters`}}:new Set(n.map(({sequence:t})=>t.length)).size!==1?{error:{type:"error",title:"Sequences are not equal in size"}}:{error:void 0}},i5=({sequences:n,...e})=>{const r=[];for(let l=0;l<n[0].sequence.length;l+=10){const c=Math.min(l+10,n[0].sequence.length);r.push(n.map(u=>u.sequence.slice(l,c).replaceAll("X","-")))}const i=":  ",s=Math.ceil((Math.max(...n.map(({id:l})=>l.length))+i.length)/10)*10,o=new Set;for(let l=0;l<n[0].sequence.length;l++){const c=n[0].sequence[l];n.every(u=>u.sequence[l]===c)&&o.add(l)}const a=n.map(({sequence:l,highlightedPositions:c})=>{if(!c)return;const u=new Set;let h=1;return Array.from(l).forEach((f,p)=>{f!=="-"&&(c.has(h)&&u.add(p),++h)}),u});return d.jsxs(Re,{gapY:10,wrap:"wrap",...e,children:[d.jsxs(Re,{children:[d.jsx(ft,{direction:"column",mt:"1.1lh",h:"0.8lh"}),d.jsx(Re,{direction:"column",align:"end",justify:"end",children:n.map(({id:l})=>d.jsxs(rt,{whiteSpace:"pre",fontWeight:"bold",children:[10>l.length+i.length&&d.jsx(d.Fragment,{children:" ".repeat(s-(l.length+i.length))}),l,i]},l))})]}),r.map((l,c)=>d.jsxs(Re,{children:[d.jsx(ft,{direction:"column",mt:"1.1lh",h:"0.8lh"}),d.jsxs(Re,{direction:"column",align:"end",children:[d.jsx(rt,{color:"fg.muted",children:n[0].sequence.length<10?n[0].sequence.length:c*10+10}),l.map((u,h)=>d.jsxs(rt,{whiteSpace:"pre",children:[Array.from(u).map((f,p)=>f==="-"?d.jsx(gn,{color:"fg.subtle",children:f},p):d.jsx(gn,{bg:o.has(c*10+p)?"yellow.focusRing":void 0,fontWeight:a[h]?.has(c*10+p)?"bold":void 0,color:a[h]?.has(c*10+p)?"red":void 0,children:f},p)),10>u.length&&d.jsx(d.Fragment,{children:" ".repeat(10-u.length)})]},n[h].id))]})]},c))]})},Jo=(n,e)=>{const t=Array.from(qg(e)),r=new Set(t.filter((f,p,m)=>m.findIndex(g=>g.id===f.id)!==p).map(({id:f})=>f));if(r.size>0)return{error:{type:"error",title:`Duplicate sequence${r.size!==1?"s":""} of ${Tn(Array.from(r).map(f=>`${f} (appears ${o2(t.filter(p=>p.id===f).length)})`))}`}};const i=new Set(n.map(({id:f})=>f)),s=new Set(t.map(({id:f})=>f)),o=i.difference(s);if(o.size>0)return{error:{type:"error",title:`Missing sequence${o.size!==1?"s":""} of ${Tn(Array.from(o))}`}};let a;const l=s.difference(i);l.size>0&&(a={type:"warning",title:`Extra sequence${l.size!==1?"s":""} of ${Tn(Array.from(l))} ${l.size!==1?"are":"is"} ignored`,description:`Expected only the sequence${i.size!==1?"s":""} of ${Tn(Array.from(i))}`});const c=n.map(f=>({...f,sequence:t.find(({id:p})=>p===f.id).sequence.toUpperCase()})),u=c.filter(({sequence:f},p)=>f.replaceAll("-","")!==n[p].sequence.replaceAll("-",""));if(u.length>0)return{error:{type:"error",title:`Non-identical sequence${u.length!==1?"s":""} of ${Tn(u.map(({id:f})=>f))}`,description:"The sequences must be identical except for the gaps (i.e. '-')"}};const{error:h}=r5(c);return h?{error:h}:{warning:a,sequences:c}},Rc=({currentTarget:n},e)=>{const t=n.closest("[data-part=positioner]")||document.documentElement,r=t.scrollLeft,i=t.scrollTop;e&&(n.value=e),n.style.height="auto",n.style.height=`${n.scrollHeight}px`,t.scrollTo(r,i)};let et;const s5=({defaultSequences:n,onChange:e,readOnly:t=!1,setIsEditing:r,defaultEdit:i,inputRef:s,ref:o,...a})=>{const l=_.useCallback(({value:P})=>{const{warning:C,sequences:T}=Jo(n,P);T&&(et=Rs(et),C&&(et=nt(et,C)),e(T))},[n,e]),c=_.useMemo(()=>k2(n),[n]),[u,h]=_.useState(i??!1),f=_.useCallback(P=>{h(P),r?.(P)},[r]),[p,m]=_.useState(),g=u?void 0:p,x=_.useMemo(()=>{if(g)return Jo(n,g).sequences},[g,n]),b=u?p:void 0,y=_.useMemo(()=>{if(b===void 0)return;if(b.trim().length===0)return`Enter a sequence alignment of ${Tn(n.map(({id:C})=>C))} in FASTA format`;const{error:P}=Jo(n,b);return P?.title},[n,b]),w=_.useCallback((P,C=!1)=>{et=Rs(et);const{error:T,warning:A}=Jo(n,P);return T?(C||(et=nt(et,T)),f(!0),!1):(A&&!C&&(et=nt(et,A)),f(!1),l({value:P}),!0)},[n,f,l]),v=_.useCallback(P=>{if(P.size===0){et=nt(et,{type:"error",title:`${P.name} is empty`});return}P.text().then(C=>{if(!Ug(C)){et=nt(et,{type:"error",title:`${P.name} is not a valid FASTA file`});return}m(C),s.current&&Rc({currentTarget:s.current},C),w(C)&&(et=nt(et,{type:"success",title:`Loaded alignment from ${P.name}`}))}).catch(C=>{et=nt(et,{type:"error",title:`Couldn't read ${P.name}`,description:C.message})})},[s,w]),S=_.useCallback(P=>{if(!P.dataTransfer?.items||P.dataTransfer.items.length===0)return;const C=P.dataTransfer.items[0];if(C.kind==="file"){const T=C.getAsFile();T&&v(T)}},[v]);let k=0;return d.jsxs(ft,{onDragEnter:P=>{P.stopPropagation(),++k===1&&P.currentTarget.classList.add(Ti.dragover)},onDragLeave:P=>{P.stopPropagation(),--k===0&&P.currentTarget.classList.remove(Ti.dragover)},onDragOver:P=>{P.preventDefault(),P.stopPropagation()},onDrop:P=>{P.preventDefault(),P.stopPropagation(),P.currentTarget.classList.remove(Ti.dragover),k=0,S(P)},border:"2px solid transparent",ref:o,...a,children:[!u&&d.jsx(i5,{sequences:x??n,onClick:()=>!t&&f(!0),cursor:"text",fontFamily:"mono"}),u&&d.jsxs(vi,{invalid:!!y,children:[d.jsx(CC,{autoFocus:!0,fontFamily:"mono",overflowY:"hidden",ref:s,onFocus:Rc,onInput:Rc,value:p??c,onChange:P=>{et=Rs(et),m(P.currentTarget.value)},onKeyDown:P=>{P.key==="Enter"&&P.metaKey&&w(P.currentTarget.value)},onBlur:P=>w(P.currentTarget.value,!0)}),d.jsxs(Nr,{children:[y,"."," ",d.jsx(Nn,{onClick:()=>{m(void 0),f(!1)},children:"Revert changes."})]})]})]})},o5=_.memo(function(e){const t=te.c(31),{alignment:r,readOnly:i,applyAlignment:s,closeDialog:o}=e,a=i===void 0?!1:i,l=_.useRef(null),c=!r,[u,h]=_.useState(c),[f,p]=_.useState(r);let m;t[0]!==r||t[1]!==f||t[2]!==u?(m=!u&&f&&JSON.stringify(f)===JSON.stringify(r),t[0]=r,t[1]=f,t[2]=u,t[3]=m):m=t[3];const g=m;let x;t[4]===Symbol.for("react.memo_cache_sentinel")?(x=d.jsxs(Gt,{flexDir:"column",children:[d.jsx(Yt,{children:"Alignment"}),d.jsx(Dl,{}),d.jsx(on,{})]}),t[4]=x):x=t[4];let b;t[5]===Symbol.for("react.memo_cache_sentinel")?(b=T=>p(T),t[5]=b):b=t[5];let y;t[6]!==r||t[7]!==c||t[8]!==a?(y=d.jsx(s5,{defaultSequences:r,onChange:b,defaultEdit:c,setIsEditing:h,readOnly:a,inputRef:l}),t[6]=r,t[7]=c,t[8]=a,t[9]=y):y=t[9];let w;t[10]!==u?(w=!u&&d.jsxs(rt,{mt:5,fontSize:"xs",children:[d.jsx(gn,{bg:"yellow.focusRing",children:"X"})," - Conserved",d.jsx(gn,{fontWeight:"bold",color:"red",ml:5,children:"X"})," ","- Cross-linked"]}),t[10]=u,t[11]=w):w=t[11];let v;t[12]!==y||t[13]!==w?(v=d.jsxs(wn,{children:[y,w]}),t[12]=y,t[13]=w,t[14]=v):v=t[14];let S;t[15]!==g||t[16]!==o||t[17]!==u?(S=!u&&g&&d.jsx(ke,{variant:"surface",onClick:o,children:"Close"}),t[15]=g,t[16]=o,t[17]=u,t[18]=S):S=t[18];let k;t[19]!==g||t[20]!==s||t[21]!==o||t[22]!==f||t[23]!==u?(k=!u&&!g&&d.jsxs(d.Fragment,{children:[d.jsx(ke,{variant:"surface",onClick:o,children:"Cancel"}),d.jsx(ke,{colorPalette:"green",onClick:()=>{f&&(s(f.map(a5)),o())},disabled:!f,children:"Save alignment"})]}),t[19]=g,t[20]=s,t[21]=o,t[22]=f,t[23]=u,t[24]=k):k=t[24];let P;t[25]!==S||t[26]!==k?(P=d.jsxs(Xt,{children:[S,k]}),t[25]=S,t[26]=k,t[27]=P):P=t[27];let C;return t[28]!==P||t[29]!==v?(C=d.jsxs(d.Fragment,{children:[x,v,P]}),t[28]=P,t[29]=v,t[30]=C):C=t[30],C});function a5(n){const{sequence:e}=n;return e}const l5=_.memo(function(e){const t=te.c(104);let r,i,s,o,a,l,c,u;t[0]!==e?({experimentId:i,structureId:u,chain:r,proteinsCollection:a,mappedProteinId:s,onShowAlignment:o,ref:l,...c}=e,t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=o,t[5]=a,t[6]=l,t[7]=c,t[8]=u):(r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7],u=t[8]);let h;t[9]!==r.id||t[10]!==i||t[11]!==s||t[12]!==u?(h=async(ae,ce)=>{if(s&&UT(u,r.id,s),!ae)return;const fe=ae in ie.referenceProteinsById?ie.referenceProteinsById[ae]:ie.experiments.find(ve=>{const{id:xe}=ve;return xe===i})?.proteins.find(ve=>{const{id:xe}=ve;return xe===ae});if(fe)return VT(u,r.id,fe,ce)},t[9]=r.id,t[10]=i,t[11]=s,t[12]=u,t[13]=h):h=t[13];const[f,p]=lb(h),{value:m,loading:g,error:x}=f;let b;t[14]!==s?(b=s?[s]:[],t[14]=s,t[15]=b):b=t[15];let y;t[16]!==p?(y=ae=>{const{value:ce}=ae;return p(ce[0])},t[16]=p,t[17]=y):y=t[17];const w=!!x&&!g;let v;t[18]!==g||t[19]!==a||t[20]!==b||t[21]!==y||t[22]!==w?(v={defaultValue:b,collection:a,onValueChange:y,invalid:w,disabled:g},t[18]=g,t[19]=a,t[20]=b,t[21]=y,t[22]=w,t[23]=v):v=t[23];const S=wl(v),k=!g&&!x&&!!m;let P;t[24]!==k||t[25]!==m?(P=k&&m.message.startsWith("Note that this mapping might be wrong"),t[24]=k,t[25]=m,t[26]=P):P=t[26];const C=P;let T,A,M,O,R,j,I,E,D,L,z,B,N,U,q,X,J;if(t[27]!==r.id||t[28]!==x||t[29]!==i||t[30]!==k||t[31]!==C||t[32]!==g||t[33]!==a.items||t[34]!==l||t[35]!==c||t[36]!==S){let ae;t[54]!==i?(ae=Le=>Le.fileId===i,t[54]=i,t[55]=ae):ae=t[55];const ce=a.items.filter(ae),fe=a.items.filter(Le=>Le.fileId===void 0&&!ce.some($=>{const{value:F}=$;return F===Le.value}));M=nu,N=!!x&&!g,U=l,q=c,A=kd,j="xs",I=S,E="row",D=3,L="center",t[56]!==r.id?(z=d.jsxs(bT,{minW:5,children:["/",r.id]}),t[56]=r.id,t[57]=z):z=t[57];const ve=!g;let xe;t[58]!==k||t[59]!==C?(xe=k?{borderColor:C?"fg.warning":"fg.success"}:void 0,t[58]=k,t[59]=C,t[60]=xe):xe=t[60];let ue;t[61]===Symbol.for("react.memo_cache_sentinel")?(ue=d.jsx(xT,{placeholder:"Select protein to map",children:h5}),t[61]=ue):ue=t[61];let Se;t[62]!==g?(Se=g&&d.jsx(Zr,{}),t[62]=g,t[63]=Se):Se=t[63],t[64]!==g||t[65]!==ve||t[66]!==xe||t[67]!==Se?(B=d.jsxs(mT,{clearable:ve,hideIndicator:g,flexGrow:1,triggerProps:xe,children:[ue,Se]}),t[64]=g,t[65]=ve,t[66]=xe,t[67]=Se,t[68]=B):B=t[68],T=Kb,X=!1,J=-1,O=ce.map(f5),R=fe.length>0&&d.jsxs(d.Fragment,{children:[d.jsx(Ur,{}),fe.map(p5)]}),t[27]=r.id,t[28]=x,t[29]=i,t[30]=k,t[31]=C,t[32]=g,t[33]=a.items,t[34]=l,t[35]=c,t[36]=S,t[37]=T,t[38]=A,t[39]=M,t[40]=O,t[41]=R,t[42]=j,t[43]=I,t[44]=E,t[45]=D,t[46]=L,t[47]=z,t[48]=B,t[49]=N,t[50]=U,t[51]=q,t[52]=X,t[53]=J}else T=t[37],A=t[38],M=t[39],O=t[40],R=t[41],j=t[42],I=t[43],E=t[44],D=t[45],L=t[46],z=t[47],B=t[48],N=t[49],U=t[50],q=t[51],X=t[52],J=t[53];let ee;t[69]!==T||t[70]!==O||t[71]!==R||t[72]!==X||t[73]!==J?(ee=d.jsxs(T,{portalled:X,mt:J,children:[O,R]}),t[69]=T,t[70]=O,t[71]=R,t[72]=X,t[73]=J,t[74]=ee):ee=t[74];let re;t[75]!==A||t[76]!==j||t[77]!==I||t[78]!==E||t[79]!==D||t[80]!==L||t[81]!==z||t[82]!==B||t[83]!==ee?(re=d.jsxs(A,{size:j,value:I,flexDirection:E,gapX:D,alignItems:L,children:[z,B,ee]}),t[75]=A,t[76]=j,t[77]=I,t[78]=E,t[79]=D,t[80]=L,t[81]=z,t[82]=B,t[83]=ee,t[84]=re):re=t[84];let oe;t[85]!==x||t[86]!==g?(oe=!g&&x&&d.jsx(Nr,{children:x.message}),t[85]=x,t[86]=g,t[87]=oe):oe=t[87];let me;t[88]!==r.id||t[89]!==k||t[90]!==C||t[91]!==p||t[92]!==o||t[93]!==S||t[94]!==m?(me=k&&d.jsxs(ru,{color:C?"fg.warning":"fg.success",children:[m.message," ",o&&m.mapping.alignedSequences&&d.jsx(Nn,{onClick:()=>{Kr(S.selectedItems.length===1);const ae=S.selectedItems[0];if(!ae)return;const ce=new Set;if(ae.isReferenceProtein)for(const[fe,ve]of ie.proteinIdToReferenceProtein.entries()){if(ve.id!==ae.value)continue;const xe=ie.experiments.flatMap(m5).find(ue=>{const{id:Se}=ue;return Se===fe});xe&&Object.keys(xe.linkPositionToAminoAcid).map(g5).forEach(ue=>{const Se=ve.xlPosToRefPos[ue];Se&&ce.add(Se)})}else{const fe=ie.experiments.flatMap(x5).find(ve=>{const{id:xe}=ve;return xe===ae.value});fe&&Object.keys(fe.linkPositionToAminoAcid).map(b5).forEach(ve=>{ce.add(ve)})}return o({sequences:[{id:`/${r.id}`,sequence:m.mapping.alignedSequences.chain},{id:ae.label,sequence:m.mapping.alignedSequences.protein,highlightedPositions:ce}],applyAlignment:fe=>p(ae.value,fe)})},children:"View alignment."})]}),t[88]=r.id,t[89]=k,t[90]=C,t[91]=p,t[92]=o,t[93]=S,t[94]=m,t[95]=me):me=t[95];let ge;return t[96]!==M||t[97]!==N||t[98]!==U||t[99]!==q||t[100]!==re||t[101]!==oe||t[102]!==me?(ge=d.jsxs(M,{invalid:N,ref:U,...q,children:[re,oe,me]}),t[96]=M,t[97]=N,t[98]=U,t[99]=q,t[100]=re,t[101]=oe,t[102]=me,t[103]=ge):ge=t[103],ge}),c5=_.memo(function({experiment:e,structureId:t,ref:r,...i}){const{structures:s}=Je(ie),o=s.find(({id:f})=>f===t),a=zd(),l=_.useMemo(()=>{const f=new Set;return cd({items:[...e.proteins.map(({id:p,name:m,isReferenceProtein:g})=>(g&&f.add(p),{value:p,label:m,fileId:e.id,isReferenceProtein:g})),...a.filter(({id:p})=>!f.has(p)).map(({id:p,name:m})=>({value:p,label:m,fileId:void 0,isReferenceProtein:!0}))]})},[e.id,e.proteins,a]),c=xn({trapFocus:!1}),[u,h]=_.useState();if(o)return d.jsxs(nn,{ref:r,...i,children:[d.jsxs(Gt,{flexDir:"column",children:[d.jsx(Yt,{children:"Structure"}),d.jsx(Dl,{asChild:!0,children:d.jsx(bd,{size:"sm",orientation:"horizontal",wordBreak:"break-word",children:d.jsxs(Si,{children:[d.jsx(Pi,{children:"Name"}),d.jsx(Ci,{children:d.jsx(Rd,{name:o.name,onRename:f=>WT(o.id,{name:f})})})]})})}),d.jsx(on,{})]}),d.jsx(wn,{children:d.jsxs(So,{gap:5,align:"stretch",children:[d.jsxs(vd,{children:[d.jsxs(O1,{children:["Map chains to proteins in ",e.name]}),d.jsx(wd,{children:o.chains.map(f=>d.jsx(l5,{experimentId:e.id,structureId:o.id,chain:f,proteinsCollection:l,mappedProteinId:o.chainIdToProteinIdToMapping[f.id].entries().find(([p,m])=>l.has(p)&&m!==void 0)?.[0],onShowAlignment:p=>{h(p),c.setOpen(!0)}},f.id))})]}),d.jsx(n5,{experiment:e,structure:o},`${o.id}-${e.id}`)]})}),d.jsx(Xt,{}),d.jsx(rr,{value:c,size:"xl",placement:"top",lazyMount:!0,unmountOnExit:!0,children:d.jsx(nn,{h:"fit",portalled:!1,children:u&&d.jsx(o5,{alignment:u.sequences,applyAlignment:u.applyAlignment,closeDialog:()=>{c.setOpen(!1)}})})})]})}),u5=_.memo(function(e){const t=te.c(5),{dialog:r,dialogProps:i}=e;let s;t[0]!==i?(s=i&&d.jsx(c5,{...i}),t[0]=i,t[1]=s):s=t[1];let o;return t[2]!==r||t[3]!==s?(o=d.jsx(rr,{value:r,unmountOnExit:!0,lazyMount:!0,children:s}),t[2]=r,t[3]=s,t[4]=o):o=t[4],o});function d5(n){return n.label+(n.isReferenceProtein?" (reference protein)":"")}function h5(n){return Tn(n.map(d5))}function f5(n){return d.jsxs(Fd,{item:n,children:[n.label," ",n.isReferenceProtein?"(reference protein)":""]},n.value)}function p5(n){return d.jsxs(Fd,{item:n,children:[n.label," ",n.isReferenceProtein?"(reference protein)":""]},n.value)}function m5(n){const{proteins:e}=n;return e}function g5(n){return Number.parseInt(n)}function x5(n){const{proteins:e}=n;return e}function b5(n){return Number.parseInt(n)}const xp=n=>n.linkPosition?`${n.aminoAcid??""}${n.linkPosition}`:"",y5={cell:{width:20,height:20},labels:{crosslinks:{width:270,padding:10,fontSize:10,columns:[{render:({id:n})=>n,padding:0},{render:({from:n,to:e})=>`${xp(n)} - ${xp(e)}`,padding:30},{render:({from:n,to:e},t,r)=>r?`${t[n.proteinId].name} - ${t[e.proteinId].name}`:null,x:0,textAnchor:"start"}]},structures:{height:100,padding:10,fontSize:10}}},v5=n=>{const e=te.c(31);let t,r,i,s,o,a,l;e[0]!==n?({config:l,experiments:t,groupedCrosslinkIds:r,structureNameById:a,proteinsById:i,ref:s,...o}=n,e[0]=n,e[1]=t,e[2]=r,e[3]=i,e[4]=s,e[5]=o,e[6]=a,e[7]=l):(t=e[1],r=e[2],i=e[3],s=e[4],o=e[5],a=e[6],l=e[7]);const c=l===void 0?y5:l;let u;if(e[8]!==c.cell.height||e[9]!==c.cell.width||e[10]!==c.labels.crosslinks.columns||e[11]!==c.labels.crosslinks.fontSize||e[12]!==c.labels.crosslinks.padding||e[13]!==c.labels.crosslinks.width||e[14]!==c.labels.structures.fontSize||e[15]!==c.labels.structures.height||e[16]!==c.labels.structures.padding||e[17]!==t||e[18]!==r||e[19]!==i||e[20]!==s||e[21]!==o||e[22]!==a){const h=t.flatMap(w5),f=[];for(const{ids:m}of r.flatMap(_5))f.push(...t.flatMap((g,x)=>{const{experiment:b}=g,{crosslinks:y}=b;return m[x].map(w=>[x,y.find(v=>v.id===w)])}));let p;e[24]!==c.cell.width||e[25]!==c.labels.crosslinks.width||e[26]!==c.labels.structures.fontSize||e[27]!==c.labels.structures.height||e[28]!==c.labels.structures.padding||e[29]!==a?(p=(m,g)=>{const[x,b]=m;return d.jsx("text",{transform:`translate(${c.labels.crosslinks.width+(g+.5)*c.cell.width}, ${c.labels.structures.height-c.labels.structures.padding}) rotate(90)`,dominantBaseline:"middle",textAnchor:"end",fontSize:c.labels.structures.fontSize,children:a[b]},`${x}-structure-${b}`)},e[24]=c.cell.width,e[25]=c.labels.crosslinks.width,e[26]=c.labels.structures.fontSize,e[27]=c.labels.structures.height,e[28]=c.labels.structures.padding,e[29]=a,e[30]=p):p=e[30],u=d.jsxs("svg",{viewBox:`0 0 ${c.labels.crosslinks.width+h.length*c.cell.width} ${c.labels.structures.height+f.length*c.cell.height}`,width:c.labels.crosslinks.width+h.length*c.cell.width,height:c.labels.structures.height+f.length*c.cell.height,...o,ref:s,children:[f.map((m,g)=>{const[x,b]=m;return h.map((y,w)=>{const[v,S]=y;return v===x?d.jsx("rect",{width:c.cell.width,height:c.cell.height,x:c.labels.crosslinks.width+w*c.cell.width,y:c.labels.structures.height+g*c.cell.height,fill:An(t[v].structureToXlinkIdToStatus[S]?.[b.id])},`${v}-${b.id}-${S}`):null})}),f.map((m,g)=>{const[x,b]=m;return c.labels.crosslinks.columns.map((y,w)=>{const{render:v,padding:S,...k}=y;return d.jsx("text",{y:c.labels.structures.height+(g+.5)*c.cell.height,x:c.labels.crosslinks.width-c.labels.crosslinks.padding-(S??0),dominantBaseline:"middle",textAnchor:"end",fontSize:c.labels.crosslinks.fontSize,...k,children:v(b,i,g===0||b.from.proteinId!==f[g-1][1].from.proteinId||b.to.proteinId!==f[g-1][1].to.proteinId)},`${x}-xlink-${b.id}-${w}`)})}),h.map(p)]}),e[8]=c.cell.height,e[9]=c.cell.width,e[10]=c.labels.crosslinks.columns,e[11]=c.labels.crosslinks.fontSize,e[12]=c.labels.crosslinks.padding,e[13]=c.labels.crosslinks.width,e[14]=c.labels.structures.fontSize,e[15]=c.labels.structures.height,e[16]=c.labels.structures.padding,e[17]=t,e[18]=r,e[19]=i,e[20]=s,e[21]=o,e[22]=a,e[23]=u}else u=e[23];return u};function w5(n,e){const{groupedStructureIds:t}=n;return t.flat().map(r=>[e,r])}function _5(n){const{rows:e}=n;return e}const S5=n=>{const e=te.c(42);let t,r,i;e[0]!==n?({exportBasename:t,gridProps:r,...i}=n,e[0]=n,e[1]=t,e[2]=r,e[3]=i):(t=e[1],r=e[2],i=e[3]);const s=_.useRef(null);let o;e[4]!==t?(o=()=>{if(!s.current)return;const E=document.createElement("a"),D=new Blob([new XMLSerializer().serializeToString(s.current)],{type:"image/svg+xml"});E.href=URL.createObjectURL(D),E.download=`${t}-figure.svg`,E.click()},e[4]=t,e[5]=o):o=e[5];const a=o;let l;e[6]!==t?(l=()=>{if(!s.current)return;const E=new Blob([new XMLSerializer().serializeToString(s.current)],{type:"image/svg+xml"}),D=window.URL||window.webkitURL||window,L=D.createObjectURL(E),z=new Image;z.width=s.current.viewBox.baseVal.width,z.height=s.current.viewBox.baseVal.height,z.src=L,z.onload=function(){const B=document.getElementById("canvas");B.width=z.width,B.height=z.height,B.getContext("2d")?.drawImage(z,0,0),D.revokeObjectURL(L);const U=B.toDataURL("image/png").replace("image/png","image/octet-stream"),q=document.createElement("a");q.href=U,q.download=`${t}.png`,q.click()}},e[6]=t,e[7]=l):l=e[7];const c=l,[u,h]=_.useState(!1),[f,p]=_.useState(!1);let m;e[8]===Symbol.for("react.memo_cache_sentinel")?(m=d.jsxs(Gt,{flexDir:"column",children:[d.jsx(Yt,{children:"Export Figure"}),d.jsx(on,{})]}),e[8]=m):m=e[8];let g;e[9]===Symbol.for("react.memo_cache_sentinel")?(g=()=>h(P5),e[9]=g):g=e[9];const x=u?"zoom-out":"zoom-in",b=f?"linear-gradient(45deg, #E0E0E0 25%, transparent 25%), linear-gradient(-45deg, #E0E0E0 25%, transparent 25%), linear-gradient(45deg, transparent 75%, #E0E0E0 75%), linear-gradient(-45deg, transparent 75%, #E0E0E0 75%)":void 0,y=f?"20px 20px":void 0,w=f?"0 0, 0 10px, 10px -10px, -10px 0px":void 0;let v;e[10]!==u?(v=u?{}:{height:"100%"},e[10]=u,e[11]=v):v=e[11];let S;e[12]!==f?(S=f?{}:{style:{backgroundColor:"white"}},e[12]=f,e[13]=S):S=e[13];let k;e[14]!==r||e[15]!==S||e[16]!==v?(k=d.jsx(v5,{...r,ref:s,...v,...S}),e[14]=r,e[15]=S,e[16]=v,e[17]=k):k=e[17];let P;e[18]===Symbol.for("react.memo_cache_sentinel")?(P=d.jsx("canvas",{style:{display:"none"},id:"canvas"}),e[18]=P):P=e[18];let C;e[19]!==k||e[20]!==x||e[21]!==b||e[22]!==y||e[23]!==w?(C=d.jsxs(wn,{as:Re,justifyContent:"center",onClick:g,cursor:x,bgImage:b,bgSize:y,bgPos:w,children:[k,P]}),e[19]=k,e[20]=x,e[21]=b,e[22]=y,e[23]=w,e[24]=C):C=e[24];let T;e[25]===Symbol.for("react.memo_cache_sentinel")?(T=E=>{const{checked:D}=E;return p(!!D)},e[25]=T):T=e[25];let A;e[26]!==f?(A=d.jsx(Qn,{checked:f,onCheckedChange:T,variant:"outline",children:"Transparent background"}),e[26]=f,e[27]=A):A=e[27];let M;e[28]!==a?(M=d.jsx(ke,{variant:"outline",onClick:()=>a(),children:"Export as SVG"}),e[28]=a,e[29]=M):M=e[29];let O;e[30]!==c?(O=d.jsx(ke,{variant:"outline",onClick:()=>c(),children:"Export as PNG"}),e[30]=c,e[31]=O):O=e[31];let R;e[32]!==M||e[33]!==O?(R=d.jsxs(zs,{children:[M,O]}),e[32]=M,e[33]=O,e[34]=R):R=e[34];let j;e[35]!==A||e[36]!==R?(j=d.jsxs(Xt,{as:Re,justifyContent:"space-between",children:[A,R]}),e[35]=A,e[36]=R,e[37]=j):j=e[37];let I;return e[38]!==i||e[39]!==C||e[40]!==j?(I=d.jsxs(nn,{...i,children:[m,C,j]}),e[38]=i,e[39]=C,e[40]=j,e[41]=I):I=e[41],I},tv=n=>{const e=te.c(5),{dialog:t,dialogProps:r}=n;let i;e[0]!==r?(i=r&&d.jsx(S5,{...r}),e[0]=r,e[1]=i):i=e[1];let s;return e[2]!==t||e[3]!==i?(s=d.jsx(rr,{value:t,size:"cover",placement:"center",scrollBehavior:"inside",unmountOnExit:!0,lazyMount:!0,children:i}),e[2]=t,e[3]=i,e[4]=s):s=e[4],s};function P5(n){return!n}const bp=({fromProteinId:n,fromDomainName:e,toProteinId:t,toDomainName:r})=>`${n}-${e}-${t}-${r}`,nv=(n,e,t,r)=>{const[i,s]=_.useState({});for(const[m,g]of Object.entries(i)){const x=n.indexOf(m);if(x===-1)s(b=>Object.fromEntries(Object.entries(b).filter(([y])=>y!==m)));else{const b=new Set(g).difference(new Set(e.flatMap(({rows:y})=>y.flatMap(({ids:w})=>w[x]))));b.size>0&&s(y=>({...y,[m]:y[m]?.filter(w=>!b.has(w))}))}}const o=_.useMemo(()=>t.map(m=>{if(m)return m.ids.every((g,x)=>g.every(b=>i[n[x]]?.includes(b)===!0))?!0:m.ids.some((g,x)=>g.some(b=>i[n[x]]?.includes(b)===!0))?"indeterminate":!1}),[t,i,n]),a=_.useMemo(()=>r.map((m,g)=>{if(m===void 0)return;let x;for(let b=g;b<o.length&&(b===g||r[b]===void 0);++b)if(o[b]!==void 0){if(x===void 0){if(x=o[b],x==="indeterminate")return"indeterminate"}else if(x!==o[b])return"indeterminate"}return x}),[r,o]),l=Object.values(i).flat().length,c=o.some(m=>m==="indeterminate")?void 0:o.filter(m=>m===!0).length,u=_.useCallback((m,g)=>{const x=Object.fromEntries(_i(...g.map(({ids:b})=>b)).map((b,y)=>[n[y],b.flatMap(w=>w??[])]));s(m?b=>Object.fromEntries(Object.values(Object.groupBy([...Object.entries(b).flatMap(([y,w])=>w?[[y,w]]:[]),...Object.entries(x)],([y])=>y)).filter(y=>y!==void 0).map(y=>[y[0][0],Array.from(new Set(y.flatMap(([w,v])=>v)))])):b=>Object.fromEntries(Object.entries(b).map(([y,w])=>[y,w?.filter(v=>!x[y].includes(v))])))},[n]),h=_.useCallback((m,g,x)=>{if(!x)u(m,[g]);else{const b=t.findIndex(w=>w&&JSON.stringify(w)===JSON.stringify(g)),y=pl(o,m,b);u(m,y.map(w=>t[w]).filter(w=>w!==void 0))}},[u,t,o]),f=_.useCallback((m,g,x)=>u(m,e.find(b=>bp(b)===bp(g)).rows),[u,e]),p=_.useCallback(()=>s({}),[]);return{selectedCrosslinkIds:i,rowIndexToCheckedState:o,rowIndexToGroupCheckedState:a,numOfSelectedCrosslinks:l,numOfSelectedRows:c,onRowToggle:h,onGroupToggle:f,clearSelectedRows:p}},rv=_.memo(function(e){const t=te.c(40);let r,i,s,o,a,l,c;t[0]!==e?({selectedCrosslinkIds:c,numOfSelectedCrosslinks:s,numOfSelectedRows:o,clearSelectedRows:r,saveCrosslinksTable:l,hideCrosslinks:i,...a}=e,t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=o,t[5]=a,t[6]=l,t[7]=c):(r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6],c=t[7]);const u=s>0;let h;t[8]!==r?(h=T=>{const{open:A}=T;return A?null:r()},t[8]=r,t[9]=h):h=t[9];let f;t[10]!==s||t[11]!==o?(f=o!==void 0&&o!==s?De(o,"row"):De(s,"crosslink"),t[10]=s,t[11]=o,t[12]=f):f=t[12];let p;t[13]!==f?(p=d.jsxs(ql,{children:[f," ","selected"]}),t[13]=f,t[14]=p):p=t[14];let m;t[15]===Symbol.for("react.memo_cache_sentinel")?(m=d.jsx(Ni,{}),t[15]=m):m=t[15];let g;t[16]!==l||t[17]!==c?(g=()=>l(c),t[16]=l,t[17]=c,t[18]=g):g=t[18];let x;t[19]===Symbol.for("react.memo_cache_sentinel")?(x=d.jsx(ry,{}),t[19]=x):x=t[19];let b;t[20]!==g?(b=d.jsxs(ke,{variant:"surface",size:"sm",onClick:g,children:[x,"Export"]}),t[20]=g,t[21]=b):b=t[21];let y;t[22]===Symbol.for("react.memo_cache_sentinel")?(y=d.jsx(Ni,{}),t[22]=y):y=t[22];let w;t[23]!==r||t[24]!==i||t[25]!==c?(w=()=>{i(c),r()},t[23]=r,t[24]=i,t[25]=c,t[26]=w):w=t[26];let v;t[27]===Symbol.for("react.memo_cache_sentinel")?(v=d.jsx(a2,{}),t[27]=v):v=t[27];let S;t[28]!==w?(S=d.jsxs(ke,{variant:"surface",colorPalette:"red",size:"sm",onClick:w,children:[v,"Hide"]}),t[28]=w,t[29]=S):S=t[29];let k;t[30]===Symbol.for("react.memo_cache_sentinel")?(k=d.jsx(Wl,{}),t[30]=k):k=t[30];let P;t[31]!==S||t[32]!==p||t[33]!==b?(P=d.jsxs(Vl,{children:[p,m,b,y,S,k]}),t[31]=S,t[32]=p,t[33]=b,t[34]=P):P=t[34];let C;return t[35]!==a||t[36]!==u||t[37]!==P||t[38]!==h?(C=d.jsx(Ul,{open:u,onOpenChange:h,closeOnInteractOutside:!1,...a,children:P}),t[35]=a,t[36]=u,t[37]=P,t[38]=h,t[39]=C):C=t[39],C}),C5="_experimentname_7yvhj_1",k5={experimentname:C5},j5=n=>{const e=te.c(21);let t;e[0]===Symbol.for("react.memo_cache_sentinel")?(t={},e[0]=t):t=e[0];const[r,i]=_.useState(t);for(const[y,w]of Object.entries(r)){const v=n.find(k=>k.experimentId===y)?.structureIds;if(v===void 0){i(k=>Object.fromEntries(Object.entries(k).filter(P=>{const[C]=P;return C!==y})));continue}const S=new Set(w).difference(new Set(v));S.size>0&&i(k=>({...k,[y]:k[y]?.difference(S)}))}let s,o;if(e[1]!==n||e[2]!==r){let y;e[4]!==r?(y=w=>{const{experimentId:v,structureIds:S}=w;return S.map(k=>({experimentId:v,structureId:k,checked:r[v]?.has(k)??!1}))},e[4]=r,e[5]=y):y=e[5],o=n.flatMap(y),e[1]=n,e[2]=r,e[3]=o}else o=e[3];s=o;const a=s;let l,c;if(e[6]!==n||e[7]!==r){let y;e[10]!==r?(y=v=>{const{experimentId:S}=v;return r[S]?.size??0},e[10]=r,e[11]=y):y=e[11];const w=n.map(y);l=w.reduce(T5,0),c=l===0?0:w.reduce(M5,0),e[6]=n,e[7]=r,e[8]=l,e[9]=c}else l=e[8],c=e[9];const u=c;let h;e[12]===Symbol.for("react.memo_cache_sentinel")?(h=(y,w)=>{const v=Object.fromEntries(Object.entries(Object.groupBy(w,A5)).map(I5));i(y?S=>Object.fromEntries(Object.values(Object.groupBy([...Object.entries(S).flatMap(R5),...Object.entries(v)],O5)).filter($5).map(N5)):S=>Object.fromEntries(Object.entries(S).map(k=>{const[P,C]=k;return[P,C?.difference(new Set(v[P]??[]))]})))},e[12]=h):h=e[12];const f=h;let p;e[13]!==a?(p=(y,w,v,S)=>{if(!S)f(y,[{experimentId:w,structureId:v}]);else{const k=a.findIndex(C=>C.experimentId===w&&C.structureId===v),P=pl(a.map(L5),y,k);f(y,P.map(C=>a[C]).filter(F5))}},e[13]=a,e[14]=p):p=e[14];const m=p;let g;e[15]===Symbol.for("react.memo_cache_sentinel")?(g=()=>i({}),e[15]=g):g=e[15];const x=g;let b;return e[16]!==r||e[17]!==u||e[18]!==l||e[19]!==m?(b={experimentIdToSelectedStructureIds:r,numOfSelectedStructures:l,numOfExperimentsWithSelections:u,onStructureToggle:m,clearStructureSelection:x},e[16]=r,e[17]=u,e[18]=l,e[19]=m,e[20]=b):b=e[20],b};function T5(n,e){return n+e}function M5(n,e){return n+(e>0?1:0)}function A5(n){const{experimentId:e}=n;return e}function E5(n){const{structureId:e}=n;return e}function I5(n){const[e,t]=n;return[e,t?.map(E5)??[]]}function R5(n){const[e,t]=n;return t?[[e,Array.from(t)]]:[]}function O5(n){const[e]=n;return e}function $5(n){return n!==void 0}function D5(n){const[,e]=n;return e}function N5(n){return[n[0][0],new Set(n.flatMap(D5))]}function L5(n){const{checked:e}=n;return e}function F5(n){return n!==void 0}const z5=_.memo(function({experiments:e,groupedCrosslinkIds:t,proteinsById:r,structuresById:i,groupDuplicates:s,hideCrosslinks:o}){const a=_.useDeferredValue(e),l=!Object.is(a,e),c=_.useDeferredValue(t),u=_.useDeferredValue(r),h=_.useDeferredValue(i),f=_.useDeferredValue(s),p=_.useRef(null),m=_.useMemo(()=>{const $=[void 0,void 0];return c.forEach(({rows:F},V)=>{V!==0&&$.push(void 0);const K=f?F.length:F.reduce((G,{ids:pe})=>G+Math.max(...pe.map(W=>W.length)),0);$.push(V),$.push(...Array(K-1).fill(void 0))}),$},[f,c]),g=_.useMemo(()=>{const $=[void 0,void 0];return c.forEach(({rows:F},V)=>{V!==0&&$.push(void 0);for(const K of F)if(f)$.push(K);else{const G=_i(...K.homoMultimeric),pe=_i(...K.scores);$.push(..._i(...K.ids).map((W,de)=>({...K,ids:W.map(we=>we!==void 0?[we]:[]),homoMultimeric:W.map((we,Ge)=>we!==void 0?[G[de]?.[Ge]]:[]),scores:W.map((we,Ge)=>we!==void 0?[pe[de]?.[Ge]]:[])})).flat())}}),$},[f,c]),x=$=>{if($===0)return"header";if($===1)return"header-2";const F=g[$];return F===void 0?`gap-after-${x($-1)}`:F.ids.map(V=>V.length>0?V.join("-"):"X").join(":")},b=uy({enabled:c.length>0,count:g.length,estimateSize:$=>$===0?40:$===1?80:g[$]===void 0?5:26,scrollMargin:p.current?.offsetTop??0,getItemKey:x,overscan:20,rangeExtractor:$=>new Set([0,1,...Vd($),...m.flatMap((F,V)=>F!==void 0?[V]:[])]).values().toArray()}),y=_.useMemo(()=>{const $=[void 0];return a.forEach(({groupedStructureIds:F},V)=>{V!==0&&$.push(void 0),$.push([V,void 0]),F.forEach((K,G)=>{G!==0&&$.push([V,void 0]),$.push(...K.map(pe=>[V,pe]))}),$.push([V,void 0])}),$},[a]),w=$=>{if($===0)return"header";const F=y[$];return F===void 0||F[1]===void 0?`gap-after-${w($-1)}`:`${a[F[0]].experiment.id}-${F[1]}`},v=cy({enabled:c.length>0,horizontal:!0,count:y.length,getScrollElement:()=>p.current,estimateSize:$=>{if($===0)return 237;const F=y[$];return F===void 0?10:F[1]===void 0?5:26},overscan:20,getItemKey:w}),S=v.getVirtualItems(),[k,P]=S.length>0?[S[0].start,v.getTotalSize()-S[S.length-1].end]:[0,0],{experimentIdToSelectedStructureIds:C,numOfSelectedStructures:T,numOfExperimentsWithSelections:A,onStructureToggle:M,clearStructureSelection:O}=j5(_.useMemo(()=>a.map(({experiment:$,groupedStructureIds:F})=>({experimentId:$.id,structureIds:F.flat()})),[a]));let R=v.measurementsCache[0]?.size??0;const j=$=>{if(!v.options.enabled||!$||!$.dataset.index)return;const F=$.getBoundingClientRect().width;if($.dataset.index==="0"){R<F&&(R=F,v.resizeItem(0,Math.ceil(F)));return}const[V,K]=$.dataset.index.split("-").map(G=>Number.parseInt(G));if(!Number.isNaN(V)&&!Number.isNaN(K)){let G=F;for(let W=V;W<K;++W){const de=y[W];de===void 0?G-=10:de[1]===void 0?G-=5:G-=26}const pe=G/2;(v.measurementsCache[V]?.size??0)<pe&&v.resizeItem(V,Math.ceil(pe)),(v.measurementsCache[K]?.size??0)<pe&&v.resizeItem(K,Math.ceil(pe))}};_.useEffect(()=>{v.measure()},[c,u,v]);let I=b.measurementsCache[0]?.size??0;const E=$=>{!b.options.enabled||!$||$.dataset.index!=="1"||I<$.getBoundingClientRect().height&&(I=$.getBoundingClientRect().height,b.resizeItem(1,Math.ceil($.getBoundingClientRect().height)))};_.useEffect(()=>{b.measure()},[h,b]);const D=_.useMemo(()=>d.jsxs(d.Fragment,{children:[d.jsx(Aa,{styles:{".xlink":{cursor:"pointer",color:"transparent",fontSize:"0.8rem",alignContent:"center",textAlign:"center",":hover":{boxShadow:"inset 0px 0px 0px 1px var(--chakra-colors-fg-inverted)",color:"var(--chakra-colors-fg-inverted)"}}}}),d.jsx(Aa,{styles:Object.fromEntries(c.flatMap(({fromProteinId:$,fromDomainName:F,toProteinId:V,toDomainName:K})=>[$,...F?[$+F]:[],V,...K?[V+K]:[]].map(G=>[`html:has(.xlp${$i(G)}:hover) .xlp${$i(G)}`,{boxShadow:"inset 0px 0px 0px 1px var(--chakra-colors-fg-info)"}])))})]}),[c]),[L,z]=_.useState(),B=xn({trapFocus:!1}),[N,U]=_.useState(),q=xn({trapFocus:!1}),X=a.some(({experiment:{crosslinks:$}})=>$.some(({score:F})=>F!==void 0)),[J,ee]=Jy("fieldToShow","ids"),re=a.length>1?void 0:X?J:"ids",oe=X?()=>ee(J==="ids"?"scores":"ids"):void 0,me=xn({}),{selectedCrosslinkIds:ge,rowIndexToCheckedState:ae,rowIndexToGroupCheckedState:ce,numOfSelectedCrosslinks:fe,numOfSelectedRows:ve,onRowToggle:xe,onGroupToggle:ue,clearSelectedRows:Se}=nv(_.useMemo(()=>a.map(({experiment:$})=>$.id),[a]),c,g,m),Le=_.useCallback($=>$l(Ol(a.map(({experiment:F})=>F),c.map(({rows:F,...V})=>({rows:F.map(({ids:K,...G})=>({ids:K.map((pe,W)=>pe.filter(de=>$[a[W].experiment.id]?.includes(de)===!0)),...G})),...V}))),`${a.length===1?a[0].experiment.name??"XLinkUp":"Experiments"}-xlinks`),[a,c]);return d.jsxs(d.Fragment,{children:[d.jsx(u5,{dialog:B,dialogProps:L}),d.jsx(GR,{dialog:q,dialogProps:N}),d.jsx(tv,{dialog:me,dialogProps:{exportBasename:a.length===1?a[0].experiment.name??"XLinkUp":"Experiments",gridProps:{experiments:a,groupedCrosslinkIds:c,proteinsById:u,structureNameById:Object.fromEntries(Object.values(h).map(({id:$,name:F})=>[$,F]))}}}),D,d.jsx("div",{ref:p,style:{overflowY:"auto",opacity:l?.5:1,transition:l?"opacity 0.2s 0.2s linear":"opacity 0s 0s linear",userSelect:"none",WebkitUserSelect:"none",display:"flex",justifyContent:"center",marginLeft:"1rem",marginRight:"1rem",marginBottom:fe>0||T>0?"5rem":void 0},children:d.jsx("div",{style:{height:b.getTotalSize(),position:"relative",width:v.getTotalSize()},children:b.getVirtualItems().map($=>{const F=$.index===0||$.index===1,V=g[$.index];if(!F&&V===void 0)return null;const K=!F&&m[$.index]!==void 0?c[m[$.index]]:void 0;return d.jsxs("div",{"data-index":$.index,ref:$.index===1?E:void 0,style:{position:"absolute",top:0,left:0,transform:`translateY(${$.start-b.options.scrollMargin}px)`,display:"flex"},children:[d.jsx("div",{style:{width:`${k}px`}}),S.map(G=>{const pe=G.index===0,W=y[G.index];if($.index===0){const we=W?.[0];if(we===void 0)return d.jsx("div",{"data-index":G.index,style:{minHeight:$.size,minWidth:G.size,maxHeight:150,maxWidth:500,flexShrink:0}},G.key);if(y[G.index-1]?.[0]===we)return null;const tt=y.findLastIndex(se=>se?.[0]===we&&se?.[1]===void 0),le=Array.from(new Array(tt-G.index+1)).map((se,Q)=>G.index+Q);return d.jsx("div",{"data-index":`${G.index}-${tt}`,ref:j,className:a.length>1?k5.experimentname:void 0,style:{minHeight:$.size,minWidth:le.reduce((se,Q)=>se+(S[Q]?.size??0),0),maxHeight:150,maxWidth:500,flexShrink:0,textAlign:"center"},children:a.length>1&&d.jsxs("span",{children:[d.jsx(ml,{pb:"0.1rem",mr:"0.5rem",children:d.jsx(Hd,{})}),a[we].experiment.name]})},G.key)}const de=W!==void 0&&W[1]!==void 0?{file:a[W[0]],structureId:W[1],crosslinkIds:V?.ids[W[0]]}:void 0;return d.jsxs("div",{"data-index":G.index,ref:G.index===0?j:void 0,className:Jn(de?.crosslinkIds)?"xlink":void 0,onClick:()=>{if(de?.crosslinkIds&&de.crosslinkIds.length>0){const we=h[de.structureId];U({experiment:de.file.experiment,crosslinkIds:de.crosslinkIds,structure:we}),q.setOpen(!0)}},style:{minHeight:$.size,maxHeight:150,minWidth:G.size,maxWidth:500,flexShrink:0,...Jn(de?.crosslinkIds)?{backgroundColor:An(de.file.structureToXlinkIdToStatus[de.structureId]?.[de.crosslinkIds[0]])}:{}},children:[F&&$.index===1&&pe&&d.jsx(dy,{field:re,onFieldClick:oe,viewName:a.length===1?a[0].experiment.name??"XLinkUp":"Experiments",experiments:a.map(({experiment:we})=>we),groupedCrosslinkIds:c,exportFigureDialog:a.some(({groupedStructureIds:we})=>we.flat().length>0)?me:void 0,showingStructures:a.some(({groupedStructureIds:we})=>we.flat().length>0),disableMenus:fe!==0||T!==0}),F&&$.index===1&&!pe&&de!==void 0&&d.jsx(cM,{experimentId:de.file.experiment.id,structure:h[de.structureId],checked:C?.[de.file.experiment.id]?.has(de.structureId)??!1,onToggle:fe===0?M:void 0,onClick:()=>{z({experiment:de.file.experiment,structureId:de.structureId}),B.setOpen(!0)}}),pe&&!F&&V!==void 0&&d.jsx(sy,{rowHeader:V,groupHeader:K,field:re,checked:ae[$.index],groupedChecked:ce[$.index],toggle:T===0?xe:void 0,toggleGroup:T===0?ue:void 0}),de?.crosslinkIds&&(de.crosslinkIds.length??0)>1&&`x${de.crosslinkIds.length}`]},G.key)}),d.jsx("div",{style:{width:`${P}px`}})]},$.key)})})}),d.jsx(Ul,{open:T>0,onOpenChange:({open:$})=>$?null:O(),closeOnInteractOutside:!1,children:d.jsxs(Vl,{children:[d.jsxs(ql,{children:[De(T,"structure")," selected"]}),d.jsx(Ni,{}),d.jsxs(ke,{variant:"surface",size:"sm",disabled:A>1,onClick:()=>{const $=Object.entries(C??{}).find(([K,G])=>G&&G.size>0);if(!$||!$[1])return;const[F,V]=$;OT(F,[...V]),O()},children:[d.jsx(lM,{}),"Group"]}),d.jsx(Ni,{}),d.jsxs(Od,{placement:"center",children:[d.jsx($d,{asChild:!0,children:d.jsxs(ke,{variant:"surface",colorPalette:"red",size:"sm",children:[d.jsx(l2,{}),"Hide"]})}),d.jsxs(nn,{children:[d.jsxs(Gt,{children:[d.jsxs(Yt,{children:["Hide ",De(T,"structure"),"?"]}),d.jsx(on,{})]}),d.jsxs(wn,{children:["The structure",T!==1?"s":""," will be removed from the experiment",A!==1?"s":"",', but will still be available under the "Structures" tab.']}),d.jsxs(Xt,{children:[d.jsx(Sr,{asChild:!0,children:d.jsx(ke,{variant:"outline",children:"Cancel"})}),d.jsx(Sr,{asChild:!0,children:d.jsx(ke,{colorPalette:"red",onClick:()=>{Object.entries(C??{}).forEach(([$,F])=>{F&&Bd($,Array.from(F))}),O()},children:"Hide"})})]})]})]}),d.jsx(Wl,{})]})}),d.jsx(rv,{selectedCrosslinkIds:ge,numOfSelectedCrosslinks:fe,numOfSelectedRows:ve,clearSelectedRows:Se,saveCrosslinksTable:Le,hideCrosslinks:o})]})}),iv=_.memo(function(e){const t=te.c(6),{resetFilters:r,loading:i}=e;let s;t[0]===Symbol.for("react.memo_cache_sentinel")?(s=d.jsx(wP,{children:d.jsx(zg,{})}),t[0]=s):s=t[0];let o,a;t[1]===Symbol.for("react.memo_cache_sentinel")?(o=d.jsx(_P,{children:"No crosslinks match the current filters"}),a=d.jsx(SP,{children:"Adjust the filters or upload a new file to see crosslinks."}),t[1]=o,t[2]=a):(o=t[1],a=t[2]);let l;return t[3]!==i||t[4]!==r?(l=d.jsx(yP,{children:d.jsxs(vP,{children:[s,d.jsxs(So,{textAlign:"center",children:[o,a,d.jsx(co,{size:"sm",onClick:r,variant:"outline",loading:i,children:"Reset Filters"})]})]})}),t[3]=i,t[4]=r,t[5]=l):l=t[5],l});function sv({experiments:n,structures:e,groupDuplicates:t,resetFilters:r,hideCrosslinks:i}){const s=_.useMemo(()=>Object.fromEntries(e.map(l=>[l.id,l])),[e]),o=_.useMemo(()=>Object.fromEntries(n.flatMap(({experiment:{proteins:l}})=>l.map(c=>[c.id,c]))),[n]),a=_.useMemo(()=>qs(n.map(({experiment:{crosslinks:l},visibleCrosslinkIds:c})=>l.filter(({id:u})=>c.has(u))),o),[n,o]);return a.length===0?d.jsx(iv,{resetFilters:r,loading:!1}):d.jsx(z5,{experiments:n,groupedCrosslinkIds:a,proteinsById:o,structuresById:s,groupDuplicates:t,hideCrosslinks:i})}const ov=(n,e)=>{const t=new Set;for(const r of n){const i=xb(r,e),s=Mn(i?[i]:[],e);t.add(s)}return t.size===1&&t.has(void 0)?"unmapped":(t.delete(void 0),t.size===1?t.values().next().value??"unmapped":t.has("ok")?(Kr(t.has("under")||t.has("over")),"partially-ok"):(Kr(t.size===2&&t.has("under")&&t.has("over")),"mixed-violated"))},Jl=(n,e)=>{const t=n.map(r=>ov(r,e));return Bs(Object.entries(Object.groupBy(t,r=>r)).map(([r,i])=>[r,i.length]))};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Oo(n){return n+.5|0}const gr=(n,e,t)=>Math.max(Math.min(n,t),e);function js(n){return gr(Oo(n*2.55),0,255)}function vr(n){return gr(Oo(n*255),0,255)}function Kn(n){return gr(Oo(n/2.55)/100,0,1)}function yp(n){return gr(Oo(n*100),0,100)}const Jt={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Ru=[..."0123456789ABCDEF"],B5=n=>Ru[n&15],H5=n=>Ru[(n&240)>>4]+Ru[n&15],Qo=n=>(n&240)>>4===(n&15),V5=n=>Qo(n.r)&&Qo(n.g)&&Qo(n.b)&&Qo(n.a);function W5(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&Jt[n[1]]*17,g:255&Jt[n[2]]*17,b:255&Jt[n[3]]*17,a:e===5?Jt[n[4]]*17:255}:(e===7||e===9)&&(t={r:Jt[n[1]]<<4|Jt[n[2]],g:Jt[n[3]]<<4|Jt[n[4]],b:Jt[n[5]]<<4|Jt[n[6]],a:e===9?Jt[n[7]]<<4|Jt[n[8]]:255})),t}const U5=(n,e)=>n<255?e(n):"";function q5(n){var e=V5(n)?B5:H5;return n?"#"+e(n.r)+e(n.g)+e(n.b)+U5(n.a,e):void 0}const X5=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function av(n,e,t){const r=e*Math.min(t,1-t),i=(s,o=(s+n/30)%12)=>t-r*Math.max(Math.min(o-3,9-o,1),-1);return[i(0),i(8),i(4)]}function G5(n,e,t){const r=(i,s=(i+n/60)%6)=>t-t*e*Math.max(Math.min(s,4-s,1),0);return[r(5),r(3),r(1)]}function Y5(n,e,t){const r=av(n,1,.5);let i;for(e+t>1&&(i=1/(e+t),e*=i,t*=i),i=0;i<3;i++)r[i]*=1-e-t,r[i]+=e;return r}function K5(n,e,t,r,i){return n===i?(e-t)/r+(e<t?6:0):e===i?(t-n)/r+2:(n-e)/r+4}function lh(n){const t=n.r/255,r=n.g/255,i=n.b/255,s=Math.max(t,r,i),o=Math.min(t,r,i),a=(s+o)/2;let l,c,u;return s!==o&&(u=s-o,c=a>.5?u/(2-s-o):u/(s+o),l=K5(t,r,i,u,s),l=l*60+.5),[l|0,c||0,a]}function ch(n,e,t,r){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,r)).map(vr)}function uh(n,e,t){return ch(av,n,e,t)}function Z5(n,e,t){return ch(Y5,n,e,t)}function J5(n,e,t){return ch(G5,n,e,t)}function lv(n){return(n%360+360)%360}function Q5(n){const e=X5.exec(n);let t=255,r;if(!e)return;e[5]!==r&&(t=e[6]?js(+e[5]):vr(+e[5]));const i=lv(+e[2]),s=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?r=Z5(i,s,o):e[1]==="hsv"?r=J5(i,s,o):r=uh(i,s,o),{r:r[0],g:r[1],b:r[2],a:t}}function eO(n,e){var t=lh(n);t[0]=lv(t[0]+e),t=uh(t),n.r=t[0],n.g=t[1],n.b=t[2]}function tO(n){if(!n)return;const e=lh(n),t=e[0],r=yp(e[1]),i=yp(e[2]);return n.a<255?`hsla(${t}, ${r}%, ${i}%, ${Kn(n.a)})`:`hsl(${t}, ${r}%, ${i}%)`}const vp={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},wp={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function nO(){const n={},e=Object.keys(wp),t=Object.keys(vp);let r,i,s,o,a;for(r=0;r<e.length;r++){for(o=a=e[r],i=0;i<t.length;i++)s=t[i],a=a.replace(s,vp[s]);s=parseInt(wp[o],16),n[a]=[s>>16&255,s>>8&255,s&255]}return n}let ea;function rO(n){ea||(ea=nO(),ea.transparent=[0,0,0,0]);const e=ea[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const iO=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function sO(n){const e=iO.exec(n);let t=255,r,i,s;if(e){if(e[7]!==r){const o=+e[7];t=e[8]?js(o):gr(o*255,0,255)}return r=+e[1],i=+e[3],s=+e[5],r=255&(e[2]?js(r):gr(r,0,255)),i=255&(e[4]?js(i):gr(i,0,255)),s=255&(e[6]?js(s):gr(s,0,255)),{r,g:i,b:s,a:t}}}function oO(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${Kn(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const Oc=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,xi=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function aO(n,e,t){const r=xi(Kn(n.r)),i=xi(Kn(n.g)),s=xi(Kn(n.b));return{r:vr(Oc(r+t*(xi(Kn(e.r))-r))),g:vr(Oc(i+t*(xi(Kn(e.g))-i))),b:vr(Oc(s+t*(xi(Kn(e.b))-s))),a:n.a+t*(e.a-n.a)}}function ta(n,e,t){if(n){let r=lh(n);r[e]=Math.max(0,Math.min(r[e]+r[e]*t,e===0?360:1)),r=uh(r),n.r=r[0],n.g=r[1],n.b=r[2]}}function cv(n,e){return n&&Object.assign(e||{},n)}function _p(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=vr(n[3]))):(e=cv(n,{r:0,g:0,b:0,a:1}),e.a=vr(e.a)),e}function lO(n){return n.charAt(0)==="r"?sO(n):Q5(n)}class Qs{constructor(e){if(e instanceof Qs)return e;const t=typeof e;let r;t==="object"?r=_p(e):t==="string"&&(r=W5(e)||rO(e)||lO(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=cv(this._rgb);return e&&(e.a=Kn(e.a)),e}set rgb(e){this._rgb=_p(e)}rgbString(){return this._valid?oO(this._rgb):void 0}hexString(){return this._valid?q5(this._rgb):void 0}hslString(){return this._valid?tO(this._rgb):void 0}mix(e,t){if(e){const r=this.rgb,i=e.rgb;let s;const o=t===s?.5:t,a=2*o-1,l=r.a-i.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;s=1-c,r.r=255&c*r.r+s*i.r+.5,r.g=255&c*r.g+s*i.g+.5,r.b=255&c*r.b+s*i.b+.5,r.a=o*r.a+(1-o)*i.a,this.rgb=r}return this}interpolate(e,t){return e&&(this._rgb=aO(this._rgb,e._rgb,t)),this}clone(){return new Qs(this.rgb)}alpha(e){return this._rgb.a=vr(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=Oo(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return ta(this._rgb,2,e),this}darken(e){return ta(this._rgb,2,-e),this}saturate(e){return ta(this._rgb,1,e),this}desaturate(e){return ta(this._rgb,1,-e),this}rotate(e){return eO(this._rgb,e),this}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Un(){}const cO=(()=>{let n=0;return()=>n++})();function Ne(n){return n==null}function qe(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Ae(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function Ot(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function Cn(n,e){return Ot(n)?n:e}function Ce(n,e){return typeof n>"u"?e:n}const uO=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,uv=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function Be(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function Fe(n,e,t,r){let i,s,o;if(qe(n))for(s=n.length,i=0;i<s;i++)e.call(t,n[i],i);else if(Ae(n))for(o=Object.keys(n),s=o.length,i=0;i<s;i++)e.call(t,n[o[i]],o[i])}function Qa(n,e){let t,r,i,s;if(!n||!e||n.length!==e.length)return!1;for(t=0,r=n.length;t<r;++t)if(i=n[t],s=e[t],i.datasetIndex!==s.datasetIndex||i.index!==s.index)return!1;return!0}function el(n){if(qe(n))return n.map(el);if(Ae(n)){const e=Object.create(null),t=Object.keys(n),r=t.length;let i=0;for(;i<r;++i)e[t[i]]=el(n[t[i]]);return e}return n}function dv(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function dO(n,e,t,r){if(!dv(n))return;const i=e[n],s=t[n];Ae(i)&&Ae(s)?eo(i,s,r):e[n]=el(s)}function eo(n,e,t){const r=qe(e)?e:[e],i=r.length;if(!Ae(n))return n;t=t||{};const s=t.merger||dO;let o;for(let a=0;a<i;++a){if(o=r[a],!Ae(o))continue;const l=Object.keys(o);for(let c=0,u=l.length;c<u;++c)s(l[c],n,o,t)}return n}function $s(n,e){return eo(n,e,{merger:hO})}function hO(n,e,t){if(!dv(n))return;const r=e[n],i=t[n];Ae(r)&&Ae(i)?$s(r,i):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=el(i))}const Sp={"":n=>n,x:n=>n.x,y:n=>n.y};function fO(n){const e=n.split("."),t=[];let r="";for(const i of e)r+=i,r.endsWith("\\")?r=r.slice(0,-1)+".":(t.push(r),r="");return t}function pO(n){const e=fO(n);return t=>{for(const r of e){if(r==="")break;t=t&&t[r]}return t}}function ri(n,e){return(Sp[e]||(Sp[e]=pO(e)))(n)}function dh(n){return n.charAt(0).toUpperCase()+n.slice(1)}const $t=n=>typeof n<"u",Rt=n=>typeof n=="function",Pp=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function mO(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const ze=Math.PI,ut=2*ze,gO=ut+ze,tl=Number.POSITIVE_INFINITY,hh=ze/180,dt=ze/2,Qt=ze/4,nl=ze*2/3,hv=Math.log10,$n=Math.sign;function Ds(n,e,t){return Math.abs(n-e)<t}function Cp(n){const e=Math.round(n);n=Ds(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(hv(n))),r=n/t;return(r<=1?1:r<=2?2:r<=5?5:10)*t}function xO(n){const e=[],t=Math.sqrt(n);let r;for(r=1;r<t;r++)n%r===0&&(e.push(r),e.push(n/r));return t===(t|0)&&e.push(t),e.sort((i,s)=>i-s).pop(),e}function bO(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function ii(n){return!bO(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function yO(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function vO(n,e,t){let r,i,s;for(r=0,i=n.length;r<i;r++)s=n[r][t],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function st(n){return n*(ze/180)}function fv(n){return n*(180/ze)}function kp(n){if(!Ot(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function Ou(n,e){const t=e.x-n.x,r=e.y-n.y,i=Math.sqrt(t*t+r*r);let s=Math.atan2(r,t);return s<-.5*ze&&(s+=ut),{angle:s,distance:i}}function Hi(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function wO(n,e){return(n-e+gO)%ut-ze}function lr(n){return(n%ut+ut)%ut}function rl(n,e,t,r){const i=lr(n),s=lr(e),o=lr(t),a=lr(s-i),l=lr(o-i),c=lr(i-s),u=lr(i-o);return i===s||i===o||r&&s===o||a>l&&c<u}function Bt(n,e,t){return Math.max(e,Math.min(t,n))}function _O(n){return Bt(n,-32768,32767)}function Br(n,e,t,r=1e-6){return n>=Math.min(e,t)-r&&n<=Math.max(e,t)+r}function fh(n,e,t){t=t||(o=>n[o]<e);let r=n.length-1,i=0,s;for(;r-i>1;)s=i+r>>1,t(s)?i=s:r=s;return{lo:i,hi:r}}const Hr=(n,e,t,r)=>fh(n,t,r?i=>{const s=n[i][e];return s<t||s===t&&n[i+1][e]===t}:i=>n[i][e]<t),SO=(n,e,t)=>fh(n,t,r=>n[r][e]>=t);function PO(n,e,t){let r=0,i=n.length;for(;r<i&&n[r]<e;)r++;for(;i>r&&n[i-1]>t;)i--;return r>0||i<n.length?n.slice(r,i):n}const pv=["push","pop","shift","splice","unshift"];function CO(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),pv.forEach(t=>{const r="_onData"+dh(t),i=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...s){const o=i.apply(this,s);return n._chartjs.listeners.forEach(a=>{typeof a[r]=="function"&&a[r](...s)}),o}})})}function jp(n,e){const t=n._chartjs;if(!t)return;const r=t.listeners,i=r.indexOf(e);i!==-1&&r.splice(i,1),!(r.length>0)&&(pv.forEach(s=>{delete n[s]}),delete n._chartjs)}function mv(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const gv=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function xv(n,e){let t=[],r=!1;return function(...i){t=i,r||(r=!0,gv.call(window,()=>{r=!1,n.apply(e,t)}))}}function kO(n,e){let t;return function(...r){return e?(clearTimeout(t),t=setTimeout(n,e,r)):n.apply(this,r),e}}const bv=n=>n==="start"?"left":n==="end"?"right":"center",Ft=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,jO=(n,e,t,r)=>n===(r?"left":"right")?t:n==="center"?(e+t)/2:e;function TO(n,e,t){const r=e.length;let i=0,s=r;if(n._sorted){const{iScale:o,vScale:a,_parsed:l}=n,c=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,u=o.axis,{min:h,max:f,minDefined:p,maxDefined:m}=o.getUserBounds();if(p){if(i=Math.min(Hr(l,u,h).lo,t?r:Hr(e,u,o.getPixelForValue(h)).lo),c){const g=l.slice(0,i+1).reverse().findIndex(x=>!Ne(x[a.axis]));i-=Math.max(0,g)}i=Bt(i,0,r-1)}if(m){let g=Math.max(Hr(l,o.axis,f,!0).hi+1,t?0:Hr(e,u,o.getPixelForValue(f),!0).hi+1);if(c){const x=l.slice(g-1).findIndex(b=>!Ne(b[a.axis]));g+=Math.max(0,x)}s=Bt(g,i,r)-i}else s=r-i}return{start:i,count:s}}function MO(n){const{xScale:e,yScale:t,_scaleRanges:r}=n,i={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!r)return n._scaleRanges=i,!0;const s=r.xmin!==e.min||r.xmax!==e.max||r.ymin!==t.min||r.ymax!==t.max;return Object.assign(r,i),s}const na=n=>n===0||n===1,Tp=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*ut/t)),Mp=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*ut/t)+1,Ns={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*dt)+1,easeOutSine:n=>Math.sin(n*dt),easeInOutSine:n=>-.5*(Math.cos(ze*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>na(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>na(n)?n:Tp(n,.075,.3),easeOutElastic:n=>na(n)?n:Mp(n,.075,.3),easeInOutElastic(n){return na(n)?n:n<.5?.5*Tp(n*2,.1125,.45):.5+.5*Mp(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-Ns.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Ns.easeInBounce(n*2)*.5:Ns.easeOutBounce(n*2-1)*.5+.5};function ph(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function Ap(n){return ph(n)?n:new Qs(n)}function $c(n){return ph(n)?n:new Qs(n).saturate(.5).darken(.1).hexString()}const AO=["x","y","borderWidth","radius","tension"],EO=["color","borderColor","backgroundColor"];function IO(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:EO},numbers:{type:"number",properties:AO}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function RO(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const Ep=new Map;function OO(n,e){e=e||{};const t=n+JSON.stringify(e);let r=Ep.get(t);return r||(r=new Intl.NumberFormat(n,e),Ep.set(t,r)),r}function mh(n,e,t){return OO(e,t).format(n)}const $O={values(n){return qe(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const r=this.chart.options.locale;let i,s=n;if(t.length>1){const c=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(c<1e-4||c>1e15)&&(i="scientific"),s=DO(n,t)}const o=hv(Math.abs(s)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),l={notation:i,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),mh(n,r,l)}};function DO(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var yv={formatters:$O};function NO(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:yv.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const si=Object.create(null),$u=Object.create(null);function Ls(n,e){if(!e)return n;const t=e.split(".");for(let r=0,i=t.length;r<i;++r){const s=t[r];n=n[s]||(n[s]=Object.create(null))}return n}function Dc(n,e,t){return typeof e=="string"?eo(Ls(n,e),t):eo(Ls(n,""),e)}class LO{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,i)=>$c(i.backgroundColor),this.hoverBorderColor=(r,i)=>$c(i.borderColor),this.hoverColor=(r,i)=>$c(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return Dc(this,e,t)}get(e){return Ls(this,e)}describe(e,t){return Dc($u,e,t)}override(e,t){return Dc(si,e,t)}route(e,t,r,i){const s=Ls(this,e),o=Ls(this,r),a="_"+t;Object.defineProperties(s,{[a]:{value:s[t],writable:!0},[t]:{enumerable:!0,get(){const l=this[a],c=o[i];return Ae(l)?Object.assign({},c,l):Ce(l,c)},set(l){this[a]=l}}})}apply(e){e.forEach(t=>t(this))}}var Ze=new LO({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[IO,RO,NO]);function FO(n){return!n||Ne(n.size)||Ne(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function Ip(n,e,t,r,i){let s=e[i];return s||(s=e[i]=n.measureText(i).width,t.push(i)),s>r&&(r=s),r}function Ar(n,e,t){const r=n.currentDevicePixelRatio,i=t!==0?Math.max(t/2,.5):0;return Math.round((e-i)*r)/r+i}function Rp(n,e){!e&&!n||(e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore())}function Du(n,e,t,r){vv(n,e,t,r,null)}function vv(n,e,t,r,i){let s,o,a,l,c,u,h,f;const p=e.pointStyle,m=e.rotation,g=e.radius;let x=(m||0)*hh;if(p&&typeof p=="object"&&(s=p.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){n.save(),n.translate(t,r),n.rotate(x),n.drawImage(p,-p.width/2,-p.height/2,p.width,p.height),n.restore();return}if(!(isNaN(g)||g<=0)){switch(n.beginPath(),p){default:i?n.ellipse(t,r,i/2,g,0,0,ut):n.arc(t,r,g,0,ut),n.closePath();break;case"triangle":u=i?i/2:g,n.moveTo(t+Math.sin(x)*u,r-Math.cos(x)*g),x+=nl,n.lineTo(t+Math.sin(x)*u,r-Math.cos(x)*g),x+=nl,n.lineTo(t+Math.sin(x)*u,r-Math.cos(x)*g),n.closePath();break;case"rectRounded":c=g*.516,l=g-c,o=Math.cos(x+Qt)*l,h=Math.cos(x+Qt)*(i?i/2-c:l),a=Math.sin(x+Qt)*l,f=Math.sin(x+Qt)*(i?i/2-c:l),n.arc(t-h,r-a,c,x-ze,x-dt),n.arc(t+f,r-o,c,x-dt,x),n.arc(t+h,r+a,c,x,x+dt),n.arc(t-f,r+o,c,x+dt,x+ze),n.closePath();break;case"rect":if(!m){l=Math.SQRT1_2*g,u=i?i/2:l,n.rect(t-u,r-l,2*u,2*l);break}x+=Qt;case"rectRot":h=Math.cos(x)*(i?i/2:g),o=Math.cos(x)*g,a=Math.sin(x)*g,f=Math.sin(x)*(i?i/2:g),n.moveTo(t-h,r-a),n.lineTo(t+f,r-o),n.lineTo(t+h,r+a),n.lineTo(t-f,r+o),n.closePath();break;case"crossRot":x+=Qt;case"cross":h=Math.cos(x)*(i?i/2:g),o=Math.cos(x)*g,a=Math.sin(x)*g,f=Math.sin(x)*(i?i/2:g),n.moveTo(t-h,r-a),n.lineTo(t+h,r+a),n.moveTo(t+f,r-o),n.lineTo(t-f,r+o);break;case"star":h=Math.cos(x)*(i?i/2:g),o=Math.cos(x)*g,a=Math.sin(x)*g,f=Math.sin(x)*(i?i/2:g),n.moveTo(t-h,r-a),n.lineTo(t+h,r+a),n.moveTo(t+f,r-o),n.lineTo(t-f,r+o),x+=Qt,h=Math.cos(x)*(i?i/2:g),o=Math.cos(x)*g,a=Math.sin(x)*g,f=Math.sin(x)*(i?i/2:g),n.moveTo(t-h,r-a),n.lineTo(t+h,r+a),n.moveTo(t+f,r-o),n.lineTo(t-f,r+o);break;case"line":o=i?i/2:Math.cos(x)*g,a=Math.sin(x)*g,n.moveTo(t-o,r-a),n.lineTo(t+o,r+a);break;case"dash":n.moveTo(t,r),n.lineTo(t+Math.cos(x)*(i?i/2:g),r+Math.sin(x)*g);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function to(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function Ql(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function ec(n){n.restore()}function zO(n,e,t,r,i){if(!e)return n.lineTo(t.x,t.y);if(i==="middle"){const s=(e.x+t.x)/2;n.lineTo(s,e.y),n.lineTo(s,t.y)}else i==="after"!=!!r?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function BO(n,e,t,r){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(r?e.cp1x:e.cp2x,r?e.cp1y:e.cp2y,r?t.cp2x:t.cp1x,r?t.cp2y:t.cp1y,t.x,t.y)}function HO(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),Ne(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function VO(n,e,t,r,i){if(i.strikethrough||i.underline){const s=n.measureText(r),o=e-s.actualBoundingBoxLeft,a=e+s.actualBoundingBoxRight,l=t-s.actualBoundingBoxAscent,c=t+s.actualBoundingBoxDescent,u=i.strikethrough?(l+c)/2:c;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=i.decorationWidth||2,n.moveTo(o,u),n.lineTo(a,u),n.stroke()}}function WO(n,e){const t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function il(n,e,t,r,i,s={}){const o=qe(e)?e:[e],a=s.strokeWidth>0&&s.strokeColor!=="";let l,c;for(n.save(),n.font=i.string,HO(n,s),l=0;l<o.length;++l)c=o[l],s.backdrop&&WO(n,s.backdrop),a&&(s.strokeColor&&(n.strokeStyle=s.strokeColor),Ne(s.strokeWidth)||(n.lineWidth=s.strokeWidth),n.strokeText(c,t,r,s.maxWidth)),n.fillText(c,t,r,s.maxWidth),VO(n,t,r,c,s),r+=Number(i.lineHeight);n.restore()}function no(n,e){const{x:t,y:r,w:i,h:s,radius:o}=e;n.arc(t+o.topLeft,r+o.topLeft,o.topLeft,1.5*ze,ze,!0),n.lineTo(t,r+s-o.bottomLeft),n.arc(t+o.bottomLeft,r+s-o.bottomLeft,o.bottomLeft,ze,dt,!0),n.lineTo(t+i-o.bottomRight,r+s),n.arc(t+i-o.bottomRight,r+s-o.bottomRight,o.bottomRight,dt,0,!0),n.lineTo(t+i,r+o.topRight),n.arc(t+i-o.topRight,r+o.topRight,o.topRight,0,-dt,!0),n.lineTo(t+o.topLeft,r)}const UO=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,qO=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function XO(n,e){const t=(""+n).match(UO);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const GO=n=>+n||0;function wv(n,e){const t={},r=Ae(e),i=r?Object.keys(e):e,s=Ae(n)?r?o=>Ce(n[o],n[e[o]]):o=>n[o]:()=>n;for(const o of i)t[o]=GO(s(o));return t}function _v(n){return wv(n,{top:"y",right:"x",bottom:"y",left:"x"})}function Gr(n){return wv(n,["topLeft","topRight","bottomLeft","bottomRight"])}function wt(n){const e=_v(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function ht(n,e){n=n||{},e=e||Ze.font;let t=Ce(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let r=Ce(n.style,e.style);r&&!(""+r).match(qO)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const i={family:Ce(n.family,e.family),lineHeight:XO(Ce(n.lineHeight,e.lineHeight),t),size:t,style:r,weight:Ce(n.weight,e.weight),string:""};return i.string=FO(i),i}function ra(n,e,t,r){let i,s,o;for(i=0,s=n.length;i<s;++i)if(o=n[i],o!==void 0&&o!==void 0)return o}function YO(n,e,t){const{min:r,max:i}=n,s=uv(e,(i-r)/2),o=(a,l)=>t&&a===0?0:a+l;return{min:o(r,-Math.abs(s)),max:o(i,s)}}function ui(n,e){return Object.assign(Object.create(n),e)}function gh(n,e=[""],t,r,i=()=>n[0]){const s=t||n;typeof r>"u"&&(r=kv("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:s,_fallback:r,_getTarget:i,override:a=>gh([a,...n],e,s,r)};return new Proxy(o,{deleteProperty(a,l){return delete a[l],delete a._keys,delete n[0][l],!0},get(a,l){return Pv(a,l,()=>r4(l,e,n,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(a,l){return $p(a).includes(l)},ownKeys(a){return $p(a)},set(a,l,c){const u=a._storage||(a._storage=i());return a[l]=u[l]=c,delete a._keys,!0}})}function Vi(n,e,t,r){const i={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:Sv(n,r),setContext:s=>Vi(n,s,t,r),override:s=>Vi(n.override(s),e,t,r)};return new Proxy(i,{deleteProperty(s,o){return delete s[o],delete n[o],!0},get(s,o,a){return Pv(s,o,()=>ZO(s,o,a))},getOwnPropertyDescriptor(s,o){return s._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(s,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(s,o,a){return n[o]=a,delete s[o],!0}})}function Sv(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:r=e.indexable,_allKeys:i=e.allKeys}=n;return{allKeys:i,scriptable:t,indexable:r,isScriptable:Rt(t)?t:()=>t,isIndexable:Rt(r)?r:()=>r}}const KO=(n,e)=>n?n+dh(e):e,xh=(n,e)=>Ae(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function Pv(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e)||e==="constructor")return n[e];const r=t();return n[e]=r,r}function ZO(n,e,t){const{_proxy:r,_context:i,_subProxy:s,_descriptors:o}=n;let a=r[e];return Rt(a)&&o.isScriptable(e)&&(a=JO(e,a,n,t)),qe(a)&&a.length&&(a=QO(e,a,n,o.isIndexable)),xh(e,a)&&(a=Vi(a,i,s&&s[e],o)),a}function JO(n,e,t,r){const{_proxy:i,_context:s,_subProxy:o,_stack:a}=t;if(a.has(n))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+n);a.add(n);let l=e(s,o||r);return a.delete(n),xh(n,l)&&(l=bh(i._scopes,i,n,l)),l}function QO(n,e,t,r){const{_proxy:i,_context:s,_subProxy:o,_descriptors:a}=t;if(typeof s.index<"u"&&r(n))return e[s.index%e.length];if(Ae(e[0])){const l=e,c=i._scopes.filter(u=>u!==l);e=[];for(const u of l){const h=bh(c,i,n,u);e.push(Vi(h,s,o&&o[n],a))}}return e}function Cv(n,e,t){return Rt(n)?n(e,t):n}const e4=(n,e)=>n===!0?e:typeof n=="string"?ri(e,n):void 0;function t4(n,e,t,r,i){for(const s of e){const o=e4(t,s);if(o){n.add(o);const a=Cv(o._fallback,t,i);if(typeof a<"u"&&a!==t&&a!==r)return a}else if(o===!1&&typeof r<"u"&&t!==r)return null}return!1}function bh(n,e,t,r){const i=e._rootScopes,s=Cv(e._fallback,t,r),o=[...n,...i],a=new Set;a.add(r);let l=Op(a,o,t,s||t,r);return l===null||typeof s<"u"&&s!==t&&(l=Op(a,o,s,l,r),l===null)?!1:gh(Array.from(a),[""],i,s,()=>n4(e,t,r))}function Op(n,e,t,r,i){for(;t;)t=t4(n,e,t,r,i);return t}function n4(n,e,t){const r=n._getTarget();e in r||(r[e]={});const i=r[e];return qe(i)&&Ae(t)?t:i||{}}function r4(n,e,t,r){let i;for(const s of e)if(i=kv(KO(s,n),t),typeof i<"u")return xh(n,i)?bh(t,r,n,i):i}function kv(n,e){for(const t of e){if(!t)continue;const r=t[n];if(typeof r<"u")return r}}function $p(n){let e=n._keys;return e||(e=n._keys=i4(n._scopes)),e}function i4(n){const e=new Set;for(const t of n)for(const r of Object.keys(t).filter(i=>!i.startsWith("_")))e.add(r);return Array.from(e)}const s4=Number.EPSILON||1e-14,Wi=(n,e)=>e<n.length&&!n[e].skip&&n[e],jv=n=>n==="x"?"y":"x";function o4(n,e,t,r){const i=n.skip?e:n,s=e,o=t.skip?e:t,a=Hi(s,i),l=Hi(o,s);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const h=r*c,f=r*u;return{previous:{x:s.x-h*(o.x-i.x),y:s.y-h*(o.y-i.y)},next:{x:s.x+f*(o.x-i.x),y:s.y+f*(o.y-i.y)}}}function a4(n,e,t){const r=n.length;let i,s,o,a,l,c=Wi(n,0);for(let u=0;u<r-1;++u)if(l=c,c=Wi(n,u+1),!(!l||!c)){if(Ds(e[u],0,s4)){t[u]=t[u+1]=0;continue}i=t[u]/e[u],s=t[u+1]/e[u],a=Math.pow(i,2)+Math.pow(s,2),!(a<=9)&&(o=3/Math.sqrt(a),t[u]=i*o*e[u],t[u+1]=s*o*e[u])}}function l4(n,e,t="x"){const r=jv(t),i=n.length;let s,o,a,l=Wi(n,0);for(let c=0;c<i;++c){if(o=a,a=l,l=Wi(n,c+1),!a)continue;const u=a[t],h=a[r];o&&(s=(u-o[t])/3,a[`cp1${t}`]=u-s,a[`cp1${r}`]=h-s*e[c]),l&&(s=(l[t]-u)/3,a[`cp2${t}`]=u+s,a[`cp2${r}`]=h+s*e[c])}}function c4(n,e="x"){const t=jv(e),r=n.length,i=Array(r).fill(0),s=Array(r);let o,a,l,c=Wi(n,0);for(o=0;o<r;++o)if(a=l,l=c,c=Wi(n,o+1),!!l){if(c){const u=c[e]-l[e];i[o]=u!==0?(c[t]-l[t])/u:0}s[o]=a?c?$n(i[o-1])!==$n(i[o])?0:(i[o-1]+i[o])/2:i[o-1]:i[o]}a4(n,i,s),l4(n,s,e)}function ia(n,e,t){return Math.max(Math.min(n,t),e)}function u4(n,e){let t,r,i,s,o,a=to(n[0],e);for(t=0,r=n.length;t<r;++t)o=s,s=a,a=t<r-1&&to(n[t+1],e),s&&(i=n[t],o&&(i.cp1x=ia(i.cp1x,e.left,e.right),i.cp1y=ia(i.cp1y,e.top,e.bottom)),a&&(i.cp2x=ia(i.cp2x,e.left,e.right),i.cp2y=ia(i.cp2y,e.top,e.bottom)))}function d4(n,e,t,r,i){let s,o,a,l;if(e.spanGaps&&(n=n.filter(c=>!c.skip)),e.cubicInterpolationMode==="monotone")c4(n,i);else{let c=r?n[n.length-1]:n[0];for(s=0,o=n.length;s<o;++s)a=n[s],l=o4(c,a,n[Math.min(s+1,o-(r?0:1))%o],e.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}e.capBezierPoints&&u4(n,t)}function yh(){return typeof window<"u"&&typeof document<"u"}function vh(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function sl(n,e,t){let r;return typeof n=="string"?(r=parseInt(n,10),n.indexOf("%")!==-1&&(r=r/100*e.parentNode[t])):r=n,r}const tc=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function h4(n,e){return tc(n).getPropertyValue(e)}const f4=["top","right","bottom","left"];function Yr(n,e,t){const r={};t=t?"-"+t:"";for(let i=0;i<4;i++){const s=f4[i];r[s]=parseFloat(n[e+"-"+s+t])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const p4=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function m4(n,e){const t=n.touches,r=t&&t.length?t[0]:n,{offsetX:i,offsetY:s}=r;let o=!1,a,l;if(p4(i,s,n.target))a=i,l=s;else{const c=e.getBoundingClientRect();a=r.clientX-c.left,l=r.clientY-c.top,o=!0}return{x:a,y:l,box:o}}function Or(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:r}=e,i=tc(t),s=i.boxSizing==="border-box",o=Yr(i,"padding"),a=Yr(i,"border","width"),{x:l,y:c,box:u}=m4(n,t),h=o.left+(u&&a.left),f=o.top+(u&&a.top);let{width:p,height:m}=e;return s&&(p-=o.width+a.width,m-=o.height+a.height),{x:Math.round((l-h)/p*t.width/r),y:Math.round((c-f)/m*t.height/r)}}function g4(n,e,t){let r,i;if(e===void 0||t===void 0){const s=n&&vh(n);if(!s)e=n.clientWidth,t=n.clientHeight;else{const o=s.getBoundingClientRect(),a=tc(s),l=Yr(a,"border","width"),c=Yr(a,"padding");e=o.width-c.width-l.width,t=o.height-c.height-l.height,r=sl(a.maxWidth,s,"clientWidth"),i=sl(a.maxHeight,s,"clientHeight")}}return{width:e,height:t,maxWidth:r||tl,maxHeight:i||tl}}const sa=n=>Math.round(n*10)/10;function x4(n,e,t,r){const i=tc(n),s=Yr(i,"margin"),o=sl(i.maxWidth,n,"clientWidth")||tl,a=sl(i.maxHeight,n,"clientHeight")||tl,l=g4(n,e,t);let{width:c,height:u}=l;if(i.boxSizing==="content-box"){const f=Yr(i,"border","width"),p=Yr(i,"padding");c-=p.width+f.width,u-=p.height+f.height}return c=Math.max(0,c-s.width),u=Math.max(0,r?c/r:u-s.height),c=sa(Math.min(c,o,l.maxWidth)),u=sa(Math.min(u,a,l.maxHeight)),c&&!u&&(u=sa(c/2)),(e!==void 0||t!==void 0)&&r&&l.height&&u>l.height&&(u=l.height,c=sa(Math.floor(u*r))),{width:c,height:u}}function Dp(n,e,t){const r=e||1,i=Math.floor(n.height*r),s=Math.floor(n.width*r);n.height=Math.floor(n.height),n.width=Math.floor(n.width);const o=n.canvas;return o.style&&(t||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==r||o.height!==i||o.width!==s?(n.currentDevicePixelRatio=r,o.height=i,o.width=s,n.ctx.setTransform(r,0,0,r,0,0),!0):!1}const b4=function(){let n=!1;try{const e={get passive(){return n=!0,!1}};yh()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return n}();function Np(n,e){const t=h4(n,e),r=t&&t.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function $r(n,e,t,r){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function y4(n,e,t,r){return{x:n.x+t*(e.x-n.x),y:r==="middle"?t<.5?n.y:e.y:r==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function v4(n,e,t,r){const i={x:n.cp2x,y:n.cp2y},s={x:e.cp1x,y:e.cp1y},o=$r(n,i,t),a=$r(i,s,t),l=$r(s,e,t),c=$r(o,a,t),u=$r(a,l,t);return $r(c,u,t)}const w4=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,r){return t-r},leftForLtr(t,r){return t-r}}},_4=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function Oi(n,e,t){return n?w4(e,t):_4()}function Tv(n,e){let t,r;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,r=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=r)}function Mv(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function Av(n){return n==="angle"?{between:rl,compare:wO,normalize:lr}:{between:Br,compare:(e,t)=>e-t,normalize:e=>e}}function Lp({start:n,end:e,count:t,loop:r,style:i}){return{start:n%t,end:e%t,loop:r&&(e-n+1)%t===0,style:i}}function S4(n,e,t){const{property:r,start:i,end:s}=t,{between:o,normalize:a}=Av(r),l=e.length;let{start:c,end:u,loop:h}=n,f,p;if(h){for(c+=l,u+=l,f=0,p=l;f<p&&o(a(e[c%l][r]),i,s);++f)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:h,style:n.style}}function P4(n,e,t){if(!t)return[n];const{property:r,start:i,end:s}=t,o=e.length,{compare:a,between:l,normalize:c}=Av(r),{start:u,end:h,loop:f,style:p}=S4(n,e,t),m=[];let g=!1,x=null,b,y,w;const v=()=>l(i,w,b)&&a(i,w)!==0,S=()=>a(s,b)===0||l(s,w,b),k=()=>g||v(),P=()=>!g||S();for(let C=u,T=u;C<=h;++C)y=e[C%o],!y.skip&&(b=c(y[r]),b!==w&&(g=l(b,i,s),x===null&&k()&&(x=a(b,i)===0?C:T),x!==null&&P()&&(m.push(Lp({start:x,end:C,loop:f,count:o,style:p})),x=null),T=C,w=b));return x!==null&&m.push(Lp({start:x,end:h,loop:f,count:o,style:p})),m}function C4(n,e){const t=[],r=n.segments;for(let i=0;i<r.length;i++){const s=P4(r[i],n.points,e);s.length&&t.push(...s)}return t}function k4(n,e,t,r){let i=0,s=e-1;if(t&&!r)for(;i<e&&!n[i].skip;)i++;for(;i<e&&n[i].skip;)i++;for(i%=e,t&&(s+=i);s>i&&n[s%e].skip;)s--;return s%=e,{start:i,end:s}}function j4(n,e,t,r){const i=n.length,s=[];let o=e,a=n[e],l;for(l=e+1;l<=t;++l){const c=n[l%i];c.skip||c.stop?a.skip||(r=!1,s.push({start:e%i,end:(l-1)%i,loop:r}),e=o=c.stop?l:null):(o=l,a.skip&&(e=l)),a=c}return o!==null&&s.push({start:e%i,end:o%i,loop:r}),s}function T4(n,e){const t=n.points,r=n.options.spanGaps,i=t.length;if(!i)return[];const s=!!n._loop,{start:o,end:a}=k4(t,i,s,r);if(r===!0)return Fp(n,[{start:o,end:a,loop:s}],t,e);const l=a<o?a+i:a,c=!!n._fullLoop&&o===0&&a===i-1;return Fp(n,j4(t,o,l,c),t,e)}function Fp(n,e,t,r){return!r||!r.setContext||!t?e:M4(n,e,t,r)}function M4(n,e,t,r){const i=n._chart.getContext(),s=zp(n.options),{_datasetIndex:o,options:{spanGaps:a}}=n,l=t.length,c=[];let u=s,h=e[0].start,f=h;function p(m,g,x,b){const y=a?-1:1;if(m!==g){for(m+=l;t[m%l].skip;)m-=y;for(;t[g%l].skip;)g+=y;m%l!==g%l&&(c.push({start:m%l,end:g%l,loop:x,style:b}),u=b,h=g%l)}}for(const m of e){h=a?h:m.start;let g=t[h%l],x;for(f=h+1;f<=m.end;f++){const b=t[f%l];x=zp(r.setContext(ui(i,{type:"segment",p0:g,p1:b,p0DataIndex:(f-1)%l,p1DataIndex:f%l,datasetIndex:o}))),A4(x,u)&&p(h,f-1,m.loop,u),g=b,u=x}h<f-1&&p(h,f-1,m.loop,u)}return c}function zp(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function A4(n,e){if(!e)return!1;const t=[],r=function(i,s){return ph(s)?(t.includes(s)||t.push(s),t.indexOf(s)):s};return JSON.stringify(n,r)!==JSON.stringify(e,r)}function oa(n,e,t){return n.options.clip?n[t]:e[t]}function E4(n,e){const{xScale:t,yScale:r}=n;return t&&r?{left:oa(t,e,"left"),right:oa(t,e,"right"),top:oa(r,e,"top"),bottom:oa(r,e,"bottom")}:e}function I4(n,e){const t=e._clip;if(t.disabled)return!1;const r=E4(e,n.chartArea);return{left:t.left===!1?0:r.left-(t.left===!0?0:t.left),right:t.right===!1?n.width:r.right+(t.right===!0?0:t.right),top:t.top===!1?0:r.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?n.height:r.bottom+(t.bottom===!0?0:t.bottom)}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class R4{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,r,i){const s=t.listeners[i],o=t.duration;s.forEach(a=>a({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(r-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=gv.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((r,i)=>{if(!r.running||!r.items.length)return;const s=r.items;let o=s.length-1,a=!1,l;for(;o>=0;--o)l=s[o],l._active?(l._total>r.duration&&(r.duration=l._total),l.tick(e),a=!0):(s[o]=s[s.length-1],s.pop());a&&(i.draw(),this._notify(i,r,e,"progress")),s.length||(r.running=!1,this._notify(i,r,e,"complete"),r.initial=!1),t+=s.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let r=t.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,r)),r}listen(e,t,r){this._getAnims(e).listeners[t].push(r)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((r,i)=>Math.max(r,i._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const r=t.items;let i=r.length-1;for(;i>=0;--i)r[i].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Xn=new R4;const Bp="transparent",O4={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const r=Ap(n||Bp),i=r.valid&&Ap(e||Bp);return i&&i.valid?i.mix(r,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class $4{constructor(e,t,r,i){const s=t[r];i=ra([e.to,i,s,e.from]);const o=ra([e.from,s,i]);this._active=!0,this._fn=e.fn||O4[e.type||typeof o],this._easing=Ns[e.easing]||Ns.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=r,this._from=o,this._to=i,this._promises=void 0}active(){return this._active}update(e,t,r){if(this._active){this._notify(!1);const i=this._target[this._prop],s=r-this._start,o=this._duration-s;this._start=r,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=ra([e.to,t,i,e.from]),this._from=ra([e.from,i,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,r=this._duration,i=this._prop,s=this._from,o=this._loop,a=this._to;let l;if(this._active=s!==a&&(o||t<r),!this._active){this._target[i]=a,this._notify(!0);return}if(t<0){this._target[i]=s;return}l=t/r%2,l=o&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[i]=this._fn(s,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,r)=>{e.push({res:t,rej:r})})}_notify(e){const t=e?"res":"rej",r=this._promises||[];for(let i=0;i<r.length;i++)r[i][t]()}}class wh{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!Ae(e))return;const t=Object.keys(Ze.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const s=e[i];if(!Ae(s))return;const o={};for(const a of t)o[a]=s[a];(qe(s.properties)&&s.properties||[i]).forEach(a=>{(a===i||!r.has(a))&&r.set(a,o)})})}_animateOptions(e,t){const r=t.options,i=N4(e,r);if(!i)return[];const s=this._createAnimations(i,r);return r.$shared&&D4(e.options.$animations,r).then(()=>{e.options=r},()=>{}),s}_createAnimations(e,t){const r=this._properties,i=[],s=e.$animations||(e.$animations={}),o=Object.keys(t),a=Date.now();let l;for(l=o.length-1;l>=0;--l){const c=o[l];if(c.charAt(0)==="$")continue;if(c==="options"){i.push(...this._animateOptions(e,t));continue}const u=t[c];let h=s[c];const f=r.get(c);if(h)if(f&&h.active()){h.update(f,u,a);continue}else h.cancel();if(!f||!f.duration){e[c]=u;continue}s[c]=h=new $4(f,e,c,u),i.push(h)}return i}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const r=this._createAnimations(e,t);if(r.length)return Xn.add(this._chart,r),!0}}function D4(n,e){const t=[],r=Object.keys(e);for(let i=0;i<r.length;i++){const s=n[r[i]];s&&s.active()&&t.push(s.wait())}return Promise.all(t)}function N4(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function Hp(n,e){const t=n&&n.options||{},r=t.reverse,i=t.min===void 0?e:0,s=t.max===void 0?e:0;return{start:r?s:i,end:r?i:s}}function L4(n,e,t){if(t===!1)return!1;const r=Hp(n,t),i=Hp(e,t);return{top:i.end,right:r.end,bottom:i.start,left:r.start}}function F4(n){let e,t,r,i;return Ae(n)?(e=n.top,t=n.right,r=n.bottom,i=n.left):e=t=r=i=n,{top:e,right:t,bottom:r,left:i,disabled:n===!1}}function Ev(n,e){const t=[],r=n._getSortedDatasetMetas(e);let i,s;for(i=0,s=r.length;i<s;++i)t.push(r[i].index);return t}function Vp(n,e,t,r={}){const i=n.keys,s=r.mode==="single";let o,a,l,c;if(e===null)return;let u=!1;for(o=0,a=i.length;o<a;++o){if(l=+i[o],l===t){if(u=!0,r.all)continue;break}c=n.values[l],Ot(c)&&(s||e===0||$n(e)===$n(c))&&(e+=c)}return!u&&!r.all?0:e}function z4(n,e){const{iScale:t,vScale:r}=e,i=t.axis==="x"?"x":"y",s=r.axis==="x"?"x":"y",o=Object.keys(n),a=new Array(o.length);let l,c,u;for(l=0,c=o.length;l<c;++l)u=o[l],a[l]={[i]:u,[s]:n[u]};return a}function Nc(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function B4(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function H4(n){const{min:e,max:t,minDefined:r,maxDefined:i}=n.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:i?t:Number.POSITIVE_INFINITY}}function V4(n,e,t){const r=n[e]||(n[e]={});return r[t]||(r[t]={})}function Wp(n,e,t,r){for(const i of e.getMatchingVisibleMetas(r).reverse()){const s=n[i.index];if(t&&s>0||!t&&s<0)return i.index}return null}function Up(n,e){const{chart:t,_cachedMeta:r}=n,i=t._stacks||(t._stacks={}),{iScale:s,vScale:o,index:a}=r,l=s.axis,c=o.axis,u=B4(s,o,r),h=e.length;let f;for(let p=0;p<h;++p){const m=e[p],{[l]:g,[c]:x}=m,b=m._stacks||(m._stacks={});f=b[c]=V4(i,u,g),f[a]=x,f._top=Wp(f,o,!0,r.type),f._bottom=Wp(f,o,!1,r.type);const y=f._visualValues||(f._visualValues={});y[a]=x}}function Lc(n,e){const t=n.scales;return Object.keys(t).filter(r=>t[r].axis===e).shift()}function W4(n,e){return ui(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function U4(n,e,t){return ui(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function ms(n,e){const t=n.controller.index,r=n.vScale&&n.vScale.axis;if(r){e=e||n._parsed;for(const i of e){const s=i._stacks;if(!s||s[r]===void 0||s[r][t]===void 0)return;delete s[r][t],s[r]._visualValues!==void 0&&s[r]._visualValues[t]!==void 0&&delete s[r]._visualValues[t]}}}const Fc=n=>n==="reset"||n==="none",qp=(n,e)=>e?n:Object.assign({},n),q4=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:Ev(t,!0),values:null};class nc{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Nc(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&ms(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,r=this.getDataset(),i=(h,f,p,m)=>h==="x"?f:h==="r"?m:p,s=t.xAxisID=Ce(r.xAxisID,Lc(e,"x")),o=t.yAxisID=Ce(r.yAxisID,Lc(e,"y")),a=t.rAxisID=Ce(r.rAxisID,Lc(e,"r")),l=t.indexAxis,c=t.iAxisID=i(l,s,o,a),u=t.vAxisID=i(l,o,s,a);t.xScale=this.getScaleForId(s),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(a),t.iScale=this.getScaleForId(c),t.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&jp(this._data,this),e._stacked&&ms(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),r=this._data;if(Ae(t)){const i=this._cachedMeta;this._data=z4(t,i)}else if(r!==t){if(r){jp(r,this);const i=this._cachedMeta;ms(i),i._parsed=[]}t&&Object.isExtensible(t)&&CO(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,r=this.getDataset();let i=!1;this._dataCheck();const s=t._stacked;t._stacked=Nc(t.vScale,t),t.stack!==r.stack&&(i=!0,ms(t),t.stack=r.stack),this._resyncElements(e),(i||s!==t._stacked)&&(Up(this,t._parsed),t._stacked=Nc(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:r,_data:i}=this,{iScale:s,_stacked:o}=r,a=s.axis;let l=e===0&&t===i.length?!0:r._sorted,c=e>0&&r._parsed[e-1],u,h,f;if(this._parsing===!1)r._parsed=i,r._sorted=!0,f=i;else{qe(i[e])?f=this.parseArrayData(r,i,e,t):Ae(i[e])?f=this.parseObjectData(r,i,e,t):f=this.parsePrimitiveData(r,i,e,t);const p=()=>h[a]===null||c&&h[a]<c[a];for(u=0;u<t;++u)r._parsed[u+e]=h=f[u],l&&(p()&&(l=!1),c=h);r._sorted=l}o&&Up(this,f)}parsePrimitiveData(e,t,r,i){const{iScale:s,vScale:o}=e,a=s.axis,l=o.axis,c=s.getLabels(),u=s===o,h=new Array(i);let f,p,m;for(f=0,p=i;f<p;++f)m=f+r,h[f]={[a]:u||s.parse(c[m],m),[l]:o.parse(t[m],m)};return h}parseArrayData(e,t,r,i){const{xScale:s,yScale:o}=e,a=new Array(i);let l,c,u,h;for(l=0,c=i;l<c;++l)u=l+r,h=t[u],a[l]={x:s.parse(h[0],u),y:o.parse(h[1],u)};return a}parseObjectData(e,t,r,i){const{xScale:s,yScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(i);let u,h,f,p;for(u=0,h=i;u<h;++u)f=u+r,p=t[f],c[u]={x:s.parse(ri(p,a),f),y:o.parse(ri(p,l),f)};return c}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,r){const i=this.chart,s=this._cachedMeta,o=t[e.axis],a={keys:Ev(i,!0),values:t._stacks[e.axis]._visualValues};return Vp(a,o,s.index,{mode:r})}updateRangeFromParsed(e,t,r,i){const s=r[t.axis];let o=s===null?NaN:s;const a=i&&r._stacks[t.axis];i&&a&&(i.values=a,o=Vp(i,s,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const r=this._cachedMeta,i=r._parsed,s=r._sorted&&e===r.iScale,o=i.length,a=this._getOtherScale(e),l=q4(t,r,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:h}=H4(a);let f,p;function m(){p=i[f];const g=p[a.axis];return!Ot(p[e.axis])||u>g||h<g}for(f=0;f<o&&!(!m()&&(this.updateRangeFromParsed(c,e,p,l),s));++f);if(s){for(f=o-1;f>=0;--f)if(!m()){this.updateRangeFromParsed(c,e,p,l);break}}return c}getAllParsedValues(e){const t=this._cachedMeta._parsed,r=[];let i,s,o;for(i=0,s=t.length;i<s;++i)o=t[i][e.axis],Ot(o)&&r.push(o);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,r=t.iScale,i=t.vScale,s=this.getParsed(e);return{label:r?""+r.getLabelForValue(s[r.axis]):"",value:i?""+i.getLabelForValue(s[i.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=F4(Ce(this.options.clip,L4(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,r=this._cachedMeta,i=r.data||[],s=t.chartArea,o=[],a=this._drawStart||0,l=this._drawCount||i.length-a,c=this.options.drawActiveElementsOnTop;let u;for(r.dataset&&r.dataset.draw(e,s,a,l),u=a;u<a+l;++u){const h=i[u];h.hidden||(h.active&&c?o.push(h):h.draw(e,s))}for(u=0;u<o.length;++u)o[u].draw(e,s)}getStyle(e,t){const r=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,t,r){const i=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];s=o.$context||(o.$context=U4(this.getContext(),e,o)),s.parsed=this.getParsed(e),s.raw=i.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=W4(this.chart.getContext(),this.index)),s.dataset=i,s.index=s.datasetIndex=this.index;return s.active=!!t,s.mode=r,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",r){const i=t==="active",s=this._cachedDataOpts,o=e+"-"+t,a=s[o],l=this.enableOptionSharing&&$t(r);if(a)return qp(a,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,e),h=i?[`${e}Hover`,"hover",e,""]:[e,""],f=c.getOptionScopes(this.getDataset(),u),p=Object.keys(Ze.elements[e]),m=()=>this.getContext(r,i,t),g=c.resolveNamedOptions(f,p,m,h);return g.$shared&&(g.$shared=l,s[o]=Object.freeze(qp(g,l))),g}_resolveAnimations(e,t,r){const i=this.chart,s=this._cachedDataOpts,o=`animation-${t}`,a=s[o];if(a)return a;let l;if(i.options.animation!==!1){const u=this.chart.config,h=u.datasetAnimationScopeKeys(this._type,t),f=u.getOptionScopes(this.getDataset(),h);l=u.createResolver(f,this.getContext(e,r,t))}const c=new wh(i,l&&l.animations);return l&&l._cacheable&&(s[o]=Object.freeze(c)),c}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||Fc(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const r=this.resolveDataElementOptions(e,t),i=this._sharedOptions,s=this.getSharedOptions(r),o=this.includeOptions(t,s)||s!==i;return this.updateSharedOptions(s,t,r),{sharedOptions:s,includeOptions:o}}updateElement(e,t,r,i){Fc(i)?Object.assign(e,r):this._resolveAnimations(t,i).update(e,r)}updateSharedOptions(e,t,r){e&&!Fc(t)&&this._resolveAnimations(void 0,t).update(e,r)}_setStyle(e,t,r,i){e.active=i;const s=this.getStyle(t,i);this._resolveAnimations(t,r,i).update(e,{options:!i&&this.getSharedOptions(s)||s})}removeHoverStyle(e,t,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,t,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,r=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const i=r.length,s=t.length,o=Math.min(s,i);o&&this.parse(0,o),s>i?this._insertElements(i,s-i,e):s<i&&this._removeElements(s,i-s)}_insertElements(e,t,r=!0){const i=this._cachedMeta,s=i.data,o=e+t;let a;const l=c=>{for(c.length+=t,a=c.length-1;a>=o;a--)c[a]=c[a-t]};for(l(s),a=e;a<o;++a)s[a]=new this.dataElementType;this._parsing&&l(i._parsed),this.parse(e,t),r&&this.updateElements(s,e,t,"reset")}updateElements(e,t,r,i){}_removeElements(e,t){const r=this._cachedMeta;if(this._parsing){const i=r._parsed.splice(e,t);r._stacked&&ms(r,i)}r.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,r,i]=e;this[t](r,i)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function X4(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let r=[];for(let i=0,s=t.length;i<s;i++)r=r.concat(t[i].controller.getAllParsedValues(n));n._cache.$bar=mv(r.sort((i,s)=>i-s))}return n._cache.$bar}function G4(n){const e=n.iScale,t=X4(e,n.type);let r=e._length,i,s,o,a;const l=()=>{o===32767||o===-32768||($t(a)&&(r=Math.min(r,Math.abs(o-a)||r)),a=o)};for(i=0,s=t.length;i<s;++i)o=e.getPixelForValue(t[i]),l();for(a=void 0,i=0,s=e.ticks.length;i<s;++i)o=e.getPixelForTick(i),l();return r}function Y4(n,e,t,r){const i=t.barThickness;let s,o;return Ne(i)?(s=e.min*t.categoryPercentage,o=t.barPercentage):(s=i*r,o=1),{chunk:s/r,ratio:o,start:e.pixels[n]-s/2}}function K4(n,e,t,r){const i=e.pixels,s=i[n];let o=n>0?i[n-1]:null,a=n<i.length-1?i[n+1]:null;const l=t.categoryPercentage;o===null&&(o=s-(a===null?e.end-e.start:a-s)),a===null&&(a=s+s-o);const c=s-(s-Math.min(o,a))/2*l;return{chunk:Math.abs(a-o)/2*l/r,ratio:t.barPercentage,start:c}}function Z4(n,e,t,r){const i=t.parse(n[0],r),s=t.parse(n[1],r),o=Math.min(i,s),a=Math.max(i,s);let l=o,c=a;Math.abs(o)>Math.abs(a)&&(l=a,c=o),e[t.axis]=c,e._custom={barStart:l,barEnd:c,start:i,end:s,min:o,max:a}}function Iv(n,e,t,r){return qe(n)?Z4(n,e,t,r):e[t.axis]=t.parse(n,r),e}function Xp(n,e,t,r){const i=n.iScale,s=n.vScale,o=i.getLabels(),a=i===s,l=[];let c,u,h,f;for(c=t,u=t+r;c<u;++c)f=e[c],h={},h[i.axis]=a||i.parse(o[c],c),l.push(Iv(f,h,s,c));return l}function zc(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function J4(n,e,t){return n!==0?$n(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function Q4(n){let e,t,r,i,s;return n.horizontal?(e=n.base>n.x,t="left",r="right"):(e=n.base<n.y,t="bottom",r="top"),e?(i="end",s="start"):(i="start",s="end"),{start:t,end:r,reverse:e,top:i,bottom:s}}function e$(n,e,t,r){let i=e.borderSkipped;const s={};if(!i){n.borderSkipped=s;return}if(i===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:a,reverse:l,top:c,bottom:u}=Q4(n);i==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===r?i=c:(t._bottom||0)===r?i=u:(s[Gp(u,o,a,l)]=!0,i=c)),s[Gp(i,o,a,l)]=!0,n.borderSkipped=s}function Gp(n,e,t,r){return r?(n=t$(n,e,t),n=Yp(n,t,e)):n=Yp(n,e,t),n}function t$(n,e,t){return n===e?t:n===t?e:n}function Yp(n,e,t){return n==="start"?e:n==="end"?t:n}function n$(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class r$ extends nc{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,t,r,i){return Xp(e,t,r,i)}parseArrayData(e,t,r,i){return Xp(e,t,r,i)}parseObjectData(e,t,r,i){const{iScale:s,vScale:o}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=s.axis==="x"?a:l,u=o.axis==="x"?a:l,h=[];let f,p,m,g;for(f=r,p=r+i;f<p;++f)g=t[f],m={},m[s.axis]=s.parse(ri(g,c),f),h.push(Iv(ri(g,u),m,o,f));return h}updateRangeFromParsed(e,t,r,i){super.updateRangeFromParsed(e,t,r,i);const s=r._custom;s&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:r,vScale:i}=t,s=this.getParsed(e),o=s._custom,a=zc(o)?"["+o.start+", "+o.end+"]":""+i.getLabelForValue(s[i.axis]);return{label:""+r.getLabelForValue(s[r.axis]),value:a}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,r,i){const s=i==="reset",{index:o,_cachedMeta:{vScale:a}}=this,l=a.getBasePixel(),c=a.isHorizontal(),u=this._getRuler(),{sharedOptions:h,includeOptions:f}=this._getSharedOptions(t,i);for(let p=t;p<t+r;p++){const m=this.getParsed(p),g=s||Ne(m[a.axis])?{base:l,head:l}:this._calculateBarValuePixels(p),x=this._calculateBarIndexPixels(p,u),b=(m._stacks||{})[a.axis],y={horizontal:c,base:g.base,enableBorderRadius:!b||zc(m._custom)||o===b._top||o===b._bottom,x:c?g.head:x.center,y:c?x.center:g.head,height:c?x.size:Math.abs(g.size),width:c?Math.abs(g.size):x.size};f&&(y.options=h||this.resolveDataElementOptions(p,e[p].active?"active":i));const w=y.options||e[p].options;e$(y,w,b,o),n$(y,w,u.ratio),this.updateElement(e[p],p,y,i)}}_getStacks(e,t){const{iScale:r}=this._cachedMeta,i=r.getMatchingVisibleMetas(this._type).filter(u=>u.controller.options.grouped),s=r.options.stacked,o=[],a=this._cachedMeta.controller.getParsed(t),l=a&&a[r.axis],c=u=>{const h=u._parsed.find(p=>p[r.axis]===l),f=h&&h[u.vScale.axis];if(Ne(f)||isNaN(f))return!0};for(const u of i)if(!(t!==void 0&&c(u))&&((s===!1||o.indexOf(u.stack)===-1||s===void 0&&u.stack===void 0)&&o.push(u.stack),u.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(r=>e[r].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const r of this.chart.data.datasets)e[Ce(this.chart.options.indexAxis==="x"?r.xAxisID:r.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,r){const i=this._getStacks(e,r),s=t!==void 0?i.indexOf(t):-1;return s===-1?i.length-1:s}_getRuler(){const e=this.options,t=this._cachedMeta,r=t.iScale,i=[];let s,o;for(s=0,o=t.data.length;s<o;++s)i.push(r.getPixelForValue(this.getParsed(s)[r.axis],s));const a=e.barThickness;return{min:a||G4(t),pixels:i,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:a?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:r,index:i},options:{base:s,minBarLength:o}}=this,a=s||0,l=this.getParsed(e),c=l._custom,u=zc(c);let h=l[t.axis],f=0,p=r?this.applyStack(t,l,r):h,m,g;p!==h&&(f=p-h,p=h),u&&(h=c.barStart,p=c.barEnd-c.barStart,h!==0&&$n(h)!==$n(c.barEnd)&&(f=0),f+=h);const x=!Ne(s)&&!u?s:f;let b=t.getPixelForValue(x);if(this.chart.getDataVisibility(e)?m=t.getPixelForValue(f+p):m=b,g=m-b,Math.abs(g)<o){g=J4(g,t,a)*o,h===a&&(b-=g/2);const y=t.getPixelForDecimal(0),w=t.getPixelForDecimal(1),v=Math.min(y,w),S=Math.max(y,w);b=Math.max(Math.min(b,S),v),m=b+g,r&&!u&&(l._stacks[t.axis]._visualValues[i]=t.getValueForPixel(m)-t.getValueForPixel(b))}if(b===t.getPixelForValue(a)){const y=$n(g)*t.getLineWidthForValue(a)/2;b+=y,g-=y}return{size:g,base:b,head:m,center:m+g/2}}_calculateBarIndexPixels(e,t){const r=t.scale,i=this.options,s=i.skipNull,o=Ce(i.maxBarThickness,1/0);let a,l;const c=this._getAxisCount();if(t.grouped){const u=s?this._getStackCount(e):t.stackCount,h=i.barThickness==="flex"?K4(e,t,i,u*c):Y4(e,t,i,u*c),f=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,p=this._getAxis().indexOf(Ce(f,this.getFirstScaleIdForIndexAxis())),m=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0)+p;a=h.start+h.chunk*m+h.chunk/2,l=Math.min(o,h.chunk*h.ratio)}else a=r.getPixelForValue(this.getParsed(e)[r.axis],e),l=Math.min(o,t.min*t.ratio);return{base:a-l/2,head:a+l/2,center:a,size:l}}draw(){const e=this._cachedMeta,t=e.vScale,r=e.data,i=r.length;let s=0;for(;s<i;++s)this.getParsed(s)[t.axis]!==null&&!r[s].hidden&&r[s].draw(this._ctx)}}function i$(n,e,t){let r=1,i=1,s=0,o=0;if(e<ut){const a=n,l=a+e,c=Math.cos(a),u=Math.sin(a),h=Math.cos(l),f=Math.sin(l),p=(w,v,S)=>rl(w,a,l,!0)?1:Math.max(v,v*t,S,S*t),m=(w,v,S)=>rl(w,a,l,!0)?-1:Math.min(v,v*t,S,S*t),g=p(0,c,h),x=p(dt,u,f),b=m(ze,c,h),y=m(ze+dt,u,f);r=(g-b)/2,i=(x-y)/2,s=-(g+b)/2,o=-(x+y)/2}return{ratioX:r,ratioY:i,offsetX:s,offsetY:o}}class s$ extends nc{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data;if(t.labels.length&&t.datasets.length){const{labels:{pointStyle:r,color:i}}=e.legend.options;return t.labels.map((s,o)=>{const l=e.getDatasetMeta(0).controller.getStyle(o);return{text:s,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:i,lineWidth:l.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(o),index:o}})}return[]}},onClick(e,t,r){r.chart.toggleDataVisibility(t.index),r.chart.update()}}}};constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const r=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=r;else{let s=l=>+r[l];if(Ae(r[e])){const{key:l="value"}=this._parsing;s=c=>+ri(r[c],l)}let o,a;for(o=e,a=e+t;o<a;++o)i._parsed[o]=s(o)}}_getRotation(){return st(this.options.rotation-90)}_getCircumference(){return st(this.options.circumference)}_getRotationExtents(){let e=ut,t=-ut;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const i=this.chart.getDatasetMeta(r).controller,s=i._getRotation(),o=i._getCircumference();e=Math.min(e,s),t=Math.max(t,s+o)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:r}=t,i=this._cachedMeta,s=i.data,o=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,a=Math.max((Math.min(r.width,r.height)-o)/2,0),l=Math.min(uO(this.options.cutout,a),1),c=this._getRingWeight(this.index),{circumference:u,rotation:h}=this._getRotationExtents(),{ratioX:f,ratioY:p,offsetX:m,offsetY:g}=i$(h,u,l),x=(r.width-o)/f,b=(r.height-o)/p,y=Math.max(Math.min(x,b)/2,0),w=uv(this.options.radius,y),v=Math.max(w*l,0),S=(w-v)/this._getVisibleDatasetWeightTotal();this.offsetX=m*w,this.offsetY=g*w,i.total=this.calculateTotal(),this.outerRadius=w-S*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-S*c,0),this.updateElements(s,0,s.length,e)}_circumference(e,t){const r=this.options,i=this._cachedMeta,s=this._getCircumference();return t&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||i._parsed[e]===null||i.data[e].hidden?0:this.calculateCircumference(i._parsed[e]*s/ut)}updateElements(e,t,r,i){const s=i==="reset",o=this.chart,a=o.chartArea,c=o.options.animation,u=(a.left+a.right)/2,h=(a.top+a.bottom)/2,f=s&&c.animateScale,p=f?0:this.innerRadius,m=f?0:this.outerRadius,{sharedOptions:g,includeOptions:x}=this._getSharedOptions(t,i);let b=this._getRotation(),y;for(y=0;y<t;++y)b+=this._circumference(y,s);for(y=t;y<t+r;++y){const w=this._circumference(y,s),v=e[y],S={x:u+this.offsetX,y:h+this.offsetY,startAngle:b,endAngle:b+w,circumference:w,outerRadius:m,innerRadius:p};x&&(S.options=g||this.resolveDataElementOptions(y,v.active?"active":i)),b+=w,this.updateElement(v,y,S,i)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let r=0,i;for(i=0;i<t.length;i++){const s=e._parsed[i];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(i)&&!t[i].hidden&&(r+=Math.abs(s))}return r}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?ut*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,r=this.chart,i=r.data.labels||[],s=mh(t._parsed[e],r.options.locale);return{label:i[e]||"",value:s}}getMaxBorderWidth(e){let t=0;const r=this.chart;let i,s,o,a,l;if(!e){for(i=0,s=r.data.datasets.length;i<s;++i)if(r.isDatasetVisible(i)){o=r.getDatasetMeta(i),e=o.data,a=o.controller;break}}if(!e)return 0;for(i=0,s=e.length;i<s;++i)l=a.resolveDataElementOptions(i),l.borderAlign!=="inner"&&(t=Math.max(t,l.borderWidth||0,l.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let r=0,i=e.length;r<i;++r){const s=this.resolveDataElementOptions(r);t=Math.max(t,s.offset||0,s.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(t+=this._getRingWeight(r));return t}_getRingWeight(e){return Math.max(Ce(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class o$ extends nc{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:r,data:i=[],_dataset:s}=t,o=this.chart._animationsDisabled;let{start:a,count:l}=TO(t,i,o);this._drawStart=a,this._drawCount=l,MO(t)&&(a=0,l=i.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!s._decimated,r.points=i;const c=this.resolveDatasetElementOptions(e);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(r,void 0,{animated:!o,options:c},e),this.updateElements(i,a,l,e)}updateElements(e,t,r,i){const s=i==="reset",{iScale:o,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:h}=this._getSharedOptions(t,i),f=o.axis,p=a.axis,{spanGaps:m,segment:g}=this.options,x=ii(m)?m:Number.POSITIVE_INFINITY,b=this.chart._animationsDisabled||s||i==="none",y=t+r,w=e.length;let v=t>0&&this.getParsed(t-1);for(let S=0;S<w;++S){const k=e[S],P=b?k:{};if(S<t||S>=y){P.skip=!0;continue}const C=this.getParsed(S),T=Ne(C[p]),A=P[f]=o.getPixelForValue(C[f],S),M=P[p]=s||T?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,C,l):C[p],S);P.skip=isNaN(A)||isNaN(M)||T,P.stop=S>0&&Math.abs(C[f]-v[f])>x,g&&(P.parsed=C,P.raw=c.data[S]),h&&(P.options=u||this.resolveDataElementOptions(S,k.active?"active":i)),b||this.updateElement(k,S,P,i),v=C}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,r=t.options&&t.options.borderWidth||0,i=e.data||[];if(!i.length)return r;const s=i[0].size(this.resolveDataElementOptions(0)),o=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(r,s,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}function Er(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class _h{static override(e){Object.assign(_h.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Er()}parse(){return Er()}format(){return Er()}add(){return Er()}diff(){return Er()}startOf(){return Er()}endOf(){return Er()}}var a$={_date:_h};function l$(n,e,t,r){const{controller:i,data:s,_sorted:o}=n,a=i._cachedMeta.iScale,l=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(a&&e===a.axis&&e!=="r"&&o&&s.length){const c=a._reversePixels?SO:Hr;if(r){if(i._sharedOptions){const u=s[0],h=typeof u.getRange=="function"&&u.getRange(e);if(h){const f=c(s,e,t-h),p=c(s,e,t+h);return{lo:f.lo,hi:p.hi}}}}else{const u=c(s,e,t);if(l){const{vScale:h}=i._cachedMeta,{_parsed:f}=n,p=f.slice(0,u.lo+1).reverse().findIndex(g=>!Ne(g[h.axis]));u.lo-=Math.max(0,p);const m=f.slice(u.hi).findIndex(g=>!Ne(g[h.axis]));u.hi+=Math.max(0,m)}return u}}return{lo:0,hi:s.length-1}}function rc(n,e,t,r,i){const s=n.getSortedVisibleDatasetMetas(),o=t[e];for(let a=0,l=s.length;a<l;++a){const{index:c,data:u}=s[a],{lo:h,hi:f}=l$(s[a],e,o,i);for(let p=h;p<=f;++p){const m=u[p];m.skip||r(m,c,p)}}}function c$(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(r,i){const s=e?Math.abs(r.x-i.x):0,o=t?Math.abs(r.y-i.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(o,2))}}function Bc(n,e,t,r,i){const s=[];return!i&&!n.isPointInArea(e)||rc(n,t,e,function(a,l,c){!i&&!to(a,n.chartArea,0)||a.inRange(e.x,e.y,r)&&s.push({element:a,datasetIndex:l,index:c})},!0),s}function u$(n,e,t,r){let i=[];function s(o,a,l){const{startAngle:c,endAngle:u}=o.getProps(["startAngle","endAngle"],r),{angle:h}=Ou(o,{x:e.x,y:e.y});rl(h,c,u)&&i.push({element:o,datasetIndex:a,index:l})}return rc(n,t,e,s),i}function d$(n,e,t,r,i,s){let o=[];const a=c$(t);let l=Number.POSITIVE_INFINITY;function c(u,h,f){const p=u.inRange(e.x,e.y,i);if(r&&!p)return;const m=u.getCenterPoint(i);if(!(!!s||n.isPointInArea(m))&&!p)return;const x=a(e,m);x<l?(o=[{element:u,datasetIndex:h,index:f}],l=x):x===l&&o.push({element:u,datasetIndex:h,index:f})}return rc(n,t,e,c),o}function Hc(n,e,t,r,i,s){return!s&&!n.isPointInArea(e)?[]:t==="r"&&!r?u$(n,e,t,i):d$(n,e,t,r,i,s)}function Kp(n,e,t,r,i){const s=[],o=t==="x"?"inXRange":"inYRange";let a=!1;return rc(n,t,e,(l,c,u)=>{l[o]&&l[o](e[t],i)&&(s.push({element:l,datasetIndex:c,index:u}),a=a||l.inRange(e.x,e.y,i))}),r&&!a?[]:s}var h$={modes:{index(n,e,t,r){const i=Or(e,n),s=t.axis||"x",o=t.includeInvisible||!1,a=t.intersect?Bc(n,i,s,r,o):Hc(n,i,s,!1,r,o),l=[];return a.length?(n.getSortedVisibleDatasetMetas().forEach(c=>{const u=a[0].index,h=c.data[u];h&&!h.skip&&l.push({element:h,datasetIndex:c.index,index:u})}),l):[]},dataset(n,e,t,r){const i=Or(e,n),s=t.axis||"xy",o=t.includeInvisible||!1;let a=t.intersect?Bc(n,i,s,r,o):Hc(n,i,s,!1,r,o);if(a.length>0){const l=a[0].datasetIndex,c=n.getDatasetMeta(l).data;a=[];for(let u=0;u<c.length;++u)a.push({element:c[u],datasetIndex:l,index:u})}return a},point(n,e,t,r){const i=Or(e,n),s=t.axis||"xy",o=t.includeInvisible||!1;return Bc(n,i,s,r,o)},nearest(n,e,t,r){const i=Or(e,n),s=t.axis||"xy",o=t.includeInvisible||!1;return Hc(n,i,s,t.intersect,r,o)},x(n,e,t,r){const i=Or(e,n);return Kp(n,i,"x",t.intersect,r)},y(n,e,t,r){const i=Or(e,n);return Kp(n,i,"y",t.intersect,r)}}};const Rv=["left","top","right","bottom"];function gs(n,e){return n.filter(t=>t.pos===e)}function Zp(n,e){return n.filter(t=>Rv.indexOf(t.pos)===-1&&t.box.axis===e)}function xs(n,e){return n.sort((t,r)=>{const i=e?r:t,s=e?t:r;return i.weight===s.weight?i.index-s.index:i.weight-s.weight})}function f$(n){const e=[];let t,r,i,s,o,a;for(t=0,r=(n||[]).length;t<r;++t)i=n[t],{position:s,options:{stack:o,stackWeight:a=1}}=i,e.push({index:t,box:i,pos:s,horizontal:i.isHorizontal(),weight:i.weight,stack:o&&s+o,stackWeight:a});return e}function p$(n){const e={};for(const t of n){const{stack:r,pos:i,stackWeight:s}=t;if(!r||!Rv.includes(i))continue;const o=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=s}return e}function m$(n,e){const t=p$(n),{vBoxMaxWidth:r,hBoxMaxHeight:i}=e;let s,o,a;for(s=0,o=n.length;s<o;++s){a=n[s];const{fullSize:l}=a.box,c=t[a.stack],u=c&&a.stackWeight/c.weight;a.horizontal?(a.width=u?u*r:l&&e.availableWidth,a.height=i):(a.width=r,a.height=u?u*i:l&&e.availableHeight)}return t}function g$(n){const e=f$(n),t=xs(e.filter(c=>c.box.fullSize),!0),r=xs(gs(e,"left"),!0),i=xs(gs(e,"right")),s=xs(gs(e,"top"),!0),o=xs(gs(e,"bottom")),a=Zp(e,"x"),l=Zp(e,"y");return{fullSize:t,leftAndTop:r.concat(s),rightAndBottom:i.concat(l).concat(o).concat(a),chartArea:gs(e,"chartArea"),vertical:r.concat(i).concat(l),horizontal:s.concat(o).concat(a)}}function Jp(n,e,t,r){return Math.max(n[t],e[t])+Math.max(n[r],e[r])}function Ov(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function x$(n,e,t,r){const{pos:i,box:s}=t,o=n.maxPadding;if(!Ae(i)){t.size&&(n[i]-=t.size);const h=r[t.stack]||{size:0,count:1};h.size=Math.max(h.size,t.horizontal?s.height:s.width),t.size=h.size/h.count,n[i]+=t.size}s.getPadding&&Ov(o,s.getPadding());const a=Math.max(0,e.outerWidth-Jp(o,n,"left","right")),l=Math.max(0,e.outerHeight-Jp(o,n,"top","bottom")),c=a!==n.w,u=l!==n.h;return n.w=a,n.h=l,t.horizontal?{same:c,other:u}:{same:u,other:c}}function b$(n){const e=n.maxPadding;function t(r){const i=Math.max(e[r]-n[r],0);return n[r]+=i,i}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function y$(n,e){const t=e.maxPadding;function r(i){const s={left:0,top:0,right:0,bottom:0};return i.forEach(o=>{s[o]=Math.max(e[o],t[o])}),s}return r(n?["left","right"]:["top","bottom"])}function Ts(n,e,t,r){const i=[];let s,o,a,l,c,u;for(s=0,o=n.length,c=0;s<o;++s){a=n[s],l=a.box,l.update(a.width||e.w,a.height||e.h,y$(a.horizontal,e));const{same:h,other:f}=x$(e,t,a,r);c|=h&&i.length,u=u||f,l.fullSize||i.push(a)}return c&&Ts(i,e,t,r)||u}function aa(n,e,t,r,i){n.top=t,n.left=e,n.right=e+r,n.bottom=t+i,n.width=r,n.height=i}function Qp(n,e,t,r){const i=t.padding;let{x:s,y:o}=e;for(const a of n){const l=a.box,c=r[a.stack]||{placed:0,weight:1},u=a.stackWeight/c.weight||1;if(a.horizontal){const h=e.w*u,f=c.size||l.height;$t(c.start)&&(o=c.start),l.fullSize?aa(l,i.left,o,t.outerWidth-i.right-i.left,f):aa(l,e.left+c.placed,o,h,f),c.start=o,c.placed+=h,o=l.bottom}else{const h=e.h*u,f=c.size||l.width;$t(c.start)&&(s=c.start),l.fullSize?aa(l,s,i.top,f,t.outerHeight-i.bottom-i.top):aa(l,s,e.top+c.placed,f,h),c.start=s,c.placed+=h,s=l.right}}e.x=s,e.y=o}var xr={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,r){if(!n)return;const i=wt(n.options.layout.padding),s=Math.max(e-i.width,0),o=Math.max(t-i.height,0),a=g$(n.boxes),l=a.vertical,c=a.horizontal;Fe(n.boxes,g=>{typeof g.beforeLayout=="function"&&g.beforeLayout()});const u=l.reduce((g,x)=>x.box.options&&x.box.options.display===!1?g:g+1,0)||1,h=Object.freeze({outerWidth:e,outerHeight:t,padding:i,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/u,hBoxMaxHeight:o/2}),f=Object.assign({},i);Ov(f,wt(r));const p=Object.assign({maxPadding:f,w:s,h:o,x:i.left,y:i.top},i),m=m$(l.concat(c),h);Ts(a.fullSize,p,h,m),Ts(l,p,h,m),Ts(c,p,h,m)&&Ts(l,p,h,m),b$(p),Qp(a.leftAndTop,p,h,m),p.x+=p.w,p.y+=p.h,Qp(a.rightAndBottom,p,h,m),n.chartArea={left:p.left,top:p.top,right:p.left+p.w,bottom:p.top+p.h,height:p.h,width:p.w},Fe(a.chartArea,g=>{const x=g.box;Object.assign(x,n.chartArea),x.update(p.w,p.h,{left:0,top:0,right:0,bottom:0})})}};class $v{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,r){}removeEventListener(e,t,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,r,i){return t=Math.max(0,t||e.width),r=r||e.height,{width:t,height:Math.max(0,i?Math.floor(t/i):r)}}isAttached(e){return!0}updateConfig(e){}}class v$ extends $v{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const ja="$chartjs",w$={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},em=n=>n===null||n==="";function _$(n,e){const t=n.style,r=n.getAttribute("height"),i=n.getAttribute("width");if(n[ja]={initial:{height:r,width:i,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",em(i)){const s=Np(n,"width");s!==void 0&&(n.width=s)}if(em(r))if(n.style.height==="")n.height=n.width/(e||2);else{const s=Np(n,"height");s!==void 0&&(n.height=s)}return n}const Dv=b4?{passive:!0}:!1;function S$(n,e,t){n&&n.addEventListener(e,t,Dv)}function P$(n,e,t){n&&n.canvas&&n.canvas.removeEventListener(e,t,Dv)}function C$(n,e){const t=w$[n.type]||n.type,{x:r,y:i}=Or(n,e);return{type:t,chart:e,native:n,x:r!==void 0?r:null,y:i!==void 0?i:null}}function ol(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function k$(n,e,t){const r=n.canvas,i=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||ol(a.addedNodes,r),o=o&&!ol(a.removedNodes,r);o&&t()});return i.observe(document,{childList:!0,subtree:!0}),i}function j$(n,e,t){const r=n.canvas,i=new MutationObserver(s=>{let o=!1;for(const a of s)o=o||ol(a.removedNodes,r),o=o&&!ol(a.addedNodes,r);o&&t()});return i.observe(document,{childList:!0,subtree:!0}),i}const ro=new Map;let tm=0;function Nv(){const n=window.devicePixelRatio;n!==tm&&(tm=n,ro.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function T$(n,e){ro.size||window.addEventListener("resize",Nv),ro.set(n,e)}function M$(n){ro.delete(n),ro.size||window.removeEventListener("resize",Nv)}function A$(n,e,t){const r=n.canvas,i=r&&vh(r);if(!i)return;const s=xv((a,l)=>{const c=i.clientWidth;t(a,l),c<i.clientWidth&&t()},window),o=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||s(c,u)});return o.observe(i),T$(n,s),o}function Vc(n,e,t){t&&t.disconnect(),e==="resize"&&M$(n)}function E$(n,e,t){const r=n.canvas,i=xv(s=>{n.ctx!==null&&t(C$(s,n))},n);return S$(r,e,i),i}class I$ extends $v{acquireContext(e,t){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(_$(e,t),r):null}releaseContext(e){const t=e.canvas;if(!t[ja])return!1;const r=t[ja].initial;["height","width"].forEach(s=>{const o=r[s];Ne(o)?t.removeAttribute(s):t.setAttribute(s,o)});const i=r.style||{};return Object.keys(i).forEach(s=>{t.style[s]=i[s]}),t.width=t.width,delete t[ja],!0}addEventListener(e,t,r){this.removeEventListener(e,t);const i=e.$proxies||(e.$proxies={}),o={attach:k$,detach:j$,resize:A$}[t]||E$;i[t]=o(e,t,r)}removeEventListener(e,t){const r=e.$proxies||(e.$proxies={}),i=r[t];if(!i)return;({attach:Vc,detach:Vc,resize:Vc}[t]||P$)(e,t,i),r[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,r,i){return x4(e,t,r,i)}isAttached(e){const t=e&&vh(e);return!!(t&&t.isConnected)}}function R$(n){return!yh()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?v$:I$}class Nt{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}hasValue(){return ii(this.x)&&ii(this.y)}getProps(e,t){const r=this.$animations;if(!t||!r)return this;const i={};return e.forEach(s=>{i[s]=r[s]&&r[s].active()?r[s]._to:this[s]}),i}}function O$(n,e){const t=n.options.ticks,r=$$(n),i=Math.min(t.maxTicksLimit||r,r),s=t.major.enabled?N$(e):[],o=s.length,a=s[0],l=s[o-1],c=[];if(o>i)return L$(e,c,s,o/i),c;const u=D$(s,e,i);if(o>0){let h,f;const p=o>1?Math.round((l-a)/(o-1)):null;for(la(e,c,u,Ne(p)?0:a-p,a),h=0,f=o-1;h<f;h++)la(e,c,u,s[h],s[h+1]);return la(e,c,u,l,Ne(p)?e.length:l+p),c}return la(e,c,u),c}function $$(n){const e=n.options.offset,t=n._tickSize(),r=n._length/t+(e?0:1),i=n._maxLength/t;return Math.floor(Math.min(r,i))}function D$(n,e,t){const r=F$(n),i=e.length/t;if(!r)return Math.max(i,1);const s=xO(r);for(let o=0,a=s.length-1;o<a;o++){const l=s[o];if(l>i)return l}return Math.max(i,1)}function N$(n){const e=[];let t,r;for(t=0,r=n.length;t<r;t++)n[t].major&&e.push(t);return e}function L$(n,e,t,r){let i=0,s=t[0],o;for(r=Math.ceil(r),o=0;o<n.length;o++)o===s&&(e.push(n[o]),i++,s=t[i*r])}function la(n,e,t,r,i){const s=Ce(r,0),o=Math.min(Ce(i,n.length),n.length);let a=0,l,c,u;for(t=Math.ceil(t),i&&(l=i-r,t=l/Math.floor(l/t)),u=s;u<0;)a++,u=Math.round(s+a*t);for(c=Math.max(s,0);c<o;c++)c===u&&(e.push(n[c]),a++,u=Math.round(s+a*t))}function F$(n){const e=n.length;let t,r;if(e<2)return!1;for(r=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==r)return!1;return r}const z$=n=>n==="left"?"right":n==="right"?"left":n,nm=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,rm=(n,e)=>Math.min(e||n,n);function im(n,e){const t=[],r=n.length/e,i=n.length;let s=0;for(;s<i;s+=r)t.push(n[Math.floor(s)]);return t}function B$(n,e,t){const r=n.ticks.length,i=Math.min(e,r-1),s=n._startPixel,o=n._endPixel,a=1e-6;let l=n.getPixelForTick(i),c;if(!(t&&(r===1?c=Math.max(l-s,o-l):e===0?c=(n.getPixelForTick(1)-l)/2:c=(l-n.getPixelForTick(i-1))/2,l+=i<e?c:-c,l<s-a||l>o+a)))return l}function H$(n,e){Fe(n,t=>{const r=t.gc,i=r.length/2;let s;if(i>e){for(s=0;s<i;++s)delete t.data[r[s]];r.splice(0,i)}})}function bs(n){return n.drawTicks?n.tickLength:0}function sm(n,e){if(!n.display)return 0;const t=ht(n.font,e),r=wt(n.padding);return(qe(n.text)?n.text.length:1)*t.lineHeight+r.height}function V$(n,e){return ui(n,{scale:e,type:"scale"})}function W$(n,e,t){return ui(n,{tick:t,index:e,type:"tick"})}function U$(n,e,t){let r=bv(n);return(t&&e!=="right"||!t&&e==="right")&&(r=z$(r)),r}function q$(n,e,t,r){const{top:i,left:s,bottom:o,right:a,chart:l}=n,{chartArea:c,scales:u}=l;let h=0,f,p,m;const g=o-i,x=a-s;if(n.isHorizontal()){if(p=Ft(r,s,a),Ae(t)){const b=Object.keys(t)[0],y=t[b];m=u[b].getPixelForValue(y)+g-e}else t==="center"?m=(c.bottom+c.top)/2+g-e:m=nm(n,t,e);f=a-s}else{if(Ae(t)){const b=Object.keys(t)[0],y=t[b];p=u[b].getPixelForValue(y)-x+e}else t==="center"?p=(c.left+c.right)/2-x+e:p=nm(n,t,e);m=Ft(r,o,i),h=t==="left"?-dt:dt}return{titleX:p,titleY:m,maxWidth:f,rotation:h}}class is extends Nt{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:r,_suggestedMax:i}=this;return e=Cn(e,Number.POSITIVE_INFINITY),t=Cn(t,Number.NEGATIVE_INFINITY),r=Cn(r,Number.POSITIVE_INFINITY),i=Cn(i,Number.NEGATIVE_INFINITY),{min:Cn(e,r),max:Cn(t,i),minDefined:Ot(e),maxDefined:Ot(t)}}getMinMax(e){let{min:t,max:r,minDefined:i,maxDefined:s}=this.getUserBounds(),o;if(i&&s)return{min:t,max:r};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)o=a[l].controller.getMinMax(this,e),i||(t=Math.min(t,o.min)),s||(r=Math.max(r,o.max));return t=s&&t>r?r:t,r=i&&t>r?t:r,{min:Cn(t,Cn(r,t)),max:Cn(r,Cn(t,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Be(this.options.beforeUpdate,[this])}update(e,t,r){const{beginAtZero:i,grace:s,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=YO(this,s,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?im(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=O$(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,r;this.isHorizontal()?(t=this.left,r=this.right):(t=this.top,r=this.bottom,e=!e),this._startPixel=t,this._endPixel=r,this._reversePixels=e,this._length=r-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Be(this.options.afterUpdate,[this])}beforeSetDimensions(){Be(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Be(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Be(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Be(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let r,i,s;for(r=0,i=e.length;r<i;r++)s=e[r],s.label=Be(t.callback,[s.value,r,e],this)}afterTickToLabelConversion(){Be(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Be(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,r=rm(this.ticks.length,e.ticks.maxTicksLimit),i=t.minRotation||0,s=t.maxRotation;let o=i,a,l,c;if(!this._isVisible()||!t.display||i>=s||r<=1||!this.isHorizontal()){this.labelRotation=i;return}const u=this._getLabelSizes(),h=u.widest.width,f=u.highest.height,p=Bt(this.chart.width-h,0,this.maxWidth);a=e.offset?this.maxWidth/r:p/(r-1),h+6>a&&(a=p/(r-(e.offset?.5:1)),l=this.maxHeight-bs(e.grid)-t.padding-sm(e.title,this.chart.options.font),c=Math.sqrt(h*h+f*f),o=fv(Math.min(Math.asin(Bt((u.highest.height+6)/a,-1,1)),Math.asin(Bt(l/c,-1,1))-Math.asin(Bt(f/c,-1,1)))),o=Math.max(i,Math.min(s,o))),this.labelRotation=o}afterCalculateLabelRotation(){Be(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Be(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:r,title:i,grid:s}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){const l=sm(i,t.options.font);if(a?(e.width=this.maxWidth,e.height=bs(s)+l):(e.height=this.maxHeight,e.width=bs(s)+l),r.display&&this.ticks.length){const{first:c,last:u,widest:h,highest:f}=this._getLabelSizes(),p=r.padding*2,m=st(this.labelRotation),g=Math.cos(m),x=Math.sin(m);if(a){const b=r.mirror?0:x*h.width+g*f.height;e.height=Math.min(this.maxHeight,e.height+b+p)}else{const b=r.mirror?0:g*h.width+x*f.height;e.width=Math.min(this.maxWidth,e.width+b+p)}this._calculatePadding(c,u,x,g)}}this._handleMargins(),a?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,r,i){const{ticks:{align:s,padding:o},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,h=this.right-this.getPixelForTick(this.ticks.length-1);let f=0,p=0;l?c?(f=i*e.width,p=r*t.height):(f=r*e.height,p=i*t.width):s==="start"?p=t.width:s==="end"?f=e.width:s!=="inner"&&(f=e.width/2,p=t.width/2),this.paddingLeft=Math.max((f-u+o)*this.width/(this.width-u),0),this.paddingRight=Math.max((p-h+o)*this.width/(this.width-h),0)}else{let u=t.height/2,h=e.height/2;s==="start"?(u=0,h=e.height):s==="end"&&(u=t.height,h=0),this.paddingTop=u+o,this.paddingBottom=h+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Be(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,r;for(t=0,r=e.length;t<r;t++)Ne(e[t].label)&&(e.splice(t,1),r--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let r=this.ticks;t<r.length&&(r=im(r,t)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,r){const{ctx:i,_longestTextCache:s}=this,o=[],a=[],l=Math.floor(t/rm(t,r));let c=0,u=0,h,f,p,m,g,x,b,y,w,v,S;for(h=0;h<t;h+=l){if(m=e[h].label,g=this._resolveTickFontOptions(h),i.font=x=g.string,b=s[x]=s[x]||{data:{},gc:[]},y=g.lineHeight,w=v=0,!Ne(m)&&!qe(m))w=Ip(i,b.data,b.gc,w,m),v=y;else if(qe(m))for(f=0,p=m.length;f<p;++f)S=m[f],!Ne(S)&&!qe(S)&&(w=Ip(i,b.data,b.gc,w,S),v+=y);o.push(w),a.push(v),c=Math.max(w,c),u=Math.max(v,u)}H$(s,t);const k=o.indexOf(c),P=a.indexOf(u),C=T=>({width:o[T]||0,height:a[T]||0});return{first:C(0),last:C(t-1),widest:C(k),highest:C(P),widths:o,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return _O(this._alignToPixels?Ar(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const r=t[e];return r.$context||(r.$context=W$(this.getContext(),e,r))}return this.$context||(this.$context=V$(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=st(this.labelRotation),r=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t)),s=this._getLabelSizes(),o=e.autoSkipPadding||0,a=s?s.widest.width+o:0,l=s?s.highest.height+o:0;return this.isHorizontal()?l*r>a*i?a/r:l/i:l*i<a*r?l/r:a/i}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,r=this.chart,i=this.options,{grid:s,position:o,border:a}=i,l=s.offset,c=this.isHorizontal(),h=this.ticks.length+(l?1:0),f=bs(s),p=[],m=a.setContext(this.getContext()),g=m.display?m.width:0,x=g/2,b=function(E){return Ar(r,E,g)};let y,w,v,S,k,P,C,T,A,M,O,R;if(o==="top")y=b(this.bottom),P=this.bottom-f,T=y-x,M=b(e.top)+x,R=e.bottom;else if(o==="bottom")y=b(this.top),M=e.top,R=b(e.bottom)-x,P=y+x,T=this.top+f;else if(o==="left")y=b(this.right),k=this.right-f,C=y-x,A=b(e.left)+x,O=e.right;else if(o==="right")y=b(this.left),A=e.left,O=b(e.right)-x,k=y+x,C=this.left+f;else if(t==="x"){if(o==="center")y=b((e.top+e.bottom)/2+.5);else if(Ae(o)){const E=Object.keys(o)[0],D=o[E];y=b(this.chart.scales[E].getPixelForValue(D))}M=e.top,R=e.bottom,P=y+x,T=P+f}else if(t==="y"){if(o==="center")y=b((e.left+e.right)/2);else if(Ae(o)){const E=Object.keys(o)[0],D=o[E];y=b(this.chart.scales[E].getPixelForValue(D))}k=y-x,C=k-f,A=e.left,O=e.right}const j=Ce(i.ticks.maxTicksLimit,h),I=Math.max(1,Math.ceil(h/j));for(w=0;w<h;w+=I){const E=this.getContext(w),D=s.setContext(E),L=a.setContext(E),z=D.lineWidth,B=D.color,N=L.dash||[],U=L.dashOffset,q=D.tickWidth,X=D.tickColor,J=D.tickBorderDash||[],ee=D.tickBorderDashOffset;v=B$(this,w,l),v!==void 0&&(S=Ar(r,v,z),c?k=C=A=O=S:P=T=M=R=S,p.push({tx1:k,ty1:P,tx2:C,ty2:T,x1:A,y1:M,x2:O,y2:R,width:z,color:B,borderDash:N,borderDashOffset:U,tickWidth:q,tickColor:X,tickBorderDash:J,tickBorderDashOffset:ee}))}return this._ticksLength=h,this._borderValue=y,p}_computeLabelItems(e){const t=this.axis,r=this.options,{position:i,ticks:s}=r,o=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:u,mirror:h}=s,f=bs(r.grid),p=f+u,m=h?-u:p,g=-st(this.labelRotation),x=[];let b,y,w,v,S,k,P,C,T,A,M,O,R="middle";if(i==="top")k=this.bottom-m,P=this._getXAxisLabelAlignment();else if(i==="bottom")k=this.top+m,P=this._getXAxisLabelAlignment();else if(i==="left"){const I=this._getYAxisLabelAlignment(f);P=I.textAlign,S=I.x}else if(i==="right"){const I=this._getYAxisLabelAlignment(f);P=I.textAlign,S=I.x}else if(t==="x"){if(i==="center")k=(e.top+e.bottom)/2+p;else if(Ae(i)){const I=Object.keys(i)[0],E=i[I];k=this.chart.scales[I].getPixelForValue(E)+p}P=this._getXAxisLabelAlignment()}else if(t==="y"){if(i==="center")S=(e.left+e.right)/2-p;else if(Ae(i)){const I=Object.keys(i)[0],E=i[I];S=this.chart.scales[I].getPixelForValue(E)}P=this._getYAxisLabelAlignment(f).textAlign}t==="y"&&(l==="start"?R="top":l==="end"&&(R="bottom"));const j=this._getLabelSizes();for(b=0,y=a.length;b<y;++b){w=a[b],v=w.label;const I=s.setContext(this.getContext(b));C=this.getPixelForTick(b)+s.labelOffset,T=this._resolveTickFontOptions(b),A=T.lineHeight,M=qe(v)?v.length:1;const E=M/2,D=I.color,L=I.textStrokeColor,z=I.textStrokeWidth;let B=P;o?(S=C,P==="inner"&&(b===y-1?B=this.options.reverse?"left":"right":b===0?B=this.options.reverse?"right":"left":B="center"),i==="top"?c==="near"||g!==0?O=-M*A+A/2:c==="center"?O=-j.highest.height/2-E*A+A:O=-j.highest.height+A/2:c==="near"||g!==0?O=A/2:c==="center"?O=j.highest.height/2-E*A:O=j.highest.height-M*A,h&&(O*=-1),g!==0&&!I.showLabelBackdrop&&(S+=A/2*Math.sin(g))):(k=C,O=(1-M)*A/2);let N;if(I.showLabelBackdrop){const U=wt(I.backdropPadding),q=j.heights[b],X=j.widths[b];let J=O-U.top,ee=0-U.left;switch(R){case"middle":J-=q/2;break;case"bottom":J-=q;break}switch(P){case"center":ee-=X/2;break;case"right":ee-=X;break;case"inner":b===y-1?ee-=X:b>0&&(ee-=X/2);break}N={left:ee,top:J,width:X+U.width,height:q+U.height,color:I.backdropColor}}x.push({label:v,font:T,textOffset:O,options:{rotation:g,color:D,strokeColor:L,strokeWidth:z,textAlign:B,textBaseline:R,translation:[S,k],backdrop:N}})}return x}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-st(this.labelRotation))return e==="top"?"left":"right";let i="center";return t.align==="start"?i="left":t.align==="end"?i="right":t.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:r,mirror:i,padding:s}}=this.options,o=this._getLabelSizes(),a=e+s,l=o.widest.width;let c,u;return t==="left"?i?(u=this.right+s,r==="near"?c="left":r==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-a,r==="near"?c="right":r==="center"?(c="center",u-=l/2):(c="left",u=this.left)):t==="right"?i?(u=this.left+s,r==="near"?c="right":r==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+a,r==="near"?c="left":r==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:r,top:i,width:s,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(r,i,s,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const i=this.ticks.findIndex(s=>s.value===e);return i>=0?t.setContext(this.getContext(i)).lineWidth:0}drawGrid(e){const t=this.options.grid,r=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,o;const a=(l,c,u)=>{!u.width||!u.color||(r.save(),r.lineWidth=u.width,r.strokeStyle=u.color,r.setLineDash(u.borderDash||[]),r.lineDashOffset=u.borderDashOffset,r.beginPath(),r.moveTo(l.x,l.y),r.lineTo(c.x,c.y),r.stroke(),r.restore())};if(t.display)for(s=0,o=i.length;s<o;++s){const l=i[s];t.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),t.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:r,grid:i}}=this,s=r.setContext(this.getContext()),o=r.display?s.width:0;if(!o)return;const a=i.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,u,h,f;this.isHorizontal()?(c=Ar(e,this.left,o)-o/2,u=Ar(e,this.right,a)+a/2,h=f=l):(h=Ar(e,this.top,o)-o/2,f=Ar(e,this.bottom,a)+a/2,c=u=l),t.save(),t.lineWidth=s.width,t.strokeStyle=s.color,t.beginPath(),t.moveTo(c,h),t.lineTo(u,f),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const r=this.ctx,i=this._computeLabelArea();i&&Ql(r,i);const s=this.getLabelItems(e);for(const o of s){const a=o.options,l=o.font,c=o.label,u=o.textOffset;il(r,c,0,u,l,a)}i&&ec(r)}drawTitle(){const{ctx:e,options:{position:t,title:r,reverse:i}}=this;if(!r.display)return;const s=ht(r.font),o=wt(r.padding),a=r.align;let l=s.lineHeight/2;t==="bottom"||t==="center"||Ae(t)?(l+=o.bottom,qe(r.text)&&(l+=s.lineHeight*(r.text.length-1))):l+=o.top;const{titleX:c,titleY:u,maxWidth:h,rotation:f}=q$(this,l,t,a);il(e,r.text,0,0,s,{color:r.color,maxWidth:h,rotation:f,textAlign:U$(a,t,i),textBaseline:"middle",translation:[c,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,r=Ce(e.grid&&e.grid.z,-1),i=Ce(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==is.prototype.draw?[{z:t,draw:s=>{this.draw(s)}}]:[{z:r,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:t,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",i=[];let s,o;for(s=0,o=t.length;s<o;++s){const a=t[s];a[r]===this.id&&(!e||a.type===e)&&i.push(a)}return i}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return ht(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class ca{constructor(e,t,r){this.type=e,this.scope=t,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let r;Y$(t)&&(r=this.register(t));const i=this.items,s=e.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in i||(i[s]=e,X$(e,o,r),this.override&&Ze.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,r=e.id,i=this.scope;r in t&&delete t[r],i&&r in Ze[i]&&(delete Ze[i][r],this.override&&delete si[r])}}function X$(n,e,t){const r=eo(Object.create(null),[t?Ze.get(t):{},Ze.get(e),n.defaults]);Ze.set(e,r),n.defaultRoutes&&G$(e,n.defaultRoutes),n.descriptors&&Ze.describe(e,n.descriptors)}function G$(n,e){Object.keys(e).forEach(t=>{const r=t.split("."),i=r.pop(),s=[n].concat(r).join("."),o=e[t].split("."),a=o.pop(),l=o.join(".");Ze.route(s,i,l,a)})}function Y$(n){return"id"in n&&"defaults"in n}class K${constructor(){this.controllers=new ca(nc,"datasets",!0),this.elements=new ca(Nt,"elements"),this.plugins=new ca(Object,"plugins"),this.scales=new ca(is,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,r){[...t].forEach(i=>{const s=r||this._getRegistryForType(i);r||s.isForType(i)||s===this.plugins&&i.id?this._exec(e,s,i):Fe(i,o=>{const a=r||this._getRegistryForType(o);this._exec(e,a,o)})})}_exec(e,t,r){const i=dh(e);Be(r["before"+i],[],r),t[e](r),Be(r["after"+i],[],r)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const r=this._typedRegistries[t];if(r.isForType(e))return r}return this.plugins}_get(e,t,r){const i=t.get(e);if(i===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return i}}var jn=new K$;class Z${constructor(){this._init=[]}notify(e,t,r,i){t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const s=i?this._descriptors(e).filter(i):this._descriptors(e),o=this._notify(s,e,t,r);return t==="afterDestroy"&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall")),o}_notify(e,t,r,i){i=i||{};for(const s of e){const o=s.plugin,a=o[r],l=[t,i,s.options];if(Be(a,l,o)===!1&&i.cancelable)return!1}return!0}invalidate(){Ne(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const r=e&&e.config,i=Ce(r.options&&r.options.plugins,{}),s=J$(r);return i===!1&&!t?[]:eD(e,s,i,t)}_notifyStateChanges(e){const t=this._oldCache||[],r=this._cache,i=(s,o)=>s.filter(a=>!o.some(l=>a.plugin.id===l.plugin.id));this._notify(i(t,r),e,"stop"),this._notify(i(r,t),e,"start")}}function J$(n){const e={},t=[],r=Object.keys(jn.plugins.items);for(let s=0;s<r.length;s++)t.push(jn.getPlugin(r[s]));const i=n.plugins||[];for(let s=0;s<i.length;s++){const o=i[s];t.indexOf(o)===-1&&(t.push(o),e[o.id]=!0)}return{plugins:t,localIds:e}}function Q$(n,e){return!e&&n===!1?null:n===!0?{}:n}function eD(n,{plugins:e,localIds:t},r,i){const s=[],o=n.getContext();for(const a of e){const l=a.id,c=Q$(r[l],i);c!==null&&s.push({plugin:a,options:tD(n.config,{plugin:a,local:t[l]},c,o)})}return s}function tD(n,{plugin:e,local:t},r,i){const s=n.pluginScopeKeys(e),o=n.getOptionScopes(r,s);return t&&e.defaults&&o.push(e.defaults),n.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Nu(n,e){const t=Ze.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function nD(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function rD(n,e){return n===e?"_index_":"_value_"}function om(n){if(n==="x"||n==="y"||n==="r")return n}function iD(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function Lu(n,...e){if(om(n))return n;for(const t of e){const r=t.axis||iD(t.position)||n.length>1&&om(n[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function am(n,e,t){if(t[e+"AxisID"]===n)return{axis:e}}function sD(n,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(r=>r.xAxisID===n||r.yAxisID===n);if(t.length)return am(n,"x",t[0])||am(n,"y",t[0])}return{}}function oD(n,e){const t=si[n.type]||{scales:{}},r=e.scales||{},i=Nu(n.type,e),s=Object.create(null);return Object.keys(r).forEach(o=>{const a=r[o];if(!Ae(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const l=Lu(o,a,sD(o,n),Ze.scales[a.type]),c=rD(l,i),u=t.scales||{};s[o]=$s(Object.create(null),[{axis:l},a,u[l],u[c]])}),n.data.datasets.forEach(o=>{const a=o.type||n.type,l=o.indexAxis||Nu(a,e),u=(si[a]||{}).scales||{};Object.keys(u).forEach(h=>{const f=nD(h,l),p=o[f+"AxisID"]||f;s[p]=s[p]||Object.create(null),$s(s[p],[{axis:f},r[p],u[h]])})}),Object.keys(s).forEach(o=>{const a=s[o];$s(a,[Ze.scales[a.type],Ze.scale])}),s}function Lv(n){const e=n.options||(n.options={});e.plugins=Ce(e.plugins,{}),e.scales=oD(n,e)}function Fv(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function aD(n){return n=n||{},n.data=Fv(n.data),Lv(n),n}const lm=new Map,zv=new Set;function ua(n,e){let t=lm.get(n);return t||(t=e(),lm.set(n,t),zv.add(t)),t}const ys=(n,e,t)=>{const r=ri(e,t);r!==void 0&&n.add(r)};class lD{constructor(e){this._config=aD(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=Fv(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),Lv(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return ua(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return ua(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return ua(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,r=this.type;return ua(`${r}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const r=this._scopeCache;let i=r.get(e);return(!i||t)&&(i=new Map,r.set(e,i)),i}getOptionScopes(e,t,r){const{options:i,type:s}=this,o=this._cachedScopes(e,r),a=o.get(t);if(a)return a;const l=new Set;t.forEach(u=>{e&&(l.add(e),u.forEach(h=>ys(l,e,h))),u.forEach(h=>ys(l,i,h)),u.forEach(h=>ys(l,si[s]||{},h)),u.forEach(h=>ys(l,Ze,h)),u.forEach(h=>ys(l,$u,h))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),zv.has(t)&&o.set(t,c),c}chartOptionScopes(){const{options:e,type:t}=this;return[e,si[t]||{},Ze.datasets[t]||{},{type:t},Ze,$u]}resolveNamedOptions(e,t,r,i=[""]){const s={$shared:!0},{resolver:o,subPrefixes:a}=cm(this._resolverCache,e,i);let l=o;if(uD(o,t)){s.$shared=!1,r=Rt(r)?r():r;const c=this.createResolver(e,r,a);l=Vi(o,r,c)}for(const c of t)s[c]=l[c];return s}createResolver(e,t,r=[""],i){const{resolver:s}=cm(this._resolverCache,e,r);return Ae(t)?Vi(s,t,void 0,i):s}}function cm(n,e,t){let r=n.get(e);r||(r=new Map,n.set(e,r));const i=t.join();let s=r.get(i);return s||(s={resolver:gh(e,t),subPrefixes:t.filter(a=>!a.toLowerCase().includes("hover"))},r.set(i,s)),s}const cD=n=>Ae(n)&&Object.getOwnPropertyNames(n).some(e=>Rt(n[e]));function uD(n,e){const{isScriptable:t,isIndexable:r}=Sv(n);for(const i of e){const s=t(i),o=r(i),a=(o||s)&&n[i];if(s&&(Rt(a)||cD(a))||o&&qe(a))return!0}return!1}var dD="4.5.0";const hD=["top","bottom","left","right","chartArea"];function um(n,e){return n==="top"||n==="bottom"||hD.indexOf(n)===-1&&e==="x"}function dm(n,e){return function(t,r){return t[n]===r[n]?t[e]-r[e]:t[n]-r[n]}}function hm(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),Be(t&&t.onComplete,[n],e)}function fD(n){const e=n.chart,t=e.options.animation;Be(t&&t.onProgress,[n],e)}function Bv(n){return yh()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const Ta={},fm=n=>{const e=Bv(n);return Object.values(Ta).filter(t=>t.canvas===e).pop()};function pD(n,e,t){const r=Object.keys(n);for(const i of r){const s=+i;if(s>=e){const o=n[i];delete n[i],(t>0||s>e)&&(n[s+t]=o)}}}function mD(n,e,t,r){return!t||n.type==="mouseout"?null:r?e:n}let Dn=class{static defaults=Ze;static instances=Ta;static overrides=si;static registry=jn;static version=dD;static getChart=fm;static register(...e){jn.add(...e),pm()}static unregister(...e){jn.remove(...e),pm()}constructor(e,t){const r=this.config=new lD(t),i=Bv(e),s=fm(i);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const o=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||R$(i)),this.platform.updateConfig(r);const a=this.platform.acquireContext(i,o.aspectRatio),l=a&&a.canvas,c=l&&l.height,u=l&&l.width;if(this.id=cO(),this.ctx=a,this.canvas=l,this.width=u,this.height=c,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Z$,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=kO(h=>this.update(h),o.resizeDelay||0),this._dataChanges=[],Ta[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Xn.listen(this,"complete",hm),Xn.listen(this,"progress",fD),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:r,height:i,_aspectRatio:s}=this;return Ne(e)?t&&s?s:i?r/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return jn}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Dp(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Rp(this.canvas,this.ctx),this}stop(){return Xn.stop(this),this}resize(e,t){Xn.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const r=this.options,i=this.canvas,s=r.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(i,e,t,s),a=r.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,Dp(this,a,!0)&&(this.notifyPlugins("resize",{size:o}),Be(r.onResize,[this,o],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};Fe(t,(r,i)=>{r.id=i})}buildOrUpdateScales(){const e=this.options,t=e.scales,r=this.scales,i=Object.keys(r).reduce((o,a)=>(o[a]=!1,o),{});let s=[];t&&(s=s.concat(Object.keys(t).map(o=>{const a=t[o],l=Lu(o,a),c=l==="r",u=l==="x";return{options:a,dposition:c?"chartArea":u?"bottom":"left",dtype:c?"radialLinear":u?"category":"linear"}}))),Fe(s,o=>{const a=o.options,l=a.id,c=Lu(l,a),u=Ce(a.type,o.dtype);(a.position===void 0||um(a.position,c)!==um(o.dposition))&&(a.position=o.dposition),i[l]=!0;let h=null;if(l in r&&r[l].type===u)h=r[l];else{const f=jn.getScale(u);h=new f({id:l,type:u,ctx:this.ctx,chart:this}),r[h.id]=h}h.init(a,e)}),Fe(i,(o,a)=>{o||delete r[a]}),Fe(r,o=>{xr.configure(this,o,o.options),xr.addBox(this,o)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,r=e.length;if(e.sort((i,s)=>i.index-s.index),r>t){for(let i=t;i<r;++i)this._destroyDatasetMeta(i);e.splice(t,r-t)}this._sortedMetasets=e.slice(0).sort(dm("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((r,i)=>{t.filter(s=>s===r._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let r,i;for(this._removeUnreferencedMetasets(),r=0,i=t.length;r<i;r++){const s=t[r];let o=this.getDatasetMeta(r);const a=s.type||this.config.type;if(o.type&&o.type!==a&&(this._destroyDatasetMeta(r),o=this.getDatasetMeta(r)),o.type=a,o.indexAxis=s.indexAxis||Nu(a,this.options),o.order=s.order||0,o.index=r,o.label=""+s.label,o.visible=this.isDatasetVisible(r),o.controller)o.controller.updateIndex(r),o.controller.linkScales();else{const l=jn.getController(a),{datasetElementType:c,dataElementType:u}=Ze.datasets[a];Object.assign(l,{dataElementType:jn.getElement(u),datasetElementType:c&&jn.getElement(c)}),o.controller=new l(this,r),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){Fe(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const r=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let c=0,u=this.data.datasets.length;c<u;c++){const{controller:h}=this.getDatasetMeta(c),f=!i&&s.indexOf(h)===-1;h.buildOrUpdateElements(f),o=Math.max(+h.getMaxOverflow(),o)}o=this._minPadding=r.layout.autoPadding?o:0,this._updateLayout(o),i||Fe(s,c=>{c.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(dm("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){Fe(this.scales,e=>{xr.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!Pp(t,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:r,start:i,count:s}of t){const o=r==="_removeElements"?-s:s;pD(e,i,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,r=s=>new Set(e.filter(o=>o[0]===s).map((o,a)=>a+","+o.splice(1).join(","))),i=r(0);for(let s=1;s<t;s++)if(!Pp(i,r(s)))return;return Array.from(i).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;xr.update(this,this.width,this.height,e);const t=this.chartArea,r=t.width<=0||t.height<=0;this._layers=[],Fe(this.boxes,i=>{r&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,s)=>{i._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,r=this.data.datasets.length;t<r;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,r=this.data.datasets.length;t<r;++t)this._updateDataset(t,Rt(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const r=this.getDatasetMeta(e),i={meta:r,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(r.controller._update(t),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Xn.has(this)?this.attached&&!Xn.running(this)&&Xn.start(this):(this.draw(),hm({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,r=[];let i,s;for(i=0,s=t.length;i<s;++i){const o=t[i];(!e||o.visible)&&r.push(o)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,r={meta:e,index:e.index,cancelable:!0},i=I4(this,e);this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(i&&Ql(t,i),e.controller.draw(),i&&ec(t),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(e){return to(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,r,i){const s=h$.modes[t];return typeof s=="function"?s(this,e,r,i):[]}getDatasetMeta(e){const t=this.data.datasets[e],r=this._metasets;let i=r.filter(s=>s&&s._dataset===t).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},r.push(i)),i}getContext(){return this.$context||(this.$context=ui(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!t.hidden}setDatasetVisibility(e,t){const r=this.getDatasetMeta(e);r.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,r){const i=r?"show":"hide",s=this.getDatasetMeta(e),o=s.controller._resolveAnimations(void 0,i);$t(t)?(s.data[t].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),o.update(s,{visible:r}),this.update(a=>a.datasetIndex===e?i:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),Xn.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Rp(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete Ta[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,r=(s,o)=>{t.addEventListener(this,s,o),e[s]=o},i=(s,o,a)=>{s.offsetX=o,s.offsetY=a,this._eventHandler(s)};Fe(this.options.events,s=>r(s,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,r=(l,c)=>{t.addEventListener(this,l,c),e[l]=c},i=(l,c)=>{e[l]&&(t.removeEventListener(this,l,c),delete e[l])},s=(l,c)=>{this.canvas&&this.resize(l,c)};let o;const a=()=>{i("attach",a),this.attached=!0,this.resize(),r("resize",s),r("detach",o)};o=()=>{this.attached=!1,i("resize",s),this._stop(),this._resize(0,0),r("attach",a)},t.isAttached(this.canvas)?a():o()}unbindEvents(){Fe(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},Fe(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,r){const i=r?"set":"remove";let s,o,a,l;for(t==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+i+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){o=e[a];const c=o&&this.getDatasetMeta(o.datasetIndex).controller;c&&c[i+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],r=e.map(({datasetIndex:s,index:o})=>{const a=this.getDatasetMeta(s);if(!a)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:a.data[o],index:o}});!Qa(r,t)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,t))}notifyPlugins(e,t,r){return this._plugins.notify(this,e,t,r)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,r){const i=this.options.hover,s=(l,c)=>l.filter(u=>!c.some(h=>u.datasetIndex===h.datasetIndex&&u.index===h.index)),o=s(t,e),a=r?e:s(e,t);o.length&&this.updateHoverStyle(o,i.mode,!1),a.length&&i.mode&&this.updateHoverStyle(a,i.mode,!0)}_eventHandler(e,t){const r={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},i=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,i)===!1)return;const s=this._handleEvent(e,t,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,i),(s||r.changed)&&this.render(),this}_handleEvent(e,t,r){const{_active:i=[],options:s}=this,o=t,a=this._getActiveElements(e,i,r,o),l=mO(e),c=mD(e,this._lastEvent,r,l);r&&(this._lastEvent=null,Be(s.onHover,[e,a,this],this),l&&Be(s.onClick,[e,a,this],this));const u=!Qa(a,i);return(u||t)&&(this._active=a,this._updateHoverStyles(a,i,t)),this._lastEvent=c,u}_getActiveElements(e,t,r,i){if(e.type==="mouseout")return[];if(!r)return t;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,i)}};function pm(){return Fe(Dn.instances,n=>n._plugins.invalidate())}function Hv(n,e,t=e){n.lineCap=Ce(t.borderCapStyle,e.borderCapStyle),n.setLineDash(Ce(t.borderDash,e.borderDash)),n.lineDashOffset=Ce(t.borderDashOffset,e.borderDashOffset),n.lineJoin=Ce(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=Ce(t.borderWidth,e.borderWidth),n.strokeStyle=Ce(t.borderColor,e.borderColor)}function gD(n,e,t){n.lineTo(t.x,t.y)}function xD(n){return n.stepped?zO:n.tension||n.cubicInterpolationMode==="monotone"?BO:gD}function Vv(n,e,t={}){const r=n.length,{start:i=0,end:s=r-1}=t,{start:o,end:a}=e,l=Math.max(i,o),c=Math.min(s,a),u=i<o&&s<o||i>a&&s>a;return{count:r,start:l,loop:e.loop,ilen:c<l&&!u?r+c-l:c-l}}function bD(n,e,t,r){const{points:i,options:s}=e,{count:o,start:a,loop:l,ilen:c}=Vv(i,t,r),u=xD(s);let{move:h=!0,reverse:f}=r||{},p,m,g;for(p=0;p<=c;++p)m=i[(a+(f?c-p:p))%o],!m.skip&&(h?(n.moveTo(m.x,m.y),h=!1):u(n,g,m,f,s.stepped),g=m);return l&&(m=i[(a+(f?c:0))%o],u(n,g,m,f,s.stepped)),!!l}function yD(n,e,t,r){const i=e.points,{count:s,start:o,ilen:a}=Vv(i,t,r),{move:l=!0,reverse:c}=r||{};let u=0,h=0,f,p,m,g,x,b;const y=v=>(o+(c?a-v:v))%s,w=()=>{g!==x&&(n.lineTo(u,x),n.lineTo(u,g),n.lineTo(u,b))};for(l&&(p=i[y(0)],n.moveTo(p.x,p.y)),f=0;f<=a;++f){if(p=i[y(f)],p.skip)continue;const v=p.x,S=p.y,k=v|0;k===m?(S<g?g=S:S>x&&(x=S),u=(h*u+v)/++h):(w(),n.lineTo(v,S),m=k,h=0,g=x=S),b=S}w()}function Fu(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?yD:bD}function vD(n){return n.stepped?y4:n.tension||n.cubicInterpolationMode==="monotone"?v4:$r}function wD(n,e,t,r){let i=e._path;i||(i=e._path=new Path2D,e.path(i,t,r)&&i.closePath()),Hv(n,e.options),n.stroke(i)}function _D(n,e,t,r){const{segments:i,options:s}=e,o=Fu(e);for(const a of i)Hv(n,s,a.style),n.beginPath(),o(n,e,a,{start:t,end:t+r-1})&&n.closePath(),n.stroke()}const SD=typeof Path2D=="function";function PD(n,e,t,r){SD&&!e.options.segment?wD(n,e,t,r):_D(n,e,t,r)}class CD extends Nt{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){const i=r.spanGaps?this._loop:this._fullLoop;d4(this._points,r,e,i,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=T4(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,r=e.length;return r&&t[e[r-1].end]}interpolate(e,t){const r=this.options,i=e[t],s=this.points,o=C4(this,{property:t,start:i,end:i});if(!o.length)return;const a=[],l=vD(r);let c,u;for(c=0,u=o.length;c<u;++c){const{start:h,end:f}=o[c],p=s[h],m=s[f];if(p===m){a.push(p);continue}const g=Math.abs((i-p[t])/(m[t]-p[t])),x=l(p,m,g,r.stepped);x[t]=e[t],a.push(x)}return a.length===1?a[0]:a}pathSegment(e,t,r){return Fu(this)(e,this,t,r)}path(e,t,r){const i=this.segments,s=Fu(this);let o=this._loop;t=t||0,r=r||this.points.length-t;for(const a of i)o&=s(e,this,a,{start:t,end:t+r-1});return!!o}draw(e,t,r,i){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),PD(e,this,r,i),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function mm(n,e,t,r){const i=n.options,{[t]:s}=n.getProps([t],r);return Math.abs(e-s)<i.radius+i.hitRadius}class kD extends Nt{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,r){const i=this.options,{x:s,y:o}=this.getProps(["x","y"],r);return Math.pow(e-s,2)+Math.pow(t-o,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(e,t){return mm(this,e,"x",t)}inYRange(e,t){return mm(this,e,"y",t)}getCenterPoint(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}size(e){e=e||this.options||{};let t=e.radius||0;t=Math.max(t,t&&e.hoverRadius||0);const r=t&&e.borderWidth||0;return(t+r)*2}draw(e,t){const r=this.options;this.skip||r.radius<.1||!to(this,t,this.size(r)/2)||(e.strokeStyle=r.borderColor,e.lineWidth=r.borderWidth,e.fillStyle=r.backgroundColor,Du(e,r,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function Wv(n,e){const{x:t,y:r,base:i,width:s,height:o}=n.getProps(["x","y","base","width","height"],e);let a,l,c,u,h;return n.horizontal?(h=o/2,a=Math.min(t,i),l=Math.max(t,i),c=r-h,u=r+h):(h=s/2,a=t-h,l=t+h,c=Math.min(r,i),u=Math.max(r,i)),{left:a,top:c,right:l,bottom:u}}function br(n,e,t,r){return n?0:Bt(e,t,r)}function jD(n,e,t){const r=n.options.borderWidth,i=n.borderSkipped,s=_v(r);return{t:br(i.top,s.top,0,t),r:br(i.right,s.right,0,e),b:br(i.bottom,s.bottom,0,t),l:br(i.left,s.left,0,e)}}function TD(n,e,t){const{enableBorderRadius:r}=n.getProps(["enableBorderRadius"]),i=n.options.borderRadius,s=Gr(i),o=Math.min(e,t),a=n.borderSkipped,l=r||Ae(i);return{topLeft:br(!l||a.top||a.left,s.topLeft,0,o),topRight:br(!l||a.top||a.right,s.topRight,0,o),bottomLeft:br(!l||a.bottom||a.left,s.bottomLeft,0,o),bottomRight:br(!l||a.bottom||a.right,s.bottomRight,0,o)}}function MD(n){const e=Wv(n),t=e.right-e.left,r=e.bottom-e.top,i=jD(n,t/2,r/2),s=TD(n,t/2,r/2);return{outer:{x:e.left,y:e.top,w:t,h:r,radius:s},inner:{x:e.left+i.l,y:e.top+i.t,w:t-i.l-i.r,h:r-i.t-i.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,s.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(i.b,i.r))}}}}function Wc(n,e,t,r){const i=e===null,s=t===null,a=n&&!(i&&s)&&Wv(n,r);return a&&(i||Br(e,a.left,a.right))&&(s||Br(t,a.top,a.bottom))}function AD(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function ED(n,e){n.rect(e.x,e.y,e.w,e.h)}function Uc(n,e,t={}){const r=n.x!==t.x?-e:0,i=n.y!==t.y?-e:0,s=(n.x+n.w!==t.x+t.w?e:0)-r,o=(n.y+n.h!==t.y+t.h?e:0)-i;return{x:n.x+r,y:n.y+i,w:n.w+s,h:n.h+o,radius:n.radius}}class Sh extends Nt{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:r,backgroundColor:i}}=this,{inner:s,outer:o}=MD(this),a=AD(o.radius)?no:ED;e.save(),(o.w!==s.w||o.h!==s.h)&&(e.beginPath(),a(e,Uc(o,t,s)),e.clip(),a(e,Uc(s,-t,o)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),a(e,Uc(s,t)),e.fillStyle=i,e.fill(),e.restore()}inRange(e,t,r){return Wc(this,e,t,r)}inXRange(e,t){return Wc(this,e,null,t)}inYRange(e,t){return Wc(this,null,e,t)}getCenterPoint(e){const{x:t,y:r,base:i,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(t+i)/2:t,y:s?r:(r+i)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}const gm=(n,e)=>{let{boxHeight:t=e,boxWidth:r=e}=n;return n.usePointStyle&&(t=Math.min(t,e),r=n.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:t,itemHeight:Math.max(e,t)}},ID=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class xm extends Nt{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,r){this.maxWidth=e,this.maxHeight=t,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Be(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(r=>e.filter(r,this.chart.data))),e.sort&&(t=t.sort((r,i)=>e.sort(r,i,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const r=e.labels,i=ht(r.font),s=i.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=gm(r,s);let c,u;t.font=i.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(o,s,a,l)+10):(u=this.maxHeight,c=this._fitCols(o,i,a,l)+10),this.width=Math.min(c,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,t,r,i){const{ctx:s,maxWidth:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=i+a;let h=e;s.textAlign="left",s.textBaseline="middle";let f=-1,p=-u;return this.legendItems.forEach((m,g)=>{const x=r+t/2+s.measureText(m.text).width;(g===0||c[c.length-1]+x+2*a>o)&&(h+=u,c[c.length-(g>0?0:1)]=0,p+=u,f++),l[g]={left:0,top:p,row:f,width:x,height:i},c[c.length-1]+=x+a}),h}_fitCols(e,t,r,i){const{ctx:s,maxHeight:o,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=o-e;let h=a,f=0,p=0,m=0,g=0;return this.legendItems.forEach((x,b)=>{const{itemWidth:y,itemHeight:w}=RD(r,t,s,x,i);b>0&&p+w+2*a>u&&(h+=f+a,c.push({width:f,height:p}),m+=f+a,g++,f=p=0),l[b]={left:m,top:p,col:g,width:y,height:w},f=Math.max(f,y),p+=w+a}),h+=f,c.push({width:f,height:p}),h}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:r,labels:{padding:i},rtl:s}}=this,o=Oi(s,this.left,this.width);if(this.isHorizontal()){let a=0,l=Ft(r,this.left+i,this.right-this.lineWidths[a]);for(const c of t)a!==c.row&&(a=c.row,l=Ft(r,this.left+i,this.right-this.lineWidths[a])),c.top+=this.top+e+i,c.left=o.leftForLtr(o.x(l),c.width),l+=c.width+i}else{let a=0,l=Ft(r,this.top+e+i,this.bottom-this.columnSizes[a].height);for(const c of t)c.col!==a&&(a=c.col,l=Ft(r,this.top+e+i,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+i,c.left=o.leftForLtr(o.x(c.left),c.width),l+=c.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Ql(e,this),this._draw(),ec(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:r,ctx:i}=this,{align:s,labels:o}=e,a=Ze.color,l=Oi(e.rtl,this.left,this.width),c=ht(o.font),{padding:u}=o,h=c.size,f=h/2;let p;this.drawTitle(),i.textAlign=l.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=c.string;const{boxWidth:m,boxHeight:g,itemHeight:x}=gm(o,h),b=function(k,P,C){if(isNaN(m)||m<=0||isNaN(g)||g<0)return;i.save();const T=Ce(C.lineWidth,1);if(i.fillStyle=Ce(C.fillStyle,a),i.lineCap=Ce(C.lineCap,"butt"),i.lineDashOffset=Ce(C.lineDashOffset,0),i.lineJoin=Ce(C.lineJoin,"miter"),i.lineWidth=T,i.strokeStyle=Ce(C.strokeStyle,a),i.setLineDash(Ce(C.lineDash,[])),o.usePointStyle){const A={radius:g*Math.SQRT2/2,pointStyle:C.pointStyle,rotation:C.rotation,borderWidth:T},M=l.xPlus(k,m/2),O=P+f;vv(i,A,M,O,o.pointStyleWidth&&m)}else{const A=P+Math.max((h-g)/2,0),M=l.leftForLtr(k,m),O=Gr(C.borderRadius);i.beginPath(),Object.values(O).some(R=>R!==0)?no(i,{x:M,y:A,w:m,h:g,radius:O}):i.rect(M,A,m,g),i.fill(),T!==0&&i.stroke()}i.restore()},y=function(k,P,C){il(i,C.text,k,P+x/2,c,{strikethrough:C.hidden,textAlign:l.textAlign(C.textAlign)})},w=this.isHorizontal(),v=this._computeTitleHeight();w?p={x:Ft(s,this.left+u,this.right-r[0]),y:this.top+u+v,line:0}:p={x:this.left+u,y:Ft(s,this.top+v+u,this.bottom-t[0].height),line:0},Tv(this.ctx,e.textDirection);const S=x+u;this.legendItems.forEach((k,P)=>{i.strokeStyle=k.fontColor,i.fillStyle=k.fontColor;const C=i.measureText(k.text).width,T=l.textAlign(k.textAlign||(k.textAlign=o.textAlign)),A=m+f+C;let M=p.x,O=p.y;l.setWidth(this.width),w?P>0&&M+A+u>this.right&&(O=p.y+=S,p.line++,M=p.x=Ft(s,this.left+u,this.right-r[p.line])):P>0&&O+S>this.bottom&&(M=p.x=M+t[p.line].width+u,p.line++,O=p.y=Ft(s,this.top+v+u,this.bottom-t[p.line].height));const R=l.x(M);if(b(R,O,k),M=jO(T,M+m+f,w?M+A:this.right,e.rtl),y(l.x(M),O,k),w)p.x+=A+u;else if(typeof k.text!="string"){const j=c.lineHeight;p.y+=Uv(k,j)+u}else p.y+=S}),Mv(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,r=ht(t.font),i=wt(t.padding);if(!t.display)return;const s=Oi(e.rtl,this.left,this.width),o=this.ctx,a=t.position,l=r.size/2,c=i.top+l;let u,h=this.left,f=this.width;if(this.isHorizontal())f=Math.max(...this.lineWidths),u=this.top+c,h=Ft(e.align,h,this.right-f);else{const m=this.columnSizes.reduce((g,x)=>Math.max(g,x.height),0);u=c+Ft(e.align,this.top,this.bottom-m-e.labels.padding-this._computeTitleHeight())}const p=Ft(a,h,h+f);o.textAlign=s.textAlign(bv(a)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=r.string,il(o,t.text,p,u,r)}_computeTitleHeight(){const e=this.options.title,t=ht(e.font),r=wt(e.padding);return e.display?t.lineHeight+r.height:0}_getLegendItemAt(e,t){let r,i,s;if(Br(e,this.left,this.right)&&Br(t,this.top,this.bottom)){for(s=this.legendHitBoxes,r=0;r<s.length;++r)if(i=s[r],Br(e,i.left,i.left+i.width)&&Br(t,i.top,i.top+i.height))return this.legendItems[r]}return null}handleEvent(e){const t=this.options;if(!DD(e.type,t))return;const r=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const i=this._hoveredItem,s=ID(i,r);i&&!s&&Be(t.onLeave,[e,i,this],this),this._hoveredItem=r,r&&!s&&Be(t.onHover,[e,r,this],this)}else r&&Be(t.onClick,[e,r,this],this)}}function RD(n,e,t,r,i){const s=OD(r,n,e,t),o=$D(i,r,e.lineHeight);return{itemWidth:s,itemHeight:o}}function OD(n,e,t,r){let i=n.text;return i&&typeof i!="string"&&(i=i.reduce((s,o)=>s.length>o.length?s:o)),e+t.size/2+r.measureText(i).width}function $D(n,e,t){let r=n;return typeof e.text!="string"&&(r=Uv(e,t)),r}function Uv(n,e){const t=n.text?n.text.length:0;return e*t}function DD(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var ND={id:"legend",_element:xm,start(n,e,t){const r=n.legend=new xm({ctx:n.ctx,options:t,chart:n});xr.configure(n,r,t),xr.addBox(n,r)},stop(n){xr.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const r=n.legend;xr.configure(n,r,t),r.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const r=e.datasetIndex,i=t.chart;i.isDatasetVisible(r)?(i.hide(r),e.hidden=!0):(i.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:r,textAlign:i,color:s,useBorderRadius:o,borderRadius:a}}=n.legend.options;return n._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(t?0:void 0),u=wt(c.borderWidth);return{text:e[l.index].label,fillStyle:c.backgroundColor,fontColor:s,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:r||c.pointStyle,rotation:c.rotation,textAlign:i||c.textAlign,borderRadius:o&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};const Ms={average(n){if(!n.length)return!1;let e,t,r=new Set,i=0,s=0;for(e=0,t=n.length;e<t;++e){const a=n[e].element;if(a&&a.hasValue()){const l=a.tooltipPosition();r.add(l.x),i+=l.y,++s}}return s===0||r.size===0?!1:{x:[...r].reduce((a,l)=>a+l)/r.size,y:i/s}},nearest(n,e){if(!n.length)return!1;let t=e.x,r=e.y,i=Number.POSITIVE_INFINITY,s,o,a;for(s=0,o=n.length;s<o;++s){const l=n[s].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),u=Hi(e,c);u<i&&(i=u,a=l)}}if(a){const l=a.tooltipPosition();t=l.x,r=l.y}return{x:t,y:r}}};function kn(n,e){return e&&(qe(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function Gn(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function LD(n,e){const{element:t,datasetIndex:r,index:i}=e,s=n.getDatasetMeta(r).controller,{label:o,value:a}=s.getLabelAndValue(i);return{chart:n,label:o,parsed:s.getParsed(i),raw:n.data.datasets[r].data[i],formattedValue:a,dataset:s.getDataset(),dataIndex:i,datasetIndex:r,element:t}}function bm(n,e){const t=n.chart.ctx,{body:r,footer:i,title:s}=n,{boxWidth:o,boxHeight:a}=e,l=ht(e.bodyFont),c=ht(e.titleFont),u=ht(e.footerFont),h=s.length,f=i.length,p=r.length,m=wt(e.padding);let g=m.height,x=0,b=r.reduce((v,S)=>v+S.before.length+S.lines.length+S.after.length,0);if(b+=n.beforeBody.length+n.afterBody.length,h&&(g+=h*c.lineHeight+(h-1)*e.titleSpacing+e.titleMarginBottom),b){const v=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;g+=p*v+(b-p)*l.lineHeight+(b-1)*e.bodySpacing}f&&(g+=e.footerMarginTop+f*u.lineHeight+(f-1)*e.footerSpacing);let y=0;const w=function(v){x=Math.max(x,t.measureText(v).width+y)};return t.save(),t.font=c.string,Fe(n.title,w),t.font=l.string,Fe(n.beforeBody.concat(n.afterBody),w),y=e.displayColors?o+2+e.boxPadding:0,Fe(r,v=>{Fe(v.before,w),Fe(v.lines,w),Fe(v.after,w)}),y=0,t.font=u.string,Fe(n.footer,w),t.restore(),x+=m.width,{width:x,height:g}}function FD(n,e){const{y:t,height:r}=e;return t<r/2?"top":t>n.height-r/2?"bottom":"center"}function zD(n,e,t,r){const{x:i,width:s}=r,o=t.caretSize+t.caretPadding;if(n==="left"&&i+s+o>e.width||n==="right"&&i-s-o<0)return!0}function BD(n,e,t,r){const{x:i,width:s}=t,{width:o,chartArea:{left:a,right:l}}=n;let c="center";return r==="center"?c=i<=(a+l)/2?"left":"right":i<=s/2?c="left":i>=o-s/2&&(c="right"),zD(c,n,e,t)&&(c="center"),c}function ym(n,e,t){const r=t.yAlign||e.yAlign||FD(n,t);return{xAlign:t.xAlign||e.xAlign||BD(n,e,t,r),yAlign:r}}function HD(n,e){let{x:t,width:r}=n;return e==="right"?t-=r:e==="center"&&(t-=r/2),t}function VD(n,e,t){let{y:r,height:i}=n;return e==="top"?r+=t:e==="bottom"?r-=i+t:r-=i/2,r}function vm(n,e,t,r){const{caretSize:i,caretPadding:s,cornerRadius:o}=n,{xAlign:a,yAlign:l}=t,c=i+s,{topLeft:u,topRight:h,bottomLeft:f,bottomRight:p}=Gr(o);let m=HD(e,a);const g=VD(e,l,c);return l==="center"?a==="left"?m+=c:a==="right"&&(m-=c):a==="left"?m-=Math.max(u,f)+i:a==="right"&&(m+=Math.max(h,p)+i),{x:Bt(m,0,r.width-e.width),y:Bt(g,0,r.height-e.height)}}function da(n,e,t){const r=wt(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-r.right:n.x+r.left}function wm(n){return kn([],Gn(n))}function WD(n,e,t){return ui(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function _m(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}const qv={beforeTitle:Un,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,r=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return t[e.dataIndex]}return""},afterTitle:Un,beforeBody:Un,beforeLabel:Un,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return Ne(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:Un,afterBody:Un,beforeFooter:Un,footer:Un,afterFooter:Un};function kt(n,e,t,r){const i=n[e].call(t,r);return typeof i>"u"?qv[e].call(t,r):i}class Sm extends Nt{static positioners=Ms;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,r=this.options.setContext(this.getContext()),i=r.enabled&&t.options.animation&&r.animations,s=new wh(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=WD(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:r}=t,i=kt(r,"beforeTitle",this,e),s=kt(r,"title",this,e),o=kt(r,"afterTitle",this,e);let a=[];return a=kn(a,Gn(i)),a=kn(a,Gn(s)),a=kn(a,Gn(o)),a}getBeforeBody(e,t){return wm(kt(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:r}=t,i=[];return Fe(e,s=>{const o={before:[],lines:[],after:[]},a=_m(r,s);kn(o.before,Gn(kt(a,"beforeLabel",this,s))),kn(o.lines,kt(a,"label",this,s)),kn(o.after,Gn(kt(a,"afterLabel",this,s))),i.push(o)}),i}getAfterBody(e,t){return wm(kt(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:r}=t,i=kt(r,"beforeFooter",this,e),s=kt(r,"footer",this,e),o=kt(r,"afterFooter",this,e);let a=[];return a=kn(a,Gn(i)),a=kn(a,Gn(s)),a=kn(a,Gn(o)),a}_createItems(e){const t=this._active,r=this.chart.data,i=[],s=[],o=[];let a=[],l,c;for(l=0,c=t.length;l<c;++l)a.push(LD(this.chart,t[l]));return e.filter&&(a=a.filter((u,h,f)=>e.filter(u,h,f,r))),e.itemSort&&(a=a.sort((u,h)=>e.itemSort(u,h,r))),Fe(a,u=>{const h=_m(e.callbacks,u);i.push(kt(h,"labelColor",this,u)),s.push(kt(h,"labelPointStyle",this,u)),o.push(kt(h,"labelTextColor",this,u))}),this.labelColors=i,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=a,a}update(e,t){const r=this.options.setContext(this.getContext()),i=this._active;let s,o=[];if(!i.length)this.opacity!==0&&(s={opacity:0});else{const a=Ms[r.position].call(this,i,this._eventPosition);o=this._createItems(r),this.title=this.getTitle(o,r),this.beforeBody=this.getBeforeBody(o,r),this.body=this.getBody(o,r),this.afterBody=this.getAfterBody(o,r),this.footer=this.getFooter(o,r);const l=this._size=bm(this,r),c=Object.assign({},a,l),u=ym(this.chart,r,c),h=vm(r,c,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,s={opacity:1,x:h.x,y:h.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=o,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,r,i){const s=this.getCaretPosition(e,r,i);t.lineTo(s.x1,s.y1),t.lineTo(s.x2,s.y2),t.lineTo(s.x3,s.y3)}getCaretPosition(e,t,r){const{xAlign:i,yAlign:s}=this,{caretSize:o,cornerRadius:a}=r,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:h}=Gr(a),{x:f,y:p}=e,{width:m,height:g}=t;let x,b,y,w,v,S;return s==="center"?(v=p+g/2,i==="left"?(x=f,b=x-o,w=v+o,S=v-o):(x=f+m,b=x+o,w=v-o,S=v+o),y=x):(i==="left"?b=f+Math.max(l,u)+o:i==="right"?b=f+m-Math.max(c,h)-o:b=this.caretX,s==="top"?(w=p,v=w-o,x=b-o,y=b+o):(w=p+g,v=w+o,x=b+o,y=b-o),S=w),{x1:x,x2:b,x3:y,y1:w,y2:v,y3:S}}drawTitle(e,t,r){const i=this.title,s=i.length;let o,a,l;if(s){const c=Oi(r.rtl,this.x,this.width);for(e.x=da(this,r.titleAlign,r),t.textAlign=c.textAlign(r.titleAlign),t.textBaseline="middle",o=ht(r.titleFont),a=r.titleSpacing,t.fillStyle=r.titleColor,t.font=o.string,l=0;l<s;++l)t.fillText(i[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+a,l+1===s&&(e.y+=r.titleMarginBottom-a)}}_drawColorBox(e,t,r,i,s){const o=this.labelColors[r],a=this.labelPointStyles[r],{boxHeight:l,boxWidth:c}=s,u=ht(s.bodyFont),h=da(this,"left",s),f=i.x(h),p=l<u.lineHeight?(u.lineHeight-l)/2:0,m=t.y+p;if(s.usePointStyle){const g={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},x=i.leftForLtr(f,c)+c/2,b=m+l/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,Du(e,g,x,b),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,Du(e,g,x,b)}else{e.lineWidth=Ae(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const g=i.leftForLtr(f,c),x=i.leftForLtr(i.xPlus(f,1),c-2),b=Gr(o.borderRadius);Object.values(b).some(y=>y!==0)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,no(e,{x:g,y:m,w:c,h:l,radius:b}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),no(e,{x,y:m+1,w:c-2,h:l-2,radius:b}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(g,m,c,l),e.strokeRect(g,m,c,l),e.fillStyle=o.backgroundColor,e.fillRect(x,m+1,c-2,l-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,t,r){const{body:i}=this,{bodySpacing:s,bodyAlign:o,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:u}=r,h=ht(r.bodyFont);let f=h.lineHeight,p=0;const m=Oi(r.rtl,this.x,this.width),g=function(C){t.fillText(C,m.x(e.x+p),e.y+f/2),e.y+=f+s},x=m.textAlign(o);let b,y,w,v,S,k,P;for(t.textAlign=o,t.textBaseline="middle",t.font=h.string,e.x=da(this,x,r),t.fillStyle=r.bodyColor,Fe(this.beforeBody,g),p=a&&x!=="right"?o==="center"?c/2+u:c+2+u:0,v=0,k=i.length;v<k;++v){for(b=i[v],y=this.labelTextColors[v],t.fillStyle=y,Fe(b.before,g),w=b.lines,a&&w.length&&(this._drawColorBox(t,e,v,m,r),f=Math.max(h.lineHeight,l)),S=0,P=w.length;S<P;++S)g(w[S]),f=h.lineHeight;Fe(b.after,g)}p=0,f=h.lineHeight,Fe(this.afterBody,g),e.y-=s}drawFooter(e,t,r){const i=this.footer,s=i.length;let o,a;if(s){const l=Oi(r.rtl,this.x,this.width);for(e.x=da(this,r.footerAlign,r),e.y+=r.footerMarginTop,t.textAlign=l.textAlign(r.footerAlign),t.textBaseline="middle",o=ht(r.footerFont),t.fillStyle=r.footerColor,t.font=o.string,a=0;a<s;++a)t.fillText(i[a],l.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+r.footerSpacing}}drawBackground(e,t,r,i){const{xAlign:s,yAlign:o}=this,{x:a,y:l}=e,{width:c,height:u}=r,{topLeft:h,topRight:f,bottomLeft:p,bottomRight:m}=Gr(i.cornerRadius);t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.beginPath(),t.moveTo(a+h,l),o==="top"&&this.drawCaret(e,t,r,i),t.lineTo(a+c-f,l),t.quadraticCurveTo(a+c,l,a+c,l+f),o==="center"&&s==="right"&&this.drawCaret(e,t,r,i),t.lineTo(a+c,l+u-m),t.quadraticCurveTo(a+c,l+u,a+c-m,l+u),o==="bottom"&&this.drawCaret(e,t,r,i),t.lineTo(a+p,l+u),t.quadraticCurveTo(a,l+u,a,l+u-p),o==="center"&&s==="left"&&this.drawCaret(e,t,r,i),t.lineTo(a,l+h),t.quadraticCurveTo(a,l,a+h,l),t.closePath(),t.fill(),i.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,r=this.$animations,i=r&&r.x,s=r&&r.y;if(i||s){const o=Ms[e.position].call(this,this._active,this._eventPosition);if(!o)return;const a=this._size=bm(this,e),l=Object.assign({},o,this._size),c=ym(t,e,l),u=vm(e,l,c,t);(i._to!==u.x||s._to!==u.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(t);const i={width:this.width,height:this.height},s={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const o=wt(t.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&a&&(e.save(),e.globalAlpha=r,this.drawBackground(s,e,i,t),Tv(e,t.textDirection),s.y+=o.top,this.drawTitle(s,e,t),this.drawBody(s,e,t),this.drawFooter(s,e,t),Mv(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const r=this._active,i=e.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),s=!Qa(r,i),o=this._positionChanged(i,t);(s||o)&&(this._active=i,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,r=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,s=this._active||[],o=this._getActiveElements(e,s,t,r),a=this._positionChanged(o,e),l=t||!Qa(o,s)||a;return l&&(this._active=o,(i.enabled||i.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),l}_getActiveElements(e,t,r,i){const s=this.options;if(e.type==="mouseout")return[];if(!i)return t.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,s.mode,s,r);return s.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:r,caretY:i,options:s}=this,o=Ms[s.position].call(this,e,t);return o!==!1&&(r!==o.x||i!==o.y)}}var Mr={id:"tooltip",_element:Sm,positioners:Ms,afterInit(n,e,t){t&&(n.tooltip=new Sm({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:qv},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const UD=(n,e,t,r)=>(typeof e=="string"?(t=n.push(e)-1,r.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function qD(n,e,t,r){const i=n.indexOf(e);if(i===-1)return UD(n,e,t,r);const s=n.lastIndexOf(e);return i!==s?t:i}const XD=(n,e)=>n===null?null:Bt(Math.round(n),0,e);function Pm(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class Ph extends is{static id="category";static defaults={ticks:{callback:Pm}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const r=this.getLabels();for(const{index:i,label:s}of t)r[i]===s&&r.splice(i,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(Ne(e))return null;const r=this.getLabels();return t=isFinite(t)&&r[t]===e?t:qD(r,e,Ce(t,e),this._addedLabels),XD(t,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:r,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),t||(i=this.getLabels().length-1)),this.min=r,this.max=i}buildTicks(){const e=this.min,t=this.max,r=this.options.offset,i=[];let s=this.getLabels();s=e===0&&t===s.length-1?s:s.slice(e,t+1),this._valueRange=Math.max(s.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let o=e;o<=t;o++)i.push({value:o});return i}getLabelForValue(e){return Pm.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function GD(n,e){const t=[],{bounds:i,step:s,min:o,max:a,precision:l,count:c,maxTicks:u,maxDigits:h,includeBounds:f}=n,p=s||1,m=u-1,{min:g,max:x}=e,b=!Ne(o),y=!Ne(a),w=!Ne(c),v=(x-g)/(h+1);let S=Cp((x-g)/m/p)*p,k,P,C,T;if(S<1e-14&&!b&&!y)return[{value:g},{value:x}];T=Math.ceil(x/S)-Math.floor(g/S),T>m&&(S=Cp(T*S/m/p)*p),Ne(l)||(k=Math.pow(10,l),S=Math.ceil(S*k)/k),i==="ticks"?(P=Math.floor(g/S)*S,C=Math.ceil(x/S)*S):(P=g,C=x),b&&y&&s&&yO((a-o)/s,S/1e3)?(T=Math.round(Math.min((a-o)/S,u)),S=(a-o)/T,P=o,C=a):w?(P=b?o:P,C=y?a:C,T=c-1,S=(C-P)/T):(T=(C-P)/S,Ds(T,Math.round(T),S/1e3)?T=Math.round(T):T=Math.ceil(T));const A=Math.max(kp(S),kp(P));k=Math.pow(10,Ne(l)?A:l),P=Math.round(P*k)/k,C=Math.round(C*k)/k;let M=0;for(b&&(f&&P!==o?(t.push({value:o}),P<o&&M++,Ds(Math.round((P+M*S)*k)/k,o,Cm(o,v,n))&&M++):P<o&&M++);M<T;++M){const O=Math.round((P+M*S)*k)/k;if(y&&O>a)break;t.push({value:O})}return y&&f&&C!==a?t.length&&Ds(t[t.length-1].value,a,Cm(a,v,n))?t[t.length-1].value=a:t.push({value:a}):(!y||C===a)&&t.push({value:C}),t}function Cm(n,e,{horizontal:t,minRotation:r}){const i=st(r),s=(t?Math.sin(i):Math.cos(i))||.001,o=.75*e*(""+n).length;return Math.min(e/s,o)}class YD extends is{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return Ne(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:r}=this.getUserBounds();let{min:i,max:s}=this;const o=l=>i=t?i:l,a=l=>s=r?s:l;if(e){const l=$n(i),c=$n(s);l<0&&c<0?a(0):l>0&&c>0&&o(0)}if(i===s){let l=s===0?1:Math.abs(s*.05);a(s+l),e||o(i-l)}this.min=i,this.max=s}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:r}=e,i;return r?(i=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),t=t||11),t&&(i=Math.min(t,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const i={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},s=this._range||this,o=GD(i,s);return e.bounds==="ticks"&&vO(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let t=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const i=(r-t)/Math.max(e.length-1,1)/2;t-=i,r+=i}this._startValue=t,this._endValue=r,this._valueRange=r-t}getLabelForValue(e){return mh(e,this.chart.options.locale,this.options.ticks.format)}}class ic extends YD{static id="linear";static defaults={ticks:{callback:yv.formatters.numeric}};determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Ot(e)?e:0,this.max=Ot(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,r=st(this.options.ticks.minRotation),i=(e?Math.sin(r):Math.cos(r))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,s.lineHeight/i))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const sc={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Tt=Object.keys(sc);function km(n,e){return n-e}function jm(n,e){if(Ne(e))return null;const t=n._adapter,{parser:r,round:i,isoWeekday:s}=n._parseOpts;let o=e;return typeof r=="function"&&(o=r(o)),Ot(o)||(o=typeof r=="string"?t.parse(o,r):t.parse(o)),o===null?null:(i&&(o=i==="week"&&(ii(s)||s===!0)?t.startOf(o,"isoWeek",s):t.startOf(o,i)),+o)}function Tm(n,e,t,r){const i=Tt.length;for(let s=Tt.indexOf(n);s<i-1;++s){const o=sc[Tt[s]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((t-e)/(a*o.size))<=r)return Tt[s]}return Tt[i-1]}function KD(n,e,t,r,i){for(let s=Tt.length-1;s>=Tt.indexOf(t);s--){const o=Tt[s];if(sc[o].common&&n._adapter.diff(i,r,o)>=e-1)return o}return Tt[t?Tt.indexOf(t):0]}function ZD(n){for(let e=Tt.indexOf(n)+1,t=Tt.length;e<t;++e)if(sc[Tt[e]].common)return Tt[e]}function Mm(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:r,hi:i}=fh(t,e),s=t[r]>=e?t[r]:t[i];n[s]=!0}}function JD(n,e,t,r){const i=n._adapter,s=+i.startOf(e[0].value,r),o=e[e.length-1].value;let a,l;for(a=s;a<=o;a=+i.add(a,1,r))l=t[a],l>=0&&(e[l].major=!0);return e}function Am(n,e,t){const r=[],i={},s=e.length;let o,a;for(o=0;o<s;++o)a=e[o],i[a]=o,r.push({value:a,major:!1});return s===0||!t?r:JD(n,r,i,t)}class Em extends is{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const r=e.time||(e.time={}),i=this._adapter=new a$._date(e.adapters.date);i.init(t),$s(r.displayFormats,i.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:jm(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,r=e.time.unit||"day";let{min:i,max:s,minDefined:o,maxDefined:a}=this.getUserBounds();function l(c){!o&&!isNaN(c.min)&&(i=Math.min(i,c.min)),!a&&!isNaN(c.max)&&(s=Math.max(s,c.max))}(!o||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),i=Ot(i)&&!isNaN(i)?i:+t.startOf(Date.now(),r),s=Ot(s)&&!isNaN(s)?s:+t.endOf(Date.now(),r)+1,this.min=Math.min(i,s-1),this.max=Math.max(i+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],r=e[e.length-1]),{min:t,max:r}}buildTicks(){const e=this.options,t=e.time,r=e.ticks,i=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const s=this.min,o=this.max,a=PO(i,s,o);return this._unit=t.unit||(r.autoSkip?Tm(t.minUnit,this.min,this.max,this._getLabelCapacity(s)):KD(this,a.length,t.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:ZD(this._unit),this.initOffsets(i),e.reverse&&a.reverse(),Am(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,r=0,i,s;this.options.offset&&e.length&&(i=this.getDecimalForValue(e[0]),e.length===1?t=1-i:t=(this.getDecimalForValue(e[1])-i)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?r=s:r=(s-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;t=Bt(t,0,o),r=Bt(r,0,o),this._offsets={start:t,end:r,factor:1/(t+1+r)}}_generate(){const e=this._adapter,t=this.min,r=this.max,i=this.options,s=i.time,o=s.unit||Tm(s.minUnit,t,r,this._getLabelCapacity(t)),a=Ce(i.ticks.stepSize,1),l=o==="week"?s.isoWeekday:!1,c=ii(l)||l===!0,u={};let h=t,f,p;if(c&&(h=+e.startOf(h,"isoWeek",l)),h=+e.startOf(h,c?"day":o),e.diff(r,t,o)>1e5*a)throw new Error(t+" and "+r+" are too far apart with stepSize of "+a+" "+o);const m=i.ticks.source==="data"&&this.getDataTimestamps();for(f=h,p=0;f<r;f=+e.add(f,a,o),p++)Mm(u,f,m);return(f===r||i.bounds==="ticks"||p===1)&&Mm(u,f,m),Object.keys(u).sort(km).map(g=>+g)}getLabelForValue(e){const t=this._adapter,r=this.options.time;return r.tooltipFormat?t.format(e,r.tooltipFormat):t.format(e,r.displayFormats.datetime)}format(e,t){const i=this.options.time.displayFormats,s=this._unit,o=t||i[s];return this._adapter.format(e,o)}_tickFormatFunction(e,t,r,i){const s=this.options,o=s.ticks.callback;if(o)return Be(o,[e,t,r],this);const a=s.time.displayFormats,l=this._unit,c=this._majorUnit,u=l&&a[l],h=c&&a[c],f=r[t],p=c&&h&&f&&f.major;return this._adapter.format(e,i||(p?h:u))}generateTickLabels(e){let t,r,i;for(t=0,r=e.length;t<r;++t)i=e[t],i.label=this._tickFormatFunction(i.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+r)*t.factor)}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,r=this.ctx.measureText(e).width,i=st(this.isHorizontal()?t.maxRotation:t.minRotation),s=Math.cos(i),o=Math.sin(i),a=this._resolveTickFontOptions(0).size;return{w:r*s+a*o,h:r*o+a*s}}_getLabelCapacity(e){const t=this.options.time,r=t.displayFormats,i=r[t.unit]||r.millisecond,s=this._tickFormatFunction(e,0,Am(this,[e],this._majorUnit),i),o=this._getLabelSize(s),a=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],t,r;if(e.length)return e;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(t=0,r=i.length;t<r;++t)e=e.concat(i[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,r;if(e.length)return e;const i=this.getLabels();for(t=0,r=i.length;t<r;++t)e.push(jm(this,i[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return mv(e.sort(km))}}function ha(n,e,t){let r=0,i=n.length-1,s,o,a,l;t?(e>=n[r].pos&&e<=n[i].pos&&({lo:r,hi:i}=Hr(n,"pos",e)),{pos:s,time:a}=n[r],{pos:o,time:l}=n[i]):(e>=n[r].time&&e<=n[i].time&&({lo:r,hi:i}=Hr(n,"time",e)),{time:s,pos:a}=n[r],{time:o,pos:l}=n[i]);const c=o-s;return c?a+(l-a)*(e-s)/c:a}class L7 extends Em{static id="timeseries";static defaults=Em.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=ha(t,this.min),this._tableRange=ha(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:r}=this,i=[],s=[];let o,a,l,c,u;for(o=0,a=e.length;o<a;++o)c=e[o],c>=t&&c<=r&&i.push(c);if(i.length<2)return[{time:t,pos:0},{time:r,pos:1}];for(o=0,a=i.length;o<a;++o)u=i[o+1],l=i[o-1],c=i[o],Math.round((u+l)/2)!==c&&s.push({time:c,pos:o/(a-1)});return s}_generate(){const e=this.min,t=this.max;let r=super.getDataTimestamps();return(!r.includes(e)||!r.length)&&r.splice(0,0,e),(!r.includes(t)||r.length===1)&&r.push(t),r.sort((i,s)=>i-s)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),r=this.getLabelTimestamps();return t.length&&r.length?e=this.normalize(t.concat(r)):e=t.length?t:r,e=this._cache.all=e,e}getDecimalForValue(e){return(ha(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return ha(this._table,r*this._tableRange+this._minPos,!0)}}const Xv="label";function Im(n,e){typeof n=="function"?n(e):n&&(n.current=e)}function QD(n,e){const t=n.options;t&&e&&Object.assign(t,e)}function Gv(n,e){n.labels=e}function Yv(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Xv;const r=[];n.datasets=e.map(i=>{const s=n.datasets.find(o=>o[t]===i[t]);return!s||!i.data||r.includes(s)?{...i}:(r.push(s),Object.assign(s,i),s)})}function eN(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Xv;const t={labels:[],datasets:[]};return Gv(t,n.labels),Yv(t,n.datasets,e),t}function tN(n,e){const{height:t=150,width:r=300,redraw:i=!1,datasetIdKey:s,type:o,data:a,options:l,plugins:c=[],fallbackContent:u,updateMode:h,...f}=n,p=_.useRef(null),m=_.useRef(null),g=()=>{p.current&&(m.current=new Dn(p.current,{type:o,data:eN(a,s),options:l&&{...l},plugins:c}),Im(e,m.current))},x=()=>{Im(e,null),m.current&&(m.current.destroy(),m.current=null)};return _.useEffect(()=>{!i&&m.current&&l&&QD(m.current,l)},[i,l]),_.useEffect(()=>{!i&&m.current&&Gv(m.current.config.data,a.labels)},[i,a.labels]),_.useEffect(()=>{!i&&m.current&&a.datasets&&Yv(m.current.config.data,a.datasets,s)},[i,a.datasets]),_.useEffect(()=>{m.current&&(i?(x(),setTimeout(g)):m.current.update(h))},[i,l,a.labels,a.datasets,h]),_.useEffect(()=>{m.current&&(x(),setTimeout(g))},[o]),_.useEffect(()=>(g(),()=>x()),[]),ld.createElement("canvas",{ref:p,role:"img",height:t,width:r,...f},u)}const nN=_.forwardRef(tN);function Kv(n,e){return Dn.register(e),_.forwardRef((t,r)=>ld.createElement(nN,{...t,ref:r,type:n}))}const rN=Kv("line",o$),Ch=Kv("bar",r$);Dn.register(Ph,ic,Sh,Mr,ND);Mr.positioners.center=(n,e)=>{if(n.length===0)return!1;const{base:t,x:r,y:i,height:s}=n[0].element;return e.x<t||e.x>r?!1:{x:t+(r-t)/2,y:i-s/2,yAlign:"bottom"}};const Zv=n=>{const e=te.c(46),{groupedCategoryToCount:t}=n;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r={legend:{display:!1,onClick:iN},tooltip:{position:"center"}},e[0]=r):r=e[0];let i;e[1]===Symbol.for("react.memo_cache_sentinel")?(i={x:{stacked:!0,title:{display:!0,text:"Count"}},y:{stacked:!0}},e[1]=i):i=e[1];let s;e[2]===Symbol.for("react.memo_cache_sentinel")?(s={plugins:r,responsive:!0,maintainAspectRatio:!1,scales:i,indexAxis:"y",layout:{padding:{top:40}}},e[2]=s):s=e[2];const o=s;let a;e[3]!==t?(a=t.map(sN),e[3]=t,e[4]=a):a=e[4];let l;e[5]!==t?(l=t.map(oN),e[5]=t,e[6]=l):l=e[6];let c;e[7]!==l?(c={label:"Satisfied",data:l,backgroundColor:"green"},e[7]=l,e[8]=c):c=e[8];let u;e[9]!==t?(u=t.map(aN),e[9]=t,e[10]=u):u=e[10];let h;e[11]!==u?(h={label:"Partially Satisfied",data:u,backgroundColor:"#14b8a6"},e[11]=u,e[12]=h):h=e[12];let f;e[13]!==t?(f=t.map(lN),e[13]=t,e[14]=f):f=e[14];let p;e[15]!==f?(p={label:"Above threshold",data:f,backgroundColor:"red"},e[15]=f,e[16]=p):p=e[16];let m;e[17]!==t?(m=t.map(cN),e[17]=t,e[18]=m):m=e[18];let g;e[19]!==m?(g={label:"Mixed",data:m,backgroundColor:"pink"},e[19]=m,e[20]=g):g=e[20];let x;e[21]!==t?(x=t.map(uN),e[21]=t,e[22]=x):x=e[22];let b;e[23]!==x?(b={label:"Below threshold",data:x,backgroundColor:"orange"},e[23]=x,e[24]=b):b=e[24];let y;e[25]!==t?(y=t.map(dN),e[25]=t,e[26]=y):y=e[26];let w;e[27]!==y?(w={label:"Unmapped",data:y,backgroundColor:"rgb(161, 161, 170)"},e[27]=y,e[28]=w):w=e[28];let v;e[29]!==p||e[30]!==g||e[31]!==b||e[32]!==w||e[33]!==c||e[34]!==h?(v=[c,h,p,g,b,w],e[29]=p,e[30]=g,e[31]=b,e[32]=w,e[33]=c,e[34]=h,e[35]=v):v=e[35];let S;e[36]!==v||e[37]!==a?(S={labels:a,datasets:v},e[36]=v,e[37]=a,e[38]=S):S=e[38];const k=S,P=(190+t.length*60)/2;let C;e[39]!==P?(C={position:"relative",height:P,width:"100%"},e[39]=P,e[40]=C):C=e[40];let T;e[41]!==k?(T=d.jsx(Ch,{options:o,data:k}),e[41]=k,e[42]=T):T=e[42];let A;return e[43]!==C||e[44]!==T?(A=d.jsx("div",{style:C,children:T}),e[43]=C,e[44]=T,e[45]=A):A=e[45],A};function iN(){}function sN(n){const{label:e}=n;return e}function oN(n){const{categoryToCount:e}=n;return e.ok??0}function aN(n){const{categoryToCount:e}=n;return e["partially-ok"]??0}function lN(n){const{categoryToCount:e}=n;return e.over??0}function cN(n){const{categoryToCount:e}=n;return e["mixed-violated"]??0}function uN(n){const{categoryToCount:e}=n;return e.under??0}function dN(n){const{categoryToCount:e}=n;return e.unmapped??0}const hN=({groupedCrosslinks:n,structures:e,thresholds:t,aminoAcidsMustMatch:r})=>{const i=_.useMemo(()=>n.map(({crosslinks:a})=>a.map(l=>Qi(l,e,r))),[n,e,r]),s=_.useMemo(()=>i.map((a,l)=>{const c=(f,p)=>p===void 0?f:`${f} (${p})`,u=c(n[l].groupHeader.fromProteinName??"",n[l].groupHeader.fromDomainName),h=c(n[l].groupHeader.toProteinName??"",n[l].groupHeader.toDomainName);return{label:`${u} : ${h}`,categoryToCount:Jl(a,t??{})}}),[i,n,t]),o=t?.lower!==void 0||t?.upper!==void 0;return d.jsx(Zv,{groupedCategoryToCount:s,hasThresholds:o})},fN=({crosslinks:n,groupedStructures:e,thresholds:t,aminoAcidsMustMatch:r})=>{const i=_.useMemo(()=>e.map(a=>n.map(l=>Qi(l,a,r))),[e,n,r]),s=_.useMemo(()=>i.map((a,l)=>({label:e[l].map(({name:c})=>c).join(","),categoryToCount:Jl(a,t??{})})),[i,e,t]),o=t?.lower!==void 0||t?.upper!==void 0;return d.jsx(Zv,{groupedCategoryToCount:s,hasThresholds:o})};Dn.register(Ph,ic,Sh,Mr);Mr.positioners.top=n=>{if(n.length===0)return!1;const e=n[0].element.x,t=n.reduce((r,{element:i})=>Math.min(r,i.y),1/0);return{x:e,y:t,yAlign:"bottom"}};const pN=({crosslinks:n,structures:e,thresholds:t,aminoAcidsMustMatch:r})=>{const i=_.useMemo(()=>n.map(l=>Qi(l,e,r)),[n,e,r]),s=_.useMemo(()=>Jl(i,t??{}),[i,t]),o={plugins:{legend:{display:!1},tooltip:{position:"top",titleAlign:"center",filter(l){switch(l.label){case"Satisfied":case"Mapped":return["ok"].includes(l.dataset.label??"");case"Partially Satisfied":return["partially-ok"].includes(l.dataset.label??"");case"Violated":return["under","mixed-violated","over"].includes(l.dataset.label??"");case"Unmapped":return["unmapped"].includes(l.dataset.label??"")}return!1},callbacks:{title:l=>{if(l.length===0)return"No crosslinks";const c=l.reduce((h,{raw:f})=>h+f,0);let u=`${De(c,"crosslink")} ${c===1?"is":"are"} `;switch(l[0]?.label){case"Satisfied":u+=`satisfied
in all mapped structures`;break;case"Mapped":u+=`mapped
in all structures`;break;case"Unmapped":u+=`unmapped
in all structures`;break;case"Violated":u+=`violated
in all mapped structures`;break;case"Partially Satisfied":u+=`satisfied
in some mapped structures,
and violated in others`;break}return u},label:l=>{if(l.label!=="Violated")return"";switch(l.dataset.label){case"over":return t?.upper===void 0?"":`Above ${t?.upper??0} : ${l.raw}`;case"under":return t?.lower===void 0?"":`Below ${t?.lower??0} : ${l.raw}`;case"mixed-violated":return l.raw===0?"":`Mixed: ${l.raw}`}}}}},responsive:!0,maintainAspectRatio:!1,interaction:{mode:"x",intersect:!1},scales:{x:{stacked:!0},y:{stacked:!0,title:{display:!0,text:"Count"}}},layout:{padding:{top:40}}},a=(()=>{const l=t?.lower!==void 0||t?.upper!==void 0,c=l?["Satisfied","Partially Satisfied","Violated","Unmapped"]:["Mapped","Unmapped"],u=(h,f,p)=>({label:f,data:c.map(m=>m===h?s[f]??0:0),backgroundColor:p});return{labels:c,datasets:l?[u("Satisfied","ok","green"),u("Partially Satisfied","partially-ok","#14b8a6"),u("Violated","over","red"),u("Violated","mixed-violated","#f472b6"),u("Violated","under","orange"),u("Unmapped","unmapped","rgb(161, 161, 170)")]:[u("Mapped","ok","green"),u("Unmapped","unmapped","rgb(161, 161, 170)")]}})();return d.jsx(Sl,{children:d.jsx("div",{style:{position:"relative",height:"300px",width:"100%"},children:d.jsx(Ch,{options:o,data:a})})})},ct=50;let mN=class As{_svg;_content;_zoom;_proteinsSelection;_crosslinksSelection;_tooltip;onUpdatePositions;_classNames;_categories;_data={proteins:[],crosslinks:[]};_isMouseDown=!1;constructor(e,t,r,i,s){this._svg=hn(e),this._svg.selectChildren().remove(),this._svg.on("mousedown",()=>{this._isMouseDown=!0}).on("mouseup",()=>{this._isMouseDown=!1}),this._content=this._svg.append("g"),this._zoom=pR().scaleExtent([.01,3]).on("zoom",({transform:o})=>this._content.attr("transform",o)).filter(o=>o.type==="wheel"?o.ctrlKey:!0).on("end",()=>{this._isMouseDown=!1}),this._svg.call(this._zoom),this._proteinsSelection=this._content.append("g").selectAll("g"),this._crosslinksSelection=this._content.append("g").selectAll("path"),this._classNames=t,this._tooltip=this._svg.select(function(){return this.parentElement}).append("div").classed(this._classNames.tooltip,!0).style("position","absolute").style("opacity",0).style("pointer-events","none"),this.onUpdatePositions=i,this._categories=s,r&&this.updateData(r,0,!1)}_showTooltip(e){return t=>{const r=()=>{t.style("cursor",null),this._tooltip.transition().duration(100).style("opacity",0)},i=(s,o)=>{if(this._isMouseDown){r();return}t.style("cursor","crosshair"),e(s,o),this._tooltip.style("top",s.layerY+20+"px").style("left",s.layerX+20+"px"),this._tooltip.transition().duration(100).style("opacity",1)};t.on("mouseover",i),t.on("mousemove",i),t.on("mousedown",r),t.on("mouseleave",r)}}_showCrosslinkTooltip(){return this._showTooltip((e,{fromProtein:t,fromPosition:r,fromAminoAcid:i,toProtein:s,toPosition:o,toAminoAcid:a,category:l})=>{const c=this._data.proteins.find(({id:p})=>p===t)?.name??"",u=t===s?"":`${this._data.proteins.find(({id:p})=>p===s)?.name??""} `,h=`${c} ${i??""}${r}`,f=`${u}${a??""}${o}`;this._tooltip.html(`${h} to ${f}`+(l!==void 0?`<br/>${l}`:""))})}updateData(e,t,r){this._data={proteins:e.proteins.map(s=>({...this._data.proteins.find(({id:o})=>o===s.id),...s})),crosslinks:e.crosslinks};const i=this._simulateProteinsPositions();i&&this.onUpdatePositions?.(i),this._proteinsSelection=this._proteinsSelection.data(this._data.proteins,({id:s})=>s).join(s=>{const o=s.append("g").attr("id",({id:a})=>`protein-${a}`).classed(this._classNames.protein_from_other_experiment,({isFromCurrentExperiment:a})=>!a).attr("transform",a=>`translate(${As._getProteinPosition(a).join()})`).call(bE().subject(()=>this).on("start",As._proteinDragStarted));return o.append("rect").classed(this._classNames.protein,!0).attr("width",({length:a})=>a).attr("height",ct).call(this._showTooltip((a,{name:l})=>this._tooltip.html(l))),o.selectAll(`rect.${this._classNames.domain}`).data(a=>(a.domains??[]).map(l=>({...l,protein:a}))).join("rect").classed(this._classNames.domain,!0).attr("pointer-events","fill").attr("x",({startPosition:a})=>a).attr("y",0).attr("width",({startPosition:a,endPosition:l})=>l-a).attr("height",ct).call(this._showTooltip((a,{name:l,protein:c})=>this._tooltip.html(`${c.name}: ${l}`))),o.selectAll(`text.${this._classNames.domain}`).data(a=>a.domains??[]).join("text").classed(this._classNames.domain,!0).attr("x",({startPosition:a})=>a).attr("y",ct).attr("dominant-baseline","text-before-edge").attr("text-anchor","start").text(({name:a})=>a),o.append("path").classed(this._classNames.known_protein_borders,!0).attr("pointer-events","none").attr("d",({length:a,isEstimatedLength:l})=>{const c=yi();return c.moveTo(a,0),c.lineTo(0,0),c.lineTo(0,ct),c.lineTo(a,ct),l||c.closePath(),c.toString()}),o.append("path").classed(this._classNames.unknown_protein_borders,!0).attr("pointer-events","none").attr("d",({isEstimatedLength:a,length:l})=>{const c=yi();return a&&(c.moveTo(l,0),c.lineTo(l,ct)),c.toString()}),o.append("text").classed(this._classNames.protein_name,!0).attr("x",-20).attr("y",ct/2).attr("dominant-baseline","central").attr("text-anchor","end").text(({name:a})=>a),o},s=>(s.select(`rect.${this._classNames.protein}`).attr("width",({length:o})=>o),s.selectAll(`rect.${this._classNames.domain}`).data(o=>o.domains??[]).join("rect").classed(this._classNames.domain,!0).attr("x",({startPosition:o})=>o).attr("y",0).attr("width",({startPosition:o,endPosition:a})=>a-o).attr("height",ct),s.selectAll(`text.${this._classNames.domain}`).data(o=>o.domains??[]).join("text").classed(this._classNames.domain,!0).attr("x",({startPosition:o})=>o).attr("y",ct).attr("dominant-baseline","text-before-edge").attr("text-anchor","start").text(({name:o})=>o),s.select(`path.${this._classNames.known_protein_borders}`).attr("d",({length:o,isEstimatedLength:a})=>{const l=yi();return l.moveTo(o,0),l.lineTo(0,0),l.lineTo(0,ct),l.lineTo(o,ct),a||l.closePath(),l.toString()}),s.select(`path.${this._classNames.unknown_protein_borders}`).attr("d",({isEstimatedLength:o,length:a})=>{const l=yi();return o&&(l.moveTo(a,0),l.lineTo(a,ct)),l.toString()}),s.select(`text.${this._classNames.protein_name}`).text(({name:o})=>o),s)),this._crosslinksSelection=this._crosslinksSelection.data(this._data.crosslinks,({id:s})=>s).join(s=>s.append("path").classed(this._classNames.xlinks,!0).classed(this._classNames.interprotein,({fromProtein:o,toProtein:a})=>o!==a).classed(this._classNames.intraprotein,({fromProtein:o,toProtein:a})=>o===a).attr("pointer-events","visibleStroke").call(this._showCrosslinkTooltip())),this._redrawCrosslinks(),this.zoomToFit(void 0,t,r)}zoomToFit(e,t=100,r=!1,i=0){e||(e=this._content.node().getBBox());const s=this._svg.node().getBoundingClientRect(),o=this._zoom.scaleExtent(),a=r?Gy(this._svg.node()).k:o[1],l=Kl.scale(Math.max(o[0],Math.min(a,s.width/(e.width+i),s.height/(e.height+i)))).translate(-(e.x+e.width/2),-(e.y+e.height/2));this._svg.transition().duration(t).call(this._zoom.transform,l)}_simulateProteinsPositions(){for(const s of this._data.proteins)s.fx=s.x,s.fy=s.y;const e=new Set(this._data.proteins.filter(({fx:s,fy:o})=>s===void 0||o===void 0).map(({id:s})=>s));if(e.size===0)return;const t=this._data.crosslinks.filter(({fromProtein:s,toProtein:o})=>s!==o).map(({fromProtein:s,toProtein:o})=>({source:this._data.proteins.findIndex(({id:a})=>a===s),target:this._data.proteins.findIndex(({id:a})=>a===o)})),r=NI(this._data.proteins).stop().force("collide",jI(({length:s})=>s/2)).force("x",FI().strength(.01)).force("y",zI().strength(.01)).force("charge",LI()).force("link",MI(t));r.tick(Math.ceil(Math.log(r.alphaMin())/Math.log(1-r.alphaDecay())));const i={};for(const s of this._data.proteins)s.fx=s.x,s.fy=s.y,s.vx=void 0,s.vy=void 0,e.has(s.id)&&s.x!==void 0&&s.y!==void 0&&(i[s.id]={x:s.x,y:s.y});return i}static _getProteinPosition({x:e,y:t,length:r}){return[(e??0)-r/2,(t??0)-ct/2]}_redrawCrosslinks(){const e=Object.fromEntries(this._data.proteins.map(t=>[t.id,As._getProteinPosition(t)]));this._crosslinksSelection.classed(this._classNames.homomultimeric,({homoMultimeric:t})=>t).call(t=>{this._categories?.forEach(r=>{t.classed(this._classNames[r],i=>i.category===r)})}).attr("d",t=>{if(!(t.fromProtein in e)||!(t.toProtein in e))return null;const r=t.fromPosition==="ntd"?1:t.fromPosition,i=t.toPosition==="ntd"?1:t.toPosition,[s,o]=e[t.fromProtein],[a,l]=e[t.toProtein],c=yi();return c.moveTo(s+r,o+ct/2),t.fromProtein===t.toProtein&&(c.lineTo(s+r,o),c.bezierCurveTo(s+r,o-ct-.3*Math.abs(a+i-(s+r)),a+i,l-ct-.3*Math.abs(a+i-(s+r)),a+i,l)),c.lineTo(a+i,l+ct/2),c.toString()})}static _proteinDragStarted(e){const t=e.subject._classNames.dragging,r=hn(this).classed(t,!0).raise();e.subject._isMouseDown=!0,e.on("drag",(i,s)=>{s.x=(s.x??0)+i.dx,s.y=(s.y??0)+i.dy,r.attr("transform",o=>`translate(${As._getProteinPosition(o).join()})`),i.subject._redrawCrosslinks()}).on("end",(i,{id:s,x:o,y:a})=>{r.classed(t,!1),o!==void 0&&a!==void 0&&i.subject.onUpdatePositions?.({[s]:{x:o,y:a}}),i.subject._isMouseDown=!1})}};const gN="_xlmap_1qgca_1",xN="_grid_1qgca_5",bN="_protein_from_other_experiment_1qgca_12",yN="_tooltip_1qgca_16",vN="_protein_1qgca_12",wN="_known_protein_borders_1qgca_26",_N="_domain_1qgca_30",SN="_unknown_protein_borders_1qgca_40",PN="_dragging_1qgca_51",CN="_xlinks_1qgca_56",kN="_intraprotein_1qgca_65",jN="_interprotein_1qgca_69",TN="_homomultimeric_1qgca_69",MN="_over_1qgca_73",AN="_ok_1qgca_77",EN="_under_1qgca_81",IN="_unmapped_1qgca_85",RN="_protein_name_1qgca_97",qc={xlmap:gN,grid:xN,protein_from_other_experiment:bN,tooltip:yN,protein:vN,known_protein_borders:wN,domain:_N,unknown_protein_borders:SN,dragging:PN,xlinks:CN,intraprotein:kN,interprotein:jN,homomultimeric:TN,over:MN,ok:AN,under:EN,unmapped:IN,"partially-ok":"_partially-ok_1qgca_89","violated-mixed":"_violated-mixed_1qgca_93",protein_name:RN},ON=(n,e,t)=>{const{referenceProteinsById:r,structures:i,experimentIdToGroupedStructureIds:s,experimentIdToThresholds:o,aminoAcidsMustMatch:a}=Je(ie),l=s[n.id],c=_.useMemo(()=>{if(t.colorCrosslinksBy!=="distance")return[];const p=new Set(l.flat());return i.filter(({id:m})=>p.has(m))},[t.colorCrosslinksBy,i,l]),u=o[n.id],h=_.useMemo(()=>{const p=[];for(const m of n.crosslinks){if(m.from.linkPosition===void 0||m.to.linkPosition===void 0||!e.has(m.id))continue;const g=t.colorCrosslinksBy!=="distance"?void 0:c.length>0?ov(Qi(m,c,a),u??{})??"unmapped":"unmapped";p.push({id:m.id,homoMultimeric:m.homoMultimeric===!0,fromProtein:m.from.proteinId,fromPosition:m.from.linkPosition,fromAminoAcid:m.from.aminoAcid,toProtein:m.to.proteinId,toPosition:m.to.linkPosition,toAminoAcid:m.to.aminoAcid,category:g})}return p},[n.crosslinks,t.colorCrosslinksBy,u,c,e,a]);return{proteins:_.useMemo(()=>{const p=[];for(const{id:m,name:g,sequence:x,domains:b,isFromCurrentExperiment:y}of[...n.proteins.map(w=>({...w,isFromCurrentExperiment:!0})),...t.showProteinsFromOtherExperiments?Object.values(r).map(w=>({...w,isFromCurrentExperiment:!1})):[]]){if(p.some(v=>v.id===m)||!t.showProteinsWithoutCrosslinks&&!n.crosslinks.some(v=>e.has(v.id)&&(v.from.proteinId===m||v.to.proteinId===m)))continue;const w=x?.length??50+Math.max(0,...n.crosslinks.flatMap(({from:v,to:S})=>[...v.proteinId===m&&typeof v.linkPosition=="number"?[v.linkPosition]:[],...S.proteinId===m&&typeof S.linkPosition=="number"?[S.linkPosition]:[]]));p.push({id:m,name:g,length:w,isEstimatedLength:x===void 0,domains:b,isFromCurrentExperiment:y,...ie.proteinIdToXLMapPosition[m]??{}})}return p},[n,e,r,t.showProteinsFromOtherExperiments,t.showProteinsWithoutCrosslinks]),crosslinks:h}},$N=n=>{for(const[e,{x:t,y:r}]of Object.entries(n))ie.proteinIdToXLMapPosition[e]={x:t,y:r}};var Jv=typeof global=="object"&&global&&global.Object===Object&&global,DN=typeof self=="object"&&self&&self.Object===Object&&self,sr=Jv||DN||Function("return this")(),Ui=sr.Symbol,Qv=Object.prototype,NN=Qv.hasOwnProperty,LN=Qv.toString,vs=Ui?Ui.toStringTag:void 0;function FN(n){var e=NN.call(n,vs),t=n[vs];try{n[vs]=void 0;var r=!0}catch{}var i=LN.call(n);return r&&(e?n[vs]=t:delete n[vs]),i}var zN=Object.prototype,BN=zN.toString;function HN(n){return BN.call(n)}var VN="[object Null]",WN="[object Undefined]",Rm=Ui?Ui.toStringTag:void 0;function $o(n){return n==null?n===void 0?WN:VN:Rm&&Rm in Object(n)?FN(n):HN(n)}function io(n){return n!=null&&typeof n=="object"}var al=Array.isArray;function ew(n){var e=typeof n;return n!=null&&(e=="object"||e=="function")}var UN="[object AsyncFunction]",qN="[object Function]",XN="[object GeneratorFunction]",GN="[object Proxy]";function tw(n){if(!ew(n))return!1;var e=$o(n);return e==qN||e==XN||e==UN||e==GN}var Xc=sr["__core-js_shared__"],Om=function(){var n=/[^.]+$/.exec(Xc&&Xc.keys&&Xc.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function YN(n){return!!Om&&Om in n}var KN=Function.prototype,ZN=KN.toString;function di(n){if(n!=null){try{return ZN.call(n)}catch{}try{return n+""}catch{}}return""}var JN=/[\\^$.*+?()[\]{}|]/g,QN=/^\[object .+?Constructor\]$/,e6=Function.prototype,t6=Object.prototype,n6=e6.toString,r6=t6.hasOwnProperty,i6=RegExp("^"+n6.call(r6).replace(JN,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function s6(n){if(!ew(n)||YN(n))return!1;var e=tw(n)?i6:QN;return e.test(di(n))}function o6(n,e){return n?.[e]}function ss(n,e){var t=o6(n,e);return s6(t)?t:void 0}var zu=ss(sr,"WeakMap"),a6=9007199254740991,l6=/^(?:0|[1-9]\d*)$/;function c6(n,e){var t=typeof n;return e=e??a6,!!e&&(t=="number"||t!="symbol"&&l6.test(n))&&n>-1&&n%1==0&&n<e}function nw(n,e){return n===e||n!==n&&e!==e}var u6=9007199254740991;function rw(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=u6}function d6(n){return n!=null&&rw(n.length)&&!tw(n)}var h6=Object.prototype;function f6(n){var e=n&&n.constructor,t=typeof e=="function"&&e.prototype||h6;return n===t}function p6(n,e){for(var t=-1,r=Array(n);++t<n;)r[t]=e(t);return r}var m6="[object Arguments]";function $m(n){return io(n)&&$o(n)==m6}var iw=Object.prototype,g6=iw.hasOwnProperty,x6=iw.propertyIsEnumerable,b6=$m(function(){return arguments}())?$m:function(n){return io(n)&&g6.call(n,"callee")&&!x6.call(n,"callee")};function y6(){return!1}var sw=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Dm=sw&&typeof module=="object"&&module&&!module.nodeType&&module,v6=Dm&&Dm.exports===sw,Nm=v6?sr.Buffer:void 0,w6=Nm?Nm.isBuffer:void 0,Bu=w6||y6,_6="[object Arguments]",S6="[object Array]",P6="[object Boolean]",C6="[object Date]",k6="[object Error]",j6="[object Function]",T6="[object Map]",M6="[object Number]",A6="[object Object]",E6="[object RegExp]",I6="[object Set]",R6="[object String]",O6="[object WeakMap]",$6="[object ArrayBuffer]",D6="[object DataView]",N6="[object Float32Array]",L6="[object Float64Array]",F6="[object Int8Array]",z6="[object Int16Array]",B6="[object Int32Array]",H6="[object Uint8Array]",V6="[object Uint8ClampedArray]",W6="[object Uint16Array]",U6="[object Uint32Array]",We={};We[N6]=We[L6]=We[F6]=We[z6]=We[B6]=We[H6]=We[V6]=We[W6]=We[U6]=!0;We[_6]=We[S6]=We[$6]=We[P6]=We[D6]=We[C6]=We[k6]=We[j6]=We[T6]=We[M6]=We[A6]=We[E6]=We[I6]=We[R6]=We[O6]=!1;function q6(n){return io(n)&&rw(n.length)&&!!We[$o(n)]}function X6(n){return function(e){return n(e)}}var ow=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Fs=ow&&typeof module=="object"&&module&&!module.nodeType&&module,G6=Fs&&Fs.exports===ow,Gc=G6&&Jv.process,Lm=function(){try{var n=Fs&&Fs.require&&Fs.require("util").types;return n||Gc&&Gc.binding&&Gc.binding("util")}catch{}}(),Fm=Lm&&Lm.isTypedArray,aw=Fm?X6(Fm):q6,Y6=Object.prototype,K6=Y6.hasOwnProperty;function Z6(n,e){var t=al(n),r=!t&&b6(n),i=!t&&!r&&Bu(n),s=!t&&!r&&!i&&aw(n),o=t||r||i||s,a=o?p6(n.length,String):[],l=a.length;for(var c in n)K6.call(n,c)&&!(o&&(c=="length"||i&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||c6(c,l)))&&a.push(c);return a}function J6(n,e){return function(t){return n(e(t))}}var Q6=J6(Object.keys,Object),eL=Object.prototype,tL=eL.hasOwnProperty;function nL(n){if(!f6(n))return Q6(n);var e=[];for(var t in Object(n))tL.call(n,t)&&t!="constructor"&&e.push(t);return e}function rL(n){return d6(n)?Z6(n):nL(n)}var so=ss(Object,"create");function iL(){this.__data__=so?so(null):{},this.size=0}function sL(n){var e=this.has(n)&&delete this.__data__[n];return this.size-=e?1:0,e}var oL="__lodash_hash_undefined__",aL=Object.prototype,lL=aL.hasOwnProperty;function cL(n){var e=this.__data__;if(so){var t=e[n];return t===oL?void 0:t}return lL.call(e,n)?e[n]:void 0}var uL=Object.prototype,dL=uL.hasOwnProperty;function hL(n){var e=this.__data__;return so?e[n]!==void 0:dL.call(e,n)}var fL="__lodash_hash_undefined__";function pL(n,e){var t=this.__data__;return this.size+=this.has(n)?0:1,t[n]=so&&e===void 0?fL:e,this}function oi(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}oi.prototype.clear=iL;oi.prototype.delete=sL;oi.prototype.get=cL;oi.prototype.has=hL;oi.prototype.set=pL;function mL(){this.__data__=[],this.size=0}function oc(n,e){for(var t=n.length;t--;)if(nw(n[t][0],e))return t;return-1}var gL=Array.prototype,xL=gL.splice;function bL(n){var e=this.__data__,t=oc(e,n);if(t<0)return!1;var r=e.length-1;return t==r?e.pop():xL.call(e,t,1),--this.size,!0}function yL(n){var e=this.__data__,t=oc(e,n);return t<0?void 0:e[t][1]}function vL(n){return oc(this.__data__,n)>-1}function wL(n,e){var t=this.__data__,r=oc(t,n);return r<0?(++this.size,t.push([n,e])):t[r][1]=e,this}function or(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}or.prototype.clear=mL;or.prototype.delete=bL;or.prototype.get=yL;or.prototype.has=vL;or.prototype.set=wL;var oo=ss(sr,"Map");function _L(){this.size=0,this.__data__={hash:new oi,map:new(oo||or),string:new oi}}function SL(n){var e=typeof n;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?n!=="__proto__":n===null}function ac(n,e){var t=n.__data__;return SL(e)?t[typeof e=="string"?"string":"hash"]:t.map}function PL(n){var e=ac(this,n).delete(n);return this.size-=e?1:0,e}function CL(n){return ac(this,n).get(n)}function kL(n){return ac(this,n).has(n)}function jL(n,e){var t=ac(this,n),r=t.size;return t.set(n,e),this.size+=t.size==r?0:1,this}function hi(n){var e=-1,t=n==null?0:n.length;for(this.clear();++e<t;){var r=n[e];this.set(r[0],r[1])}}hi.prototype.clear=_L;hi.prototype.delete=PL;hi.prototype.get=CL;hi.prototype.has=kL;hi.prototype.set=jL;function TL(n,e){for(var t=-1,r=e.length,i=n.length;++t<r;)n[i+t]=e[t];return n}function ML(){this.__data__=new or,this.size=0}function AL(n){var e=this.__data__,t=e.delete(n);return this.size=e.size,t}function EL(n){return this.__data__.get(n)}function IL(n){return this.__data__.has(n)}var RL=200;function OL(n,e){var t=this.__data__;if(t instanceof or){var r=t.__data__;if(!oo||r.length<RL-1)return r.push([n,e]),this.size=++t.size,this;t=this.__data__=new hi(r)}return t.set(n,e),this.size=t.size,this}function wr(n){var e=this.__data__=new or(n);this.size=e.size}wr.prototype.clear=ML;wr.prototype.delete=AL;wr.prototype.get=EL;wr.prototype.has=IL;wr.prototype.set=OL;function $L(n,e){for(var t=-1,r=n==null?0:n.length,i=0,s=[];++t<r;){var o=n[t];e(o,t,n)&&(s[i++]=o)}return s}function DL(){return[]}var NL=Object.prototype,LL=NL.propertyIsEnumerable,zm=Object.getOwnPropertySymbols,FL=zm?function(n){return n==null?[]:(n=Object(n),$L(zm(n),function(e){return LL.call(n,e)}))}:DL;function zL(n,e,t){var r=e(n);return al(n)?r:TL(r,t(n))}function Bm(n){return zL(n,rL,FL)}var Hu=ss(sr,"DataView"),Vu=ss(sr,"Promise"),Wu=ss(sr,"Set"),Hm="[object Map]",BL="[object Object]",Vm="[object Promise]",Wm="[object Set]",Um="[object WeakMap]",qm="[object DataView]",HL=di(Hu),VL=di(oo),WL=di(Vu),UL=di(Wu),qL=di(zu),dr=$o;(Hu&&dr(new Hu(new ArrayBuffer(1)))!=qm||oo&&dr(new oo)!=Hm||Vu&&dr(Vu.resolve())!=Vm||Wu&&dr(new Wu)!=Wm||zu&&dr(new zu)!=Um)&&(dr=function(n){var e=$o(n),t=e==BL?n.constructor:void 0,r=t?di(t):"";if(r)switch(r){case HL:return qm;case VL:return Hm;case WL:return Vm;case UL:return Wm;case qL:return Um}return e});var Xm=sr.Uint8Array,XL="__lodash_hash_undefined__";function GL(n){return this.__data__.set(n,XL),this}function YL(n){return this.__data__.has(n)}function ll(n){var e=-1,t=n==null?0:n.length;for(this.__data__=new hi;++e<t;)this.add(n[e])}ll.prototype.add=ll.prototype.push=GL;ll.prototype.has=YL;function KL(n,e){for(var t=-1,r=n==null?0:n.length;++t<r;)if(e(n[t],t,n))return!0;return!1}function ZL(n,e){return n.has(e)}var JL=1,QL=2;function lw(n,e,t,r,i,s){var o=t&JL,a=n.length,l=e.length;if(a!=l&&!(o&&l>a))return!1;var c=s.get(n),u=s.get(e);if(c&&u)return c==e&&u==n;var h=-1,f=!0,p=t&QL?new ll:void 0;for(s.set(n,e),s.set(e,n);++h<a;){var m=n[h],g=e[h];if(r)var x=o?r(g,m,h,e,n,s):r(m,g,h,n,e,s);if(x!==void 0){if(x)continue;f=!1;break}if(p){if(!KL(e,function(b,y){if(!ZL(p,y)&&(m===b||i(m,b,t,r,s)))return p.push(y)})){f=!1;break}}else if(!(m===g||i(m,g,t,r,s))){f=!1;break}}return s.delete(n),s.delete(e),f}function e8(n){var e=-1,t=Array(n.size);return n.forEach(function(r,i){t[++e]=[i,r]}),t}function t8(n){var e=-1,t=Array(n.size);return n.forEach(function(r){t[++e]=r}),t}var n8=1,r8=2,i8="[object Boolean]",s8="[object Date]",o8="[object Error]",a8="[object Map]",l8="[object Number]",c8="[object RegExp]",u8="[object Set]",d8="[object String]",h8="[object Symbol]",f8="[object ArrayBuffer]",p8="[object DataView]",Gm=Ui?Ui.prototype:void 0,Yc=Gm?Gm.valueOf:void 0;function m8(n,e,t,r,i,s,o){switch(t){case p8:if(n.byteLength!=e.byteLength||n.byteOffset!=e.byteOffset)return!1;n=n.buffer,e=e.buffer;case f8:return!(n.byteLength!=e.byteLength||!s(new Xm(n),new Xm(e)));case i8:case s8:case l8:return nw(+n,+e);case o8:return n.name==e.name&&n.message==e.message;case c8:case d8:return n==e+"";case a8:var a=e8;case u8:var l=r&n8;if(a||(a=t8),n.size!=e.size&&!l)return!1;var c=o.get(n);if(c)return c==e;r|=r8,o.set(n,e);var u=lw(a(n),a(e),r,i,s,o);return o.delete(n),u;case h8:if(Yc)return Yc.call(n)==Yc.call(e)}return!1}var g8=1,x8=Object.prototype,b8=x8.hasOwnProperty;function y8(n,e,t,r,i,s){var o=t&g8,a=Bm(n),l=a.length,c=Bm(e),u=c.length;if(l!=u&&!o)return!1;for(var h=l;h--;){var f=a[h];if(!(o?f in e:b8.call(e,f)))return!1}var p=s.get(n),m=s.get(e);if(p&&m)return p==e&&m==n;var g=!0;s.set(n,e),s.set(e,n);for(var x=o;++h<l;){f=a[h];var b=n[f],y=e[f];if(r)var w=o?r(y,b,f,e,n,s):r(b,y,f,n,e,s);if(!(w===void 0?b===y||i(b,y,t,r,s):w)){g=!1;break}x||(x=f=="constructor")}if(g&&!x){var v=n.constructor,S=e.constructor;v!=S&&"constructor"in n&&"constructor"in e&&!(typeof v=="function"&&v instanceof v&&typeof S=="function"&&S instanceof S)&&(g=!1)}return s.delete(n),s.delete(e),g}var v8=1,Ym="[object Arguments]",Km="[object Array]",fa="[object Object]",w8=Object.prototype,Zm=w8.hasOwnProperty;function _8(n,e,t,r,i,s){var o=al(n),a=al(e),l=o?Km:dr(n),c=a?Km:dr(e);l=l==Ym?fa:l,c=c==Ym?fa:c;var u=l==fa,h=c==fa,f=l==c;if(f&&Bu(n)){if(!Bu(e))return!1;o=!0,u=!1}if(f&&!u)return s||(s=new wr),o||aw(n)?lw(n,e,t,r,i,s):m8(n,e,l,t,r,i,s);if(!(t&v8)){var p=u&&Zm.call(n,"__wrapped__"),m=h&&Zm.call(e,"__wrapped__");if(p||m){var g=p?n.value():n,x=m?e.value():e;return s||(s=new wr),i(g,x,t,r,s)}}return f?(s||(s=new wr),y8(n,e,t,r,i,s)):!1}function cw(n,e,t,r,i){return n===e?!0:n==null||e==null||!io(n)&&!io(e)?n!==n&&e!==e:_8(n,e,t,r,cw,i)}function S8(n,e){return cw(n,e)}/*! js-cookie v3.0.5 | MIT */function pa(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)n[r]=t[r]}return n}var P8={read:function(n){return n[0]==='"'&&(n=n.slice(1,-1)),n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent)},write:function(n){return encodeURIComponent(n).replace(/%(2[346BF]|3[AC-F]|40|5[BDE]|60|7[BCD])/g,decodeURIComponent)}};function Uu(n,e){function t(i,s,o){if(!(typeof document>"u")){o=pa({},e,o),typeof o.expires=="number"&&(o.expires=new Date(Date.now()+o.expires*864e5)),o.expires&&(o.expires=o.expires.toUTCString()),i=encodeURIComponent(i).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape);var a="";for(var l in o)o[l]&&(a+="; "+l,o[l]!==!0&&(a+="="+o[l].split(";")[0]));return document.cookie=i+"="+n.write(s,i)+a}}function r(i){if(!(typeof document>"u"||arguments.length&&!i)){for(var s=document.cookie?document.cookie.split("; "):[],o={},a=0;a<s.length;a++){var l=s[a].split("="),c=l.slice(1).join("=");try{var u=decodeURIComponent(l[0]);if(o[u]=n.read(c,u),i===u)break}catch{}}return i?o[i]:o}}return Object.create({set:t,get:r,remove:function(i,s){t(i,"",pa({},s,{expires:-1}))},withAttributes:function(i){return Uu(this.converter,pa({},this.attributes,i))},withConverter:function(i){return Uu(pa({},this.converter,i),this.attributes)}},{attributes:{value:Object.freeze(e)},converter:{value:Object.freeze(n)}})}Uu(P8,{path:"/"});var Kc={exports:{}},Zc={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Jm;function C8(){if(Jm)return Zc;Jm=1;var n=c2();function e(h,f){return h===f&&(h!==0||1/h===1/f)||h!==h&&f!==f}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,i=n.useEffect,s=n.useLayoutEffect,o=n.useDebugValue;function a(h,f){var p=f(),m=r({inst:{value:p,getSnapshot:f}}),g=m[0].inst,x=m[1];return s(function(){g.value=p,g.getSnapshot=f,l(g)&&x({inst:g})},[h,p,f]),i(function(){return l(g)&&x({inst:g}),h(function(){l(g)&&x({inst:g})})},[h]),o(p),p}function l(h){var f=h.getSnapshot;h=h.value;try{var p=f();return!t(h,p)}catch{return!0}}function c(h,f){return f()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return Zc.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:u,Zc}var Qm;function k8(){return Qm||(Qm=1,Kc.exports=C8()),Kc.exports}k8();var eg,tg;function j8(n){return typeof n=="function"}const kh=typeof window<"u",T8=typeof navigator<"u";kh&&(!((tg=window)==null||(eg=tg.navigator)==null)&&eg.userAgent)&&/iP(?:ad|hone|od)/.test(window.navigator.userAgent);const jh=kh?_.useLayoutEffect:_.useEffect,Th=n=>{const e=_.useRef(n);return jh(()=>{e.current=n},[n]),e};function M8(n,...e){n&&n.addEventListener&&n.addEventListener(...e)}function A8(n,...e){n&&n.removeEventListener&&n.removeEventListener(...e)}const E8=typeof window<"u"?window:void 0,lc={};function Mh(n,e){if(!kh)return;if(!n)return e;let t;return j8(n)?t=n():"current"in n?t=n.current:t=n,t}const I8=n=>(n+1)%1e6;function R8(){const[,n]=_.useReducer(I8,0);return n}const O8=(n,e,t)=>{const r=_.useRef(void 0),i=R8();r.current||(r.current=e),jh(()=>{t(e,r.current)||(r.current=e,i())}),_.useEffect(n,r.current)},uw=(n,e)=>{O8(n,e,S8)};function ma(n,e,t,r=lc){const i=Th(e);uw(()=>{const s=Mh(t,E8);if(!(s&&s.addEventListener))return;const o=a=>i.current(a);return M8(s,n,o,r),()=>{s&&s.removeEventListener&&A8(s,n,o)}},[n,t,r])}const Jc=n=>{const e=_.useRef(n);return jh(()=>{e.current=n},[n]),_.useCallback((...t)=>{const r=e.current;return r(...t)},[])};function $8(n){const e=Th(n);_.useEffect(()=>()=>{e.current()},[e])}const D8=(n,e)=>{const[t,r]=_.useState(!1),i=_.useRef(0);return ma("dragenter",s=>{s.preventDefault(),i.current+=1,r(!0)},n),ma("dragover",s=>{s.preventDefault()},n),ma("dragleave",s=>{s.preventDefault(),i.current-=1,i.current===0&&r(!1)},n),ma("drop",s=>{var o;s.preventDefault(),i.current=0,r(!1);var a;const l=Array.from((a=(o=s.dataTransfer)==null?void 0:o.files)!=null?a:[]);e?.(l.length===0?null:l)},n),t},N8=(n,e,t=lc)=>{const r=Th(e),i=_.useRef(),s=_.useCallback(()=>{i.current&&i.current.disconnect()},[]);return uw(()=>{const o=Mh(n);if(o)return i.current=new ResizeObserver(r.current),i.current.observe(o,t),s},[r,s,n,t]),s},L8=(n,e=lc)=>{const{box:t="content-box"}=e,[r,i]=_.useState(0),[s,o]=_.useState(0);return N8(n,([a])=>{const l=t==="border-box"?a.borderBoxSize:t==="content-box"?a.contentBoxSize:a.devicePixelContentBoxSize;l?(i(l.reduce((c,{inlineSize:u})=>c+u,0)),o(l.reduce((c,{blockSize:u})=>c+u,0))):(i(a.contentRect.width),o(a.contentRect.height))},e),[r,s]},F8=(n,e=lc)=>{const{onExit:t,onEnter:r}=e,[i,s]=_.useState(!1),o=()=>{if(ln.isEnabled){const{isFullscreen:u}=ln;u?r?.():(ln.off("change",o),t?.()),s(u)}},a=()=>{const u=Mh(n);if(u&&ln.isEnabled)try{ln.request(u),ln.on("change",o)}catch(h){console.error(h)}},l=()=>{ln.isEnabled&&ln.exit()},c=()=>{i?l():a()};return $8(()=>{ln.isEnabled&&ln.off("change",o)}),[i,{enterFullscreen:Jc(a),exitFullscreen:Jc(l),toggleFullscreen:Jc(c),isEnabled:ln.isEnabled}]},ga=T8?navigator:void 0;ga&&(ga.connection||ga.mozConnection||ga.webkitConnection);ld.use;function z8(n,e){window.URL=window.URL||window.webkitURL;var t=new Blob(n.source,{type:"text/xml"}),r=window.URL.createObjectURL(t),i=document.body,s=document.createElement("a");i.appendChild(s),s.setAttribute("download",e+".svg"),s.setAttribute("href",r),s.style.display="none",s.click(),s.parentNode.removeChild(s),setTimeout(function(){window.URL.revokeObjectURL(r)},10)}const Dr={svg:"http://www.w3.org/2000/svg",xlink:"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/"};function B8(n){var e=window.document.createElementNS(Dr.svg,"svg");window.document.body.appendChild(e);for(var t=window.getComputedStyle(e),r=o(n),i=r.length;i--;)s(r[i]);e.parentNode.removeChild(e);function s(a){var l=window.getComputedStyle(a),c,u,h,f,p="";for(c=0,u=l.length;c<u;c++)h=l[c],f=l.getPropertyValue(h),f!==t.getPropertyValue(h)&&h!=="height"&&h!=="width"&&(p+=h+":"+f+";");a.setAttribute("style",p)}function o(a){var l=[];l.push(a),c(a);function c(u){if(u&&u.hasChildNodes())for(var h=u.firstChild;h;)h.nodeType===1&&h.nodeName!="SCRIPT"&&(l.push(h),c(h)),h=h.nextSibling}return l}}function ng(n){n.setAttribute("version","1.1"),n.removeAttribute("xmlns"),n.removeAttribute("xlink"),n.hasAttributeNS(Dr.xmlns,"xmlns")||n.setAttributeNS(Dr.xmlns,"xmlns",Dr.svg),n.hasAttributeNS(Dr.xmlns,"xmlns:xlink")||n.setAttributeNS(Dr.xmlns,"xmlns:xlink",Dr.xlink),B8(n);var e=new XMLSerializer,t=e.serializeToString(n),r='<?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">',i=n.getBoundingClientRect(),s={top:i.top,left:i.left,width:i.width,height:i.height,class:n.getAttribute("class"),id:n.getAttribute("id"),childElementCount:n.childElementCount,source:[r+t]};return s}function H8(n,t){if(n.nodeName!=="svg"||n.nodeType!==1)throw"Need an svg element input";var t=t||{},s=ng(n),r=V8(s),i=t.filename||r,s=ng(n);z8(s,i)}function V8(n){var e="untitled";return n.id?e=n.id:n.class?e=n.class:window.document.title&&(e=window.document.title.replace(/[^a-z0-9]/gi,"-").toLowerCase()),e}const W8=(n,e)=>{let[t,r]=L8(n);if(t===0&&r===0){const i=document.getElementsByClassName("fileview-container").item(0);if(i){const{paddingLeft:s,paddingRight:o}=getComputedStyle(i);t=i.clientWidth-Number.parseFloat(s)-Number.parseFloat(o)}else t=960;r=e}return t=t+100,r=r+100,`${-t/2} ${-r/2} ${t} ${r}`},U8=n=>{const e=te.c(47),{experiment:t,visibleCrosslinkIds:r,height:i}=n,s=i===void 0?300:i,o=_.useRef(null),[a,l]=F8(o),{toggleFullscreen:c,isEnabled:u}=l,h=W8(o,s),f=_.useRef(null),p=_.useRef(null),m=Je(ie).xlMapSettings??{},{experimentIdToGroupedStructureIds:g}=Je(ie),x=g[t.id].flat().length>0,b=ON(t,r,m);let y,w;e[0]!==b?(y=()=>{if(p.current)p.current.updateData(b);else{if(!f.current)return;p.current=new mN(f.current,qc,b,$N,["under","ok","over","partially-ok","mixed-violated","unmapped"])}return()=>{p.current&&(p.current.onUpdatePositions=void 0,p.current=null)}},w=[b],e[0]=b,e[1]=y,e[2]=w):(y=e[1],w=e[2]),_.useEffect(y,w);let v;e[3]===Symbol.for("react.memo_cache_sentinel")?(v={gutter:2},e[3]=v):v=e[3];let S;e[4]!==c?(S=async me=>{const{value:ge}=me;if(ge==="full-screen")c();else if(ge==="export"){if(f.current===null)return;H8(f.current,{filename:"map"})}},e[4]=c,e[5]=S):S=e[5];let k;e[6]===Symbol.for("react.memo_cache_sentinel")?(k=d.jsx(Fr,{asChild:!0,children:d.jsx(ke,{size:"2xs",variant:"ghost",position:"absolute",mt:3,ml:3,children:d.jsx(Bg,{})})}),e[6]=k):k=e[6];const P=!u;let C;e[7]!==a?(C=a?d.jsx(u2,{}):d.jsx(d2,{}),e[7]=a,e[8]=C):C=e[8];const T=a?"Exit":"Enter";let A;e[9]!==T||e[10]!==P||e[11]!==C?(A=d.jsxs(tn,{value:"full-screen",disabled:P,children:[C,T," Full Screen"]}),e[9]=T,e[10]=P,e[11]=C,e[12]=A):A=e[12];let M,O;e[13]===Symbol.for("react.memo_cache_sentinel")?(M=d.jsxs(tn,{value:"export",children:[d.jsx(Ng,{}),"Export..."]}),O=d.jsx(Ei,{}),e[13]=M,e[14]=O):(M=e[13],O=e[14]);let R;e[15]!==m.showBackgroundGrid?(R=d.jsx(Mi,{value:"showBackgroundGrid",checked:m.showBackgroundGrid,onCheckedChange:q8,children:"Show Background Grid"}),e[15]=m.showBackgroundGrid,e[16]=R):R=e[16];let j;e[17]!==m.showProteinsFromOtherExperiments?(j=d.jsx(Mi,{value:"showProteinsFromOtherExperiments",checked:m.showProteinsFromOtherExperiments,onCheckedChange:X8,children:"Show All Reference Proteins"}),e[17]=m.showProteinsFromOtherExperiments,e[18]=j):j=e[18];let I;e[19]!==m.showProteinsWithoutCrosslinks?(I=d.jsx(Mi,{value:"showProteinsWithoutCrosslinks",checked:m.showProteinsWithoutCrosslinks,onCheckedChange:G8,children:"Show Proteins Without Crosslinks"}),e[19]=m.showProteinsWithoutCrosslinks,e[20]=I):I=e[20];let E;e[21]===Symbol.for("react.memo_cache_sentinel")?(E=d.jsx(Ei,{}),e[21]=E):E=e[21];let D,L;e[22]===Symbol.for("react.memo_cache_sentinel")?(D=d.jsx(ji,{fontSize:"xs",pt:0,userSelect:"none",cursor:"default",children:"Color crosslinks by"}),L=d.jsx(Ai,{value:"type",children:"Type"}),e[22]=D,e[23]=L):(D=e[22],L=e[23]);const z=!x;let B;e[24]!==z?(B=d.jsx(Ai,{value:"distance",disabled:z,children:"Distance"}),e[24]=z,e[25]=B):B=e[25];let N;e[26]!==B||e[27]!==m.colorCrosslinksBy?(N=d.jsxs(yu,{value:m.colorCrosslinksBy,onValueChange:Y8,children:[D,L,B]}),e[26]=B,e[27]=m.colorCrosslinksBy,e[28]=N):N=e[28];let U;e[29]!==A||e[30]!==R||e[31]!==j||e[32]!==I||e[33]!==N?(U=d.jsxs(fr,{portalled:!1,children:[A,M,O,R,j,I,E,N]}),e[29]=A,e[30]=R,e[31]=j,e[32]=I,e[33]=N,e[34]=U):U=e[34];let q;e[35]!==U||e[36]!==S?(q=d.jsxs(pr,{size:"sm",positioning:v,onSelect:S,children:[k,U]}),e[35]=U,e[36]=S,e[37]=q):q=e[37];let X;e[38]!==m.showBackgroundGrid?(X=[qc.xlmap,...m.showBackgroundGrid?[qc.grid]:[]],e[38]=m.showBackgroundGrid,e[39]=X):X=e[39];const J=X.join(" "),ee=a?"100%":`${s}px`;let re;e[40]!==J||e[41]!==ee||e[42]!==h?(re=d.jsx("svg",{className:J,width:"100%",height:ee,viewBox:h,ref:f}),e[40]=J,e[41]=ee,e[42]=h,e[43]=re):re=e[43];let oe;return e[44]!==q||e[45]!==re?(oe=d.jsxs(ft,{ref:o,bg:"bg",children:[q,re]}),e[44]=q,e[45]=re,e[46]=oe):oe=e[46],oe};function q8(n){ie.xlMapSettings.showBackgroundGrid=n}function X8(n){ie.xlMapSettings.showProteinsFromOtherExperiments=n}function G8(n){ie.xlMapSettings.showProteinsWithoutCrosslinks=n}function Y8(n){const{value:e}=n;return ie.xlMapSettings.colorCrosslinksBy=e}Dn.register(Ph,ic,Sh,Mr);Mr.positioners.top=n=>{if(n.length===0)return!1;const e=n[0].element.x,t=n.reduce((r,{element:i})=>Math.min(r,i.y),1/0);return{x:e,y:t,yAlign:"bottom"}};const K8=n=>{const e=te.c(21),{distances:t,view:r,thresholds:i}=n;let s,o,a,l;if(e[0]!==t||e[1]!==i||e[2]!==r){const g=AM();r==="thresholds"&&g.domain([0,1/0]).thresholds([i?.lower?[i.lower]:[],i?.upper?[i.upper]:[]].flat()),s=g(t),o={plugins:{legend:{display:!1},tooltip:{position:"top",titleAlign:"center",callbacks:{title:x=>{const b=s[x[0].dataIndex].length;return`${De(b,"distance")} ${b===1?"is":"are"}`},afterTitle:x=>{const{x0:b,x1:y}=s[x[0].dataIndex];return x[0].dataIndex===0?`below ${y} `:x[0].dataIndex===s.length-1?`above ${b} `:`between ${b}  and ${y} `},label:Z8}}},scales:{x:{display:!1,max:s[s.length-1].x0},x2:{display:!0,offset:!1,grid:{offset:!1},title:{display:!0,text:"Distance []"}},y:{title:{display:!0,text:"Count"}}},responsive:!0,maintainAspectRatio:!1,interaction:{mode:"x",intersect:!1},layout:{padding:{top:40}}},l=[void 0,...s.flatMap(J8),void 0],a=s.map(Q8),e[0]=t,e[1]=i,e[2]=r,e[3]=s,e[4]=o,e[5]=a,e[6]=l}else s=e[3],o=e[4],a=e[5],l=e[6];let c;e[7]!==s||e[8]!==i?.lower||e[9]!==i?.upper?(c=g=>{const x=i?.lower??0,b=i?.upper??1/0;if(s[g.dataIndex]===void 0)return;const{x0:y,x1:w}=s[g.dataIndex];return y===void 0||w===void 0?"green":y<x&&w<=x?"orange":y>=b&&w>b?"red":y>=x&&w<=b?"green":"darkgreen"},e[7]=s,e[8]=i?.lower,e[9]=i?.upper,e[10]=c):c=e[10];let u;e[11]!==a||e[12]!==c?(u=[{data:a,backgroundColor:c,barPercentage:1,categoryPercentage:1}],e[11]=a,e[12]=c,e[13]=u):u=e[13];let h;e[14]!==l||e[15]!==u?(h={labels:l,datasets:u},e[14]=l,e[15]=u,e[16]=h):h=e[16];const f=h;let p;e[17]===Symbol.for("react.memo_cache_sentinel")?(p={position:"relative",height:"300px",width:"100%"},e[17]=p):p=e[17];let m;return e[18]!==f||e[19]!==o?(m=d.jsx(Sl,{children:d.jsx("div",{style:p,children:d.jsx(Ch,{options:o,data:f})})}),e[18]=f,e[19]=o,e[20]=m):m=e[20],m};function Z8(){return""}function J8(n,e){const{x0:t}=n;return e===0?[]:[t]}function Q8(n){return n.x0===void 0||n.x1===void 0?null:{x:n.x0+(n.x1-n.x0)/2,y:n.length}}/*!
* chartjs-plugin-annotation v3.1.0
* https://www.chartjs.org/chartjs-plugin-annotation/index
 * (c) 2024 chartjs-plugin-annotation Contributors
 * Released under the MIT License
 */const rg={modes:{point(n,e){return Ma(n,e,{intersect:!0})},nearest(n,e,t){return nF(n,e,t)},x(n,e,t){return Ma(n,e,{intersect:t.intersect,axis:"x"})},y(n,e,t){return Ma(n,e,{intersect:t.intersect,axis:"y"})}}};function Ah(n,e,t){return(rg.modes[t.mode]||rg.modes.nearest)(n,e,t)}function eF(n,e,t){return t!=="x"&&t!=="y"?n.inRange(e.x,e.y,"x",!0)||n.inRange(e.x,e.y,"y",!0):n.inRange(e.x,e.y,t,!0)}function tF(n,e,t){return t==="x"?{x:n.x,y:e.y}:t==="y"?{x:e.x,y:n.y}:e}function Ma(n,e,t){return n.filter(r=>t.intersect?r.inRange(e.x,e.y):eF(r,e,t.axis))}function nF(n,e,t){let r=Number.POSITIVE_INFINITY;return Ma(n,e,t).reduce((i,s)=>{const o=s.getCenterPoint(),a=tF(e,o,t.axis),l=Hi(e,a);return l<r?(i=[s],r=l):l===r&&i.push(s),i},[]).sort((i,s)=>i._index-s._index).slice(0,1)}function fi(n,e,t){const r=Math.cos(t),i=Math.sin(t),s=e.x,o=e.y;return{x:s+r*(n.x-s)-i*(n.y-o),y:o+i*(n.x-s)+r*(n.y-o)}}const rF=(n,e)=>e>n||n.length>e.length&&n.slice(0,e.length)===e,Vr=.001,cc=(n,e,t)=>Math.min(t,Math.max(e,n)),dw=(n,e)=>n.value>=n.start-e&&n.value<=n.end+e;function iF(n,e,t){for(const r of Object.keys(n))n[r]=cc(n[r],e,t);return n}function sF(n,e,t,r){return!n||!e||t<=0?!1:Math.pow(n.x-e.x,2)+Math.pow(n.y-e.y,2)<=Math.pow(t+r,2)}function hw(n,{x:e,y:t,x2:r,y2:i},s,{borderWidth:o,hitTolerance:a}){const l=(o+a)/2,c=n.x>=e-l-Vr&&n.x<=r+l+Vr,u=n.y>=t-l-Vr&&n.y<=i+l+Vr;return s==="x"?c:(s==="y"||c)&&u}function fw(n,{rect:e,center:t},r,{rotation:i,borderWidth:s,hitTolerance:o}){const a=fi(n,t,st(-i));return hw(a,e,r,{borderWidth:s,hitTolerance:o})}function pi(n,e){const{centerX:t,centerY:r}=n.getProps(["centerX","centerY"],e);return{x:t,y:r}}function oF(n,e,t,r=!0){const i=t.split(".");let s=0;for(const o of e.split(".")){const a=i[s++];if(parseInt(o,10)<parseInt(a,10))break;if(rF(a,o)){if(r)throw new Error(`${n} v${t} is not supported. v${e} or newer is required.`);return!1}}return!0}const pw=n=>typeof n=="string"&&n.endsWith("%"),mw=n=>parseFloat(n)/100,gw=n=>cc(mw(n),0,1),ws=(n,e)=>({x:n,y:e,x2:n,y2:e,width:0,height:0}),aF={box:n=>ws(n.centerX,n.centerY),doughnutLabel:n=>ws(n.centerX,n.centerY),ellipse:n=>({centerX:n.centerX,centerY:n.centerX,radius:0,width:0,height:0}),label:n=>ws(n.centerX,n.centerY),line:n=>ws(n.x,n.y),point:n=>({centerX:n.centerX,centerY:n.centerY,radius:0,width:0,height:0}),polygon:n=>ws(n.centerX,n.centerY)};function Eh(n,e){return e==="start"?0:e==="end"?n:pw(e)?gw(e)*n:n/2}function Pr(n,e,t=!0){return typeof e=="number"?e:pw(e)?(t?gw(e):mw(e))*n:n}function lF(n,e){const{x:t,width:r}=n,i=e.textAlign;return i==="center"?t+r/2:i==="end"||i==="right"?t+r:t}function xw(n,e,{borderWidth:t,position:r,xAdjust:i,yAdjust:s},o){const a=Ae(o),l=e.width+(a?o.width:0)+t,c=e.height+(a?o.height:0)+t,u=Ih(r),h=ig(n.x,l,i,u.x),f=ig(n.y,c,s,u.y);return{x:h,y:f,x2:h+l,y2:f+c,width:l,height:c,centerX:h+l/2,centerY:f+c/2}}function Ih(n,e="center"){return Ae(n)?{x:Ce(n.x,e),y:Ce(n.y,e)}:(n=Ce(n,e),{x:n,y:n})}const bw=(n,e)=>n&&n.autoFit&&e<1;function yw(n,e){const t=n.font,r=qe(t)?t:[t];return bw(n,e)?r.map(function(i){const s=ht(i);return s.size=Math.floor(i.size*e),s.lineHeight=i.lineHeight,ht(s)}):r.map(i=>ht(i))}function vw(n){return n&&($t(n.xValue)||$t(n.yValue))}function ig(n,e,t=0,r){return n-Eh(e,r)+t}function os(n,e,t){const r=t.init;if(r){if(r===!0)return _w(e,t)}else return;return cF(n,e,t)}function ww(n,e,t){let r=!1;return e.forEach(i=>{Rt(n[i])?(r=!0,t[i]=n[i]):$t(t[i])&&delete t[i]}),r}function _w(n,e){const t=e.type||"line";return aF[t](n)}function cF(n,e,t){const r=Be(t.init,[{chart:n,properties:e,options:t}]);if(r===!0)return _w(e,t);if(Ae(r))return r}const Qc=new Map,uF=n=>isNaN(n)||n<=0,dF=n=>n.reduce(function(e,t){return e+=t.string,e},"");function uc(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object HTMLImageElement]"||e==="[object HTMLCanvasElement]"}}function dc(n,{x:e,y:t},r){r&&(n.translate(e,t),n.rotate(st(r)),n.translate(-e,-t))}function tr(n,e){if(e&&e.borderWidth)return n.lineCap=e.borderCapStyle||"butt",n.setLineDash(e.borderDash),n.lineDashOffset=e.borderDashOffset,n.lineJoin=e.borderJoinStyle||"miter",n.lineWidth=e.borderWidth,n.strokeStyle=e.borderColor,!0}function as(n,e){n.shadowColor=e.backgroundShadowColor,n.shadowBlur=e.shadowBlur,n.shadowOffsetX=e.shadowOffsetX,n.shadowOffsetY=e.shadowOffsetY}function hc(n,e){const t=e.content;if(uc(t))return{width:Pr(t.width,e.width),height:Pr(t.height,e.height)};const r=yw(e),i=e.textStrokeWidth,s=qe(t)?t:[t],o=s.join()+dF(r)+i+(n._measureText?"-spriting":"");return Qc.has(o)||Qc.set(o,mF(n,s,r,i)),Qc.get(o)}function Sw(n,e,t){const{x:r,y:i,width:s,height:o}=e;n.save(),as(n,t);const a=tr(n,t);n.fillStyle=t.backgroundColor,n.beginPath(),no(n,{x:r,y:i,w:s,h:o,radius:iF(Gr(t.borderRadius),0,Math.min(s,o)/2)}),n.closePath(),n.fill(),a&&(n.shadowColor=t.borderShadowColor,n.stroke()),n.restore()}function Pw(n,e,t,r){const i=t.content;if(uc(i)){n.save(),n.globalAlpha=bF(t.opacity,i.style.opacity),n.drawImage(i,e.x,e.y,e.width,e.height),n.restore();return}const s=qe(i)?i:[i],o=yw(t,r),a=t.color,l=qe(a)?a:[a],c=lF(e,t),u=e.y+t.textStrokeWidth/2;n.save(),n.textBaseline="middle",n.textAlign=t.textAlign,hF(n,t)&&gF(n,{x:c,y:u},s,o),xF(n,{x:c,y:u},s,{fonts:o,colors:l}),n.restore()}function hF(n,e){if(e.textStrokeWidth>0)return n.lineJoin="round",n.miterLimit=2,n.lineWidth=e.textStrokeWidth,n.strokeStyle=e.textStrokeColor,!0}function fF(n,e,t,r){const{radius:i,options:s}=e,o=s.pointStyle,a=s.rotation;let l=(a||0)*hh;if(uc(o)){n.save(),n.translate(t,r),n.rotate(l),n.drawImage(o,-o.width/2,-o.height/2,o.width,o.height),n.restore();return}uF(i)||pF(n,{x:t,y:r,radius:i,rotation:a,style:o,rad:l})}function pF(n,{x:e,y:t,radius:r,rotation:i,style:s,rad:o}){let a,l,c,u;switch(n.beginPath(),s){default:n.arc(e,t,r,0,ut),n.closePath();break;case"triangle":n.moveTo(e+Math.sin(o)*r,t-Math.cos(o)*r),o+=nl,n.lineTo(e+Math.sin(o)*r,t-Math.cos(o)*r),o+=nl,n.lineTo(e+Math.sin(o)*r,t-Math.cos(o)*r),n.closePath();break;case"rectRounded":u=r*.516,c=r-u,a=Math.cos(o+Qt)*c,l=Math.sin(o+Qt)*c,n.arc(e-a,t-l,u,o-ze,o-dt),n.arc(e+l,t-a,u,o-dt,o),n.arc(e+a,t+l,u,o,o+dt),n.arc(e-l,t+a,u,o+dt,o+ze),n.closePath();break;case"rect":if(!i){c=Math.SQRT1_2*r,n.rect(e-c,t-c,2*c,2*c);break}o+=Qt;case"rectRot":a=Math.cos(o)*r,l=Math.sin(o)*r,n.moveTo(e-a,t-l),n.lineTo(e+l,t-a),n.lineTo(e+a,t+l),n.lineTo(e-l,t+a),n.closePath();break;case"crossRot":o+=Qt;case"cross":a=Math.cos(o)*r,l=Math.sin(o)*r,n.moveTo(e-a,t-l),n.lineTo(e+a,t+l),n.moveTo(e+l,t-a),n.lineTo(e-l,t+a);break;case"star":a=Math.cos(o)*r,l=Math.sin(o)*r,n.moveTo(e-a,t-l),n.lineTo(e+a,t+l),n.moveTo(e+l,t-a),n.lineTo(e-l,t+a),o+=Qt,a=Math.cos(o)*r,l=Math.sin(o)*r,n.moveTo(e-a,t-l),n.lineTo(e+a,t+l),n.moveTo(e+l,t-a),n.lineTo(e-l,t+a);break;case"line":a=Math.cos(o)*r,l=Math.sin(o)*r,n.moveTo(e-a,t-l),n.lineTo(e+a,t+l);break;case"dash":n.moveTo(e,t),n.lineTo(e+Math.cos(o)*r,t+Math.sin(o)*r);break}n.fill()}function mF(n,e,t,r){n.save();const i=e.length;let s=0,o=r;for(let a=0;a<i;a++){const l=t[Math.min(a,t.length-1)];n.font=l.string;const c=e[a];s=Math.max(s,n.measureText(c).width+r),o+=l.lineHeight}return n.restore(),{width:s,height:o}}function gF(n,{x:e,y:t},r,i){n.beginPath();let s=0;r.forEach(function(o,a){const l=i[Math.min(a,i.length-1)],c=l.lineHeight;n.font=l.string,n.strokeText(o,e,t+c/2+s),s+=c}),n.stroke()}function xF(n,{x:e,y:t},r,{fonts:i,colors:s}){let o=0;r.forEach(function(a,l){const c=s[Math.min(l,s.length-1)],u=i[Math.min(l,i.length-1)],h=u.lineHeight;n.beginPath(),n.font=u.string,n.fillStyle=c,n.fillText(a,e,t+h/2+o),o+=h,n.fill()})}function bF(n,e){const t=ii(n)?n:e;return ii(t)?cc(t,0,1):1}const Cw=["left","bottom","top","right"];function yF(n,e){const{pointX:t,pointY:r,options:i}=e,s=i.callout,o=s&&s.display&&PF(e,s);if(!o||kF(e,s,o))return;if(n.save(),n.beginPath(),!tr(n,s))return n.restore();const{separatorStart:l,separatorEnd:c}=vF(e,o),{sideStart:u,sideEnd:h}=_F(e,o,l);(s.margin>0||i.borderWidth===0)&&(n.moveTo(l.x,l.y),n.lineTo(c.x,c.y)),n.moveTo(u.x,u.y),n.lineTo(h.x,h.y);const f=fi({x:t,y:r},e.getCenterPoint(),st(-e.rotation));n.lineTo(f.x,f.y),n.stroke(),n.restore()}function vF(n,e){const{x:t,y:r,x2:i,y2:s}=n,o=wF(n,e);let a,l;return e==="left"||e==="right"?(a={x:t+o,y:r},l={x:a.x,y:s}):(a={x:t,y:r+o},l={x:i,y:a.y}),{separatorStart:a,separatorEnd:l}}function wF(n,e){const{width:t,height:r,options:i}=n,s=i.callout.margin+i.borderWidth/2;return e==="right"?t+s:e==="bottom"?r+s:-s}function _F(n,e,t){const{y:r,width:i,height:s,options:o}=n,a=o.callout.start,l=SF(e,o.callout);let c,u;return e==="left"||e==="right"?(c={x:t.x,y:r+Pr(s,a)},u={x:c.x+l,y:c.y}):(c={x:t.x+Pr(i,a),y:t.y},u={x:c.x,y:c.y+l}),{sideStart:c,sideEnd:u}}function SF(n,e){const t=e.side;return n==="left"||n==="top"?-t:t}function PF(n,e){const t=e.position;return Cw.includes(t)?t:CF(n,e)}function CF(n,e){const{x:t,y:r,x2:i,y2:s,width:o,height:a,pointX:l,pointY:c,centerX:u,centerY:h,rotation:f}=n,p={x:u,y:h},m=e.start,g=Pr(o,m),x=Pr(a,m),b=[t,t+g,t+g,i],y=[r+x,s,r,s],w=[];for(let v=0;v<4;v++){const S=fi({x:b[v],y:y[v]},p,st(f));w.push({position:Cw[v],distance:Hi(S,{x:l,y:c})})}return w.sort((v,S)=>v.distance-S.distance)[0].position}function kF(n,e,t){const{pointX:r,pointY:i}=n,s=e.margin;let o=r,a=i;return t==="left"?o+=s:t==="right"?o-=s:t==="top"?a+=s:t==="bottom"&&(a-=s),n.inRange(o,a)}const sg={xScaleID:{min:"xMin",max:"xMax",start:"left",end:"right",startProp:"x",endProp:"x2"},yScaleID:{min:"yMin",max:"yMax",start:"bottom",end:"top",startProp:"y",endProp:"y2"}};function qi(n,e,t){return e=typeof e=="number"?e:n.parse(e),Ot(e)?n.getPixelForValue(e):t}function ai(n,e,t){const r=e[t];if(r||t==="scaleID")return r;const i=t.charAt(0),s=Object.values(n).filter(o=>o.axis&&o.axis===i);return s.length?s[0].id:i}function kw(n,e){if(n){const t=n.options.reverse,r=qi(n,e.min,t?e.end:e.start),i=qi(n,e.max,t?e.start:e.end);return{start:r,end:i}}}function jw(n,e){const{chartArea:t,scales:r}=n,i=r[ai(r,e,"xScaleID")],s=r[ai(r,e,"yScaleID")];let o=t.width/2,a=t.height/2;return i&&(o=qi(i,e.xValue,i.left+i.width/2)),s&&(a=qi(s,e.yValue,s.top+s.height/2)),{x:o,y:a}}function Rh(n,e){const t=n.scales,r=t[ai(t,e,"xScaleID")],i=t[ai(t,e,"yScaleID")];if(!r&&!i)return{};let{left:s,right:o}=r||n.chartArea,{top:a,bottom:l}=i||n.chartArea;const c=og(r,{min:e.xMin,max:e.xMax,start:s,end:o});s=c.start,o=c.end;const u=og(i,{min:e.yMin,max:e.yMax,start:l,end:a});return a=u.start,l=u.end,{x:s,y:a,x2:o,y2:l,width:o-s,height:l-a,centerX:s+(o-s)/2,centerY:a+(l-a)/2}}function Tw(n,e){if(!vw(e)){const t=Rh(n,e);let r=e.radius;(!r||isNaN(r))&&(r=Math.min(t.width,t.height)/2,e.radius=r);const i=r*2,s=t.centerX+e.xAdjust,o=t.centerY+e.yAdjust;return{x:s-r,y:o-r,x2:s+r,y2:o+r,centerX:s,centerY:o,width:i,height:i,radius:r}}return TF(n,e)}function jF(n,e){const{scales:t,chartArea:r}=n,i=t[e.scaleID],s={x:r.left,y:r.top,x2:r.right,y2:r.bottom};return i?MF(i,s,e):AF(t,s,e),s}function Mw(n,e){const t=Rh(n,e);return t.initProperties=os(n,t,e),t.elements=[{type:"label",optionScope:"label",properties:RF(n,t,e),initProperties:t.initProperties}],t}function TF(n,e){const t=jw(n,e),r=e.radius*2;return{x:t.x-e.radius+e.xAdjust,y:t.y-e.radius+e.yAdjust,x2:t.x+e.radius+e.xAdjust,y2:t.y+e.radius+e.yAdjust,centerX:t.x+e.xAdjust,centerY:t.y+e.yAdjust,radius:e.radius,width:r,height:r}}function og(n,e){const t=kw(n,e)||e;return{start:Math.min(t.start,t.end),end:Math.max(t.start,t.end)}}function MF(n,e,t){const r=qi(n,t.value,NaN),i=qi(n,t.endValue,r);n.isHorizontal()?(e.x=r,e.x2=i):(e.y=r,e.y2=i)}function AF(n,e,t){for(const r of Object.keys(sg)){const i=n[ai(n,t,r)];if(i){const{min:s,max:o,start:a,end:l,startProp:c,endProp:u}=sg[r],h=kw(i,{min:t[s],max:t[o],start:i[a],end:i[l]});e[c]=h.start,e[u]=h.end}}}function EF({properties:n,options:e},t,r,i){const{x:s,x2:o,width:a}=n;return Aw({start:s,end:o,borderWidth:e.borderWidth},{position:r.x,padding:{start:i.left,end:i.right},adjust:e.label.xAdjust,size:t.width})}function IF({properties:n,options:e},t,r,i){const{y:s,y2:o,height:a}=n;return Aw({start:s,end:o,borderWidth:e.borderWidth},{position:r.y,padding:{start:i.top,end:i.bottom},adjust:e.label.yAdjust,size:t.height})}function Aw(n,e){const{start:t,end:r,borderWidth:i}=n,{position:s,padding:{start:o,end:a},adjust:l}=e,c=r-i-t-o-a-e.size;return t+i/2+l+Eh(c,s)}function RF(n,e,t){const r=t.label;r.backgroundColor="transparent",r.callout.display=!1;const i=Ih(r.position),s=wt(r.padding),o=hc(n.ctx,r),a=EF({properties:e,options:t},o,i,s),l=IF({properties:e,options:t},o,i,s),c=o.width+s.width,u=o.height+s.height;return{x:a,y:l,x2:a+c,y2:l+u,width:c,height:u,centerX:a+c/2,centerY:l+u/2,rotation:r.rotation}}const qu=["enter","leave"],Oh=qu.concat("click");function OF(n,e,t){e.listened=ww(t,Oh,e.listeners),e.moveListened=!1,qu.forEach(r=>{Rt(t[r])&&(e.moveListened=!0)}),(!e.listened||!e.moveListened)&&e.annotations.forEach(r=>{!e.listened&&Rt(r.click)&&(e.listened=!0),e.moveListened||qu.forEach(i=>{Rt(r[i])&&(e.listened=!0,e.moveListened=!0)})})}function $F(n,e,t){if(n.listened)switch(e.type){case"mousemove":case"mouseout":return DF(n,e,t);case"click":return NF(n,e,t)}}function DF(n,e,t){if(!n.moveListened)return;let r;e.type==="mousemove"?r=Ah(n.visibleElements,e,t.interaction):r=[];const i=n.hovered;n.hovered=r;const s={state:n,event:e};let o=ag(s,"leave",i,r);return ag(s,"enter",r,i)||o}function ag({state:n,event:e},t,r,i){let s;for(const o of r)i.indexOf(o)<0&&(s=Ew(o.options[t]||n.listeners[t],o,e)||s);return s}function NF(n,e,t){const r=n.listeners,i=Ah(n.visibleElements,e,t.interaction);let s;for(const o of i)s=Ew(o.options.click||r.click,o,e)||s;return s}function Ew(n,e,t){return Be(n,[e.$context,t])===!0}const cl=["afterDraw","beforeDraw"];function LF(n,e,t){const r=e.visibleElements;e.hooked=ww(t,cl,e.hooks),e.hooked||r.forEach(i=>{e.hooked||cl.forEach(s=>{Rt(i.options[s])&&(e.hooked=!0)})})}function lg(n,e,t){if(n.hooked){const r=e.options[t]||n.hooks[t];return Be(r,[e.$context])}}function FF(n,e,t){const r=WF(n.scales,e,t);let i=cg(e,r,"min","suggestedMin");i=cg(e,r,"max","suggestedMax")||i,i&&Rt(e.handleTickRangeOptions)&&e.handleTickRangeOptions()}function zF(n,e){for(const t of n)HF(t,e)}function cg(n,e,t,r){if(Ot(e[t])&&!BF(n.options,t,r)){const i=n[t]!==e[t];return n[t]=e[t],i}}function BF(n,e,t){return $t(n[e])||$t(n[t])}function HF(n,e){for(const t of["scaleID","xScaleID","yScaleID"]){const r=ai(e,n,t);r&&!e[r]&&VF(n,t)&&console.warn(`No scale found with id '${r}' for annotation '${n.id}'`)}}function VF(n,e){if(e==="scaleID")return!0;const t=e.charAt(0);for(const r of["Min","Max","Value"])if($t(n[t+r]))return!0;return!1}function WF(n,e,t){const r=e.axis,i=e.id,s=r+"ScaleID",o={min:Ce(e.min,Number.NEGATIVE_INFINITY),max:Ce(e.max,Number.POSITIVE_INFINITY)};for(const a of t)a.scaleID===i?ug(a,e,["value","endValue"],o):ai(n,a,s)===i&&ug(a,e,[r+"Min",r+"Max",r+"Value"],o);return o}function ug(n,e,t,r){for(const i of t){const s=n[i];if($t(s)){const o=e.parse(s);r.min=Math.min(r.min,o),r.max=Math.max(r.max,o)}}}class ls extends Nt{inRange(e,t,r,i){const{x:s,y:o}=fi({x:e,y:t},this.getCenterPoint(i),st(-this.options.rotation));return hw({x:s,y:o},this.getProps(["x","y","x2","y2"],i),r,this.options)}getCenterPoint(e){return pi(this,e)}draw(e){e.save(),dc(e,this.getCenterPoint(),this.options.rotation),Sw(e,this,this.options),e.restore()}get label(){return this.elements&&this.elements[0]}resolveElementProperties(e,t){return Mw(e,t)}}ls.id="boxAnnotation";ls.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderRadius:0,borderShadowColor:"transparent",borderWidth:1,display:!0,init:void 0,hitTolerance:0,label:{backgroundColor:"transparent",borderWidth:0,callout:{display:!1},color:"black",content:null,display:!1,drawTime:void 0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:"bold"},height:void 0,hitTolerance:void 0,opacity:void 0,padding:6,position:"center",rotation:void 0,textAlign:"start",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,yAdjust:0,z:void 0},rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,xMax:void 0,xMin:void 0,xScaleID:void 0,yMax:void 0,yMin:void 0,yScaleID:void 0,z:0};ls.defaultRoutes={borderColor:"color",backgroundColor:"color"};ls.descriptors={label:{_fallback:!0}};class fc extends Nt{inRange(e,t,r,i){return fw({x:e,y:t},{rect:this.getProps(["x","y","x2","y2"],i),center:this.getCenterPoint(i)},r,{rotation:this.rotation,borderWidth:0,hitTolerance:this.options.hitTolerance})}getCenterPoint(e){return pi(this,e)}draw(e){const t=this.options;!t.display||!t.content||(KF(e,this),e.save(),dc(e,this.getCenterPoint(),this.rotation),Pw(e,this,t,this._fitRatio),e.restore())}resolveElementProperties(e,t){const r=UF(e,t);if(!r)return{};const{controllerMeta:i,point:s,radius:o}=XF(e,t,r);let a=hc(e.ctx,t);const l=GF(a,o);bw(t,l)&&(a={width:a.width*l,height:a.height*l});const{position:c,xAdjust:u,yAdjust:h}=t,f=xw(s,a,{borderWidth:0,position:c,xAdjust:u,yAdjust:h});return{initProperties:os(e,f,t),...f,...i,rotation:t.rotation,_fitRatio:l}}}fc.id="doughnutLabelAnnotation";fc.defaults={autoFit:!0,autoHide:!0,backgroundColor:"transparent",backgroundShadowColor:"transparent",borderColor:"transparent",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderShadowColor:"transparent",borderWidth:0,color:"black",content:null,display:!0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:void 0},height:void 0,hitTolerance:0,init:void 0,opacity:void 0,position:"center",rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,spacing:1,textAlign:"center",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,yAdjust:0};fc.defaultRoutes={};function UF(n,e){return n.getSortedVisibleDatasetMetas().reduce(function(t,r){const i=r.controller;return i instanceof s$&&qF(n,e,r.data)&&(!t||i.innerRadius<t.controller.innerRadius)&&i.options.circumference>=90?r:t},void 0)}function qF(n,e,t){if(!e.autoHide)return!0;for(let r=0;r<t.length;r++)if(!t[r].hidden&&n.getDataVisibility(r))return!0}function XF({chartArea:n},e,t){const{left:r,top:i,right:s,bottom:o}=n,{innerRadius:a,offsetX:l,offsetY:c}=t.controller,u=(r+s)/2+l,h=(i+o)/2+c,f={left:Math.max(u-a,r),right:Math.min(u+a,s),top:Math.max(h-a,i),bottom:Math.min(h+a,o)},p={x:(f.left+f.right)/2,y:(f.top+f.bottom)/2},m=e.spacing+e.borderWidth/2,g=a-m,x=p.y>h,b=x?i+m:o-m,y=YF(b,u,h,g);return{controllerMeta:{_centerX:u,_centerY:h,_radius:g,_counterclockwise:x,...y},point:p,radius:Math.min(a,Math.min(f.right-f.left,f.bottom-f.top)/2)}}function GF({width:n,height:e},t){const r=Math.sqrt(Math.pow(n,2)+Math.pow(e,2));return t*2/r}function YF(n,e,t,r){const i=Math.pow(t-n,2),s=Math.pow(r,2),o=e*-2,a=Math.pow(e,2)+i-s,l=Math.pow(o,2)-4*a;if(l<=0)return{_startAngle:0,_endAngle:ut};const c=(-o-Math.sqrt(l))/2,u=(-o+Math.sqrt(l))/2;return{_startAngle:Ou({x:e,y:t},{x:c,y:n}).angle,_endAngle:Ou({x:e,y:t},{x:u,y:n}).angle}}function KF(n,e){const{_centerX:t,_centerY:r,_radius:i,_startAngle:s,_endAngle:o,_counterclockwise:a,options:l}=e;n.save();const c=tr(n,l);n.fillStyle=l.backgroundColor,n.beginPath(),n.arc(t,r,i,s,o,a),n.closePath(),n.fill(),c&&n.stroke(),n.restore()}class Do extends Nt{inRange(e,t,r,i){return fw({x:e,y:t},{rect:this.getProps(["x","y","x2","y2"],i),center:this.getCenterPoint(i)},r,{rotation:this.rotation,borderWidth:this.options.borderWidth,hitTolerance:this.options.hitTolerance})}getCenterPoint(e){return pi(this,e)}draw(e){const t=this.options,r=!$t(this._visible)||this._visible;!t.display||!t.content||!r||(e.save(),dc(e,this.getCenterPoint(),this.rotation),yF(e,this),Sw(e,this,t),Pw(e,ZF(this),t),e.restore())}resolveElementProperties(e,t){let r;if(vw(t))r=jw(e,t);else{const{centerX:a,centerY:l}=Rh(e,t);r={x:a,y:l}}const i=wt(t.padding),s=hc(e.ctx,t),o=xw(r,s,t,i);return{initProperties:os(e,o,t),pointX:r.x,pointY:r.y,...o,rotation:t.rotation}}}Do.id="labelAnnotation";Do.defaults={adjustScaleRange:!0,backgroundColor:"transparent",backgroundShadowColor:"transparent",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderRadius:0,borderShadowColor:"transparent",borderWidth:0,callout:{borderCapStyle:"butt",borderColor:void 0,borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:1,display:!1,margin:5,position:"auto",side:5,start:"50%"},color:"black",content:null,display:!0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:void 0},height:void 0,hitTolerance:0,init:void 0,opacity:void 0,padding:6,position:"center",rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,textAlign:"center",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,xMax:void 0,xMin:void 0,xScaleID:void 0,xValue:void 0,yAdjust:0,yMax:void 0,yMin:void 0,yScaleID:void 0,yValue:void 0,z:0};Do.defaultRoutes={borderColor:"color"};function ZF({x:n,y:e,width:t,height:r,options:i}){const s=i.borderWidth/2,o=wt(i.padding);return{x:n+o.left+s,y:e+o.top+s,width:t-o.left-o.right-i.borderWidth,height:r-o.top-o.bottom-i.borderWidth}}const $h=(n,e,t)=>({x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}),Xu=(n,e,t)=>$h(e,t,Math.abs((n-e.y)/(t.y-e.y))).x,dg=(n,e,t)=>$h(e,t,Math.abs((n-e.x)/(t.x-e.x))).y,Es=n=>n*n,JF=(n,e,{x:t,y:r,x2:i,y2:s},o)=>o==="y"?{start:Math.min(r,s),end:Math.max(r,s),value:e}:{start:Math.min(t,i),end:Math.max(t,i),value:n},hg=(n,e,t,r)=>(1-r)*(1-r)*n+2*(1-r)*r*e+r*r*t,Gu=(n,e,t,r)=>({x:hg(n.x,e.x,t.x,r),y:hg(n.y,e.y,t.y,r)}),fg=(n,e,t,r)=>2*(1-r)*(e-n)+2*r*(t-e),pg=(n,e,t,r)=>-Math.atan2(fg(n.x,e.x,t.x,r),fg(n.y,e.y,t.y,r))+.5*ze;class No extends Nt{inRange(e,t,r,i){const s=(this.options.borderWidth+this.options.hitTolerance)/2;if(r!=="x"&&r!=="y"){const o={mouseX:e,mouseY:t},{path:a,ctx:l}=this;if(a){tr(l,this.options),l.lineWidth+=this.options.hitTolerance;const{chart:u}=this.$context,h=e*u.currentDevicePixelRatio,f=t*u.currentDevicePixelRatio,p=l.isPointInStroke(a,h,f)||Yu(this,o,i);return l.restore(),p}const c=Es(s);return nz(this,o,c,i)||Yu(this,o,i)}return QF(this,{mouseX:e,mouseY:t},r,{hitSize:s,useFinalPosition:i})}getCenterPoint(e){return pi(this,e)}draw(e){const{x:t,y:r,x2:i,y2:s,cp:o,options:a}=this;if(e.save(),!tr(e,a))return e.restore();as(e,a);const l=Math.sqrt(Math.pow(i-t,2)+Math.pow(s-r,2));if(a.curve&&o)return uz(e,this,o,l),e.restore();const{startOpts:c,endOpts:u,startAdjust:h,endAdjust:f}=Iw(this),p=Math.atan2(s-r,i-t);e.translate(t,r),e.rotate(p),e.beginPath(),e.moveTo(0+h,0),e.lineTo(l-f,0),e.shadowColor=a.borderShadowColor,e.stroke(),Ku(e,0,h,c),Ku(e,l,-f,u),e.restore()}get label(){return this.elements&&this.elements[0]}resolveElementProperties(e,t){const r=jF(e,t),{x:i,y:s,x2:o,y2:a}=r,l=ez(r,e.chartArea),c=l?tz({x:i,y:s},{x:o,y:a},e.chartArea):{x:i,y:s,x2:o,y2:a,width:Math.abs(o-i),height:Math.abs(a-s)};if(c.centerX=(o+i)/2,c.centerY=(a+s)/2,c.initProperties=os(e,c,t),t.curve){const h={x:c.x,y:c.y},f={x:c.x2,y:c.y2};c.cp=cz(c,t,Hi(h,f))}const u=rz(e,c,t.label);return u._visible=l,c.elements=[{type:"label",optionScope:"label",properties:u,initProperties:c.initProperties}],c}}No.id="lineAnnotation";const mg={backgroundColor:void 0,backgroundShadowColor:void 0,borderColor:void 0,borderDash:void 0,borderDashOffset:void 0,borderShadowColor:void 0,borderWidth:void 0,display:void 0,fill:void 0,length:void 0,shadowBlur:void 0,shadowOffsetX:void 0,shadowOffsetY:void 0,width:void 0};No.defaults={adjustScaleRange:!0,arrowHeads:{display:!1,end:Object.assign({},mg),fill:!1,length:12,start:Object.assign({},mg),width:6},borderDash:[],borderDashOffset:0,borderShadowColor:"transparent",borderWidth:2,curve:!1,controlPoint:{y:"-50%"},display:!0,endValue:void 0,init:void 0,hitTolerance:0,label:{backgroundColor:"rgba(0,0,0,0.8)",backgroundShadowColor:"transparent",borderCapStyle:"butt",borderColor:"black",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderRadius:6,borderShadowColor:"transparent",borderWidth:0,callout:Object.assign({},Do.defaults.callout),color:"#fff",content:null,display:!1,drawTime:void 0,font:{family:void 0,lineHeight:void 0,size:void 0,style:void 0,weight:"bold"},height:void 0,hitTolerance:void 0,opacity:void 0,padding:6,position:"center",rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,textAlign:"center",textStrokeColor:void 0,textStrokeWidth:0,width:void 0,xAdjust:0,yAdjust:0,z:void 0},scaleID:void 0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,value:void 0,xMax:void 0,xMin:void 0,xScaleID:void 0,yMax:void 0,yMin:void 0,yScaleID:void 0,z:0};No.descriptors={arrowHeads:{start:{_fallback:!0},end:{_fallback:!0},_fallback:!0}};No.defaultRoutes={borderColor:"color"};function QF(n,{mouseX:e,mouseY:t},r,{hitSize:i,useFinalPosition:s}){const o=JF(e,t,n.getProps(["x","y","x2","y2"],s),r);return dw(o,i)||Yu(n,{mouseX:e,mouseY:t},s,r)}function ez({x:n,y:e,x2:t,y2:r},{top:i,right:s,bottom:o,left:a}){return!(n<a&&t<a||n>s&&t>s||e<i&&r<i||e>o&&r>o)}function gg({x:n,y:e},t,{top:r,right:i,bottom:s,left:o}){return n<o&&(e=dg(o,{x:n,y:e},t),n=o),n>i&&(e=dg(i,{x:n,y:e},t),n=i),e<r&&(n=Xu(r,{x:n,y:e},t),e=r),e>s&&(n=Xu(s,{x:n,y:e},t),e=s),{x:n,y:e}}function tz(n,e,t){const{x:r,y:i}=gg(n,e,t),{x:s,y:o}=gg(e,n,t);return{x:r,y:i,x2:s,y2:o,width:Math.abs(s-r),height:Math.abs(o-i)}}function nz(n,{mouseX:e,mouseY:t},r=Vr,i){const{x:s,y:o,x2:a,y2:l}=n.getProps(["x","y","x2","y2"],i),c=a-s,u=l-o,h=Es(c)+Es(u),f=h===0?-1:((e-s)*c+(t-o)*u)/h;let p,m;return f<0?(p=s,m=o):f>1?(p=a,m=l):(p=s+f*c,m=o+f*u),Es(e-p)+Es(t-m)<=r}function Yu(n,{mouseX:e,mouseY:t},r,i){const s=n.label;return s.options.display&&s.inRange(e,t,i,r)}function rz(n,e,t){const r=t.borderWidth,i=wt(t.padding),s=hc(n.ctx,t),o=s.width+i.width+r,a=s.height+i.height+r;return sz(e,t,{width:o,height:a,padding:i},n.chartArea)}function iz(n){const{x:e,y:t,x2:r,y2:i}=n,s=Math.atan2(i-t,r-e);return s>ze/2?s-ze:s<ze/-2?s+ze:s}function sz(n,e,t,r){const{width:i,height:s,padding:o}=t,{xAdjust:a,yAdjust:l}=e,c={x:n.x,y:n.y},u={x:n.x2,y:n.y2},h=e.rotation==="auto"?iz(n):st(e.rotation),f=oz(i,s,h),p=az(n,e,{labelSize:f,padding:o},r),m=n.cp?Gu(c,n.cp,u,p):$h(c,u,p),g={size:f.w,min:r.left,max:r.right,padding:o.left},x={size:f.h,min:r.top,max:r.bottom,padding:o.top},b=bg(m.x,g)+a,y=bg(m.y,x)+l;return{x:b-i/2,y:y-s/2,x2:b+i/2,y2:y+s/2,centerX:b,centerY:y,pointX:m.x,pointY:m.y,width:i,height:s,rotation:fv(h)}}function oz(n,e,t){const r=Math.cos(t),i=Math.sin(t);return{w:Math.abs(n*r)+Math.abs(e*i),h:Math.abs(n*i)+Math.abs(e*r)}}function az(n,e,t,r){let i;const s=lz(n,r);return e.position==="start"?i=xg({w:n.x2-n.x,h:n.y2-n.y},t,e,s):e.position==="end"?i=1-xg({w:n.x-n.x2,h:n.y-n.y2},t,e,s):i=Eh(1,e.position),i}function xg(n,e,t,r){const{labelSize:i,padding:s}=e,o=n.w*r.dx,a=n.h*r.dy,l=o>0&&(i.w/2+s.left-r.x)/o,c=a>0&&(i.h/2+s.top-r.y)/a;return cc(Math.max(l,c),0,.25)}function lz(n,e){const{x:t,x2:r,y:i,y2:s}=n,o=Math.min(i,s)-e.top,a=Math.min(t,r)-e.left,l=e.bottom-Math.max(i,s),c=e.right-Math.max(t,r);return{x:Math.min(a,c),y:Math.min(o,l),dx:a<=c?1:-1,dy:o<=l?1:-1}}function bg(n,e){const{size:t,min:r,max:i,padding:s}=e,o=t/2;return t>i-r?(i+r)/2:(r>=n-s-o&&(n=r+s+o),i<=n+s+o&&(n=i-s-o),n)}function Iw(n){const e=n.options,t=e.arrowHeads&&e.arrowHeads.start,r=e.arrowHeads&&e.arrowHeads.end;return{startOpts:t,endOpts:r,startAdjust:yg(n,t),endAdjust:yg(n,r)}}function yg(n,e){if(!e||!e.display)return 0;const{length:t,width:r}=e,i=n.options.borderWidth/2,s={x:t,y:r+i};return Math.abs(Xu(0,s,{x:0,y:i}))}function Ku(n,e,t,r){if(!r||!r.display)return;const{length:i,width:s,fill:o,backgroundColor:a,borderColor:l}=r,c=Math.abs(e-i)+t;n.beginPath(),as(n,r),tr(n,r),n.moveTo(c,-s),n.lineTo(e+t,0),n.lineTo(c,s),o===!0?(n.fillStyle=a||l,n.closePath(),n.fill(),n.shadowColor="transparent"):n.shadowColor=r.borderShadowColor,n.stroke()}function cz(n,e,t){const{x:r,y:i,x2:s,y2:o,centerX:a,centerY:l}=n,c=Math.atan2(o-i,s-r),u=Ih(e.controlPoint,0),h={x:a+Pr(t,u.x,!1),y:l+Pr(t,u.y,!1)};return fi(h,{x:a,y:l},c)}function vg(n,{x:e,y:t},{angle:r,adjust:i},s){!s||!s.display||(n.save(),n.translate(e,t),n.rotate(r),Ku(n,0,-i,s),n.restore())}function uz(n,e,t,r){const{x:i,y:s,x2:o,y2:a,options:l}=e,{startOpts:c,endOpts:u,startAdjust:h,endAdjust:f}=Iw(e),p={x:i,y:s},m={x:o,y:a},g=pg(p,t,m,0),x=pg(p,t,m,1)-ze,b=Gu(p,t,m,h/r),y=Gu(p,t,m,1-f/r),w=new Path2D;n.beginPath(),w.moveTo(b.x,b.y),w.quadraticCurveTo(t.x,t.y,y.x,y.y),n.shadowColor=l.borderShadowColor,n.stroke(w),e.path=w,e.ctx=n,vg(n,b,{angle:g,adjust:h},c),vg(n,y,{angle:x,adjust:f},u)}class Lo extends Nt{inRange(e,t,r,i){const s=this.options.rotation,o=(this.options.borderWidth+this.options.hitTolerance)/2;if(r!=="x"&&r!=="y")return dz({x:e,y:t},this.getProps(["width","height","centerX","centerY"],i),s,o);const{x:a,y:l,x2:c,y2:u}=this.getProps(["x","y","x2","y2"],i),h=r==="y"?{start:l,end:u}:{start:a,end:c},f=fi({x:e,y:t},this.getCenterPoint(i),st(-s));return f[r]>=h.start-o-Vr&&f[r]<=h.end+o+Vr}getCenterPoint(e){return pi(this,e)}draw(e){const{width:t,height:r,centerX:i,centerY:s,options:o}=this;e.save(),dc(e,this.getCenterPoint(),o.rotation),as(e,this.options),e.beginPath(),e.fillStyle=o.backgroundColor;const a=tr(e,o);e.ellipse(i,s,r/2,t/2,ze/2,0,2*ze),e.fill(),a&&(e.shadowColor=o.borderShadowColor,e.stroke()),e.restore()}get label(){return this.elements&&this.elements[0]}resolveElementProperties(e,t){return Mw(e,t)}}Lo.id="ellipseAnnotation";Lo.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderDash:[],borderDashOffset:0,borderShadowColor:"transparent",borderWidth:1,display:!0,hitTolerance:0,init:void 0,label:Object.assign({},ls.defaults.label),rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,xMax:void 0,xMin:void 0,xScaleID:void 0,yMax:void 0,yMin:void 0,yScaleID:void 0,z:0};Lo.defaultRoutes={borderColor:"color",backgroundColor:"color"};Lo.descriptors={label:{_fallback:!0}};function dz(n,e,t,r){const{width:i,height:s,centerX:o,centerY:a}=e,l=i/2,c=s/2;if(l<=0||c<=0)return!1;const u=st(t||0),h=Math.cos(u),f=Math.sin(u),p=Math.pow(h*(n.x-o)+f*(n.y-a),2),m=Math.pow(f*(n.x-o)-h*(n.y-a),2);return p/Math.pow(l+r,2)+m/Math.pow(c+r,2)<=1.0001}class pc extends Nt{inRange(e,t,r,i){const{x:s,y:o,x2:a,y2:l,width:c}=this.getProps(["x","y","x2","y2","width"],i),u=(this.options.borderWidth+this.options.hitTolerance)/2;return r!=="x"&&r!=="y"?sF({x:e,y:t},this.getCenterPoint(i),c/2,u):dw(r==="y"?{start:o,end:l,value:t}:{start:s,end:a,value:e},u)}getCenterPoint(e){return pi(this,e)}draw(e){const t=this.options,r=t.borderWidth;if(t.radius<.1)return;e.save(),e.fillStyle=t.backgroundColor,as(e,t);const i=tr(e,t);fF(e,this,this.centerX,this.centerY),i&&!uc(t.pointStyle)&&(e.shadowColor=t.borderShadowColor,e.stroke()),e.restore(),t.borderWidth=r}resolveElementProperties(e,t){const r=Tw(e,t);return r.initProperties=os(e,r,t),r}}pc.id="pointAnnotation";pc.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderDash:[],borderDashOffset:0,borderShadowColor:"transparent",borderWidth:1,display:!0,hitTolerance:0,init:void 0,pointStyle:"circle",radius:10,rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,xAdjust:0,xMax:void 0,xMin:void 0,xScaleID:void 0,xValue:void 0,yAdjust:0,yMax:void 0,yMin:void 0,yScaleID:void 0,yValue:void 0,z:0};pc.defaultRoutes={borderColor:"color",backgroundColor:"color"};class mc extends Nt{inRange(e,t,r,i){if(r!=="x"&&r!=="y")return this.options.radius>=.1&&this.elements.length>1&&fz(this.elements,e,t,i);const s=fi({x:e,y:t},this.getCenterPoint(i),st(-this.options.rotation)),o=this.elements.map(c=>r==="y"?c.bY:c.bX),a=Math.min(...o),l=Math.max(...o);return s[r]>=a&&s[r]<=l}getCenterPoint(e){return pi(this,e)}draw(e){const{elements:t,options:r}=this;e.save(),e.beginPath(),e.fillStyle=r.backgroundColor,as(e,r);const i=tr(e,r);let s=!0;for(const o of t)s?(e.moveTo(o.x,o.y),s=!1):e.lineTo(o.x,o.y);e.closePath(),e.fill(),i&&(e.shadowColor=r.borderShadowColor,e.stroke()),e.restore()}resolveElementProperties(e,t){const r=Tw(e,t),{sides:i,rotation:s}=t,o=[],a=2*ze/i;let l=s*hh;for(let c=0;c<i;c++,l+=a){const u=hz(r,t,l);u.initProperties=os(e,r,t),o.push(u)}return r.elements=o,r}}mc.id="polygonAnnotation";mc.defaults={adjustScaleRange:!0,backgroundShadowColor:"transparent",borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderShadowColor:"transparent",borderWidth:1,display:!0,hitTolerance:0,init:void 0,point:{radius:0},radius:10,rotation:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,sides:3,xAdjust:0,xMax:void 0,xMin:void 0,xScaleID:void 0,xValue:void 0,yAdjust:0,yMax:void 0,yMin:void 0,yScaleID:void 0,yValue:void 0,z:0};mc.defaultRoutes={borderColor:"color",backgroundColor:"color"};function hz({centerX:n,centerY:e},{radius:t,borderWidth:r,hitTolerance:i},s){const o=(r+i)/2,a=Math.sin(s),l=Math.cos(s),c={x:n+a*t,y:e-l*t};return{type:"point",optionScope:"point",properties:{x:c.x,y:c.y,centerX:c.x,centerY:c.y,bX:n+a*(t+o),bY:e-l*(t+o)}}}function fz(n,e,t,r){let i=!1,s=n[n.length-1].getProps(["bX","bY"],r);for(const o of n){const a=o.getProps(["bX","bY"],r);a.bY>t!=s.bY>t&&e<(s.bX-a.bX)*(t-a.bY)/(s.bY-a.bY)+a.bX&&(i=!i),s=a}return i}const _r={box:ls,doughnutLabel:fc,ellipse:Lo,label:Do,line:No,point:pc,polygon:mc};Object.keys(_r).forEach(n=>{Ze.describe(`elements.${_r[n].id}`,{_fallback:"plugins.annotation.common"})});const pz={update:Object.assign},mz=Oh.concat(cl),wg=(n,e)=>Ae(e)?Ju(n,e):n,Zu=n=>n==="color"||n==="font";function Dh(n="line"){return _r[n]?n:(console.warn(`Unknown annotation type: '${n}', defaulting to 'line'`),"line")}function gz(n,e,t,r){const i=bz(n,t.animations,r),s=e.annotations,o=wz(e.elements,s);for(let a=0;a<s.length;a++){const l=s[a],c=Rw(o,a,l.type),u=l.setContext(vz(n,c,o,l)),h=c.resolveElementProperties(n,u);h.skip=xz(h),"elements"in h&&(yz(c,h.elements,u,i),delete h.elements),$t(c.x)||Object.assign(c,h),Object.assign(c,h.initProperties),h.options=Ow(u),i.update(c,h)}}function xz(n){return isNaN(n.x)||isNaN(n.y)}function bz(n,e,t){return t==="reset"||t==="none"||t==="resize"?pz:new wh(n,e)}function yz(n,e,t,r){const i=n.elements||(n.elements=[]);i.length=e.length;for(let s=0;s<e.length;s++){const o=e[s],a=o.properties,l=Rw(i,s,o.type,o.initProperties),c=t[o.optionScope].override(o);a.options=Ow(c),r.update(l,a)}}function Rw(n,e,t,r){const i=_r[Dh(t)];let s=n[e];return(!s||!(s instanceof i))&&(s=n[e]=new i,Object.assign(s,r)),s}function Ow(n){const e=_r[Dh(n.type)],t={};t.id=n.id,t.type=n.type,t.drawTime=n.drawTime,Object.assign(t,Ju(n,e.defaults),Ju(n,e.defaultRoutes));for(const r of mz)t[r]=n[r];return t}function Ju(n,e){const t={};for(const r of Object.keys(e)){const i=e[r],s=n[r];Zu(r)&&qe(s)?t[r]=s.map(o=>wg(o,i)):t[r]=wg(s,i)}return t}function vz(n,e,t,r){return e.$context||(e.$context=Object.assign(Object.create(n.getContext()),{element:e,get elements(){return t.filter(i=>i&&i.options)},id:r.id,type:"annotation"}))}function wz(n,e){const t=e.length,r=n.length;if(r<t){const i=t-r;n.splice(r,0,...new Array(i))}else r>t&&n.splice(t,r-t);return n}var _z="3.1.0";const cr=new Map,_g=n=>n.type!=="doughnutLabel",Sz=Oh.concat(cl);var Pz={id:"annotation",version:_z,beforeRegister(){oF("chart.js","4.0",Dn.version)},afterRegister(){Dn.register(_r)},afterUnregister(){Dn.unregister(_r)},beforeInit(n){cr.set(n,{annotations:[],elements:[],visibleElements:[],listeners:{},listened:!1,moveListened:!1,hooks:{},hooked:!1,hovered:[]})},beforeUpdate(n,e,t){const r=cr.get(n),i=r.annotations=[];let s=t.annotations;Ae(s)?Object.keys(s).forEach(o=>{const a=s[o];Ae(a)&&(a.id=o,i.push(a))}):qe(s)&&i.push(...s),zF(i.filter(_g),n.scales)},afterDataLimits(n,e){const t=cr.get(n);FF(n,e.scale,t.annotations.filter(_g).filter(r=>r.display&&r.adjustScaleRange))},afterUpdate(n,e,t){const r=cr.get(n);OF(n,r,t),gz(n,r,t,e.mode),r.visibleElements=r.elements.filter(i=>!i.skip&&i.options.display),LF(n,r,t)},beforeDatasetsDraw(n,e,t){_s(n,"beforeDatasetsDraw",t.clip)},afterDatasetsDraw(n,e,t){_s(n,"afterDatasetsDraw",t.clip)},beforeDatasetDraw(n,e,t){_s(n,e.index,t.clip)},beforeDraw(n,e,t){_s(n,"beforeDraw",t.clip)},afterDraw(n,e,t){_s(n,"afterDraw",t.clip)},beforeEvent(n,e,t){const r=cr.get(n);$F(r,e.event,t)&&(e.changed=!0)},afterDestroy(n){cr.delete(n)},getAnnotations(n){const e=cr.get(n);return e?e.elements:[]},_getAnnotationElementsAtEventForMode(n,e,t){return Ah(n,e,t)},defaults:{animations:{numbers:{properties:["x","y","x2","y2","width","height","centerX","centerY","pointX","pointY","radius"],type:"number"},colors:{properties:["backgroundColor","borderColor"],type:"color"}},clip:!0,interaction:{mode:void 0,axis:void 0,intersect:void 0},common:{drawTime:"afterDatasetsDraw",init:!1,label:{}}},descriptors:{_indexable:!1,_scriptable:n=>!Sz.includes(n)&&n!=="init",annotations:{_allKeys:!1,_fallback:(n,e)=>`elements.${_r[Dh(e.type)].id}`},interaction:{_fallback:!0},common:{label:{_indexable:Zu,_fallback:!0},_indexable:Zu}},additionalOptionScopes:[""]};function _s(n,e,t){const{ctx:r,chartArea:i}=n,s=cr.get(n);t&&Ql(r,i);const o=Cz(s.visibleElements,e).sort((a,l)=>a.element.options.z-l.element.options.z);for(const a of o)kz(r,i,s,a);t&&ec(r)}function Cz(n,e){const t=[];for(const r of n)if(r.options.drawTime===e&&t.push({element:r,main:!0}),r.elements&&r.elements.length)for(const i of r.elements)i.options.display&&i.options.drawTime===e&&t.push({element:i});return t}function kz(n,e,t,r){const i=r.element;r.main?(lg(t,i,"beforeDraw"),i.draw(n,e),lg(t,i,"afterDraw")):i.draw(n,e)}const jz=(n,e,t,r,i)=>{const s=_.useDeferredValue(e,[]),o=_.useDeferredValue(t,[]),a=_.useDeferredValue(i,!0),l=!Object.is(s,e)||!Object.is(o,t)||!Object.is(a,i),c=_.useMemo(()=>s.map(h=>Qi(h,o,a)),[s,o,a]),u=_.useMemo(()=>n.map(h=>Jl(c,{lower:r==="lower"?h:void 0,upper:r==="upper"?h:void 0})),[n,c,r]);return{isStale:l,value:u}};Dn.register(ic,CD,Mr,kD,Pz);Mr.positioners.top=n=>{if(n.length===0)return!1;const e=n[0].element.x,t=n.reduce((r,{element:i})=>Math.min(r,i.y),1/0);return{x:e,y:t,yAlign:"bottom"}};const Sg=qd(0,60,30),Tz=_.memo(function(e){const t=te.c(36),{crosslinks:r,structures:i,kind:s,currentThresholds:o,aminoAcidsMustMatch:a}=e,{value:l,isStale:c}=jz(Sg,r,i,s,a);let u;s==="lower"?o?.lower!==void 0&&(u=o.lower):s==="upper"&&o?.upper!==void 0&&(u=o.upper);let h;t[0]===Symbol.for("react.memo_cache_sentinel")?(h={display:!1},t[0]=h):h=t[0];let f;t[1]!==u?(f={annotations:u!==void 0?[{type:"line",xMin:u,xMax:u,borderColor:"gray",borderWidth:2,drawTime:"beforeDatasetsDraw"}]:[]},t[1]=u,t[2]=f):f=t[2];let p;t[3]===Symbol.for("react.memo_cache_sentinel")?(p={position:"top"},t[3]=p):p=t[3];let m;t[4]!==f?(m={legend:h,annotation:f,tooltip:p},t[4]=f,t[5]=m):m=t[5];let g;t[6]===Symbol.for("react.memo_cache_sentinel")?(g={mode:"index",intersect:!1},t[6]=g):g=t[6];let x;t[7]===Symbol.for("react.memo_cache_sentinel")?(x={type:"linear",title:{display:!0,text:"Distance []"}},t[7]=x):x=t[7];let b,y;t[8]===Symbol.for("react.memo_cache_sentinel")?(b={x,y:{type:"linear",title:{display:!0,text:"Count"}}},y={padding:{top:40}},t[8]=b,t[9]=y):(b=t[8],y=t[9]);let w;t[10]!==m?(w={plugins:m,responsive:!0,maintainAspectRatio:!1,interaction:g,scales:b,layout:y},t[10]=m,t[11]=w):w=t[11];const v=w;let S,k;t[12]!==l?(k=(B,N,U)=>({label:B,data:l?.map(q=>q[N]??0)??[],backgroundColor:U,borderColor:U}),t[12]=l,t[13]=k):k=t[13];const P=k;let C,T;t[14]!==P?(C=P("Satisfied","ok","green"),T=P("Partially Satisfied","partially-ok","#14b8a6"),t[14]=P,t[15]=C,t[16]=T):(C=t[15],T=t[16]);let A,M;t[17]!==P||t[18]!==s?(A=s==="upper"?[P("Above Threshold","over","red")]:[],M=s==="lower"?[P("Below Threshold","under","orange")]:[],t[17]=P,t[18]=s,t[19]=A,t[20]=M):(A=t[19],M=t[20]);let O;t[21]!==C||t[22]!==T||t[23]!==A||t[24]!==M?(O={labels:Sg,datasets:[C,T,...A,...M]},t[21]=C,t[22]=T,t[23]=A,t[24]=M,t[25]=O):O=t[25],S=O;const R=S,j=c?.5:1,I=c?"opacity 0.3s 0.5s linear":"opacity 0.2s 0s linear";let E;t[26]!==j||t[27]!==I?(E={opacity:j,transition:I},t[26]=j,t[27]=I,t[28]=E):E=t[28];let D;t[29]===Symbol.for("react.memo_cache_sentinel")?(D={position:"relative",height:"300px",width:"100%"},t[29]=D):D=t[29];let L;t[30]!==R||t[31]!==v?(L=d.jsx("div",{style:D,children:d.jsx(rN,{options:v,data:R})}),t[30]=R,t[31]=v,t[32]=L):L=t[32];let z;return t[33]!==E||t[34]!==L?(z=d.jsx(Sl,{style:E,children:L}),t[33]=E,t[34]=L,t[35]=z):z=t[35],z}),Mz=_.memo(function({experiment:e,groupDuplicates:t,visibleCrosslinkIds:r,structures:i,groupedStructureIds:s,thresholds:o,aminoAcidsMustMatch:a}){const l=_.useMemo(()=>qs([e.crosslinks.filter(({id:S})=>r.has(S))],Object.fromEntries(e.proteins.map(S=>[S.id,S]))),[e.crosslinks,r,e.proteins]),c=_.useMemo(()=>{const S=[];for(const{rows:k,...P}of l){const C=new Set(k.flatMap(({ids:T})=>T.flatMap(A=>t?A[0]:A.flat())));S.push({groupHeader:P,crosslinks:e.crosslinks.filter(({id:T})=>C.has(T))})}return S},[l,t,e.crosslinks]),u=_.useMemo(()=>{const S=new Set(gb(l,t));return e.crosslinks.filter(({id:k})=>S.has(k))},[l,t,e.crosslinks]),h=_.useMemo(()=>{const S=s.map(k=>k.map(P=>i.find(C=>C.id===P)).filter(P=>P!==void 0)).filter(k=>k.length>0);return S.length===1?S[0].map(k=>[k]):S},[s,i]),f=_.useMemo(()=>u.flatMap(S=>Qi(S,i,a).map(k=>xb(k,o??{})).filter(k=>k!==void 0)),[u,i,a,o]),p={xlmap:"2D Map",overview:"Crosslinks Distribution",byProtein:"Crosslinks Distribution by Protein",byStructure:"Crosslinks Distribution by Structure",upperThresholdExplorer:"Crosslinks Distribution for Different Upper Distance Thresholds",lowerThresholdExplorer:"Crosslinks Distribution for Different Lower Distance Thresholds",histogram:"Distances Distribution",thresholds:"Distances Distribution"},[m,g]=DC("xlmap"),x=h.flat().length,b=u.length>0&&x>0,y=b&&f.length>0,w=y&&(o?.lower!==void 0||o?.upper!==void 0),v=!b||!y&&["histogram","thresholds","upperThresholdExplorer","lowerThresholdExplorer"].includes(m)||!w&&m==="thresholds"?"xlmap":m;return v!==m&&g(v),d.jsxs(d.Fragment,{children:[d.jsxs(So,{gap:0,children:[d.jsxs(bo,{positioning:{placement:"bottom",gutter:2},size:"sm",children:[d.jsx(yo,{asChild:!0,children:d.jsxs(Nn,{ml:"1rem",children:[d.jsx(Ws,{children:p[v]}),d.jsx(ml,{size:"xs",children:d.jsx(Hg,{})})]})}),d.jsx(vo,{children:d.jsx(wo,{children:d.jsxs(H1,{value:v,onValueChange:({value:S})=>_.startTransition(()=>{g(S)}),children:[d.jsxs(qn,{value:"xlmap",children:["2D Map",d.jsx(un,{})]}),d.jsx(ba,{}),d.jsx(ji,{children:"Crosslinks Distribution"}),d.jsxs(qn,{value:"overview",disabled:!b,children:["Overview",d.jsx(un,{})]}),d.jsxs(qn,{value:"byProtein",disabled:!b,children:["By Protein",d.jsx(un,{})]}),d.jsxs(qn,{value:"byStructure",disabled:!b,children:["By Structure",d.jsx(un,{})]}),d.jsx(ba,{}),d.jsxs(ji,{children:["Distance Threshold Explorer",d.jsx("br",{}),d.jsx(rt,{fontSize:"xs",fontWeight:"light",color:"fg.muted",children:"Explore crosslink distribution for"})]}),d.jsxs(qn,{value:"upperThresholdExplorer",disabled:!y,children:["Different Upper Thresholds",d.jsx(un,{})]}),d.jsxs(qn,{value:"lowerThresholdExplorer",disabled:!y,children:["Different Lower Thresholds",d.jsx(un,{})]}),d.jsx(ba,{}),d.jsx(ji,{children:"Distances Distribution"}),d.jsxs(qn,{value:"histogram",disabled:!y,children:["Histogram",d.jsx(un,{})]}),d.jsxs(qn,{value:"thresholds",disabled:!w,children:["Thresholds",d.jsx(un,{})]})]})})})]}),d.jsxs(Ws,{size:"sm",color:"gray",children:[v==="histogram"||v==="thresholds"?De(f.length,"distance"):De(u.length,"crosslink"),v!=="xlmap"&&` in ${De(x,"structure")}`]})]}),v==="xlmap"&&d.jsx(U8,{experiment:e,visibleCrosslinkIds:r}),v!=="xlmap"&&d.jsxs(Xi,{maxW:"3xl",mt:"-40px",children:[v==="overview"&&d.jsx(pN,{crosslinks:u,structures:i,thresholds:o,aminoAcidsMustMatch:a}),v==="byProtein"&&d.jsx(hN,{groupedCrosslinks:c,structures:i,thresholds:o,aminoAcidsMustMatch:a}),v==="byStructure"&&d.jsx(fN,{crosslinks:u,groupedStructures:h,thresholds:o,aminoAcidsMustMatch:a}),(v==="upperThresholdExplorer"||v==="lowerThresholdExplorer")&&d.jsx(Tz,{crosslinks:u,structures:i,currentThresholds:o,aminoAcidsMustMatch:a,kind:v==="lowerThresholdExplorer"?"lower":"upper"}),(v==="histogram"||v==="thresholds")&&d.jsx(K8,{distances:f,view:v,thresholds:o})]})]})}),Az=n=>Object.entries(n).forEach(([e,t])=>t&&za(e,!1,new Set(t))),Ez=_.memo(function(e){const t=te.c(57);let r,i,s;t[0]!==e?({experiment:r,ref:i,...s}=e,t[0]=e,t[1]=r,t[2]=i,t[3]=s):(r=t[1],i=t[2],s=t[3]);const{experimentIdToThresholds:o,aminoAcidsMustMatch:a}=Je(ie),l=o[r.id],[c,u]=XT(r),h=PT(r);let f,p;t[4]!==h.crosslinks?(p=new Set(h.crosslinks.filter(Iz).map(Rz)),t[4]=h.crosslinks,t[5]=p):p=t[5],f=p;const m=f;let g,x;t[6]!==a||t[7]!==h.crosslinks||t[8]!==l||t[9]!==c?(x=Da(c,h.crosslinks,a,l),t[6]=a,t[7]=h.crosslinks,t[8]=l,t[9]=c,t[10]=x):x=t[10],g=x;const b=g;let y,w;t[11]!==r.crosslinks?(w=new Set(r.crosslinks.map(Oz)),t[11]=r.crosslinks,t[12]=w):w=t[12],y=w;const v=y,{experimentIdToVisibleCrosslinkIds:S,groupDuplicatedCrosslinks:k}=Je(ie),P=S[r.id];let C,T;t[13]!==u||t[14]!==h||t[15]!==b||t[16]!==P?(T=[{experiment:h,structureToXlinkIdToStatus:b,visibleCrosslinkIds:P,groupedStructureIds:u}],t[13]=u,t[14]=h,t[15]=b,t[16]=P,t[17]=T):T=t[17],C=T;const A=C;let M;t[18]!==r.id?(M=()=>$T(r.id),t[18]=r.id,t[19]=M):M=t[19];const O=M;let R;t[20]!==r||t[21]!==h?(R=d.jsx(zT,{experiment:r,resolvedExperiment:h}),t[20]=r,t[21]=h,t[22]=R):R=t[22];let j;t[23]!==a||t[24]!==k||t[25]!==u||t[26]!==h||t[27]!==l||t[28]!==P||t[29]!==c?(j=d.jsx(Mz,{experiment:h,groupDuplicates:k,visibleCrosslinkIds:P,structures:c,groupedStructureIds:u,thresholds:l,aminoAcidsMustMatch:a}),t[23]=a,t[24]=k,t[25]=u,t[26]=h,t[27]=l,t[28]=P,t[29]=c,t[30]=j):j=t[30];const I=(l?.lower?1:0)+(l?.upper?1:0);let E;t[31]!==v||t[32]!==r.id||t[33]!==b||t[34]!==I||t[35]!==m||t[36]!==P?(E=d.jsx(BT,{w:"fit-content",experimentId:r.id,structureToXlinkIdToStatus:b,allCrosslinkIds:v,visibleCrosslinkIds:P,unmappedCrosslinkIds:m,numOfDistanceConstraints:I}),t[31]=v,t[32]=r.id,t[33]=b,t[34]=I,t[35]=m,t[36]=P,t[37]=E):E=t[37];let D;t[38]!==r.id||t[39]!==l||t[40]!==c.length?(D=c.length>0&&d.jsx(Ck,{experimentId:r.id,thresholds:l}),t[38]=r.id,t[39]=l,t[40]=c.length,t[41]=D):D=t[41];let L;t[42]!==R||t[43]!==j||t[44]!==E||t[45]!==D?(L=d.jsx(Xi,{maxW:"5xl",className:"fileview-container",children:d.jsxs(bn,{gap:5,children:[R,j,E,D]})}),t[42]=R,t[43]=j,t[44]=E,t[45]=D,t[46]=L):L=t[46];let z;t[47]!==A||t[48]!==k||t[49]!==O||t[50]!==c?(z=d.jsx(sv,{experiments:A,structures:c,groupDuplicates:k,resetFilters:O,hideCrosslinks:Az}),t[47]=A,t[48]=k,t[49]=O,t[50]=c,t[51]=z):z=t[51];let B;return t[52]!==i||t[53]!==s||t[54]!==L||t[55]!==z?(B=d.jsx(d.Fragment,{children:d.jsxs(bn,{ref:i,...s,children:[L,z]})}),t[52]=i,t[53]=s,t[54]=L,t[55]=z,t[56]=B):B=t[56],B});function Iz(n){const{from:e,to:t}=n;return e.linkPosition===void 0||t.linkPosition===void 0}function Rz(n){const{id:e}=n;return e}function Oz(n){const{id:e}=n;return e}const Nh=_.memo(function(e){const t=te.c(24);let r,i,s,o,a,l;t[0]!==e?({children:i,hideButtonUnlessHover:a,hideButtonUnlessSelected:l,buttonProps:r,ref:s,...o}=e,t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=o,t[5]=a,t[6]=l):(r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],l=t[6]);const c=a===void 0?!1:a,u=l===void 0?!1:l;let h;e:{if(!c&&!u){h=null;break e}let x;t[7]!==c?(x=c?{_hover:{opacity:1},_peerHover:{opacity:1}}:{},t[7]=c,t[8]=x):x=t[8];let b;t[9]!==u?(b=u?{css:{".peer:is([aria-selected=true], [data-selected]) ~ &":{opacity:1}}}:{},t[9]=u,t[10]=b):b=t[10];let y;t[11]!==x||t[12]!==b?(y={opacity:0,...x,...b},t[11]=x,t[12]=b,t[13]=y):y=t[13],h=y}const f=h;let p;t[14]!==i||t[15]!==s||t[16]!==o?(p=d.jsx(sb,{pr:"2.75rem",className:"peer",flexGrow:1,justifyContent:"center",ref:s,...o,children:i}),t[14]=i,t[15]=s,t[16]=o,t[17]=p):p=t[17];let m;t[18]!==r||t[19]!==f?(m=d.jsx(mt,{size:"2xs",alignSelf:"center",variant:"ghost",colorPalette:"bg",ml:"-2rem",mr:"0.5rem",...f,...r}),t[18]=r,t[19]=f,t[20]=m):m=t[20];let g;return t[21]!==p||t[22]!==m?(g=d.jsxs(Re,{children:[p,m]}),t[21]=p,t[22]=m,t[23]=g):g=t[23],g}),$z=_.memo(function(e){const t=te.c(26);let r,i,s,o;t[0]!==e?({experimentId:r,experimentName:i,ref:s,...o}=e,t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=o):(r=t[1],i=t[2],s=t[3],o=t[4]);const a=uo({defaultValue:i,placeholder:{preview:"File",edit:""},onValueCommit:b=>{const{value:y}=b;if(!(y.trim()===""?void 0:y.trim())){i&&a.setValue(i);return}const v=ie.experiments.find(S=>{const{id:k}=S;return k===r});v&&(v.name=y)},activationMode:"dblclick",autoResize:!0});let l;t[5]!==a||t[6]!==r?(l=b=>{const{value:y}=b;return y==="close"?Uh(r):y==="rename"?a.edit():null},t[5]=a,t[6]=r,t[7]=l):l=t[7];let c;t[8]===Symbol.for("react.memo_cache_sentinel")?(c=d.jsx(od,{}),t[8]=c):c=t[8];let u;t[9]!==r?(u={children:c,onClick:()=>Uh(r)},t[9]=r,t[10]=u):u=t[10];let h;t[11]===Symbol.for("react.memo_cache_sentinel")?(h=d.jsx(ml,{children:d.jsx(Hd,{})}),t[11]=h):h=t[11];let f;t[12]===Symbol.for("react.memo_cache_sentinel")?(f=d.jsxs(R1,{children:[d.jsx(Cl,{cursor:"unset",_hover:{bg:"unset"}}),d.jsx(yd,{focusRing:"none",onClick:Dz,onKeyDown:Nz,onKeyUp:Lz})]}),t[12]=f):f=t[12];let p;t[13]!==a?(p=d.jsx(Pl,{value:a,size:"sm",children:f}),t[13]=a,t[14]=p):p=t[14];let m;t[15]!==r||t[16]!==s||t[17]!==o||t[18]!==u||t[19]!==p?(m=d.jsx(dM,{as:"div",children:d.jsxs(Nh,{value:r,hideButtonUnlessHover:!0,hideButtonUnlessSelected:!0,buttonProps:u,ref:s,...o,children:[h,p]})}),t[15]=r,t[16]=s,t[17]=o,t[18]=u,t[19]=p,t[20]=m):m=t[20];let g;t[21]===Symbol.for("react.memo_cache_sentinel")?(g=d.jsxs(fr,{children:[d.jsx(tn,{value:"rename",children:"Rename"}),d.jsx(tn,{value:"close",children:"Close"})]}),t[21]=g):g=t[21];let x;return t[22]!==r||t[23]!==l||t[24]!==m?(x=d.jsxs(pr,{size:"sm",onSelect:l,children:[m,g]},r),t[22]=r,t[23]=l,t[24]=m,t[25]=x):x=t[25],x});function Dz(n){return n.stopPropagation()}function Nz(n){return n.stopPropagation()}function Lz(n){return n.preventDefault()}const Fz="/xlinkup/next/assets/worker-CUPp4CIB.js";var Is={exports:{}};const zz={},Bz=Object.freeze(Object.defineProperty({__proto__:null,default:zz},Symbol.toStringTag,{value:"Module"})),bi=h2(Bz);/**
 * workerpool.js
 * https://github.com/josdejong/workerpool
 *
 * Offload tasks to a pool of workers on node.js and in the browser.
 *
 * @version 9.3.3
 * @date    2025-06-27
 *
 * @license
 * Copyright (C) 2014-2022 Jos de Jong <wjosdejong@gmail.com>
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy
 * of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */var Hz=Is.exports,Pg;function Vz(){return Pg||(Pg=1,function(n,e){(function(t,r){r(e)})(Hz,function(t){var r={},i={exports:{}};(function($){var F=function(G){return typeof G<"u"&&G.versions!=null&&G.versions.node!=null&&G+""=="[object process]"};$.exports.isNode=F,$.exports.platform=typeof process<"u"&&F(process)?"node":"browser";var V=$.exports.platform==="node"&&bi;$.exports.isMainThread=$.exports.platform==="node"?(!V||V.isMainThread)&&!process.connected:typeof Window<"u",$.exports.cpus=$.exports.platform==="browser"?self.navigator.hardwareConcurrency:bi.cpus().length})(i);var s=i.exports,o={},a;function l(){if(a)return o;a=1;function $(G,pe){var W=this;if(!(this instanceof $))throw new SyntaxError("Constructor must be called with the new operator");if(typeof G!="function")throw new SyntaxError("Function parameter handler(resolve, reject) missing");var de=[],we=[];this.resolved=!1,this.rejected=!1,this.pending=!0,this[Symbol.toStringTag]="Promise";var Ge=function(Q,be){de.push(Q),we.push(be)};this.then=function(se,Q){return new $(function(be,Pe){var Ie=se?F(se,be,Pe):be,gt=Q?F(Q,be,Pe):Pe;Ge(Ie,gt)},W)};var tt=function(Q){return W.resolved=!0,W.rejected=!1,W.pending=!1,de.forEach(function(be){be(Q)}),Ge=function(Pe,Ie){Pe(Q)},tt=le=function(){},W},le=function(Q){return W.resolved=!1,W.rejected=!0,W.pending=!1,we.forEach(function(be){be(Q)}),Ge=function(Pe,Ie){Ie(Q)},tt=le=function(){},W};this.cancel=function(){return pe?pe.cancel():le(new V),W},this.timeout=function(se){if(pe)pe.timeout(se);else{var Q=setTimeout(function(){le(new K("Promise timed out after "+se+" ms"))},se);W.always(function(){clearTimeout(Q)})}return W},G(function(se){tt(se)},function(se){le(se)})}function F(G,pe,W){return function(de){try{var we=G(de);we&&typeof we.then=="function"&&typeof we.catch=="function"?we.then(pe,W):pe(we)}catch(Ge){W(Ge)}}}$.prototype.catch=function(G){return this.then(null,G)},$.prototype.always=function(G){return this.then(G,G)},$.prototype.finally=function(G){var pe=this,W=function(){return new $(function(we){return we()}).then(G).then(function(){return pe})};return this.then(W,W)},$.all=function(G){return new $(function(pe,W){var de=G.length,we=[];de?G.forEach(function(Ge,tt){Ge.then(function(le){we[tt]=le,de--,de==0&&pe(we)},function(le){de=0,W(le)})}):pe(we)})},$.defer=function(){var G={};return G.promise=new $(function(pe,W){G.resolve=pe,G.reject=W}),G};function V(G){this.message=G||"promise cancelled",this.stack=new Error().stack}V.prototype=new Error,V.prototype.constructor=Error,V.prototype.name="CancellationError",$.CancellationError=V;function K(G){this.message=G||"timeout exceeded",this.stack=new Error().stack}return K.prototype=new Error,K.prototype.constructor=Error,K.prototype.name="TimeoutError",$.TimeoutError=K,o.Promise=$,o}function c($,F){(F==null||F>$.length)&&(F=$.length);for(var V=0,K=Array(F);V<F;V++)K[V]=$[V];return K}function u($,F){var V=typeof Symbol<"u"&&$[Symbol.iterator]||$["@@iterator"];if(!V){if(Array.isArray($)||(V=b($))||F){V&&($=V);var K=0,G=function(){};return{s:G,n:function(){return K>=$.length?{done:!0}:{done:!1,value:$[K++]}},e:function(we){throw we},f:G}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var pe,W=!0,de=!1;return{s:function(){V=V.call($)},n:function(){var we=V.next();return W=we.done,we},e:function(we){de=!0,pe=we},f:function(){try{W||V.return==null||V.return()}finally{if(de)throw pe}}}}function h($,F,V){return(F=g(F))in $?Object.defineProperty($,F,{value:V,enumerable:!0,configurable:!0,writable:!0}):$[F]=V,$}function f($,F){var V=Object.keys($);if(Object.getOwnPropertySymbols){var K=Object.getOwnPropertySymbols($);F&&(K=K.filter(function(G){return Object.getOwnPropertyDescriptor($,G).enumerable})),V.push.apply(V,K)}return V}function p($){for(var F=1;F<arguments.length;F++){var V=arguments[F]!=null?arguments[F]:{};F%2?f(Object(V),!0).forEach(function(K){h($,K,V[K])}):Object.getOwnPropertyDescriptors?Object.defineProperties($,Object.getOwnPropertyDescriptors(V)):f(Object(V)).forEach(function(K){Object.defineProperty($,K,Object.getOwnPropertyDescriptor(V,K))})}return $}function m($,F){if(typeof $!="object"||!$)return $;var V=$[Symbol.toPrimitive];if(V!==void 0){var K=V.call($,F);if(typeof K!="object")return K;throw new TypeError("@@toPrimitive must return a primitive value.")}return(F==="string"?String:Number)($)}function g($){var F=m($,"string");return typeof F=="symbol"?F:F+""}function x($){"@babel/helpers - typeof";return x=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(F){return typeof F}:function(F){return F&&typeof Symbol=="function"&&F.constructor===Symbol&&F!==Symbol.prototype?"symbol":typeof F},x($)}function b($,F){if($){if(typeof $=="string")return c($,F);var V={}.toString.call($).slice(8,-1);return V==="Object"&&$.constructor&&(V=$.constructor.name),V==="Map"||V==="Set"?Array.from($):V==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(V)?c($,F):void 0}}var y={exports:{}},w={},v;function S(){return v||(v=1,w.validateOptions=function(F,V,K){if(F){var G=F?Object.keys(F):[],pe=G.find(function(de){return!V.includes(de)});if(pe)throw new Error('Object "'+K+'" contains an unknown option "'+pe+'"');var W=V.find(function(de){return Object.prototype[de]&&!G.includes(de)});if(W)throw new Error('Object "'+K+'" contains an inherited option "'+W+'" which is not defined in the object itself but in its prototype. Only plain objects are allowed. Please remove the option from the prototype or override it with a value "undefined".');return F}},w.workerOptsNames=["credentials","name","type"],w.forkOptsNames=["cwd","detached","env","execPath","execArgv","gid","serialization","signal","killSignal","silent","stdio","uid","windowsVerbatimArguments","timeout"],w.workerThreadOptsNames=["argv","env","eval","execArgv","stdin","stdout","stderr","workerData","trackUnmanagedFds","transferList","resourceLimits","name"]),w}var k,P;function C(){return P||(P=1,k=`!function(e,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(e="undefined"!=typeof globalThis?globalThis:e||self).worker=n()}(this,(function(){"use strict";function e(n){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(n)}function n(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var t={};var r=function(e,n){this.message=e,this.transfer=n},o={};function i(e,n){var t=this;if(!(this instanceof i))throw new SyntaxError("Constructor must be called with the new operator");if("function"!=typeof e)throw new SyntaxError("Function parameter handler(resolve, reject) missing");var r=[],o=[];this.resolved=!1,this.rejected=!1,this.pending=!0,this[Symbol.toStringTag]="Promise";var a=function(e,n){r.push(e),o.push(n)};this.then=function(e,n){return new i((function(t,r){var o=e?u(e,t,r):t,i=n?u(n,t,r):r;a(o,i)}),t)};var f=function(e){return t.resolved=!0,t.rejected=!1,t.pending=!1,r.forEach((function(n){n(e)})),a=function(n,t){n(e)},f=d=function(){},t},d=function(e){return t.resolved=!1,t.rejected=!0,t.pending=!1,o.forEach((function(n){n(e)})),a=function(n,t){t(e)},f=d=function(){},t};this.cancel=function(){return n?n.cancel():d(new s),t},this.timeout=function(e){if(n)n.timeout(e);else{var r=setTimeout((function(){d(new c("Promise timed out after "+e+" ms"))}),e);t.always((function(){clearTimeout(r)}))}return t},e((function(e){f(e)}),(function(e){d(e)}))}function u(e,n,t){return function(r){try{var o=e(r);o&&"function"==typeof o.then&&"function"==typeof o.catch?o.then(n,t):n(o)}catch(e){t(e)}}}function s(e){this.message=e||"promise cancelled",this.stack=(new Error).stack}function c(e){this.message=e||"timeout exceeded",this.stack=(new Error).stack}return i.prototype.catch=function(e){return this.then(null,e)},i.prototype.always=function(e){return this.then(e,e)},i.prototype.finally=function(e){var n=this,t=function(){return new i((function(e){return e()})).then(e).then((function(){return n}))};return this.then(t,t)},i.all=function(e){return new i((function(n,t){var r=e.length,o=[];r?e.forEach((function(e,i){e.then((function(e){o[i]=e,0==--r&&n(o)}),(function(e){r=0,t(e)}))})):n(o)}))},i.defer=function(){var e={};return e.promise=new i((function(n,t){e.resolve=n,e.reject=t})),e},s.prototype=new Error,s.prototype.constructor=Error,s.prototype.name="CancellationError",i.CancellationError=s,c.prototype=new Error,c.prototype.constructor=Error,c.prototype.name="TimeoutError",i.TimeoutError=c,o.Promise=i,function(n){var t=r,i=o.Promise,u="__workerpool-cleanup__",s={exit:function(){}},c={addAbortListener:function(e){s.abortListeners.push(e)},emit:s.emit};if("undefined"!=typeof self&&"function"==typeof postMessage&&"function"==typeof addEventListener)s.on=function(e,n){addEventListener(e,(function(e){n(e.data)}))},s.send=function(e,n){n?postMessage(e,n):postMessage(e)};else{if("undefined"==typeof process)throw new Error("Script must be executed as a worker");var a;try{a=require("worker_threads")}catch(n){if("object"!==e(n)||null===n||"MODULE_NOT_FOUND"!==n.code)throw n}if(a&&null!==a.parentPort){var f=a.parentPort;s.send=f.postMessage.bind(f),s.on=f.on.bind(f),s.exit=process.exit.bind(process)}else s.on=process.on.bind(process),s.send=function(e){process.send(e)},s.on("disconnect",(function(){process.exit(1)})),s.exit=process.exit.bind(process)}function d(e){return Object.getOwnPropertyNames(e).reduce((function(n,t){return Object.defineProperty(n,t,{value:e[t],enumerable:!0})}),{})}function l(e){return e&&"function"==typeof e.then&&"function"==typeof e.catch}s.methods={},s.methods.run=function(e,n){var t=new Function("return ("+e+").apply(this, arguments);");return t.worker=c,t.apply(t,n)},s.methods.methods=function(){return Object.keys(s.methods)},s.terminationHandler=void 0,s.abortListenerTimeout=1e3,s.abortListeners=[],s.terminateAndExit=function(e){var n=function(){s.exit(e)};if(!s.terminationHandler)return n();var t=s.terminationHandler(e);return l(t)?(t.then(n,n),t):(n(),new i((function(e,n){n(new Error("Worker terminating"))})))},s.cleanup=function(e){if(!s.abortListeners.length)return s.send({id:e,method:u,error:d(new Error("Worker terminating"))}),new i((function(e){e()}));var n,t=s.abortListeners.map((function(e){return e()})),r=new i((function(e,t){n=setTimeout((function(){t(new Error("Timeout occured waiting for abort handler, killing worker"))}),s.abortListenerTimeout)})),o=i.all(t).then((function(){clearTimeout(n),s.abortListeners.length||(s.abortListeners=[])}),(function(){clearTimeout(n),s.exit()}));return new i((function(e,n){o.then(e,n),r.then(e,n)})).then((function(){s.send({id:e,method:u,error:null})}),(function(n){s.send({id:e,method:u,error:n?d(n):null})}))};var p=null;s.on("message",(function(e){if("__workerpool-terminate__"===e)return s.terminateAndExit(0);if(e.method===u)return s.cleanup(e.id);try{var n=s.methods[e.method];if(!n)throw new Error('Unknown method "'+e.method+'"');p=e.id;var r=n.apply(n,e.params);l(r)?r.then((function(n){n instanceof t?s.send({id:e.id,result:n.message,error:null},n.transfer):s.send({id:e.id,result:n,error:null}),p=null})).catch((function(n){s.send({id:e.id,result:null,error:d(n)}),p=null})):(r instanceof t?s.send({id:e.id,result:r.message,error:null},r.transfer):s.send({id:e.id,result:r,error:null}),p=null)}catch(n){s.send({id:e.id,result:null,error:d(n)})}})),s.register=function(e,n){if(e)for(var t in e)e.hasOwnProperty(t)&&(s.methods[t]=e[t],s.methods[t].worker=c);n&&(s.terminationHandler=n.onTerminate,s.abortListenerTimeout=n.abortListenerTimeout||1e3),s.send("ready")},s.emit=function(e){if(p){if(e instanceof t)return void s.send({id:p,isEvent:!0,payload:e.message},e.transfer);s.send({id:p,isEvent:!0,payload:e})}},n.add=s.register,n.emit=s.emit}(t),n(t)}));
//# sourceMappingURL=worker.min.js.map
`),k}var T;function A(){if(T)return y.exports;T=1;var $=l(),F=$.Promise,V=s,K=S(),G=K.validateOptions,pe=K.forkOptsNames,W=K.workerThreadOptsNames,de=K.workerOptsNames,we="__workerpool-terminate__",Ge="__workerpool-cleanup__";function tt(){var _e=se();if(!_e)throw new Error("WorkerPool: workerType = 'thread' is not supported, Node >= 11.7.0 required");return _e}function le(){if(typeof Worker!="function"&&((typeof Worker>"u"?"undefined":x(Worker))!=="object"||typeof Worker.prototype.constructor!="function"))throw new Error("WorkerPool: Web Workers not supported")}function se(){try{return bi}catch(_e){if(x(_e)==="object"&&_e!==null&&_e.code==="MODULE_NOT_FOUND")return null;throw _e}}function Q(){if(V.platform==="browser"){if(typeof Blob>"u")throw new Error("Blob not supported by the browser");if(!window.URL||typeof window.URL.createObjectURL!="function")throw new Error("URL.createObjectURL not supported by the browser");var _e=new Blob([C()],{type:"text/javascript"});return window.URL.createObjectURL(_e)}else return __dirname+"/worker.js"}function be(_e,Te){if(Te.workerType==="web")return le(),Pe(_e,Te.workerOpts,Worker);if(Te.workerType==="thread")return ne=tt(),Ie(_e,ne,Te);if(Te.workerType==="process"||!Te.workerType)return gt(_e,Pt(Te),bi);if(V.platform==="browser")return le(),Pe(_e,Te.workerOpts,Worker);var ne=se();return ne?Ie(_e,ne,Te):gt(_e,Pt(Te),bi)}function Pe(_e,Te,ne){G(Te,de,"workerOpts");var ye=new ne(_e,Te);return ye.isBrowserWorker=!0,ye.on=function(Ee,$e){this.addEventListener(Ee,function(He){$e(He.data)})},ye.send=function(Ee,$e){this.postMessage(Ee,$e)},ye}function Ie(_e,Te,ne){var ye,Ee;G(ne?.workerThreadOpts,W,"workerThreadOpts");var $e=new Te.Worker(_e,p({stdout:(ye=ne?.emitStdStreams)!==null&&ye!==void 0?ye:!1,stderr:(Ee=ne?.emitStdStreams)!==null&&Ee!==void 0?Ee:!1},ne?.workerThreadOpts));return $e.isWorkerThread=!0,$e.send=function(He,Me){this.postMessage(He,Me)},$e.kill=function(){return this.terminate(),!0},$e.disconnect=function(){this.terminate()},ne!=null&&ne.emitStdStreams&&($e.stdout.on("data",function(He){return $e.emit("stdout",He)}),$e.stderr.on("data",function(He){return $e.emit("stderr",He)})),$e}function gt(_e,Te,ne){G(Te.forkOpts,pe,"forkOpts");var ye=ne.fork(_e,Te.forkArgs,Te.forkOpts),Ee=ye.send;return ye.send=function($e){return Ee.call(ye,$e)},Te.emitStdStreams&&(ye.stdout.on("data",function($e){return ye.emit("stdout",$e)}),ye.stderr.on("data",function($e){return ye.emit("stderr",$e)})),ye.isChildProcess=!0,ye}function Pt(_e){_e=_e||{};var Te=process.execArgv.join(" "),ne=Te.indexOf("--inspect")!==-1,ye=Te.indexOf("--debug-brk")!==-1,Ee=[];return ne&&(Ee.push("--inspect="+_e.debugPort),ye&&Ee.push("--debug-brk")),process.execArgv.forEach(function($e){$e.indexOf("--max-old-space-size")>-1&&Ee.push($e)}),Object.assign({},_e,{forkArgs:_e.forkArgs,forkOpts:Object.assign({},_e.forkOpts,{execArgv:(_e.forkOpts&&_e.forkOpts.execArgv||[]).concat(Ee),stdio:_e.emitStdStreams?"pipe":void 0})})}function Kt(_e){for(var Te=new Error(""),ne=Object.keys(_e),ye=0;ye<ne.length;ye++)Te[ne[ye]]=_e[ne[ye]];return Te}function xt(_e,Te){Object.values(_e.processing).forEach(function(ne){var ye;return ne==null||(ye=ne.options)===null||ye===void 0?void 0:ye.on(Te)}),Object.values(_e.tracking).forEach(function(ne){var ye;return ne==null||(ye=ne.options)===null||ye===void 0?void 0:ye.on(Te)})}function an(_e,Te){var ne=this,ye=Te||{};this.script=_e||Q(),this.worker=be(this.script,ye),this.debugPort=ye.debugPort,this.forkOpts=ye.forkOpts,this.forkArgs=ye.forkArgs,this.workerOpts=ye.workerOpts,this.workerThreadOpts=ye.workerThreadOpts,this.workerTerminateTimeout=ye.workerTerminateTimeout,_e||(this.worker.ready=!0),this.requestQueue=[],this.worker.on("stdout",function(Me){xt(ne,{stdout:Me.toString()})}),this.worker.on("stderr",function(Me){xt(ne,{stderr:Me.toString()})}),this.worker.on("message",function(Me){if(!ne.terminated)if(typeof Me=="string"&&Me==="ready")ne.worker.ready=!0,$e();else{var it=Me.id,Ve=ne.processing[it];if(Ve!==void 0)Me.isEvent?Ve.options&&typeof Ve.options.on=="function"&&Ve.options.on(Me.payload):(delete ne.processing[it],ne.terminating===!0&&ne.terminate(),Me.error?Ve.resolver.reject(Kt(Me.error)):Ve.resolver.resolve(Me.result));else{var Ve=ne.tracking[it];Ve!==void 0&&Me.isEvent&&Ve.options&&typeof Ve.options.on=="function"&&Ve.options.on(Me.payload)}if(Me.method===Ge){var Ct=ne.tracking[Me.id];Ct!==void 0&&(Me.error?(clearTimeout(Ct.timeoutId),Ct.resolver.reject(Kt(Me.error))):(ne.tracking&&clearTimeout(Ct.timeoutId),Ct.resolver.reject(new Lh(Ct.error)))),delete ne.tracking[it]}}});function Ee(Me){ne.terminated=!0;for(var it in ne.processing)ne.processing[it]!==void 0&&ne.processing[it].resolver.reject(Me);ne.processing=Object.create(null)}function $e(){var Me=u(ne.requestQueue.splice(0)),it;try{for(Me.s();!(it=Me.n()).done;){var Ve=it.value;ne.worker.send(Ve.message,Ve.transfer)}}catch(Ct){Me.e(Ct)}finally{Me.f()}}var He=this.worker;this.worker.on("error",Ee),this.worker.on("exit",function(Me,it){var Ve=`Workerpool Worker terminated Unexpectedly
`;Ve+="    exitCode: `"+Me+"`\n",Ve+="    signalCode: `"+it+"`\n",Ve+="    workerpool.script: `"+ne.script+"`\n",Ve+="    spawnArgs: `"+He.spawnargs+"`\n",Ve+="    spawnfile: `"+He.spawnfile+"`\n",Ve+="    stdout: `"+He.stdout+"`\n",Ve+="    stderr: `"+He.stderr+"`\n",Ee(new Error(Ve))}),this.processing=Object.create(null),this.tracking=Object.create(null),this.terminating=!1,this.terminated=!1,this.cleaning=!1,this.terminationHandler=null,this.lastId=0}an.prototype.methods=function(){return this.exec("methods")},an.prototype.exec=function(_e,Te,ne,ye){ne||(ne=F.defer());var Ee=++this.lastId;this.processing[Ee]={id:Ee,resolver:ne,options:ye};var $e={message:{id:Ee,method:_e,params:Te},transfer:ye&&ye.transfer};this.terminated?ne.reject(new Error("Worker is terminated")):this.worker.ready?this.worker.send($e.message,$e.transfer):this.requestQueue.push($e);var He=this;return ne.promise.catch(function(Me){if(Me instanceof F.CancellationError||Me instanceof F.TimeoutError)return He.tracking[Ee]={id:Ee,resolver:F.defer(),options:ye,error:Me},delete He.processing[Ee],He.tracking[Ee].resolver.promise=He.tracking[Ee].resolver.promise.catch(function(it){if(delete He.tracking[Ee],it instanceof Lh)throw it.error;var Ve=He.terminateAndNotify(!0).then(function(){throw it},function(Ct){throw Ct});return Ve}),He.worker.send({id:Ee,method:Ge}),He.tracking[Ee].timeoutId=setTimeout(function(){He.tracking[Ee].resolver.reject(Me)},He.workerTerminateTimeout),He.tracking[Ee].resolver.promise;throw Me})},an.prototype.busy=function(){return this.cleaning||Object.keys(this.processing).length>0},an.prototype.terminate=function(_e,Te){var ne=this;if(_e){for(var ye in this.processing)this.processing[ye]!==void 0&&this.processing[ye].resolver.reject(new Error("Worker terminated"));this.processing=Object.create(null)}for(var Ee=0,$e=Object.values(ne.tracking);Ee<$e.length;Ee++){var He=$e[Ee];clearTimeout(He.timeoutId),He.resolver.reject(new Error("Worker Terminating"))}if(ne.tracking=Object.create(null),typeof Te=="function"&&(this.terminationHandler=Te),this.busy())this.terminating=!0;else{var Me=function(Ct){if(ne.terminated=!0,ne.cleaning=!1,ne.worker!=null&&ne.worker.removeAllListeners&&ne.worker.removeAllListeners("message"),ne.worker=null,ne.terminating=!1,ne.terminationHandler)ne.terminationHandler(Ct,ne);else if(Ct)throw Ct};if(this.worker)if(typeof this.worker.kill=="function"){if(this.worker.killed){Me(new Error("worker already killed!"));return}var it=setTimeout(function(){ne.worker&&ne.worker.kill()},this.workerTerminateTimeout);this.worker.once("exit",function(){clearTimeout(it),ne.worker&&(ne.worker.killed=!0),Me()}),this.worker.ready?this.worker.send(we):this.requestQueue.push({message:we}),this.cleaning=!0;return}else if(typeof this.worker.terminate=="function")this.worker.terminate(),this.worker.killed=!0;else throw new Error("Failed to terminate worker");Me()}},an.prototype.terminateAndNotify=function(_e,Te){var ne=F.defer();return Te&&ne.promise.timeout(Te),this.terminate(_e,function(ye,Ee){ye?ne.reject(ye):ne.resolve(Ee)}),ne.promise};function Lh(_e){this.error=_e,this.stack=new Error().stack}return y.exports=an,y.exports._tryRequireWorkerThreads=se,y.exports._setupProcessWorker=gt,y.exports._setupBrowserWorker=Pe,y.exports._setupWorkerThreadWorker=Ie,y.exports.ensureWorkerThreads=tt,y.exports}var M,O;function R(){if(O)return M;O=1;var $=65535;M=F;function F(){this.ports=Object.create(null),this.length=0}return F.prototype.nextAvailableStartingAt=function(V){for(;this.ports[V]===!0;)V++;if(V>=$)throw new Error("WorkerPool debug port limit reached: "+V+">= "+$);return this.ports[V]=!0,this.length++,V},F.prototype.releasePort=function(V){delete this.ports[V],this.length--},M}var j,I;function E(){if(I)return j;I=1;var $=l(),F=$.Promise,V=A(),K=s,G=R(),pe=new G;function W(le,se){typeof le=="string"?this.script=le||null:(this.script=null,se=le),this.workers=[],this.tasks=[],se=se||{},this.forkArgs=Object.freeze(se.forkArgs||[]),this.forkOpts=Object.freeze(se.forkOpts||{}),this.workerOpts=Object.freeze(se.workerOpts||{}),this.workerThreadOpts=Object.freeze(se.workerThreadOpts||{}),this.debugPortStart=se.debugPortStart||43210,this.nodeWorker=se.nodeWorker,this.workerType=se.workerType||se.nodeWorker||"auto",this.maxQueueSize=se.maxQueueSize||1/0,this.workerTerminateTimeout=se.workerTerminateTimeout||1e3,this.onCreateWorker=se.onCreateWorker||function(){return null},this.onTerminateWorker=se.onTerminateWorker||function(){return null},this.emitStdStreams=se.emitStdStreams||!1,se&&"maxWorkers"in se?(de(se.maxWorkers),this.maxWorkers=se.maxWorkers):this.maxWorkers=Math.max((K.cpus||4)-1,1),se&&"minWorkers"in se&&(se.minWorkers==="max"?this.minWorkers=this.maxWorkers:(we(se.minWorkers),this.minWorkers=se.minWorkers,this.maxWorkers=Math.max(this.minWorkers,this.maxWorkers)),this._ensureMinWorkers()),this._boundNext=this._next.bind(this),this.workerType==="thread"&&V.ensureWorkerThreads()}W.prototype.exec=function(le,se,Q){if(se&&!Array.isArray(se))throw new TypeError('Array expected as argument "params"');if(typeof le=="string"){var be=F.defer();if(this.tasks.length>=this.maxQueueSize)throw new Error("Max queue size of "+this.maxQueueSize+" reached");var Pe=this.tasks,Ie={method:le,params:se,resolver:be,timeout:null,options:Q};Pe.push(Ie);var gt=be.promise.timeout;return be.promise.timeout=function(Kt){return Pe.indexOf(Ie)!==-1?(Ie.timeout=Kt,be.promise):gt.call(be.promise,Kt)},this._next(),be.promise}else{if(typeof le=="function")return this.exec("run",[String(le),se],Q);throw new TypeError('Function or string expected as argument "method"')}},W.prototype.proxy=function(){if(arguments.length>0)throw new Error("No arguments expected");var le=this;return this.exec("methods").then(function(se){var Q={};return se.forEach(function(be){Q[be]=function(){return le.exec(be,Array.prototype.slice.call(arguments))}}),Q})},W.prototype._next=function(){if(this.tasks.length>0){var le=this._getWorker();if(le){var se=this,Q=this.tasks.shift();if(Q.resolver.promise.pending){var be=le.exec(Q.method,Q.params,Q.resolver,Q.options).then(se._boundNext).catch(function(){if(le.terminated)return se._removeWorker(le)}).then(function(){se._next()});typeof Q.timeout=="number"&&be.timeout(Q.timeout)}else se._next()}}},W.prototype._getWorker=function(){for(var le=this.workers,se=0;se<le.length;se++){var Q=le[se];if(Q.busy()===!1)return Q}return le.length<this.maxWorkers?(Q=this._createWorkerHandler(),le.push(Q),Q):null},W.prototype._removeWorker=function(le){var se=this;return pe.releasePort(le.debugPort),this._removeWorkerFromList(le),this._ensureMinWorkers(),new F(function(Q,be){le.terminate(!1,function(Pe){se.onTerminateWorker({forkArgs:le.forkArgs,forkOpts:le.forkOpts,workerThreadOpts:le.workerThreadOpts,script:le.script}),Pe?be(Pe):Q(le)})})},W.prototype._removeWorkerFromList=function(le){var se=this.workers.indexOf(le);se!==-1&&this.workers.splice(se,1)},W.prototype.terminate=function(le,se){var Q=this;this.tasks.forEach(function(Pt){Pt.resolver.reject(new Error("Pool terminated"))}),this.tasks.length=0;var be=function(Kt){pe.releasePort(Kt.debugPort),this._removeWorkerFromList(Kt)},Pe=be.bind(this),Ie=[],gt=this.workers.slice();return gt.forEach(function(Pt){var Kt=Pt.terminateAndNotify(le,se).then(Pe).always(function(){Q.onTerminateWorker({forkArgs:Pt.forkArgs,forkOpts:Pt.forkOpts,workerThreadOpts:Pt.workerThreadOpts,script:Pt.script})});Ie.push(Kt)}),F.all(Ie)},W.prototype.stats=function(){var le=this.workers.length,se=this.workers.filter(function(Q){return Q.busy()}).length;return{totalWorkers:le,busyWorkers:se,idleWorkers:le-se,pendingTasks:this.tasks.length,activeTasks:se}},W.prototype._ensureMinWorkers=function(){if(this.minWorkers)for(var le=this.workers.length;le<this.minWorkers;le++)this.workers.push(this._createWorkerHandler())},W.prototype._createWorkerHandler=function(){var le=this.onCreateWorker({forkArgs:this.forkArgs,forkOpts:this.forkOpts,workerOpts:this.workerOpts,workerThreadOpts:this.workerThreadOpts,script:this.script})||{};return new V(le.script||this.script,{forkArgs:le.forkArgs||this.forkArgs,forkOpts:le.forkOpts||this.forkOpts,workerOpts:le.workerOpts||this.workerOpts,workerThreadOpts:le.workerThreadOpts||this.workerThreadOpts,debugPort:pe.nextAvailableStartingAt(this.debugPortStart),workerType:this.workerType,workerTerminateTimeout:this.workerTerminateTimeout,emitStdStreams:this.emitStdStreams})};function de(le){if(!Ge(le)||!tt(le)||le<1)throw new TypeError("Option maxWorkers must be an integer number >= 1")}function we(le){if(!Ge(le)||!tt(le)||le<0)throw new TypeError("Option minWorkers must be an integer number >= 0")}function Ge(le){return typeof le=="number"}function tt(le){return Math.round(le)==le}return j=W,j}var D={},L,z;function B(){if(z)return L;z=1;function $(F,V){this.message=F,this.transfer=V}return L=$,L}var N;function U(){return N||(N=1,function($){var F=B(),V=l().Promise,K="__workerpool-terminate__",G="__workerpool-cleanup__",pe=1e3,W={exit:function(){}},de={addAbortListener:function(be){W.abortListeners.push(be)},emit:W.emit};if(typeof self<"u"&&typeof postMessage=="function"&&typeof addEventListener=="function")W.on=function(Q,be){addEventListener(Q,function(Pe){be(Pe.data)})},W.send=function(Q,be){be?postMessage(Q,be):postMessage(Q)};else if(typeof process<"u"){var we;try{we=bi}catch(Q){if(!(x(Q)==="object"&&Q!==null&&Q.code==="MODULE_NOT_FOUND"))throw Q}if(we&&we.parentPort!==null){var Ge=we.parentPort;W.send=Ge.postMessage.bind(Ge),W.on=Ge.on.bind(Ge),W.exit=process.exit.bind(process)}else W.on=process.on.bind(process),W.send=function(Q){process.send(Q)},W.on("disconnect",function(){process.exit(1)}),W.exit=process.exit.bind(process)}else throw new Error("Script must be executed as a worker");function tt(Q){return Object.getOwnPropertyNames(Q).reduce(function(be,Pe){return Object.defineProperty(be,Pe,{value:Q[Pe],enumerable:!0})},{})}function le(Q){return Q&&typeof Q.then=="function"&&typeof Q.catch=="function"}W.methods={},W.methods.run=function(be,Pe){var Ie=new Function("return ("+be+").apply(this, arguments);");return Ie.worker=de,Ie.apply(Ie,Pe)},W.methods.methods=function(){return Object.keys(W.methods)},W.terminationHandler=void 0,W.abortListenerTimeout=pe,W.abortListeners=[],W.terminateAndExit=function(Q){var be=function(){W.exit(Q)};if(!W.terminationHandler)return be();var Pe=W.terminationHandler(Q);return le(Pe)?(Pe.then(be,be),Pe):(be(),new V(function(Ie,gt){gt(new Error("Worker terminating"))}))},W.cleanup=function(Q){if(!W.abortListeners.length)return W.send({id:Q,method:G,error:tt(new Error("Worker terminating"))}),new V(function(xt){xt()});var be=function(){W.exit()},Pe=function(){W.abortListeners.length||(W.abortListeners=[])},Ie=W.abortListeners.map(function(xt){return xt()}),gt,Pt=new V(function(xt,an){gt=setTimeout(function(){an(new Error("Timeout occured waiting for abort handler, killing worker"))},W.abortListenerTimeout)}),Kt=V.all(Ie).then(function(){clearTimeout(gt),Pe()},function(){clearTimeout(gt),be()});return new V(function(xt,an){Kt.then(xt,an),Pt.then(xt,an)}).then(function(){W.send({id:Q,method:G,error:null})},function(xt){W.send({id:Q,method:G,error:xt?tt(xt):null})})};var se=null;W.on("message",function(Q){if(Q===K)return W.terminateAndExit(0);if(Q.method===G)return W.cleanup(Q.id);try{var be=W.methods[Q.method];if(be){se=Q.id;var Pe=be.apply(be,Q.params);le(Pe)?Pe.then(function(Ie){Ie instanceof F?W.send({id:Q.id,result:Ie.message,error:null},Ie.transfer):W.send({id:Q.id,result:Ie,error:null}),se=null}).catch(function(Ie){W.send({id:Q.id,result:null,error:tt(Ie)}),se=null}):(Pe instanceof F?W.send({id:Q.id,result:Pe.message,error:null},Pe.transfer):W.send({id:Q.id,result:Pe,error:null}),se=null)}else throw new Error('Unknown method "'+Q.method+'"')}catch(Ie){W.send({id:Q.id,result:null,error:tt(Ie)})}}),W.register=function(Q,be){if(Q)for(var Pe in Q)Q.hasOwnProperty(Pe)&&(W.methods[Pe]=Q[Pe],W.methods[Pe].worker=de);be&&(W.terminationHandler=be.onTerminate,W.abortListenerTimeout=be.abortListenerTimeout||pe),W.send("ready")},W.emit=function(Q){if(se){if(Q instanceof F){W.send({id:se,isEvent:!0,payload:Q.message},Q.transfer);return}W.send({id:se,isEvent:!0,payload:Q})}},$.add=W.register,$.emit=W.emit}(D)),D}var q=s.platform,X=s.isMainThread,J=s.cpus;function ee($,F){var V=E();return new V($,F)}var re=r.pool=ee;function oe($,F){var V=U();V.add($,F)}var me=r.worker=oe;function ge($){var F=U();F.emit($)}var ae=r.workerEmit=ge,ce=l(),fe=ce.Promise,ve=r.Promise=fe,xe=r.Transfer=B(),ue=r.platform=q,Se=r.isMainThread=X,Le=r.cpus=J;t.Promise=ve,t.Transfer=xe,t.cpus=Le,t.default=r,t.isMainThread=Se,t.platform=ue,t.pool=re,t.worker=me,t.workerEmit=ae,Object.defineProperty(t,"__esModule",{value:!0})})}(Is,Is.exports)),Is.exports}var Wz=Vz();const Uz=$g(Wz);class $w{_pool;constructor(e){this._pool=Uz.pool(e,{maxWorkers:5,workerOpts:{type:void 0}})}exec(...e){let t;return e.length>0&&typeof e.at(-1)=="function"&&(t=e.pop()),this._pool.exec("default",e,{on:t})}async terminate(){await this._pool.terminate(!0)}}const Dw=new $w(Fz),Nw=async()=>{await Dw.terminate()},qz=(n,e)=>{const t=n.map(({id:r,name:i,structure:s})=>s?{id:r,name:i,chainIdToProteinIdToMapping:Object.fromEntries(s.chains.map(({id:o})=>[o,Kg()])),...s,chains:s.chains.map(({residues:o,...a})=>({...a,residues:Yg(o)}))}:[]).flat();ie.structures.push(...t);for(const r of e??[])ny(r,n.map(({id:i})=>i));return t},Xz=()=>{const n=te.c(12);let e;n[0]===Symbol.for("react.memo_cache_sentinel")?(e=[],n[0]=e):e=n[0];const[t,r]=_.useState(e);let i;n[1]===Symbol.for("react.memo_cache_sentinel")?(i=b=>r(y=>y.map(w=>{if(!(w.id in b))return w;const v=b[w.id];return v===null?[]:"split"in v?v.split.map(S=>{const{name:k,addSuffix:P,...C}=S;return{name:(k??w.name)+(Jn(P)?`-${P.join("-")}`:""),...C}}):{...w,...b[w.id]}}).flat()),n[1]=i):i=n[1];const s=i;let o;n[2]===Symbol.for("react.memo_cache_sentinel")?(o=b=>{const y=b.map(Gz);r(v=>[...v,...y.map(Yz)]);const w={};for(const{id:v,fetchParams:S,parseParams:k}of y){const{cancel:P}=Dw.exec(S,k??{},C=>s({[v]:{stage:C}})).then(C=>s({[v]:{split:C.map(Kz)}})).catch(C=>{C.name==="CancellationError"||C.message==="Worker terminated"?s({[v]:null}):s({[v]:{error:C}})}).finally(()=>s({[v]:{cancel:void 0}}));w[v]={cancel:P}}s(w)},n[2]=o):o=n[2];const a=o;let l;n[3]===Symbol.for("react.memo_cache_sentinel")?(l=b=>{r(y=>y.filter(w=>w.id!==b?!0:(w.cancel?.(),!1)))},n[3]=l):l=n[3];const c=l;let u,h;n[4]!==t?(h=t.some(Zz),n[4]=t,n[5]=h):h=n[5],u=h;const f=u;let p,m;n[6]!==t?(m=t.some(Jz),n[6]=t,n[7]=m):m=n[7],p=m;const g=p;let x;return n[8]!==g||n[9]!==f||n[10]!==t?(x={structures:t,loadStructures:a,removeStructure:c,isLoading:f,hasErrors:g},n[8]=g,n[9]=f,n[10]=t,n[11]=x):x=n[11],x};function Gz(n){return{id:gl(),...n}}function Yz(n){const{id:e,...t}=n;return{id:e,name:t.name,stage:"queue"}}function Kz(n){return{id:gl(),addSuffix:n.metadata.suffix,stage:"done",structure:n}}function Zz(n){const{stage:e,error:t}=n;return e!=="done"&&!t}function Jz(n){const{error:e}=n;return e!==void 0}function Qz(n,e,t,r){var i=this,s=_.useRef(null),o=_.useRef(0),a=_.useRef(0),l=_.useRef(null),c=_.useRef([]),u=_.useRef(),h=_.useRef(),f=_.useRef(n),p=_.useRef(!0);f.current=n;var m=typeof window<"u",g=!e&&e!==0&&m;if(typeof n!="function")throw new TypeError("Expected a function");e=+e||0;var x=!!(t=t||{}).leading,b=!("trailing"in t)||!!t.trailing,y="maxWait"in t,w="debounceOnServer"in t&&!!t.debounceOnServer,v=y?Math.max(+t.maxWait||0,e):null;_.useEffect(function(){return p.current=!0,function(){p.current=!1}},[]);var S=_.useMemo(function(){var k=function(R){var j=c.current,I=u.current;return c.current=u.current=null,o.current=R,a.current=a.current||R,h.current=f.current.apply(I,j)},P=function(R,j){g&&cancelAnimationFrame(l.current),l.current=g?requestAnimationFrame(R):setTimeout(R,j)},C=function(R){if(!p.current)return!1;var j=R-s.current;return!s.current||j>=e||j<0||y&&R-o.current>=v},T=function(R){return l.current=null,b&&c.current?k(R):(c.current=u.current=null,h.current)},A=function R(){var j=Date.now();if(x&&a.current===o.current&&M(),C(j))return T(j);if(p.current){var I=e-(j-s.current),E=y?Math.min(I,v-(j-o.current)):I;P(R,E)}},M=function(){r&&r({})},O=function(){if(m||w){var R=Date.now(),j=C(R);if(c.current=[].slice.call(arguments),u.current=i,s.current=R,j){if(!l.current&&p.current)return o.current=s.current,P(A,e),x?k(s.current):h.current;if(y)return P(A,e),k(s.current)}return l.current||P(A,e),h.current}};return O.cancel=function(){l.current&&(g?cancelAnimationFrame(l.current):clearTimeout(l.current)),o.current=0,c.current=s.current=u.current=l.current=null},O.isPending=function(){return!!l.current},O.flush=function(){return l.current?T(Date.now()):h.current},O},[x,y,e,v,b,g,m,w,r]);return S}function e9(n,e){return n===e}function Lw(n,e,t){var r=e9,i=_.useRef(n),s=_.useState({})[1],o=Qz(_.useCallback(function(l){i.current=l,s({})},[s]),e,t,s),a=_.useRef(n);return r(a.current,n)||(o(n),a.current=n),[i.current,o]}const Fw=n=>{const e=n.split("-",2);return{pdbId:e[0],assemblyId:e.length>0?e[1]:void 0}},t9=n=>/^[A-Za-z0-9_]{4,20}$/.test(n),n9=n=>/^\d+|deposited$/.test(n),Cg=new Map,r9=rs(async({query:n},e)=>Promise.all(qb(n).map(async t=>{const r=Cg.get(t.trim());if(r)return r;const{pdbId:i,assemblyId:s}=Fw(t.trim());if(!t9(i))throw new Error(`PDB ID "${i}" is invalid`);if(s!==void 0&&!n9(s))throw new Error(`PDB ID "${i}-${s}" is invalid`);const{data:o}=await Xe.post("https://data.rcsb.org/graphql",{query:"query ($pdbId: String!) { entry(entry_id: $pdbId) { struct { title } assemblies { rcsb_assembly_info { assembly_id } } rcsb_comp_model_provenance { source_db source_url source_pae_url } } }",variables:{pdbId:i}},{signal:e});if(!o.data?.entry||o.data.entry.assemblies.length===0)throw new Error(`Couldn't find structure with PDB ID "${i}"`);const a=o.data.entry.assemblies.map(({rcsb_assembly_info:c})=>c.assembly_id);if(s&&!a.includes(s))throw new Error(`Assembly ${s} doesn't exist in ${i}`);const l={title:o.data.entry.struct.title,sourceDb:o.data.entry.rcsb_comp_model_provenance?.source_db,sourceUrl:o.data.entry.rcsb_comp_model_provenance?.source_url,scoresDataUrl:o.data.entry.rcsb_comp_model_provenance?.source_pae_url??void 0,pdbId:i,assemblyId:s};return Cg.set(t.trim(),l),l}))),zw=({accessions:n,contentType:e=["experimental"],start:t=0,rows:r=500})=>{const i=n.filter(o=>!es(o));if(i.length>0)throw new Error(`Invalid UniProt accessions: ${i}`);return{query:{type:"group",logical_operator:"and",nodes:n.map(o=>({type:"group",logical_operator:"and",nodes:[{type:"terminal",service:"text",parameters:{attribute:"rcsb_polymer_entity_container_identifiers.reference_sequence_identifiers.database_accession",operator:"in",value:[o]}},{type:"terminal",service:"text",parameters:{attribute:"rcsb_polymer_entity_container_identifiers.reference_sequence_identifiers.database_name",operator:"exact_match",value:"UniProt"}}],label:"nested-attribute"}))},return_type:"assembly",request_options:{results_content_type:e,results_verbosity:"compact",paginate:{start:t,rows:r}}}},i9=n=>"https://www.rcsb.org/search?request="+encodeURIComponent(JSON.stringify(zw(n))),s9=rs(async(n,e)=>{if(n.accessions.length===0)return{totalCount:0,assemblies:[]};const{data:t}=await Xe.post("https://search.rcsb.org/rcsbsearch/v2/query",zw(n),{signal:e});return t?{totalCount:t.total_count,assemblies:(t.result_set??[]).map(Fw)??[]}:{totalCount:0,assemblies:[]}}),Bw=n=>e=>{const[t,r]=_.useState({});return _.useEffect(()=>{if(e===t.query)return;if(e===void 0){r({});return}const i=new AbortController;return r({query:e}),n(e,i.signal).then(s=>{r({query:e,data:s})}).catch(s=>{s.name!=="CanceledError"&&r({query:e,error:s})}),()=>{i.abort()}},e&&Object.values(e)),t},o9=Bw(oT),a9=Bw(r9),l9=({pdbId:n,assemblyId:e,sourceUrl:t,scoresDataUrl:r})=>(e==="deposited"&&(e=void 0),{name:n+(e?`-${e}`:""),fetchParams:{type:"url",url:t??`https://models.rcsb.org/${n}.bcif.gz`,scoresDataUrl:r},parseParams:{...e?{assemblyIds:[e]}:{}}}),Hw=n=>{const e=te.c(51);let t,r,i,s,o,a,l,c,u,h,f,p,m;e[0]!==n?({placeholder:u,value:m,onChange:l,onSubmit:c,autoFocus:t,error:i,success:p,isLoading:a,endElementWhenEmpty:r,helperTextWhenEmpty:s,inputRef:o,ref:h,...f}=n,e[0]=n,e[1]=t,e[2]=r,e[3]=i,e[4]=s,e[5]=o,e[6]=a,e[7]=l,e[8]=c,e[9]=u,e[10]=h,e[11]=f,e[12]=p,e[13]=m):(t=e[1],r=e[2],i=e[3],s=e[4],o=e[5],a=e[6],l=e[7],c=e[8],u=e[9],h=e[10],f=e[11],p=e[12],m=e[13]);const[g,x]=_.useState(!1),b=!!i,y=p?"green":void 0;let w;e[14]!==r||e[15]!==a||e[16]!==c||e[17]!==p||e[18]!==m?(w=a?d.jsx(Zr,{}):p?d.jsx(mt,{size:"2xs",onClick:()=>c(),children:d.jsx(Vg,{})}):m.length===0&&r,e[14]=r,e[15]=a,e[16]=c,e[17]=p,e[18]=m,e[19]=w):w=e[19];let v;e[20]!==c?(v=R=>{R.key==="Enter"&&c()},e[20]=c,e[21]=v):v=e[21];let S,k;e[22]===Symbol.for("react.memo_cache_sentinel")?(S=()=>x(!0),k=()=>x(!1),e[22]=S,e[23]=k):(S=e[22],k=e[23]);let P;e[24]!==t||e[25]!==o||e[26]!==l||e[27]!==u||e[28]!==v||e[29]!==m?(P=d.jsx(ki,{placeholder:u,ref:o,value:m,onChange:l,autoFocus:t,spellCheck:"false",autoCorrect:"off",autoComplete:"off",onKeyDown:v,onFocus:S,onBlur:k}),e[24]=t,e[25]=o,e[26]=l,e[27]=u,e[28]=v,e[29]=m,e[30]=P):P=e[30];let C;e[31]!==w||e[32]!==P?(C=d.jsx(f2,{flex:"1",w:"full",endElement:w,children:P}),e[31]=w,e[32]=P,e[33]=C):C=e[33];let T;e[34]!==i?(T=i&&d.jsx(Nr,{children:i}),e[34]=i,e[35]=T):T=e[35];let A;e[36]!==g||e[37]!==p?(A=p&&d.jsxs(ru,{as:Re,w:"full",justifyContent:"space-between",children:[d.jsx(rt,{children:p}),g&&d.jsxs(rt,{textAlign:"end",fontSize:"xs",children:["Press ",d.jsx("strong",{children:"ENTER"})," to add"]})]}),e[36]=g,e[37]=p,e[38]=A):A=e[38];let M;e[39]!==s||e[40]!==m?(M=s&&m.length===0&&d.jsx(ru,{children:s}),e[39]=s,e[40]=m,e[41]=M):M=e[41];let O;return e[42]!==h||e[43]!==f||e[44]!==b||e[45]!==A||e[46]!==M||e[47]!==y||e[48]!==C||e[49]!==T?(O=d.jsxs(vi,{ref:h,...f,invalid:b,colorPalette:y,children:[C,T,A,M]}),e[42]=h,e[43]=f,e[44]=b,e[45]=A,e[46]=M,e[47]=y,e[48]=C,e[49]=T,e[50]=O):O=e[50],O},c9=n=>{const e=te.c(25);let t,r,i;e[0]!==n?({onAddedProteins:t,ref:r,...i}=n,e[0]=n,e[1]=t,e[2]=r,e[3]=i):(t=e[1],r=e[2],i=e[3]);const[s,o]=_.useState(""),[a,l]=Lw(s,300),{isPending:c}=l;let u;e[4]!==a?(u={values:a},e[4]=a,e[5]=u):u=e[5];const{query:h,data:f,error:p}=o9(u),m=s.trim().length>0,g=m&&!c()&&h?.values.toUpperCase()===s.toUpperCase();let x;e[6]!==f||e[7]!==g?(x=g&&f!==void 0&&f.length>0&&f.every(u9),e[6]=f,e[7]=g,e[8]=x):x=e[8];const b=x,y=g&&!!p,w=m&&!b&&!y;let v;e[9]!==f||e[10]!==b||e[11]!==t?(v=()=>{b&&(t(f),o(""))},e[9]=f,e[10]=b,e[11]=t,e[12]=v):v=e[12];const S=v;let k;e[13]===Symbol.for("react.memo_cache_sentinel")?(k=A=>o(A.currentTarget.value),e[13]=k):k=e[13];let P;e[14]!==f||e[15]!==b?(P=b&&(f.length===1?d.jsxs(d.Fragment,{children:[d.jsx(gn,{fontFamily:"mono",children:f[0].uniprotAccession})," - ",f[0].recommendedName,f[0].organismName&&d.jsxs(d.Fragment,{children:[d.jsx("br",{}),f[0].organismName]})]}):`${f.length} proteins`),e[14]=f,e[15]=b,e[16]=P):P=e[16];const C=y&&p.message;let T;return e[17]!==S||e[18]!==w||e[19]!==r||e[20]!==i||e[21]!==P||e[22]!==C||e[23]!==s?(T=d.jsx(Hw,{placeholder:"UniProt accession(s)",value:s,onChange:k,onSubmit:S,success:P,error:C,isLoading:w,...i,ref:r}),e[17]=S,e[18]=w,e[19]=r,e[20]=i,e[21]=P,e[22]=C,e[23]=s,e[24]=T):T=e[24],T};function u9(n){return n!==void 0}const d9=(n,e)=>{const t=te.c(10);let r;t[0]===Symbol.for("react.memo_cache_sentinel")?(r={},t[0]=r):r=t[0];const[i,s]=_.useState(r);let o,a;t[1]!==n||t[2]!==e?(o=()=>{if(n.length===0){s({});return}const p=new AbortController,m={accessions:n,includeComputational:e};return s({query:m}),s9({accessions:n,contentType:["experimental",...e?["computational"]:[]]},p.signal).then(g=>{s({query:m,data:g})}).catch(g=>{g.name!=="CanceledError"&&(s({query:m,error:g}),p.abort())}),()=>{p.abort()}},a=[n,e],t[1]=n,t[2]=e,t[3]=o,t[4]=a):(o=t[3],a=t[4]),_.useEffect(o,a);const l=n.length>0&&new Set(i.query?.accessions).symmetricDifference(new Set(n)).size===0,c=l&&!!i.data,u=l&&!!i.error,h=n.length>0&&!c&&!u;let f;return t[5]!==i||t[6]!==u||t[7]!==h||t[8]!==c?(f={...i,isSuccess:c,isError:u,isLoading:h},t[5]=i,t[6]=u,t[7]=h,t[8]=c,t[9]=f):f=t[9],f},h9=n=>{const e=te.c(33),{onSelectedAssemblies:t}=n;let r;e[0]===Symbol.for("react.memo_cache_sentinel")?(r=[],e[0]=r):r=e[0];const[i,s]=_.useState(r),[o,a]=_.useState(!1);let l,c;e[1]!==i?(c=i.map(f9),e[1]=i,e[2]=c):c=e[2],l=c;const u=l,{data:h,error:f,isSuccess:p,isError:m,isLoading:g}=d9(u,o);let x;e[3]!==h||e[4]!==p||e[5]!==t?(x=()=>{!p||!h||h.totalCount===0||t?.(h.assemblies)},e[3]=h,e[4]=p,e[5]=t,e[6]=x):x=e[6];const b=x;let y;e[7]===Symbol.for("react.memo_cache_sentinel")?(y=d.jsxs(Gt,{flexDir:"column",children:[d.jsx(Yt,{children:"Search Structures by Proteins"}),d.jsx(on,{})]}),e[7]=y):y=e[7];let w;e[8]===Symbol.for("react.memo_cache_sentinel")?(w=d.jsx(c9,{autoFocus:!0,placeholder:"Enter UniProt Accession(s) or Entry Name(s)",onAddedProteins:M=>s(O=>[...O,...M])}),e[8]=w):w=e[8];let v;if(e[9]!==i){let M;e[11]===Symbol.for("react.memo_cache_sentinel")?(M=O=>{const{uniprotAccession:R,uniprotEntryName:j}=O;return d.jsx(Mt,{colorPalette:"green",onClose:()=>s(I=>I.filter(E=>E.uniprotAccession!==R)),children:j},R)},e[11]=M):M=e[11],v=i.map(M),e[9]=i,e[10]=v}else v=e[10];let S;e[12]!==v?(S=d.jsx(ko,{children:v}),e[12]=v,e[13]=S):S=e[13];let k;e[14]===Symbol.for("react.memo_cache_sentinel")?(k=M=>{const{checked:O}=M;return a(O)},e[14]=k):k=e[14];let P;e[15]!==o?(P=d.jsx(ah,{checked:o,onCheckedChange:k,children:"Include computational models"}),e[15]=o,e[16]=P):P=e[16];let C;e[17]!==P||e[18]!==S?(C=d.jsx(wn,{asChild:!0,children:d.jsxs(bn,{gap:"4",children:[w,S,P]})}),e[17]=P,e[18]=S,e[19]=C):C=e[19];let T;e[20]!==u||e[21]!==h||e[22]!==f?.message||e[23]!==o||e[24]!==m||e[25]!==g||e[26]!==p||e[27]!==b||e[28]!==i.length?(T=i.length>0&&d.jsx(Xt,{children:m?d.jsxs(Qr,{status:"error",size:"sm",width:"fit",children:[d.jsx(Di,{}),d.jsx(Zi,{children:d.jsx(Vs,{children:f?.message})})]}):d.jsxs(d.Fragment,{children:[p&&d.jsxs(Nn,{fontSize:"xs",onClick:()=>window.open(i9({accessions:u,contentType:["experimental",...o?["computational"]:[]]})),children:["Open query in RCSB PDB ",d.jsx(p2,{})]}),d.jsx(ke,{loading:g,disabled:!p||(h?.totalCount??0)===0,onClick:b,children:h&&h.totalCount>0?`Use ${h.totalCount} Matching ${h.totalCount===1?"Assembly":"Assemblies"}`:"No Matching Assemblies"})]})}),e[20]=u,e[21]=h,e[22]=f?.message,e[23]=o,e[24]=m,e[25]=g,e[26]=p,e[27]=b,e[28]=i.length,e[29]=T):T=e[29];let A;return e[30]!==C||e[31]!==T?(A=d.jsxs(d.Fragment,{children:[y,C,T]}),e[30]=C,e[31]=T,e[32]=A):A=e[32],A};function f9(n){const{uniprotAccession:e}=n;return e}const p9=({dialogRef:n,finalFocusEl:e,onSelectedAssemblies:t})=>{const r=xn({finalFocusEl:e});_.useEffect(()=>{if(n)return n.current=r,()=>{n.current=null}},[n,r]);const i=_.useRef(null);return d.jsx(rr,{value:r,placement:"top",size:"lg",lazyMount:!0,unmountOnExit:!0,children:d.jsx(nn,{portalled:!1,ref:i,children:d.jsx(h9,{onSelectedAssemblies:(...s)=>(r.setOpen(!1),t?.(...s)),containerRef:i})})})},m9=({onAddedStructures:n,endElementWhenEmpty:e,setDisableFileDrop:t,ref:r,...i})=>{const[s,o]=_.useState(""),[a,{isPending:l}]=Lw(s,300),{query:c,data:u,error:h}=a9({query:a}),f=s.trim().length>0,p=f&&!l()&&c?.query===s,m=p&&Jn(u),g=p&&!!h,x=f&&!m&&!g,b=_.useCallback(()=>{m&&(n(u.map(v=>l9(v))),o(""))},[m,n,u]),y=_.useRef(null);_.useEffect(()=>{t?.(y.current?.open??!1)},[y.current?.open,t]);const w=_.useRef(null);return d.jsxs(d.Fragment,{children:[d.jsx(p9,{onSelectedAssemblies:v=>o(v.map(({pdbId:S,assemblyId:k})=>S+(k?`-${k}`:"")).join(", ")),finalFocusEl:()=>w.current,dialogRef:y}),d.jsx(Hw,{placeholder:"PDB ID(s)",value:s,onChange:v=>o(v.currentTarget.value),onSubmit:b,success:m&&(u.length===1?d.jsxs(d.Fragment,{children:[u[0].sourceDb&&d.jsxs(d.Fragment,{children:[d.jsxs("b",{children:[u[0].sourceDb,":"]})," "]}),u[0].title]}):De(u.length,"structure")),error:g&&h.message,helperTextWhenEmpty:d.jsxs(Nn,{onClick:()=>y.current?.setOpen(!0),children:[d.jsx(m2,{}),"Search Structures by UniProt Accession"]}),isLoading:x,endElementWhenEmpty:e,inputRef:w,...i,ref:r})]})},g9="_droparea_kmyc6_1",x9="_dragover_kmyc6_9",kg={droparea:g9,dragover:x9},b9=[["mmCIF",{stringExtensions:["cif","mmcif","mcif"],binaryExtensions:["bcif"]}],["PDB",{stringExtensions:["pdb","ent"]}]],y9=b9.flatMap(([n,{stringExtensions:e,binaryExtensions:t}])=>[e??[],t??[]].join()).flatMap(n=>[n,`${n}.gz`]),v9="_loaderbox_f1zdr_1",w9="_drop_f1zdr_5",jg={loaderbox:v9,drop:w9},_9=n=>{const e=te.c(20);let t,r,i,s;e[0]!==n?({state:s,onClose:t,ref:r,...i}=n,e[0]=n,e[1]=t,e[2]=r,e[3]=i,e[4]=s):(t=e[1],r=e[2],i=e[3],s=e[4]);const{id:o,name:a,stage:l,error:c}=s,u=!!c,h=l==="done"&&!u,f=!h&&!u;let p;e[5]!==o||e[6]!==t?(p=t?()=>t(o):void 0,e[5]=o,e[6]=t,e[7]=p):p=e[7];let m;e[8]!==c||e[9]!==u||e[10]!==f||e[11]!==l?(m=f?l==="fetching"?d.jsx("div",{className:jg.loaderbox,children:d.jsxs("div",{className:jg.drop,children:[d.jsx(Wh,{}),d.jsx(Wh,{})]})}):d.jsx(Zr,{size:"xs",animationDuration:l==="queue"?"1s":"0.3s"}):u?d.jsx(en,{content:c.message,showArrow:!0,openDelay:0,closeDelay:0,children:d.jsx(Fg,{})}):null,e[8]=c,e[9]=u,e[10]=f,e[11]=l,e[12]=m):m=e[12];const g=h?"green":u?"red":void 0;let x;return e[13]!==a||e[14]!==r||e[15]!==i||e[16]!==p||e[17]!==m||e[18]!==g?(x=d.jsx(Mt,{size:"lg",onClose:p,startElement:m,colorPalette:g,ref:r,...i,children:a}),e[13]=a,e[14]=r,e[15]=i,e[16]=p,e[17]=m,e[18]=g,e[19]=x):x=e[19],x},Vw=n=>{const{name:e}=/(?<name>[^\/\\]*?)(\.[^\/\\]*)?$/m.exec(n)?.groups??{};return e},S9=n=>{const e=te.c(57),{setPreventClose:t,onFinishedLoadingStructures:r,containerRef:i}=n,{loadStructures:s,structures:o,removeStructure:a,isLoading:l,hasErrors:c}=Xz(),[u,h]=_.useState(!1);let f;e[0]!==u||e[1]!==s?(f=q=>{!q||u||s(q.filter(P9).map(C9))},e[0]=u,e[1]=s,e[2]=f):f=e[2];const p=D8(document,f);let m;e[3]!==s?(m=()=>{const q=document.createElement("input");q.type="file",q.accept=[...y9.map(k9),".zip"].join(","),q.multiple=!0,q.onchange=X=>{const J=Array.from(q.files??[]);J.length!==0&&s(J.map(j9))},q.click()},e[3]=s,e[4]=m):m=e[4];const g=m,x=o.length>0;let b,y;e[5]!==t||e[6]!==x?(b=()=>{t(x)},y=[t,x],e[5]=t,e[6]=x,e[7]=b,e[8]=y):(b=e[7],y=e[8]),_.useEffect(b,y);const{experiments:w}=Je(ie);let v;e[9]!==w?(v=new Set(w.map(T9)),e[9]=w,e[10]=v):v=e[10];const[S,k]=_.useState(v),[P,C]=_.useState(!1);let T;e[11]!==r||e[12]!==S||e[13]!==o?(T=()=>{C(!0),setTimeout(()=>{const q=qz(o,Array.from(S));r?.(q,Array.from(S))},1e3)},e[11]=r,e[12]=S,e[13]=o,e[14]=T):T=e[14];const A=T;let M,O;e[15]!==w||e[16]!==S?(M=()=>{Array.from(S).every(q=>w.some(X=>{const{id:J}=X;return J===q}))||k(q=>q.difference(new Set(w.map(M9))))},O=[S,w],e[15]=w,e[16]=S,e[17]=M,e[18]=O):(M=e[17],O=e[18]),_.useEffect(M,O);let R;e[19]!==p||e[20]!==u?(R=!u&&d.jsx("div",{className:`${kg.droparea} ${p?kg.dragover:""}`}),e[19]=p,e[20]=u,e[21]=R):R=e[21];let j;e[22]===Symbol.for("react.memo_cache_sentinel")?(j=d.jsx(Yt,{children:"Add Structures"}),e[22]=j):j=e[22];let I;e[23]!==P?(I=!P&&d.jsx(on,{}),e[23]=P,e[24]=I):I=e[24];let E;e[25]!==I?(E=d.jsxs(Gt,{flexDir:"column",children:[j,I]}),e[25]=I,e[26]=E):E=e[26];let D;e[27]!==P||e[28]!==s||e[29]!==g?(D=!P&&d.jsx(m9,{autoFocus:!0,placeholder:"Enter PDB ID(s) or drop a file (mmCIF or PDB)",onAddedStructures:s,endElementWhenEmpty:d.jsx(mt,{size:"xs",variant:"subtle",onClick:g,children:d.jsx(g2,{})}),setDisableFileDrop:h}),e[27]=P,e[28]=s,e[29]=g,e[30]=D):D=e[30];let L;if(e[31]!==P||e[32]!==a||e[33]!==o){let q;e[35]!==P||e[36]!==a?(q=X=>d.jsx(_9,{state:X,onClose:P?void 0:a},X.id),e[35]=P,e[36]=a,e[37]=q):q=e[37],L=o.map(q),e[31]=P,e[32]=a,e[33]=o,e[34]=L}else L=e[34];let z;e[38]!==L?(z=d.jsx(ko,{children:L}),e[38]=L,e[39]=z):z=e[39];let B;e[40]!==D||e[41]!==z?(B=d.jsx(wn,{asChild:!0,children:d.jsxs(bn,{gap:"4",children:[D,z]})}),e[40]=D,e[41]=z,e[42]=B):B=e[42];let N;e[43]!==i||e[44]!==w||e[45]!==c||e[46]!==P||e[47]!==l||e[48]!==S||e[49]!==o.length||e[50]!==A?(N=o.length>0&&!l&&!c&&d.jsx(Xt,{children:d.jsxs(_1,{attached:!0,children:[d.jsxs(ke,{loading:P,onClick:()=>A(),children:["Add"," ",De(o.length,"Structure","s",o.length===1?null:void 0)," ","to"," ",S.size===0?"Project":De(S.size,"Experiment","s",S.size===w.length?w.length>1?"All":null:void 0)]}),!P&&w.length>0&&d.jsxs(bo,{closeOnSelect:!1,children:[d.jsx(yo,{asChild:!0,children:d.jsx(mt,{minW:3,roundedLeft:0,children:d.jsx(Hg,{})})}),d.jsx(Cr,{container:i,children:d.jsx(vo,{children:d.jsx(wo,{children:d.jsx(z1,{children:w.map(q=>{const{id:X,name:J}=q;return d.jsxs(B1,{value:J??"Unnamed Experiment",checked:S.has(X),onCheckedChange:ee=>k(re=>ee?re.union(new Set([X])):re.difference(new Set([X]))),children:[J??"Unnamed Experiment",d.jsx(un,{})]},X)})})})})})]})]})}),e[43]=i,e[44]=w,e[45]=c,e[46]=P,e[47]=l,e[48]=S,e[49]=o.length,e[50]=A,e[51]=N):N=e[51];let U;return e[52]!==E||e[53]!==B||e[54]!==N||e[55]!==R?(U=d.jsxs(d.Fragment,{children:[R,E,B,N]}),e[52]=E,e[53]=B,e[54]=N,e[55]=R,e[56]=U):U=e[56],U};function P9(n){const{size:e}=n;return e>0}function C9(n){return{name:Vw(n.name)??n.name,fetchParams:{type:"file",file:n}}}function k9(n){return`.${n}`}function j9(n){return{name:Vw(n.name)??n.name,fetchParams:{type:"file",file:n}}}function T9(n){const{id:e}=n;return e}function M9(n){const{id:e}=n;return e}const A9="/xlinkup/next/assets/worker-CV9JbfXp.js",Qu=({startPosition:n,sequence:e})=>$i(`${n}-${e}`).toString(),E9=new $w(A9),I9=n=>{const e=new Set,t=[],r=ie.experiments.filter(({id:i})=>n?.includes(i)??!0);for(const i of[...r.flatMap(({id:s,proteins:o})=>_T(o).map(a=>a.isReferenceProtein?a:{...a,experimentId:s})),...Object.values(ie.referenceProteinsById).map(s=>({...s,isReferenceProtein:!0}))])e.has(i.id)||(t.push(Gg(i)),e.add(i.id));return t},R9=n=>{const e={};for(const[t,r]of n.flatMap(({id:i,chains:s})=>s.map(o=>[i,o]))){const i=Qu(r);i in e?e[i].ids.push([t,r.id]):e[i]={chain:x2(r,["sequence","startPosition"]),ids:[[t,r.id]],stage:"queue"}}return{id:gl(),chainHashToMappingState:e,structureIdToChainIdToSelectedMappings:Object.fromEntries(n.map(({id:t,chains:r})=>[t,Object.fromEntries(r.map(({id:i})=>[i,void 0]))]))}},O9=(n,e)=>{const[t,r]=_.useState(),i=_.useCallback((c,u,h)=>r(f=>{if(f===void 0||f.id!==c)return f;const{chainHashToMappingState:p,structureIdToChainIdToSelectedMappings:m,...g}=f;let x=m;if(h?.availableMappings!==void 0){Kr(h.availableMappings!==void 0);const b=h.availableMappings.filter(({confidence:w})=>w>.6);x={...m};const y=p[u].ids;for(const[w,v]of y){const S=x[w];S[v]===void 0&&(x[w]={...S,[v]:[...b]})}}return{chainHashToMappingState:h===null?Object.fromEntries(Object.entries(p).filter(([b])=>b!==u)):{...p,[u]:{...p[u],...h}},structureIdToChainIdToSelectedMappings:x??m,...g}}),[]);_.useEffect(()=>{r(c=>(Object.values(c?.chainHashToMappingState??{}).map(({cancel:u})=>u?.()),R9(n)))},[n,e]),_.useEffect(()=>{if(t===void 0)return;const{id:c,chainHashToMappingState:u}=t,h=Object.entries(u).filter(([f,{stage:p,cancel:m}])=>p==="queue"&&!m);for(const[f,{chain:p}]of h){const{cancel:m}=E9.exec(p,e,g=>i(c,f,{stage:g})).then(g=>i(c,f,{stage:"done",availableMappings:g})).catch(g=>{g.name==="CancellationError"||g.message==="Worker terminated"?i(c,f,null):i(c,f,{error:g})}).finally(()=>i(c,f,{cancel:void 0}));i(c,f,{cancel:m})}},[t,e,i]);const s=_.useCallback((c,u,h,f)=>{r(p=>{if(p===void 0)return p;const{structureIdToChainIdToSelectedMappings:m,...g}=p;Kr(f===null||f.proteinId===h);const b=[...(m[c][u]??[]).filter(y=>y.proteinId!==h),...f?[f]:[]];return{structureIdToChainIdToSelectedMappings:Object.fromEntries(Object.entries(m).map(([y,w])=>[y,y===c?{...w,[u]:b}:w])),...g}})},[]),o=_.useMemo(()=>{if(t===void 0)return null;const c={loading:0,success:0,mapped:0,error:0};for(const[u,h]of n.flatMap(({id:f,chains:p})=>p.map(m=>[f,m]))){const f=t.structureIdToChainIdToSelectedMappings[u][h.id];if(f!==void 0){c.success++,f.length>0&&c.mapped++;continue}const{error:p,stage:m}=t.chainHashToMappingState[Qu(h)];p?c.error++:c.loading++}return c},[n,t]),a=_.useCallback((c,u)=>{if(t===void 0)return;const h=t.chainHashToMappingState?.[Qu(u)],f=t.structureIdToChainIdToSelectedMappings[c][u.id];return f!==void 0?{chain:u,ids:[[c,u.id]],stage:"done",availableMappings:h.availableMappings,selectedMappings:f}:{...h,selectedMappings:[]}},[t]),l=_.useCallback(({id:c,chains:u})=>{const h=t?.structureIdToChainIdToSelectedMappings[c];return Object.fromEntries(u.map(({id:f})=>[f,Kg(h?.[f]?.map(({proteinId:p,proteinPosToChainPos:m})=>[p,Yg(m)]))]))},[t?.structureIdToChainIdToSelectedMappings]);return{chainCounts:o,updateChainSelectedMapping:s,getMappingState:a,getMappingsForStructure:l}},$9=({structureId:n,chainId:e,state:t,proteinById:r,updateChainSelectedMapping:i,ref:s,...o})=>{const a=!!t.error,c=!(t.stage==="done"&&!a)&&!a,u=_.useMemo(()=>{const h=new Set(t.selectedMappings?.map(({proteinId:p})=>p)),f={count:0,availble:[],unmappable:[]};for(const p of t.availableMappings??[])h.has(p.proteinId)||(f.count++,f.availble.push({...p,...r[p.proteinId]}),h.add(p.proteinId));for(const p of Object.values(r))h.has(p.id)||(f.count++,f.unmappable.push(p),h.add(p.id));return f},[r,t.selectedMappings,t.availableMappings]);return c?d.jsx(Zr,{size:"xs",animationDuration:t.stage==="queue"?"1s":"0.3s"}):a?d.jsxs(Qr,{status:"error",size:"sm",children:[d.jsx(Di,{}),d.jsx(Vs,{children:t.error?.message})]}):d.jsxs(ko,{ref:s,...o,children:[t.selectedMappings?.map(h=>{const f=r[h.proteinId];return d.jsxs(U1,{positioning:{placement:"top-end"},size:"sm",lazyMount:!0,unmountOnExit:!0,children:[d.jsx(Ia,{asChild:!0,children:d.jsx(ke,{size:"2xs",variant:"subtle",colorPalette:h.confidence>=.6?"green":"orange",children:f.name})}),d.jsx(_d,{children:d.jsxs(Sd,{children:[d.jsx(Cd,{}),d.jsxs(BP,{children:[d.jsxs(FP,{children:["Mapped to ",f.name]}),d.jsx(q1,{asChild:!0,children:d.jsx(lo,{size:"xs",position:"absolute",top:"2",insetEnd:"2"})})]}),d.jsxs(ou,{children:[d.jsxs(bd,{orientation:"horizontal",children:[d.jsxs(Si,{children:[d.jsxs(Pi,{children:["Coverage"," ",d.jsx(du,{children:"Percentage of residues in the protein that are aligned to positions in this chain."})]}),d.jsxs(Ci,{children:[(h.relativeHits*100).toFixed(0),"%"]})]}),h.alignmentScore&&d.jsxs(Si,{children:[d.jsxs(Pi,{children:["Alignment Score"," ",d.jsx(du,{children:"Quality of the sequence alignment between the protein and the chain. Higher scores indicate better matches."})]}),d.jsxs(Ci,{children:[(h.alignmentScore*100).toFixed(0),"%"]})]})]}),h.confidence<.6&&d.jsxs(Qr,{status:"warning",size:"sm",mt:4,borderStartWidth:"3px",borderStartColor:"colorPalette.600",children:[d.jsx(Di,{}),d.jsxs(Zi,{children:[d.jsx(Vs,{children:"This alignment might be incorrect"}),d.jsx(mo,{children:"This alignment may be incomplete or inconsistent with the proteins expected sequence."}),d.jsx(ke,{size:"2xs",colorPalette:"green",variant:"surface",mt:2,onClick:()=>i(n,e,f.id,{...h,confidence:1}),children:"Mark as Trusted"})]})]})]}),d.jsx(zP,{children:d.jsxs(ke,{size:"xs",colorPalette:"red",variant:"surface",onClick:()=>i(n,e,f.id,null),children:[d.jsx(od,{}),"Unmap"]})})]})})]},h.proteinId)}),u.count>0&&d.jsxs(bo,{size:"sm",onSelect:({value:h})=>i(n,e,h,t.availableMappings?.find(({proteinId:f})=>f===h)??null),children:[d.jsx(yo,{asChild:!0,children:d.jsxs(ke,{size:"2xs",variant:"ghost",children:[d.jsx(Jr,{}),(t.selectedMappings?.length??0)===0&&"Map to Protein"]})}),d.jsx(vo,{children:d.jsxs(wo,{children:[u.availble.map(({id:h,name:f,confidence:p})=>d.jsx(Ea,{value:h,flexDirection:"column",alignItems:"stretch",children:d.jsxs(Re,{gapX:3,children:[d.jsx(rt,{flex:1,children:f}),d.jsxs(rt,{textAlign:"end",fontSize:"2xs",color:"fg.muted",children:[(p*100).toFixed(0),"%"]})]})},h)),u.unmappable.map(({id:h,name:f})=>d.jsx(Ea,{value:h,disabled:!0,children:f},h))]})})]})]})},D9=({collection:n,onValueChange:e,selectRef:t,ref:r,...i})=>{const s=wl({collection:n,multiple:!0,onValueChange:e});return _.useEffect(()=>{if(t)return t.current=s,()=>{t.current=null}},[t,s]),d.jsxs(kd,{value:s,size:"sm",display:"inline",...i,children:[d.jsx(tb,{}),d.jsx(jd,{asChild:!0,children:d.jsx(mt,{size:"2xs",variant:s.hasSelectedItems?"surface":"ghost",colorPalette:s.hasSelectedItems?"blue":void 0,ml:3,...s.getTriggerProps(),children:d.jsx(zg,{})})}),d.jsx(K1,{children:d.jsx(Z1,{minW:"32",children:s.collection.items.map(o=>d.jsxs(Q1,{item:o,children:[o.label,d.jsx(eb,{})]},o.value))})})]})},ul=n=>{const e=te.c(8);let t,r;e[0]!==n?({value:r,...t}=n,e[0]=n,e[1]=t,e[2]=r):(t=e[1],r=e[2]);const{_collection:i,_onValueChange:s,_selectRef:o}=r;let a;return e[3]!==i||e[4]!==s||e[5]!==o||e[6]!==t?(a=d.jsx(D9,{collection:i,onValueChange:s,selectRef:o,...t}),e[3]=i,e[4]=s,e[5]=o,e[6]=t,e[7]=a):a=e[7],a},dl=n=>{const e=te.c(7);let t,r;e[0]!==n?(r=cd({items:n}),e[0]=n,e[1]=r):r=e[1],t=r;const i=t,s=_.useRef(null),[o,a]=_.useState();let l;e[2]===Symbol.for("react.memo_cache_sentinel")?(l=p=>{const{value:m}=p;return a(m.length===0?void 0:m)},e[2]=l):l=e[2];const c=l;let u;e[3]===Symbol.for("react.memo_cache_sentinel")?(u=()=>{s.current?.clearValue()},e[3]=u):u=e[3];const h=u;let f;return e[4]!==i||e[5]!==o?(f={filter:o,clear:h,_collection:i,_onValueChange:c,_selectRef:s},e[4]=i,e[5]=o,e[6]=f):f=e[6],f},eu=5,N9=({addedStructures:n,getMappingState:e,updateChainSelectedMapping:t,proteinById:r,ref:i,...s})=>{const o=dl(_.useMemo(()=>n.map(({id:f,name:p})=>({value:f,label:p})),[n])),a=dl(_.useMemo(()=>Object.values(r).map(({id:f,name:p})=>({value:f,label:p})),[r])),l=_.useMemo(()=>n.filter(({id:f})=>o.filter?.includes(f)??!0).flatMap(f=>f.chains.flatMap(p=>{const m=e(f.id,p);return m?[{structure:f,chain:p,state:m}]:[]}).filter(({state:p})=>a.filter===void 0?!0:p.selectedMappings?.some(m=>a.filter.includes(m.proteinId))??!1)),[n,o.filter,a.filter,e]),[c,u]=_.useState(1),h=_.useMemo(()=>{const f=[],p=(c-1)*eu,m=c*eu;let g=-1;for(const x of l){if(++g,g>=m)break;if(g>=p){f.push(x);continue}}return f},[l,c]);return l.length>0&&h.length===0&&c!==1&&u(1),d.jsxs(d.Fragment,{children:[d.jsxs(Md,{size:"sm",ref:i,...s,children:[d.jsxs(El,{children:[d.jsx(Rn,{htmlWidth:"40%"}),d.jsx(Rn,{htmlWidth:"10%"}),d.jsx(Rn,{})]}),d.jsx(Al,{children:d.jsxs(En,{children:[d.jsxs(In,{children:["Structure",d.jsx(ul,{value:o})]}),d.jsx(In,{verticalAlign:"baseline",children:"Chain"}),d.jsxs(In,{children:["Protein(s) to Map",d.jsx(ul,{value:a})]})]})}),d.jsxs(Ad,{children:[h.map(({structure:f,chain:p,state:m})=>d.jsxs(En,{children:[d.jsx(zt,{wordBreak:"break-word",children:f.name}),d.jsx(zt,{children:p.id}),d.jsx(zt,{children:d.jsx($9,{structureId:f.id,chainId:p.id,state:m,updateChainSelectedMapping:t,proteinById:r})})]},`${f.id}-${p.id}`)),l.length===0&&d.jsx(En,{children:d.jsxs(zt,{colSpan:3,textAlign:"center",py:5,children:["Nothing to Show",(o.filter!==void 0||a.filter!==void 0)&&d.jsxs(d.Fragment,{children:[d.jsx("br",{}),d.jsx(Nn,{colorPalette:"teal",onClick:()=>{o.clear(),a.clear()},children:"Reset Filters"})]})]})})]})]}),h.length<l.length&&d.jsx(RP,{count:l.length,pageSize:eu,page:c,onPageChange:({page:f})=>u(f),textAlign:"center",children:d.jsxs(_1,{variant:"ghost",size:"2xs",wrap:"wrap",children:[d.jsx(NP,{asChild:!0,children:d.jsx(mt,{children:d.jsx(b2,{})})}),d.jsx(LP,{render:f=>d.jsx(mt,{variant:{base:"ghost",_selected:"outline"},children:f.value})}),d.jsx(DP,{asChild:!0,children:d.jsx(mt,{children:d.jsx(Vg,{})})})]})})]})},L9=n=>{const e=te.c(17),{addedStructuresCount:t,numOfChains:r,experimentIdsCount:i}=n,[s,o]=_.useState(!1);if(s)return null;let a;e[0]===Symbol.for("react.memo_cache_sentinel")?(a=d.jsx(Di,{}),e[0]=a):a=e[0];let l;e[1]!==t?(l=De(t,"Structure"),e[1]=t,e[2]=l):l=e[2];let c;e[3]!==l?(c=d.jsxs(Vs,{children:[l," Added Successfully"]}),e[3]=l,e[4]=c):c=e[4];const u=t!==1?"s":"",h=t!==1?"have":"has",f=i>0?`selected experiment${i!==1?"s":""}`:"project",p=r!==1?"s":"",m=t>1?"each structure":"the structure";let g;e[5]!==u||e[6]!==h||e[7]!==f||e[8]!==p||e[9]!==m?(g=d.jsxs(mo,{children:["The structure",u," ",h," been added to the"," ",f,". ","Next, map the chain",p," within"," ",m," to the corresponding proteins. This mapping can be updated later in the Structures tab."]}),e[5]=u,e[6]=h,e[7]=f,e[8]=p,e[9]=m,e[10]=g):g=e[10];let x;e[11]!==c||e[12]!==g?(x=d.jsxs(Zi,{children:[c,g]}),e[11]=c,e[12]=g,e[13]=x):x=e[13];let b;e[14]===Symbol.for("react.memo_cache_sentinel")?(b=d.jsx(qS,{pos:"relative",top:"-2",insetEnd:"-2",onClick:()=>o(!0)}),e[14]=b):b=e[14];let y;return e[15]!==x?(y=d.jsxs(Qr,{status:"success",children:[a,x,b]}),e[15]=x,e[16]=y):y=e[16],y},F9=n=>{const e=te.c(39),{addedStructures:t,experimentIds:r,mappableProteins:i,onFinishedMappingStructures:s}=n;let o,a;e[0]!==i?(a=Object.fromEntries(i.map(z9)),e[0]=i,e[1]=a):a=e[1],o=a;const l=o;let c;c=t.reduce(B9,0);const u=c,{getMappingState:h,chainCounts:f,getMappingsForStructure:p,updateChainSelectedMapping:m}=O9(t,i),g=f!==null&&f.loading===0,[x,b]=_.useState(!1);let y;e[2]!==t||e[3]!==f?.success||e[4]!==p||e[5]!==s?(y=()=>{b(!0),setTimeout(()=>{for(const j of t)HT(j.id,p(j));s?.(f?.success??0)},1e3)},e[2]=t,e[3]=f?.success,e[4]=p,e[5]=s,e[6]=y):y=e[6];const w=y,v=u!==1?"s":"";let S;e[7]!==v?(S=d.jsx(Gt,{flexDir:"column",children:d.jsxs(Yt,{children:["Map Chain",v," to Proteins"]})}),e[7]=v,e[8]=S):S=e[8];let k;e[9]!==t.length||e[10]!==r.length||e[11]!==u?(k=d.jsx(L9,{addedStructuresCount:t.length,numOfChains:u,experimentIdsCount:r.length}),e[9]=t.length,e[10]=r.length,e[11]=u,e[12]=k):k=e[12];let P;e[13]!==f||e[14]!==g||e[15]!==i.length||e[16]!==u?(P=!g&&d.jsx(HP,{max:u,value:f===null?null:u-f.loading,colorPalette:(f?.error??0)>0?"red":void 0,shape:"full",variant:"subtle",children:d.jsxs(_o,{gap:5,children:[d.jsxs(VP,{children:["Mapping to ",De(i.length,"protein"),"..."]}),d.jsx(WP,{flex:"1",children:d.jsx(UP,{})}),f!==null&&d.jsxs(qP,{children:[Math.round(100-100*f.loading/u),"%"]})]})}),e[13]=f,e[14]=g,e[15]=i.length,e[16]=u,e[17]=P):P=e[17];let C;e[18]!==t||e[19]!==h||e[20]!==l||e[21]!==m?(C=d.jsx(N9,{addedStructures:t,getMappingState:h,updateChainSelectedMapping:m,proteinById:l}),e[18]=t,e[19]=h,e[20]=l,e[21]=m,e[22]=C):C=e[22];let T;e[23]!==k||e[24]!==P||e[25]!==C?(T=d.jsx(wn,{asChild:!0,children:d.jsxs(bn,{gap:"4",children:[k,P,C]})}),e[23]=k,e[24]=P,e[25]=C,e[26]=T):T=e[26];let A;e[27]===Symbol.for("react.memo_cache_sentinel")?(A=d.jsx(Sr,{asChild:!0,children:d.jsx(ke,{size:"xs",variant:"ghost",children:"Continue Without Mapping"})}),e[27]=A):A=e[27];let M;e[28]!==f?.mapped||e[29]!==g||e[30]!==x||e[31]!==w?(M=(x||!g||f?.mapped>0)&&d.jsxs(ke,{loading:!g||x,onClick:()=>w(),children:["Map ",De(f?.mapped??0,"Chain")]}),e[28]=f?.mapped,e[29]=g,e[30]=x,e[31]=w,e[32]=M):M=e[32];let O;e[33]!==M?(O=d.jsxs(Xt,{children:[A,M]}),e[33]=M,e[34]=O):O=e[34];let R;return e[35]!==T||e[36]!==O||e[37]!==S?(R=d.jsxs(d.Fragment,{children:[S,T,O]}),e[35]=T,e[36]=O,e[37]=S,e[38]=R):R=e[38],R};function z9(n){return[n.id,n]}function B9(n,e){const{chains:t}=e;return n+t.length}const H9=n=>{const e=te.c(14),{setPreventClose:t,onFlowEnded:r,containerRef:i}=n,[s,o]=_.useState();if(s===void 0){let a;e[0]!==r?(a=(c,u)=>{Nw();const h=I9(u);h.length>0?o({addedStructures:c,experimentIds:u,mappableProteins:h}):(yr.success({title:`${De(c.length,"Structure")} Added Successfully`}),r())},e[0]=r,e[1]=a):a=e[1];let l;return e[2]!==i||e[3]!==t||e[4]!==a?(l=d.jsx(S9,{setPreventClose:t,onFinishedLoadingStructures:a,containerRef:i}),e[2]=i,e[3]=t,e[4]=a,e[5]=l):l=e[5],l}else{let a;e[6]!==r?(a=c=>{c>0&&yr.success({title:`${De(c,"Chain")} Mapped Successfully`}),r()},e[6]=r,e[7]=a):a=e[7];let l;return e[8]!==s.addedStructures||e[9]!==s.experimentIds||e[10]!==s.mappableProteins||e[11]!==t||e[12]!==a?(l=d.jsx(F9,{addedStructures:s.addedStructures,experimentIds:s.experimentIds,mappableProteins:s.mappableProteins,setPreventClose:t,onFinishedMappingStructures:a}),e[8]=s.addedStructures,e[9]=s.experimentIds,e[10]=s.mappableProteins,e[11]=t,e[12]=a,e[13]=l):l=e[13],l}},V9=({dialogRef:n})=>{const[e,t]=_.useState(!1),r=xn({restoreFocus:!1,closeOnEscape:!e,closeOnInteractOutside:!e,onOpenChange:s=>{s.open||(Nw(),t(!1))}});_.useEffect(()=>{if(n)return n.current=r,()=>{n.current=null}},[n,r]);const i=_.useRef(null);return d.jsx(rr,{value:r,placement:"top",size:"lg",lazyMount:!0,unmountOnExit:!0,children:d.jsx(nn,{ref:i,children:d.jsx(H9,{setPreventClose:t,onFlowEnded:()=>r.setOpen(!1),containerRef:i})})})},W9=({openAddStructuresDialogRef:n,ref:e,...t})=>{const r=_.useRef(null),i=_.useCallback(()=>{r.current?.setOpen(!0)},[r]);return _.useEffect(()=>{if(n!==void 0)return n.current=i,()=>{n.current=null}},[n,i]),d.jsxs(d.Fragment,{children:[d.jsx(V9,{dialogRef:r}),d.jsx(Nh,{buttonProps:{children:d.jsx(Jr,{}),onClick:i},ref:e,...t,children:"Structures"})]})},U9=n=>{const e=te.c(69);let t,r,i;e[0]!==n?({onAddReferneceProteinClicked:t,ref:r,...i}=n,e[0]=n,e[1]=t,e[2]=r,e[3]=i):(t=e[1],r=e[2],i=e[3]);const s=zd(),{experiments:o,proteinIdToReferenceProtein:a}=Je(ie);let l;e[4]!==a?(l=ce=>{const{protein:fe}=ce;return a.get(fe.id)?.id??fe.id},e[4]=a,e[5]=l):l=e[5];const c=Object.groupBy(o.flatMap(q9),l);let u;e[6]===Symbol.for("react.memo_cache_sentinel")?(u=[],e[6]=u):u=e[6];const[h,f]=_.useState(u),p=Xi,m="5xl",g=6,x=Yh,b=s.length>0;let y;e[7]===Symbol.for("react.memo_cache_sentinel")?(y=d.jsxs(El,{children:[d.jsx(Rn,{htmlWidth:"5%"}),d.jsx(Rn,{htmlWidth:"30%"}),d.jsx(Rn,{})]}),e[7]=y):y=e[7];const w=h.length===0?!1:h.length===s.length?!0:"indeterminate";let v;e[8]!==s||e[9]!==f?(v=ce=>{const{checked:fe}=ce;f(fe?s.map(X9):[])},e[8]=s,e[9]=f,e[10]=v):v=e[10];let S;e[11]!==w||e[12]!==v?(S=d.jsx(In,{children:d.jsx(Qn,{size:"sm",top:"0.5","aria-label":"Select all reference proteins",checked:w,onCheckedChange:v})}),e[11]=w,e[12]=v,e[13]=S):S=e[13];let k,P;e[14]===Symbol.for("react.memo_cache_sentinel")?(k=d.jsx(In,{children:"Name"}),P=d.jsx(In,{children:"References"}),e[14]=k,e[15]=P):(k=e[14],P=e[15]);let C;e[16]!==S?(C=d.jsx(Al,{children:d.jsxs(En,{children:[S,k,P]})}),e[16]=S,e[17]=C):C=e[17];const T=Yh,A=s.map((ce,fe)=>{const ve=c[ce.id],xe=ve?Object.groupBy(ve,G9):{},ue=Object.keys(xe).toSorted((Se,Le)=>(xe[Le]?.length??0)-(xe[Se]?.length??0)).map(Se=>[Se,xe[Se]?.map(Y9)??[]]);return d.jsxs(En,{"data-selected":h.includes(ce.id)?"":void 0,children:[d.jsx(zt,{userSelect:"none",children:d.jsx(Qn,{size:"sm",top:"0.5","aria-label":"Select reference protein",checked:h.includes(ce.id),inputProps:{onClick:Se=>{const{shiftKey:Le}=Se,$=!h.includes(ce.id);if(Le){const F=pl(s.map(V=>{const{id:K}=V;return h.includes(K)}),$,fe).map(V=>s[V].id);f(V=>Array.from(new Set($?[...V,...F]:V.filter(K=>!F.includes(K)))))}else f(F=>$?[...F,ce.id]:F.filter(V=>V!==ce.id))}}})}),d.jsx(zt,{children:d.jsx(Ws,{size:"md",wordBreak:"break-word",children:ce.name})}),d.jsxs(zt,{children:[ue.length===0?"Not referenced by any protein":ue.length===1?d.jsxs(d.Fragment,{children:["Referenced by ",d.jsx("b",{children:ue[0][0]})," ","in:"," ",ue[0][1].map(K9)]}):"Referenced by:",d.jsx(D1,{ps:5,gap:3,children:ue.length>1?ue.map(J9):null})]})]},ce.id)});let M;e[18]!==t||e[19]!==s.length?(M=s.length===0&&d.jsx(En,{children:d.jsxs(zt,{colSpan:3,textAlign:"center",py:5,children:["Nothing to Show",t&&d.jsxs(d.Fragment,{children:[d.jsx("br",{}),d.jsx(Nn,{colorPalette:"teal",onClick:t,children:"Add Reference Protein"})]})]})}),e[18]=t,e[19]=s.length,e[20]=M):M=e[20];let O;e[21]!==T.Body||e[22]!==A||e[23]!==M?(O=d.jsxs(T.Body,{children:[A,M]}),e[21]=T.Body,e[22]=A,e[23]=M,e[24]=O):O=e[24];let R;e[25]!==C||e[26]!==O||e[27]!==x.Root||e[28]!==b||e[29]!==y?(R=d.jsxs(x.Root,{interactive:b,children:[y,C,O]}),e[25]=C,e[26]=O,e[27]=x.Root,e[28]=b,e[29]=y,e[30]=R):R=e[30];let j;e[31]!==p||e[32]!==r||e[33]!==i||e[34]!==R?(j=d.jsx(p,{maxW:m,pt:g,ref:r,...i,children:R}),e[31]=p,e[32]=r,e[33]=i,e[34]=R,e[35]=j):j=e[35];const I=h.length>0;let E;e[36]!==f?(E=ce=>{const{open:fe}=ce;return fe?null:f([])},e[36]=f,e[37]=E):E=e[37];let D;e[38]!==h.length?(D=De(h.length,"reference protein"),e[38]=h.length,e[39]=D):D=e[39];let L;e[40]!==D?(L=d.jsxs(ql,{children:[D," selected"]}),e[40]=D,e[41]=L):L=e[41];let z;e[42]===Symbol.for("react.memo_cache_sentinel")?(z=d.jsx(Ni,{}),e[42]=z):z=e[42];let B;e[43]===Symbol.for("react.memo_cache_sentinel")?(B=d.jsx($d,{asChild:!0,children:d.jsxs(ke,{variant:"surface",colorPalette:"red",size:"sm",children:[d.jsx(Wg,{}),"Delete"]})}),e[43]=B):B=e[43];let N;e[44]!==h.length?(N=De(h.length,"reference protein"),e[44]=h.length,e[45]=N):N=e[45];let U;e[46]!==N?(U=d.jsxs(Yt,{children:["Delete"," ",N,"?"]}),e[46]=N,e[47]=U):U=e[47];let q;e[48]===Symbol.for("react.memo_cache_sentinel")?(q=d.jsx(on,{}),e[48]=q):q=e[48];let X;e[49]!==U?(X=d.jsxs(Gt,{children:[U,q]}),e[49]=U,e[50]=X):X=e[50];let J;e[51]===Symbol.for("react.memo_cache_sentinel")?(J=d.jsx(Sr,{asChild:!0,children:d.jsx(ke,{variant:"outline",children:"Cancel"})}),e[51]=J):J=e[51];let ee;e[52]!==h||e[53]!==f?(ee=d.jsxs(Xt,{children:[J,d.jsx(Sr,{asChild:!0,children:d.jsx(ke,{colorPalette:"red",onClick:()=>{h.forEach(Q9),f([])},children:"Delete"})})]}),e[52]=h,e[53]=f,e[54]=ee):ee=e[54];let re;e[55]!==X||e[56]!==ee?(re=d.jsxs(Od,{placement:"center",children:[B,d.jsxs(nn,{children:[X,ee]})]}),e[55]=X,e[56]=ee,e[57]=re):re=e[57];let oe;e[58]===Symbol.for("react.memo_cache_sentinel")?(oe=d.jsx(Wl,{}),e[58]=oe):oe=e[58];let me;e[59]!==L||e[60]!==re?(me=d.jsxs(Vl,{children:[L,z,re,oe]}),e[59]=L,e[60]=re,e[61]=me):me=e[61];let ge;e[62]!==I||e[63]!==E||e[64]!==me?(ge=d.jsx(Ul,{open:I,onOpenChange:E,closeOnInteractOutside:!1,children:me}),e[62]=I,e[63]=E,e[64]=me,e[65]=ge):ge=e[65];let ae;return e[66]!==j||e[67]!==ge?(ae=d.jsxs(d.Fragment,{children:[j,ge]}),e[66]=j,e[67]=ge,e[68]=ae):ae=e[68],ae};function q9(n){return n.proteins.flatMap(e=>({experiment:n,protein:e}))}function X9(n){const{id:e}=n;return e}function G9(n){const{protein:e}=n;return e.name}function Y9(n){const{experiment:e}=n;return e}function K9(n){const{id:e,name:t}=n;return d.jsx(Mt,{size:"lg",mr:1,startElement:d.jsx(iy,{}),children:t},e)}function Z9(n){const{id:e,name:t}=n;return d.jsx(Mt,{size:"lg",mr:1,startElement:d.jsx(iy,{}),children:t},e)}function J9(n){const[e,t]=n;return d.jsxs(N1,{children:[d.jsx("b",{children:e})," in:"," ",t.map(Z9)]},e)}function Q9(n){yT(n)}const e7=({openAddReferenceProteinDialogRef:n,ref:e,...t})=>{const r=_.useRef(null),i=_.useCallback(()=>{r.current?.setOpen(!0)},[r]);return _.useEffect(()=>{if(n!==void 0)return n.current=i,()=>{n.current=null}},[n,i]),d.jsxs(d.Fragment,{children:[d.jsx(ey,{dialogRef:r}),d.jsx(Nh,{buttonProps:{children:d.jsx(Jr,{}),onClick:i},ref:e,...t,children:"Proteins"})]})},t7=({structure:n,visibleExperiments:e,allExperiments:t,ref:r,...i})=>{const s=_.useMemo(()=>t.filter(({id:o})=>e.every(a=>a.id!==o)),[t,e]);return d.jsxs(ko,{ref:r,...i,children:[e.map(({id:o,name:a})=>d.jsx(Mt,{size:"lg",onClose:()=>Bd(o,[n.id]),children:a},o)),s.length>0&&d.jsxs(bo,{size:"sm",onSelect:({value:o})=>ny(o,[n.id]),children:[d.jsx(yo,{asChild:!0,children:d.jsxs(ke,{size:"2xs",variant:"ghost",children:[d.jsx(Jr,{}),e.length===0&&"Add to Experiments"]})}),d.jsx(vo,{children:d.jsx(wo,{children:s.map(({id:o,name:a})=>d.jsx(Ea,{value:o,children:a},o))})})]})]})},n7=({onAddStructureClicked:n,ref:e,...t})=>{const{experiments:r,structures:i,experimentIdToGroupedStructureIds:s}=Je(ie),o=_.useMemo(()=>Object.fromEntries(i.map(({id:f})=>[f,r.filter(({id:p})=>s[p].some(m=>m.includes(f)))])),[i,r,s]),a=dl(_.useMemo(()=>i.map(({id:f,name:p})=>({value:f,label:p})),[i])),l=dl(_.useMemo(()=>r.map(({id:f,name:p})=>({value:f,label:p})),[r])),c=_.useMemo(()=>i.filter(({id:f})=>(a.filter?.includes(f)??!0)&&(l.filter?.some(p=>o[f].some(m=>m.id===p))??!0)),[i,a.filter,l.filter,o]),[u,h]=_.useState([]);return d.jsxs(d.Fragment,{children:[d.jsx(Xi,{maxW:"5xl",pt:6,ref:e,...t,children:d.jsxs(Md,{interactive:c.length>0,children:[d.jsxs(El,{children:[d.jsx(Rn,{htmlWidth:"5%"}),d.jsx(Rn,{htmlWidth:"30%"}),d.jsx(Rn,{})]}),d.jsx(Al,{children:d.jsxs(En,{children:[d.jsx(In,{children:d.jsx(Qn,{size:"sm",top:"0.5","aria-label":"Select all structures",checked:u.length===0?!1:u.length===c.length?!0:"indeterminate",onCheckedChange:({checked:f})=>{h(f?c.map(({id:p})=>p):[])}})}),d.jsxs(In,{children:["Name",d.jsx(ul,{value:a})]}),d.jsxs(In,{children:["Experiments",d.jsx(ul,{value:l})]})]})}),d.jsxs(Ad,{children:[c.map((f,p)=>d.jsxs(En,{"data-selected":u.includes(f.id)?"":void 0,children:[d.jsx(zt,{userSelect:"none",children:d.jsx(Qn,{size:"sm",top:"0.5","aria-label":"Select structure",checked:u.includes(f.id),inputProps:{onClick:({shiftKey:m})=>{const g=!u.includes(f.id);if(m){const x=pl(c.map(({id:b})=>u.includes(b)),g,p).map(b=>c[b].id);h(b=>Array.from(new Set(g?[...b,...x]:b.filter(y=>!x.includes(y)))))}else h(x=>g?[...x,f.id]:x.filter(b=>b!==f.id))}}})}),d.jsx(zt,{children:d.jsx(Ws,{size:"md",wordBreak:"break-word",children:f.name})}),d.jsx(zt,{children:d.jsx(t7,{structure:f,visibleExperiments:o[f.id],allExperiments:r})})]},f.id)),c.length===0&&d.jsx(En,{children:d.jsxs(zt,{colSpan:3,textAlign:"center",py:5,children:["Nothing to Show",a.filter!==void 0||l.filter!==void 0?d.jsxs(d.Fragment,{children:[d.jsx("br",{}),d.jsx(Nn,{colorPalette:"teal",onClick:()=>{a.clear(),l.clear()},children:"Reset Filters"})]}):n&&d.jsxs(d.Fragment,{children:[d.jsx("br",{}),d.jsx(Nn,{colorPalette:"teal",onClick:n,children:"Add Structures"})]})]})})]})]})}),d.jsx(Ul,{open:u.length>0,onOpenChange:({open:f})=>f?null:h([]),closeOnInteractOutside:!1,children:d.jsxs(Vl,{children:[d.jsxs(ql,{children:[De(u.length,"structure")," selected"]}),d.jsx(Ni,{}),d.jsxs(Od,{placement:"center",children:[d.jsx($d,{asChild:!0,children:d.jsxs(ke,{variant:"surface",colorPalette:"red",size:"sm",children:[d.jsx(Wg,{}),"Delete"]})}),d.jsxs(nn,{children:[d.jsxs(Gt,{children:[d.jsxs(Yt,{children:["Delete ",De(u.length,"structure"),"?"]}),d.jsx(on,{})]}),d.jsxs(Xt,{children:[d.jsx(Sr,{asChild:!0,children:d.jsx(ke,{variant:"outline",children:"Cancel"})}),d.jsx(Sr,{asChild:!0,children:d.jsx(ke,{colorPalette:"red",onClick:()=>{qT(u),h([])},children:"Delete"})})]})]})]}),d.jsx(Wl,{})]})})]})},r7=({protein:n,stats:e,domainNameToStats:t,toggleVisibility:r,hideMultiProteinToggles:i,ref:s,...o})=>{const a=e.interprotein.visible+e.intraprotein.visible>0;return d.jsxs(S1,{borderColor:a?"colorPalette.solid":void 0,ref:s,...o,children:[d.jsxs(C1,{children:[d.jsxs(Re,{flexDir:"row",alignItems:"center",children:[d.jsx(Rd,{name:n.name,onRename:l=>Fa(n.id,{name:l}),size:"lg",fontWeight:"semibold"}),d.jsx(pn,{stat:e.interprotein,stat2:e.intraprotein,toggleVisibility:r,dir:"rtl"})]}),d.jsx(ty,{protein:{isReferenceProtein:!0,...n},domainNameToStats:t,toggleVisibility:r,experimentId:null,w:"fit-content",mt:-2})]}),d.jsx(P1,{p:i&&e.homomultimeric.total===0?0:void 0,children:d.jsxs(xo,{children:[!i&&d.jsxs(d.Fragment,{children:[d.jsx(pn,{name:"Inter-protein",info:"Crosslinks that occur between two different proteins",stat:e.interprotein,toggleVisibility:r}),d.jsx(pn,{name:"Intra-protein",info:"Crosslinks that occur within the same protein",stat:e.intraprotein,toggleVisibility:r})]}),e.homomultimeric.total>0&&d.jsx(pn,{ms:i?void 0:6,name:"Homo-multimeric",stat:e.homomultimeric,toggleVisibility:r})]})}),d.jsx(k1,{})]})},i7=_.memo(r7),s7=_.memo(function(e){const t=te.c(13);let r,i,s;t[0]!==e?({name:s,ref:r,...i}=e,t[0]=e,t[1]=r,t[2]=i,t[3]=s):(r=t[1],i=t[2],s=t[3]);const o=s===void 0?"File":s;let a;t[4]===Symbol.for("react.memo_cache_sentinel")?(a=d.jsx(ml,{children:d.jsx(Hd,{})}),t[4]=a):a=t[4];let l;t[5]!==o?(l=Dg(o,13),t[5]=o,t[6]=l):l=t[6];let c;t[7]!==l?(c=d.jsx(rt,{display:"inline-flex",fontSize:"xs",writingMode:"vertical-lr",minH:"fit",flexGrow:1,justifyContent:"end",me:2,children:l}),t[7]=l,t[8]=c):c=t[8];let u;return t[9]!==r||t[10]!==i||t[11]!==c?(u=d.jsxs(Re,{flexDir:"column",h:"100%",justifyContent:"space-between",alignItems:"center",gap:1,ref:r,...i,children:[a,c]}),t[9]=r,t[10]=i,t[11]=c,t[12]=u):u=t[12],u}),o7=_.memo(function({experiments:e,referenceProteinsById:t,groupedCrosslinkIds:r,groupDuplicates:i,hideCrosslinks:s}){const o=_.useDeferredValue(e),a=_.useDeferredValue(t),l=_.useDeferredValue(r),c=_.useDeferredValue(i),u=o!==e||a!==t||l!==r||c!==i,h=_.useRef(null),f=_.useMemo(()=>{const N=[void 0];return l.forEach(({rows:U},q)=>{q!==0&&N.push(void 0);const X=c?U.length:U.reduce((J,{ids:ee})=>J+Math.max(...ee.map(re=>re.length)),0);N.push(q),N.push(...Array(X-1).fill(void 0))}),N},[c,l]),p=_.useMemo(()=>{const N=[void 0];return l.forEach(({rows:U},q)=>{q!==0&&N.push(void 0);for(const X of U)c?N.push(X):N.push(..._i(...X.ids).map(J=>({...X,ids:J.map(ee=>ee!==void 0?[ee]:[])})).flat())}),N},[c,l]),m=N=>{if(N===0)return"header";const U=p[N];return U===void 0?`gap-after-${m(N-1)}`:U.ids.map(q=>q.length>0?q.join("-"):"X").join(":")},g=uy({enabled:l.length>0,count:p.length,estimateSize:N=>N===0?30:p[N]===void 0?5:26,scrollMargin:h.current?.offsetTop??0,getItemKey:m,overscan:20,rangeExtractor:N=>new Set([0,...Vd(N),...p.flatMap((U,q)=>U===void 0&&q+1<p.length?[q+1]:[])]).values().toArray()}),x=o.length,b=_.useMemo(()=>[void 0,...Array(x).keys()],[x]),y=cy({enabled:l.length>0,horizontal:!0,count:b.length,getScrollElement:()=>h.current,estimateSize:N=>N===0?237:26,overscan:20,getItemKey:N=>N===0?"header":o[b[N]].id}),w=y.getVirtualItems(),[v,S]=w.length>0?[w[0].start,y.getTotalSize()-w[w.length-1].end]:[0,0];let k=y.measurementsCache[0]?.size??0;const P=N=>{!y.options.enabled||!N||N.dataset.index!=="0"||k<N.getBoundingClientRect().width&&(k=N.getBoundingClientRect().width,y.resizeItem(0,Math.ceil(N.getBoundingClientRect().width)))};_.useEffect(()=>{y.measure()},[l,a,y]);let C=g.measurementsCache[0]?.size??0;const T=N=>{!g.options.enabled||!N||N.dataset.index!=="0"||C<N.getBoundingClientRect().height&&(C=N.getBoundingClientRect().height,g.resizeItem(0,Math.ceil(N.getBoundingClientRect().height)))};_.useEffect(()=>{g.measure()},[o,g]);const A=_.useMemo(()=>d.jsxs(d.Fragment,{children:[d.jsx(Aa,{styles:{".xlink":{cursor:"pointer",color:"transparent",fontSize:"0.8rem",alignContent:"center",textAlign:"center",":hover":{boxShadow:"inset 0px 0px 0px 1px var(--chakra-colors-fg-inverted)",color:"var(--chakra-colors-fg-inverted)"}}}}),d.jsx(Aa,{styles:Object.fromEntries(l.flatMap(({fromProteinId:N,fromDomainName:U,toProteinId:q,toDomainName:X})=>[N,...U?[N+U]:[],q,...X?[q+X]:[]].map(J=>[`html:has(.xlp${$i(J)}:hover) .xlp${$i(J)}`,{boxShadow:"inset 0px 0px 0px 1px var(--chakra-colors-fg-info)"}])))})]}),[l]),M=xn({}),{selectedCrosslinkIds:O,rowIndexToCheckedState:R,rowIndexToGroupCheckedState:j,numOfSelectedCrosslinks:I,numOfSelectedRows:E,onRowToggle:D,onGroupToggle:L,clearSelectedRows:z}=nv(_.useMemo(()=>o.map(({id:N})=>N),[o]),l,p,f),B=_.useCallback(N=>$l(Ol(o,l.map(({rows:U,...q})=>({rows:U.map(({ids:X,...J})=>({ids:X.map((ee,re)=>ee.filter(oe=>N[o[re].id]?.includes(oe)===!0)),...J})),...q}))),`${o.length===1?o[0].name??"XLinkUp":"Experiments"}-xlinks`),[o,l]);return d.jsxs(d.Fragment,{children:[A,d.jsx(tv,{dialog:M,dialogProps:{exportBasename:o.length===1?o[0].name??"XLinkUp":"Experiments",gridProps:{experiments:o.map(N=>({experiment:N,structureToXlinkIdToStatus:{[N.id]:Object.fromEntries(N.crosslinks.map(({id:U})=>[U,"ok"]))},groupedStructureIds:[[N.id]]})),groupedCrosslinkIds:l,proteinsById:a,structureNameById:Object.fromEntries(o.map(({id:N,name:U})=>[N,U??"Experiment"]))}}}),d.jsx("div",{ref:h,style:{overflowY:"auto",opacity:u?.5:1,transition:u?"opacity 0.2s 0.2s linear":"opacity 0s 0s linear",userSelect:"none",WebkitUserSelect:"none",display:"flex",justifyContent:"center",marginLeft:"1rem",marginRight:"1rem"},children:d.jsx("div",{style:{height:g.getTotalSize(),position:"relative",width:y.getTotalSize()},children:g.getVirtualItems().map(N=>{const U=N.index===0,q=p[N.index];if(!U&&q===void 0)return null;const X=!U&&f[N.index]!==void 0?l[f[N.index]]:void 0;return d.jsxs("div",{"data-index":N.index,ref:N.index===0?T:void 0,style:{position:"absolute",top:0,left:0,transform:`translateY(${N.start-g.options.scrollMargin}px)`,display:"flex"},children:[d.jsx("div",{style:{width:`${v}px`}}),w.map(J=>{const ee=J.index===0,re=b[J.index],oe=re!==void 0?{file:o[re],crosslinkIds:q?.ids[re]}:void 0;return d.jsxs("div",{"data-index":J.index,ref:J.index===0?P:void 0,className:Jn(oe?.crosslinkIds)?"xlink":void 0,onClick:()=>{if(oe?.crosslinkIds&&oe.crosslinkIds.length>0)throw new Error("TODO")},style:{minHeight:N.size,maxHeight:150,minWidth:J.size,maxWidth:500,flexShrink:0,...oe?.crosslinkIds?oe.crosslinkIds.length>0?{backgroundColor:An("ok")}:{backgroundColor:"transparent"}:{}},children:[U&&ee&&d.jsx(dy,{viewName:o.length===1?o[0].name??"XLinkUp":"Experiments",experiments:o,groupedCrosslinkIds:l,exportFigureDialog:M,showingStructures:!1,disableMenus:!1}),U&&!ee&&oe!==void 0&&d.jsx(s7,{name:oe.file.name}),ee&&!U&&q!==void 0&&d.jsx(sy,{rowHeader:q,groupHeader:X,checked:R[N.index],groupedChecked:j[N.index],toggle:D,toggleGroup:L}),oe?.crosslinkIds&&(oe.crosslinkIds.length??0)>1&&`x${oe.crosslinkIds.length}`]},J.key)}),d.jsx("div",{style:{width:`${S}px`}})]},N.key)})})}),d.jsx(rv,{selectedCrosslinkIds:O,numOfSelectedCrosslinks:I,numOfSelectedRows:E,clearSelectedRows:z,saveCrosslinksTable:B,hideCrosslinks:s})]})}),a7=({ref:n,...e})=>{const{experimentIdToGroupedStructureIds:t,experimentIdToVisibleCrosslinkIds:r,experiments:i,referenceProteinsById:s,proteinIdToReferenceProtein:o,groupDuplicatedCrosslinks:a}=Je(ie),[l,c]=_.useState(),u=Object.values(t).some(M=>M.some(O=>O.length>0)),h=u&&l!==!1,f=Jb(i),p=_.useMemo(()=>qs(f.map(({id:M,crosslinks:O})=>O.filter(({id:R,from:j,to:I})=>r[M].has(R)&&j.proteinId in s&&I.proteinId in s)),s),[f,r,s]),m=p.some(({rows:M})=>M.length>0),g=_.useMemo(()=>{const M=()=>({total:0,data:[]}),O=Object.fromEntries(Object.values(s).map(({id:j,domains:I})=>[j,{stats:{interprotein:M(),intraprotein:M(),homomultimeric:M()},domainNameToStats:Object.fromEntries(I?.map(({name:E})=>[E,{interdomain:M(),intradomain:M()}])??[])}])),R=(j,I)=>{j.total+=I.length,j.data.push(...I)};for(const{fromProteinId:j,fromDomainName:I,toProteinId:E,toDomainName:D,rows:L}of p)j===E?(R(O[j].stats.intraprotein,L),R(O[j].stats.homomultimeric,L.filter(({homoMultimeric:z})=>z.flat().some(B=>B)))):(R(O[j].stats.interprotein,L),R(O[E].stats.interprotein,L)),I&&D&&I===D&&j===E?R(O[j].domainNameToStats[I].intradomain,L):[[j,I],[E,D]].forEach(([z,B])=>{B&&R(O[z].domainNameToStats[B].interdomain,L)});return O},[p,s]),[x,b]=_.useState({}),y=_.useMemo(()=>{const M=j=>{let I=0;for(const{ids:E}of j)E.some((L,z)=>{const B=i[z].id;return x[B]===void 0||L.some(N=>!x[B].includes(N))})&&(I+=1);return I},O=j=>Bs(Object.entries(j).map(([I,{data:E,...D}])=>[I,{visible:M(E),data:E,...D}])),R={};for(const[j,{stats:I,domainNameToStats:E}]of Object.entries(g))R[j]={stats:O(I),domainNameToStats:Bs(Object.entries(E).map(([D,L])=>[D,O(L)]))};return R},[g,i,x]),w=_.useCallback((M,O=!1)=>{b(O?R=>Object.fromEntries(Object.entries(R).map(([j,I])=>[j,I?.filter(E=>M[j]?.includes(E)!==!0)])):R=>Object.fromEntries(Object.values(Object.groupBy([...Object.entries(R),...Object.entries(M)].flatMap(([j,I])=>I?[[j,I]]:[]),([j])=>j)).filter(j=>j!==void 0).map(j=>[j[0][0],j.flatMap(([I,E])=>E)])))},[b]),v=_.useCallback((M,...O)=>w(Object.fromEntries(_i(...O.flat().map(({ids:R})=>R)).map((R,j)=>[i[j].id,R.flatMap(I=>I??[])])),M),[w,i]),S=_.useMemo(()=>qs(f.map(({id:M,crosslinks:O})=>O.filter(({id:R,from:j,to:I})=>r[M].has(R)&&j.proteinId in s&&I.proteinId in s&&x[M]?.includes(R)!==!0)),s),[f,r,s,x]),{structures:k,experimentIdToThresholds:P,aminoAcidsMustMatch:C}=Je(ie),T=_.useMemo(()=>k.filter(({id:M})=>Object.values(t).some(O=>O.flat().includes(M))),[k,t]),A=_.useMemo(()=>f.map(M=>({experiment:M,structureToXlinkIdToStatus:Da(T??[],M.crosslinks,C,P[M.id]),visibleCrosslinkIds:new Set(M.crosslinks.filter(({id:O,from:R,to:j})=>r[M.id].has(O)&&R.proteinId in s&&j.proteinId in s&&x[M.id]?.includes(O)!==!0).map(({id:O})=>O)),groupedStructureIds:t[M.id]})),[f,T,C,P,r,s,x,t]);return d.jsxs(bn,{ref:n,...e,children:[d.jsxs(Xi,{maxW:"5xl",children:[!m&&d.jsxs(Qr,{status:"warning",my:5,children:[d.jsx(Di,{}),d.jsxs(Zi,{children:[d.jsx(Vs,{children:"No data available"}),d.jsx(mo,{children:Object.keys(s).length===0||o.size===0?"Ensure that proteins in your experiments are mapped to a reference protein.":"All crosslinks were filtered out in the experiment pages."})]})]}),d.jsx(ft,{position:"relative",children:d.jsx(Re,{gapY:5,gapX:10,wrap:"wrap",children:Object.values(s).toSorted((M,O)=>M.name.localeCompare(O.name)).map(M=>d.jsx(i7,{protein:M,stats:y[M.id].stats,domainNameToStats:y[M.id].domainNameToStats,toggleVisibility:v,hideMultiProteinToggles:Object.keys(s).length<=1,w:"30%",overflow:"clip",size:"sm"},M.id))})}),d.jsx(Ur,{my:5}),m&&d.jsxs(d.Fragment,{children:[d.jsx(bn,{children:u&&d.jsx(ah,{checked:!!h,onCheckedChange:({checked:M})=>c(!!M),children:"Show structures"})}),d.jsx(Ur,{my:5})]})]}),m&&(S.length===0?d.jsx(iv,{resetFilters:()=>b({}),loading:!1}):h?d.jsx(sv,{experiments:A,structures:T??[],resetFilters:()=>b({}),hideCrosslinks:w,groupDuplicates:a}):d.jsx(o7,{experiments:f,groupedCrosslinkIds:S,referenceProteinsById:s,groupDuplicates:a,hideCrosslinks:w}))]})},l7=_.memo(function(e){const t=te.c(17);let r,i,s,o;t[0]!==e?({value:o,onConfirm:r,ref:i,...s}=e,t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=o):(r=t[1],i=t[2],s=t[3],o=t[4]);let a,l;t[5]===Symbol.for("react.memo_cache_sentinel")?(a=d.jsxs(Gt,{children:[d.jsx(Yt,{children:"Close Project?"}),d.jsx(on,{})]}),l=d.jsx(wn,{children:"Are you sure you want to close this project? Any unsaved data will be lost."}),t[5]=a,t[6]=l):(a=t[5],l=t[6]);let c;t[7]===Symbol.for("react.memo_cache_sentinel")?(c=d.jsx(Sr,{asChild:!0,children:d.jsx(ke,{variant:"outline",children:"Cancel"})}),t[7]=c):c=t[7];let u;t[8]!==r?(u=d.jsxs(Xt,{children:[c,d.jsx(ke,{colorPalette:"red",onClick:()=>r(),children:"Close Project"})]}),t[8]=r,t[9]=u):u=t[9];let h;t[10]!==i||t[11]!==u?(h=d.jsxs(nn,{ref:i,children:[a,l,u]}),t[10]=i,t[11]=u,t[12]=h):h=t[12];let f;return t[13]!==s||t[14]!==h||t[15]!==o?(f=d.jsx(rr,{value:o,role:"alertdialog",...s,children:h}),t[13]=s,t[14]=h,t[15]=o,t[16]=f):f=t[16],f});function c7(n){return ci({attr:{version:"1.1",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{d:"M12 10v-2h-5v-2h5v-2l3 3zM11 9v4h-5v3l-6-3v-13h11v5h-1v-4h-8l4 2v9h4v-3z"},child:[]}]})(n)}const u7=_.memo(function(e){const t=te.c(77);let r,i,s,o,a;t[0]!==e?({confirmBeforeClosing:a,saveProject:o,closeProject:r,ref:i,...s}=e,t[0]=e,t[1]=r,t[2]=i,t[3]=s,t[4]=o,t[5]=a):(r=t[1],i=t[2],s=t[3],o=t[4],a=t[5]);const l=a===void 0?!0:a,{colorMode:c,theme:u,toggleColorMode:h,setColorMode:f}=y2(),[p,m]=oh(),[g,x]=ev();let b;t[6]===Symbol.for("react.memo_cache_sentinel")?(b={closeOnInteractOutside:!0,restoreFocus:!1},t[6]=b):b=t[6];const y=xn(b),{groupDuplicatedCrosslinks:w,aminoAcidsMustMatch:v}=Je(ie);let S;t[7]!==r||t[8]!==y||t[9]!==l?(S=l&&d.jsx(l7,{value:y,onConfirm:r}),t[7]=r,t[8]=y,t[9]=l,t[10]=S):S=t[10];let k;t[11]!==r||t[12]!==y||t[13]!==l||t[14]!==o||t[15]!==h?(k=K=>{const{value:G}=K;return G==="close"?l?y.setOpen(!0):r():G==="save"?o():G==="color-mode"?h():null},t[11]=r,t[12]=y,t[13]=l,t[14]=o,t[15]=h,t[16]=k):k=t[16];let P;t[17]===Symbol.for("react.memo_cache_sentinel")?(P=d.jsx(Bg,{}),t[17]=P):P=t[17];let C;t[18]!==i||t[19]!==s?(C=d.jsx(Fr,{asChild:!0,children:d.jsx(mt,{...s,ref:i,children:P})}),t[18]=i,t[19]=s,t[20]=C):C=t[20];let T;t[21]===Symbol.for("react.memo_cache_sentinel")?(T=d.jsx(v2,{}),t[21]=T):T=t[21];let A;t[22]===Symbol.for("react.memo_cache_sentinel")?(A=d.jsxs(tn,{value:"save",children:[T,"Save Project (.","xlinkup",")"]}),t[22]=A):A=t[22];let M;t[23]===Symbol.for("react.memo_cache_sentinel")?(M={placement:"right-start",gutter:2},t[23]=M):M=t[23];let O;t[24]===Symbol.for("react.memo_cache_sentinel")?(O=d.jsx(Fr,{asChild:!0,children:d.jsxs(Cc,{value:"bla",children:[d.jsx(w2,{}),"Project Options"]})}),t[24]=O):O=t[24];let R;t[25]!==w?(R=d.jsx(Mi,{value:"group-duplicates",checked:w,onCheckedChange:d7,children:"Group Identical Crosslinks"}),t[25]=w,t[26]=R):R=t[26];let j;t[27]!==v?(j=d.jsx(Mi,{value:"amino-acids-must-match",checked:v,onCheckedChange:h7,children:"Amino Acids Must Match"}),t[27]=v,t[28]=j):j=t[28];let I;t[29]!==R||t[30]!==j?(I=d.jsxs(pr,{positioning:M,children:[O,d.jsxs(fr,{children:[R,j]})]}),t[29]=R,t[30]=j,t[31]=I):I=t[31];let E;t[32]===Symbol.for("react.memo_cache_sentinel")?(E=d.jsx(Ei,{}),t[32]=E):E=t[32];let D;t[33]===Symbol.for("react.memo_cache_sentinel")?(D={placement:"right-start",gutter:2},t[33]=D):D=t[33];let L;t[34]!==c?(L=d.jsx(Fr,{asChild:!0,children:d.jsxs(Cc,{value:"color-mode",children:[c==="light"?d.jsx(_2,{}):d.jsx(S2,{}),"Color Mode"]})}),t[34]=c,t[35]=L):L=t[35];const z=u??"system";let B;t[36]!==f?(B=K=>{const{value:G}=K;return f(G)},t[36]=f,t[37]=B):B=t[37];let N,U,q,X;t[38]===Symbol.for("react.memo_cache_sentinel")?(N=d.jsx(Ai,{value:"light",children:"Light"}),U=d.jsx(Ai,{value:"dark",children:"Dark"}),q=d.jsx(Ei,{}),X=d.jsx(Ai,{value:"system",children:"System"}),t[38]=N,t[39]=U,t[40]=q,t[41]=X):(N=t[38],U=t[39],q=t[40],X=t[41]);let J;t[42]!==z||t[43]!==B?(J=d.jsx(fr,{children:d.jsxs(yu,{value:z,onValueChange:B,children:[N,U,q,X]})}),t[42]=z,t[43]=B,t[44]=J):J=t[44];let ee;t[45]!==L||t[46]!==J?(ee=d.jsxs(pr,{positioning:D,children:[L,J]}),t[45]=L,t[46]=J,t[47]=ee):ee=t[47];let re;t[48]===Symbol.for("react.memo_cache_sentinel")?(re={placement:"right-start",gutter:2},t[48]=re):re=t[48];let oe;t[49]===Symbol.for("react.memo_cache_sentinel")?(oe=d.jsx(Fr,{asChild:!0,children:d.jsxs(Cc,{value:"bla",children:[d.jsx(P2,{}),"Preferred Visualization Tool"]})}),t[49]=oe):oe=t[49];const me=p.key;let ge;t[50]!==m?(ge=K=>{const{value:G}=K;return m(G)},t[50]=m,t[51]=ge):ge=t[51];let ae;t[52]===Symbol.for("react.memo_cache_sentinel")?(ae=Iu.map(f7),t[52]=ae):ae=t[52];let ce;t[53]!==p.key||t[54]!==ge?(ce=d.jsxs(pr,{positioning:re,children:[oe,d.jsx(fr,{children:d.jsx(yu,{value:me,onValueChange:ge,children:ae})})]}),t[53]=p.key,t[54]=ge,t[55]=ce):ce=t[55];let fe;t[56]!==x?(fe=K=>{x(K)},t[56]=x,t[57]=fe):fe=t[57];let ve;t[58]===Symbol.for("react.memo_cache_sentinel")?(ve=d.jsx(en,{content:"B-Factor / pLDDT",openDelay:0,closeDelay:0,children:d.jsx(bb,{})}),t[58]=ve):ve=t[58];let xe;t[59]!==g||t[60]!==fe?(xe=d.jsxs(Mi,{value:"color-residues-by-reliability",checked:g,onCheckedChange:fe,children:["Color Residues by Reliability"," ",ve]}),t[59]=g,t[60]=fe,t[61]=xe):xe=t[61];let ue,Se;t[62]===Symbol.for("react.memo_cache_sentinel")?(ue=d.jsxs(tn,{value:"cite",disabled:!0,children:[d.jsx(C2,{}),"Cite"]}),Se=d.jsx(Ei,{}),t[62]=ue,t[63]=Se):(ue=t[62],Se=t[63]);let Le;t[64]===Symbol.for("react.memo_cache_sentinel")?(Le=d.jsxs(tn,{value:"close",color:"fg.error",children:[d.jsx(c7,{}),"Close Project"]}),t[64]=Le):Le=t[64];let $;t[65]!==I||t[66]!==ee||t[67]!==ce||t[68]!==xe?($=d.jsxs(fr,{children:[A,I,E,ee,ce,xe,ue,Se,Le]}),t[65]=I,t[66]=ee,t[67]=ce,t[68]=xe,t[69]=$):$=t[69];let F;t[70]!==$||t[71]!==k||t[72]!==C?(F=d.jsxs(pr,{onSelect:k,lazyMount:!0,unmountOnExit:!0,children:[C,$]}),t[70]=$,t[71]=k,t[72]=C,t[73]=F):F=t[73];let V;return t[74]!==S||t[75]!==F?(V=d.jsxs(d.Fragment,{children:[S,F]}),t[74]=S,t[75]=F,t[76]=V):V=t[76],V});function d7(n){ie.groupDuplicatedCrosslinks=n}function h7(n){ie.aminoAcidsMustMatch=n}function f7(n){const{key:e,name:t}=n;return d.jsx(Ai,{value:e,children:t},e)}const Tg=n=>{const e=document.createElement("a"),t=new Blob([A2(E2(n))],{type:"application/octet-stream"});e.href=URL.createObjectURL(t),e.download="project.xlinkup",e.click()};let Mg;const p7=({closeProject:n,ref:e,...t})=>{const{experiments:r}=Je(ie),i=h1({defaultValue:r.length===0?"empty":r[0].id,activationMode:"manual"}),s=_.useMemo(()=>r.find(({id:f})=>f===i.value),[r,i.value]),o=r.length>1;(i.value!=="compare"||!o)&&i.value!=="proteins"&&i.value!=="structures"&&(r.length===0?i.setValue("empty"):s||i.setValue(r[0].id));const a=!j2();sd("beforeunload",_.useCallback(f=>{a&&(f.preventDefault(),Mg=nt(Mg,{title:"Download a copy of the project?",description:"Any unsaved data will be lost.",type:"warning",action:{label:"Save Project",onClick:()=>Tg(JSON.stringify(qh()))}}))},[a]));const l=_.useRef(i.setValue);l.current=i.setValue;const c=_.useCallback(()=>{const f=document.createElement("input");f.type="file",f.accept="text/csv,.zhrm",f.multiple=!0,f.onchange=p=>{f.remove();const m=Array.from(f.files??[]);if(m.length===0)return;const g=yr.create({type:"loading",title:`Loading ${De(m.length,"file")}...`});_.startTransition(()=>{Promise.all(m.map(T2)).then(x=>{M2(x),yr.success({id:g,title:`Added ${De(m.length,"experiment")}`,description:null}),l.current(x[0].id)}).catch(x=>{yr.error({id:g,title:"Error",description:x.message})})})},f.click()},[]),u=_.useRef(null),h=_.useRef(null);return d.jsxs(xC,{size:"sm",value:i,lazyMount:!0,unmountOnExit:!0,my:5,variant:"subtle",ref:e,...t,children:[d.jsxs(Xi,{maxW:"5xl",children:[d.jsxs(bC,{w:"full",alignItems:"center",pb:1,children:[d.jsx(Re,{flexDirection:"column",alignSelf:"stretch",mb:-1,children:d.jsx(u7,{variant:"ghost",size:"md",pb:1,flexGrow:1,borderRadius:0,confirmBeforeClosing:a,saveProject:()=>Tg(JSON.stringify(qh())),closeProject:n})}),d.jsx(Ur,{orientation:"vertical",alignSelf:"stretch",mr:1,mb:-1}),d.jsxs(Re,{wrap:"wrap",grow:1,children:[r.map((f,p)=>d.jsxs(zs,{gap:0,children:[d.jsx($z,{experimentId:f.id,experimentName:f.name}),p===r.length-1&&d.jsx(mt,{size:"xs",variant:"ghost",alignSelf:"center",ml:2,onClick:c,children:d.jsx(Jr,{})})]},f.id)),r.length===0&&d.jsxs(ke,{variant:"outline",size:"sm",onClick:c,children:[d.jsx(Jr,{}),"Add experiments to the project"]})]}),d.jsx(Ur,{orientation:"vertical",alignSelf:"stretch",mx:1,mb:-1}),o&&d.jsx(sb,{value:"compare",flexShrink:0,height:"4.5rem",children:"Compare"}),d.jsxs(zs,{flexShrink:0,orientation:"vertical",gap:0,alignItems:"stretch",children:[d.jsx(e7,{value:"proteins",openAddReferenceProteinDialogRef:u}),d.jsx(W9,{value:"structures",openAddStructuresDialogRef:h})]})]}),d.jsx(Ur,{})]}),d.jsx(Wo,{value:"compare",children:d.jsx(a7,{})}),d.jsx(Wo,{value:"proteins",children:d.jsx(U9,{onAddReferneceProteinClicked:u?.current??void 0})}),d.jsx(Wo,{value:"structures",children:d.jsx(n7,{onAddStructureClicked:h?.current??void 0})}),r.map(f=>d.jsx(Wo,{value:f.id,children:d.jsx(Ez,{experiment:f})},f.id))]})},F7=({initProps:n,closeProject:e})=>{const t=_.useRef(!1);return t.current||(I2(n),t.current=!0),d.jsx(p7,{closeProject:e})};export{F7 as XLAppWrapper};
